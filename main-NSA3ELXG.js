import{$ as Xt,$a as We,A as Ni,Aa as is,B as nu,Ba as rs,C as Jo,Ca as Kt,D as Nn,Da as fu,E as el,Ea as ll,F as iu,Fa as pu,G as ke,Ga as cl,H as Qo,Ha as Wt,I as Cn,Ia as Dn,J as xt,Ja as je,K as nl,Ka as ci,L as Fr,La as gu,M as nt,Ma as os,N as Sn,Na as mu,O as ru,Oa as hl,P as yt,Pa as He,Q as _t,Qa as ve,R as G,Ra as ye,S as Fi,Sa as ss,T as ou,Ta as Vn,U as ln,Ua as zn,V as _e,Va as fe,W as qt,Wa as rt,X as Yt,Xa as ct,Y as cn,Ya as Jt,Z as Fn,Za as Se,_ as Bi,_a as $e,a as j,aa as Br,ab as Ze,b as Pt,ba as su,bb as kt,c as Qa,ca as Ge,cb as Rt,d as pm,da as li,db as Gi,e as gm,ea as il,eb as hi,f as Yh,fa as rl,fb as ui,g as Xh,ga as wt,gb as _u,h as Yo,ha as au,hb as vu,i as sn,ia as lu,ib as hn,j as Oe,ja as Bn,jb as yu,k as Ie,ka as re,kb as At,l as Le,la as Vi,lb as xn,m as mt,ma as zi,mb as wu,n as Kh,na as ts,nb as zr,o as tl,oa as cu,ob as bu,p as Jh,pa as ol,pb as Cu,q as Bt,qa as hu,qb as Su,r as Qh,ra as Ui,rb as di,s as kn,sa as uu,sb as Un,t as tu,ta as sl,tb as Lt,u as Xo,ua as es,ub as Ur,v as Ko,va as st,vb as Du,w as an,wa as Vr,wb as ul,x as kr,xa as du,y as Nr,ya as ns,z as eu,za as al}from"./chunk-FAWL4DN2.js";var Kd=pm((Vs,Xd)=>{"use strict";(function(r,t){typeof Vs=="object"&&typeof Xd<"u"?t(Vs):typeof define=="function"&&define.amd?define(["exports"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.leaflet={}))})(Vs,function(r){"use strict";var t="1.9.4";function e(n){var s,c,d,f;for(c=1,d=arguments.length;c<d;c++){f=arguments[c];for(s in f)n[s]=f[s]}return n}var i=Object.create||(function(){function n(){}return function(s){return n.prototype=s,new n}})();function o(n,s){var c=Array.prototype.slice;if(n.bind)return n.bind.apply(n,c.call(arguments,1));var d=c.call(arguments,2);return function(){return n.apply(s,d.length?d.concat(c.call(arguments)):arguments)}}var a=0;function l(n){return"_leaflet_id"in n||(n._leaflet_id=++a),n._leaflet_id}function h(n,s,c){var d,f,_,C;return C=function(){d=!1,f&&(_.apply(c,f),f=!1)},_=function(){d?f=arguments:(n.apply(c,arguments),setTimeout(C,s),d=!0)},_}function u(n,s,c){var d=s[1],f=s[0],_=d-f;return n===d&&c?n:((n-f)%_+_)%_+f}function p(){return!1}function g(n,s){if(s===!1)return n;var c=Math.pow(10,s===void 0?6:s);return Math.round(n*c)/c}function m(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function v(n){return m(n).split(/\s+/)}function y(n,s){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var c in s)n.options[c]=s[c];return n.options}function b(n,s,c){var d=[];for(var f in n)d.push(encodeURIComponent(c?f.toUpperCase():f)+"="+encodeURIComponent(n[f]));return(!s||s.indexOf("?")===-1?"?":"&")+d.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function D(n,s){return n.replace(E,function(c,d){var f=s[d];if(f===void 0)throw new Error("No value provided for variable "+c);return typeof f=="function"&&(f=f(s)),f})}var x=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,s){for(var c=0;c<n.length;c++)if(n[c]===s)return c;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var z=0;function U(n){var s=+new Date,c=Math.max(0,16-(s-z));return z=s+c,window.setTimeout(n,c)}var $=window.requestAnimationFrame||R("RequestAnimationFrame")||U,H=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function Z(n,s,c){if(c&&$===U)n.call(s);else return $.call(window,o(n,s))}function Y(n){n&&H.call(window,n)}var pt={__proto__:null,extend:e,create:i,bind:o,get lastId(){return a},stamp:l,throttle:h,wrapNum:u,falseFn:p,formatNum:g,trim:m,splitWords:v,setOptions:y,getParamString:b,template:D,isArray:x,indexOf:A,emptyImageUrl:T,requestFn:$,cancelFn:H,requestAnimFrame:Z,cancelAnimFrame:Y};function q(){}q.extend=function(n){var s=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=s.__super__=this.prototype,d=i(c);d.constructor=s,s.prototype=d;for(var f in this)Object.prototype.hasOwnProperty.call(this,f)&&f!=="prototype"&&f!=="__super__"&&(s[f]=this[f]);return n.statics&&e(s,n.statics),n.includes&&(vt(n.includes),e.apply(null,[d].concat(n.includes))),e(d,n),delete d.statics,delete d.includes,d.options&&(d.options=c.options?i(c.options):{},e(d.options,n.options)),d._initHooks=[],d.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var _=0,C=d._initHooks.length;_<C;_++)d._initHooks[_].call(this)}},s},q.include=function(n){var s=this.prototype.options;return e(this.prototype,n),n.options&&(this.prototype.options=s,this.mergeOptions(n.options)),this},q.mergeOptions=function(n){return e(this.prototype.options,n),this},q.addInitHook=function(n){var s=Array.prototype.slice.call(arguments,1),c=typeof n=="function"?n:function(){this[n].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function vt(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=x(n)?n:[n];for(var s=0;s<n.length;s++)n[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Q={on:function(n,s,c){if(typeof n=="object")for(var d in n)this._on(d,n[d],s);else{n=v(n);for(var f=0,_=n.length;f<_;f++)this._on(n[f],s,c)}return this},off:function(n,s,c){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var d in n)this._off(d,n[d],s);else{n=v(n);for(var f=arguments.length===1,_=0,C=n.length;_<C;_++)f?this._off(n[_]):this._off(n[_],s,c)}return this},_on:function(n,s,c,d){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(n,s,c)===!1){c===this&&(c=void 0);var f={fn:s,ctx:c};d&&(f.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(f)}},_off:function(n,s,c){var d,f,_;if(this._events&&(d=this._events[n],!!d)){if(arguments.length===1){if(this._firingCount)for(f=0,_=d.length;f<_;f++)d[f].fn=p;delete this._events[n];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var C=this._listens(n,s,c);if(C!==!1){var M=d[C];this._firingCount&&(M.fn=p,this._events[n]=d=d.slice()),d.splice(C,1)}}},fire:function(n,s,c){if(!this.listens(n,c))return this;var d=e({},s,{type:n,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var f=this._events[n];if(f){this._firingCount=this._firingCount+1||1;for(var _=0,C=f.length;_<C;_++){var M=f[_],P=M.fn;M.once&&this.off(n,P,M.ctx),P.call(M.ctx||this,d)}this._firingCount--}}return c&&this._propagateEvent(d),this},listens:function(n,s,c,d){typeof n!="string"&&console.warn('"string" type argument expected');var f=s;typeof s!="function"&&(d=!!s,f=void 0,c=void 0);var _=this._events&&this._events[n];if(_&&_.length&&this._listens(n,f,c)!==!1)return!0;if(d){for(var C in this._eventParents)if(this._eventParents[C].listens(n,s,c,d))return!0}return!1},_listens:function(n,s,c){if(!this._events)return!1;var d=this._events[n]||[];if(!s)return!!d.length;c===this&&(c=void 0);for(var f=0,_=d.length;f<_;f++)if(d[f].fn===s&&d[f].ctx===c)return f;return!1},once:function(n,s,c){if(typeof n=="object")for(var d in n)this._on(d,n[d],s,!0);else{n=v(n);for(var f=0,_=n.length;f<_;f++)this._on(n[f],s,c,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[l(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[l(n)],this},_propagateEvent:function(n){for(var s in this._eventParents)this._eventParents[s].fire(n.type,e({layer:n.target,propagatedFrom:n.target},n),!0)}};Q.addEventListener=Q.on,Q.removeEventListener=Q.clearAllEventListeners=Q.off,Q.addOneTimeEventListener=Q.once,Q.fireEvent=Q.fire,Q.hasEventListeners=Q.listens;var X=q.extend(Q);function k(n,s,c){this.x=c?Math.round(n):n,this.y=c?Math.round(s):s}var Et=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};k.prototype={clone:function(){return new k(this.x,this.y)},add:function(n){return this.clone()._add(B(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(B(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new k(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new k(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Et(this.x),this.y=Et(this.y),this},distanceTo:function(n){n=B(n);var s=n.x-this.x,c=n.y-this.y;return Math.sqrt(s*s+c*c)},equals:function(n){return n=B(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=B(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function B(n,s,c){return n instanceof k?n:x(n)?new k(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new k(n.x,n.y):new k(n,s,c)}function tt(n,s){if(n)for(var c=s?[n,s]:n,d=0,f=c.length;d<f;d++)this.extend(c[d])}tt.prototype={extend:function(n){var s,c;if(!n)return this;if(n instanceof k||typeof n[0]=="number"||"x"in n)s=c=B(n);else if(n=at(n),s=n.min,c=n.max,!s||!c)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=c.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(n){return B((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return B(this.min.x,this.max.y)},getTopRight:function(){return B(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var s,c;return typeof n[0]=="number"||n instanceof k?n=B(n):n=at(n),n instanceof tt?(s=n.min,c=n.max):s=c=n,s.x>=this.min.x&&c.x<=this.max.x&&s.y>=this.min.y&&c.y<=this.max.y},intersects:function(n){n=at(n);var s=this.min,c=this.max,d=n.min,f=n.max,_=f.x>=s.x&&d.x<=c.x,C=f.y>=s.y&&d.y<=c.y;return _&&C},overlaps:function(n){n=at(n);var s=this.min,c=this.max,d=n.min,f=n.max,_=f.x>s.x&&d.x<c.x,C=f.y>s.y&&d.y<c.y;return _&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var s=this.min,c=this.max,d=Math.abs(s.x-c.x)*n,f=Math.abs(s.y-c.y)*n;return at(B(s.x-d,s.y-f),B(c.x+d,c.y+f))},equals:function(n){return n?(n=at(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function at(n,s){return!n||n instanceof tt?n:new tt(n,s)}function K(n,s){if(n)for(var c=s?[n,s]:n,d=0,f=c.length;d<f;d++)this.extend(c[d])}K.prototype={extend:function(n){var s=this._southWest,c=this._northEast,d,f;if(n instanceof it)d=n,f=n;else if(n instanceof K){if(d=n._southWest,f=n._northEast,!d||!f)return this}else return n?this.extend(dt(n)||et(n)):this;return!s&&!c?(this._southWest=new it(d.lat,d.lng),this._northEast=new it(f.lat,f.lng)):(s.lat=Math.min(d.lat,s.lat),s.lng=Math.min(d.lng,s.lng),c.lat=Math.max(f.lat,c.lat),c.lng=Math.max(f.lng,c.lng)),this},pad:function(n){var s=this._southWest,c=this._northEast,d=Math.abs(s.lat-c.lat)*n,f=Math.abs(s.lng-c.lng)*n;return new K(new it(s.lat-d,s.lng-f),new it(c.lat+d,c.lng+f))},getCenter:function(){return new it((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new it(this.getNorth(),this.getWest())},getSouthEast:function(){return new it(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof it||"lat"in n?n=dt(n):n=et(n);var s=this._southWest,c=this._northEast,d,f;return n instanceof K?(d=n.getSouthWest(),f=n.getNorthEast()):d=f=n,d.lat>=s.lat&&f.lat<=c.lat&&d.lng>=s.lng&&f.lng<=c.lng},intersects:function(n){n=et(n);var s=this._southWest,c=this._northEast,d=n.getSouthWest(),f=n.getNorthEast(),_=f.lat>=s.lat&&d.lat<=c.lat,C=f.lng>=s.lng&&d.lng<=c.lng;return _&&C},overlaps:function(n){n=et(n);var s=this._southWest,c=this._northEast,d=n.getSouthWest(),f=n.getNorthEast(),_=f.lat>s.lat&&d.lat<c.lat,C=f.lng>s.lng&&d.lng<c.lng;return _&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,s){return n?(n=et(n),this._southWest.equals(n.getSouthWest(),s)&&this._northEast.equals(n.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function et(n,s){return n instanceof K?n:new K(n,s)}function it(n,s,c){if(isNaN(n)||isNaN(s))throw new Error("Invalid LatLng object: ("+n+", "+s+")");this.lat=+n,this.lng=+s,c!==void 0&&(this.alt=+c)}it.prototype={equals:function(n,s){if(!n)return!1;n=dt(n);var c=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return c<=(s===void 0?1e-9:s)},toString:function(n){return"LatLng("+g(this.lat,n)+", "+g(this.lng,n)+")"},distanceTo:function(n){return ce.distance(this,dt(n))},wrap:function(){return ce.wrapLatLng(this)},toBounds:function(n){var s=180*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return et([this.lat-s,this.lng-c],[this.lat+s,this.lng+c])},clone:function(){return new it(this.lat,this.lng,this.alt)}};function dt(n,s,c){return n instanceof it?n:x(n)&&typeof n[0]!="object"?n.length===3?new it(n[0],n[1],n[2]):n.length===2?new it(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new it(n.lat,"lng"in n?n.lng:n.lon,n.alt):s===void 0?null:new it(n,s,c)}var ge={latLngToPoint:function(n,s){var c=this.projection.project(n),d=this.scale(s);return this.transformation._transform(c,d)},pointToLatLng:function(n,s){var c=this.scale(s),d=this.transformation.untransform(n,c);return this.projection.unproject(d)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var s=this.projection.bounds,c=this.scale(n),d=this.transformation.transform(s.min,c),f=this.transformation.transform(s.max,c);return new tt(d,f)},infinite:!1,wrapLatLng:function(n){var s=this.wrapLng?u(n.lng,this.wrapLng,!0):n.lng,c=this.wrapLat?u(n.lat,this.wrapLat,!0):n.lat,d=n.alt;return new it(c,s,d)},wrapLatLngBounds:function(n){var s=n.getCenter(),c=this.wrapLatLng(s),d=s.lat-c.lat,f=s.lng-c.lng;if(d===0&&f===0)return n;var _=n.getSouthWest(),C=n.getNorthEast(),M=new it(_.lat-d,_.lng-f),P=new it(C.lat-d,C.lng-f);return new K(M,P)}},ce=e({},ge,{wrapLng:[-180,180],R:6371e3,distance:function(n,s){var c=Math.PI/180,d=n.lat*c,f=s.lat*c,_=Math.sin((s.lat-n.lat)*c/2),C=Math.sin((s.lng-n.lng)*c/2),M=_*_+Math.cos(d)*Math.cos(f)*C*C,P=2*Math.atan2(Math.sqrt(M),Math.sqrt(1-M));return this.R*P}}),_n=6378137,he={R:_n,MAX_LATITUDE:85.0511287798,project:function(n){var s=Math.PI/180,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,n.lat),-c),f=Math.sin(d*s);return new k(this.R*n.lng*s,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(n){var s=180/Math.PI;return new it((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*s,n.x*s/this.R)},bounds:(function(){var n=_n*Math.PI;return new tt([-n,-n],[n,n])})()};function ti(n,s,c,d){if(x(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=s,this._c=c,this._d=d}ti.prototype={transform:function(n,s){return this._transform(n.clone(),s)},_transform:function(n,s){return s=s||1,n.x=s*(this._a*n.x+this._b),n.y=s*(this._c*n.y+this._d),n},untransform:function(n,s){return s=s||1,new k((n.x/s-this._b)/this._a,(n.y/s-this._d)/this._c)}};function ne(n,s,c,d){return new ti(n,s,c,d)}var be=e({},ce,{code:"EPSG:3857",projection:he,transformation:(function(){var n=.5/(Math.PI*he.R);return ne(n,.5,-n,.5)})()}),Ce=e({},be,{code:"EPSG:900913"});function Ft(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Ut(n,s){var c="",d,f,_,C,M,P;for(d=0,_=n.length;d<_;d++){for(M=n[d],f=0,C=M.length;f<C;f++)P=M[f],c+=(f?"L":"M")+P.x+" "+P.y;c+=s?J.svg?"z":"x":""}return c||"M0 0"}var Zt=document.documentElement.style,Gt="ActiveXObject"in window,ue=Gt&&!document.addEventListener,Po="msLaunchUri"in navigator&&!("documentMode"in document),br=en("webkit"),ei=en("android"),Ao=en("android 2")||en("android 3"),Da=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ni=ei&&en("Google")&&Da<537&&!("AudioNode"in window),On=!!window.opera,$c=!Po&&en("chrome"),Wc=en("gecko")&&!br&&!On&&!Gt,qp=!$c&&en("safari"),Zc=en("phantom"),qc="OTransition"in Zt,Yp=navigator.platform.indexOf("Win")===0,Yc=Gt&&"transition"in Zt,xa="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ao,Xc="MozPerspective"in Zt,Xp=!window.L_DISABLE_3D&&(Yc||xa||Xc)&&!qc&&!Zc,Cr=typeof orientation<"u"||en("mobile"),Kp=Cr&&br,Jp=Cr&&xa,Kc=!window.PointerEvent&&window.MSPointerEvent,Jc=!!(window.PointerEvent||Kc),Qc="ontouchstart"in window||!!window.TouchEvent,Qp=!window.L_NO_TOUCH&&(Qc||Jc),tg=Cr&&On,eg=Cr&&Wc,ng=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ig=(function(){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",p,s),window.removeEventListener("testPassiveEventSupport",p,s)}catch{}return n})(),rg=(function(){return!!document.createElement("canvas").getContext})(),Ea=!!(document.createElementNS&&Ft("svg").createSVGRect),og=!!Ea&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),sg=!Ea&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var s=n.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}})(),ag=navigator.platform.indexOf("Mac")===0,lg=navigator.platform.indexOf("Linux")===0;function en(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var J={ie:Gt,ielt9:ue,edge:Po,webkit:br,android:ei,android23:Ao,androidStock:ni,opera:On,chrome:$c,gecko:Wc,safari:qp,phantom:Zc,opera12:qc,win:Yp,ie3d:Yc,webkit3d:xa,gecko3d:Xc,any3d:Xp,mobile:Cr,mobileWebkit:Kp,mobileWebkit3d:Jp,msPointer:Kc,pointer:Jc,touch:Qp,touchNative:Qc,mobileOpera:tg,mobileGecko:eg,retina:ng,passiveEvents:ig,canvas:rg,svg:Ea,vml:sg,inlineSvg:og,mac:ag,linux:lg},th=J.msPointer?"MSPointerDown":"pointerdown",eh=J.msPointer?"MSPointerMove":"pointermove",nh=J.msPointer?"MSPointerUp":"pointerup",ih=J.msPointer?"MSPointerCancel":"pointercancel",Ma={touchstart:th,touchmove:eh,touchend:nh,touchcancel:ih},rh={touchstart:pg,touchmove:Ro,touchend:Ro,touchcancel:Ro},Mi={},oh=!1;function cg(n,s,c){return s==="touchstart"&&fg(),rh[s]?(c=rh[s].bind(this,c),n.addEventListener(Ma[s],c,!1),c):(console.warn("wrong event specified:",s),p)}function hg(n,s,c){if(!Ma[s]){console.warn("wrong event specified:",s);return}n.removeEventListener(Ma[s],c,!1)}function ug(n){Mi[n.pointerId]=n}function dg(n){Mi[n.pointerId]&&(Mi[n.pointerId]=n)}function sh(n){delete Mi[n.pointerId]}function fg(){oh||(document.addEventListener(th,ug,!0),document.addEventListener(eh,dg,!0),document.addEventListener(nh,sh,!0),document.addEventListener(ih,sh,!0),oh=!0)}function Ro(n,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var c in Mi)s.touches.push(Mi[c]);s.changedTouches=[s],n(s)}}function pg(n,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&ie(s),Ro(n,s)}function gg(n){var s={},c,d;for(d in n)c=n[d],s[d]=c&&c.bind?c.bind(n):c;return n=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var mg=200;function _g(n,s){n.addEventListener("dblclick",s);var c=0,d;function f(_){if(_.detail!==1){d=_.detail;return}if(!(_.pointerType==="mouse"||_.sourceCapabilities&&!_.sourceCapabilities.firesTouchEvents)){var C=uh(_);if(!(C.some(function(P){return P instanceof HTMLLabelElement&&P.attributes.for})&&!C.some(function(P){return P instanceof HTMLInputElement||P instanceof HTMLSelectElement}))){var M=Date.now();M-c<=mg?(d++,d===2&&s(gg(_))):d=1,c=M}}}return n.addEventListener("click",f),{dblclick:s,simDblclick:f}}function vg(n,s){n.removeEventListener("dblclick",s.dblclick),n.removeEventListener("click",s.simDblclick)}var Ta=Lo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Sr=Lo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ah=Sr==="webkitTransition"||Sr==="OTransition"?Sr+"End":"transitionend";function lh(n){return typeof n=="string"?document.getElementById(n):n}function Dr(n,s){var c=n.style[s]||n.currentStyle&&n.currentStyle[s];if((!c||c==="auto")&&document.defaultView){var d=document.defaultView.getComputedStyle(n,null);c=d?d[s]:null}return c==="auto"?null:c}function Dt(n,s,c){var d=document.createElement(n);return d.className=s||"",c&&c.appendChild(d),d}function Nt(n){var s=n.parentNode;s&&s.removeChild(n)}function Oo(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Ti(n){var s=n.parentNode;s&&s.lastChild!==n&&s.appendChild(n)}function Pi(n){var s=n.parentNode;s&&s.firstChild!==n&&s.insertBefore(n,s.firstChild)}function Pa(n,s){if(n.classList!==void 0)return n.classList.contains(s);var c=Io(n);return c.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(c)}function ft(n,s){if(n.classList!==void 0)for(var c=v(s),d=0,f=c.length;d<f;d++)n.classList.add(c[d]);else if(!Pa(n,s)){var _=Io(n);Aa(n,(_?_+" ":"")+s)}}function jt(n,s){n.classList!==void 0?n.classList.remove(s):Aa(n,m((" "+Io(n)+" ").replace(" "+s+" "," ")))}function Aa(n,s){n.className.baseVal===void 0?n.className=s:n.className.baseVal=s}function Io(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Pe(n,s){"opacity"in n.style?n.style.opacity=s:"filter"in n.style&&yg(n,s)}function yg(n,s){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=n.filters.item(d)}catch{if(s===1)return}s=Math.round(s*100),c?(c.Enabled=s!==100,c.Opacity=s):n.style.filter+=" progid:"+d+"(opacity="+s+")"}function Lo(n){for(var s=document.documentElement.style,c=0;c<n.length;c++)if(n[c]in s)return n[c];return!1}function ii(n,s,c){var d=s||new k(0,0);n.style[Ta]=(J.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")}function Ht(n,s){n._leaflet_pos=s,J.any3d?ii(n,s):(n.style.left=s.x+"px",n.style.top=s.y+"px")}function ri(n){return n._leaflet_pos||new k(0,0)}var xr,Er,Ra;if("onselectstart"in document)xr=function(){ut(window,"selectstart",ie)},Er=function(){It(window,"selectstart",ie)};else{var Mr=Lo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);xr=function(){if(Mr){var n=document.documentElement.style;Ra=n[Mr],n[Mr]="none"}},Er=function(){Mr&&(document.documentElement.style[Mr]=Ra,Ra=void 0)}}function Oa(){ut(window,"dragstart",ie)}function Ia(){It(window,"dragstart",ie)}var ko,La;function ka(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(No(),ko=n,La=n.style.outlineStyle,n.style.outlineStyle="none",ut(window,"keydown",No))}function No(){ko&&(ko.style.outlineStyle=La,ko=void 0,La=void 0,It(window,"keydown",No))}function ch(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Na(n){var s=n.getBoundingClientRect();return{x:s.width/n.offsetWidth||1,y:s.height/n.offsetHeight||1,boundingClientRect:s}}var wg={__proto__:null,TRANSFORM:Ta,TRANSITION:Sr,TRANSITION_END:ah,get:lh,getStyle:Dr,create:Dt,remove:Nt,empty:Oo,toFront:Ti,toBack:Pi,hasClass:Pa,addClass:ft,removeClass:jt,setClass:Aa,getClass:Io,setOpacity:Pe,testProp:Lo,setTransform:ii,setPosition:Ht,getPosition:ri,get disableTextSelection(){return xr},get enableTextSelection(){return Er},disableImageDrag:Oa,enableImageDrag:Ia,preventOutline:ka,restoreOutline:No,getSizedParentNode:ch,getScale:Na};function ut(n,s,c,d){if(s&&typeof s=="object")for(var f in s)Ba(n,f,s[f],c);else{s=v(s);for(var _=0,C=s.length;_<C;_++)Ba(n,s[_],c,d)}return this}var nn="_leaflet_events";function It(n,s,c,d){if(arguments.length===1)hh(n),delete n[nn];else if(s&&typeof s=="object")for(var f in s)Va(n,f,s[f],c);else if(s=v(s),arguments.length===2)hh(n,function(M){return A(s,M)!==-1});else for(var _=0,C=s.length;_<C;_++)Va(n,s[_],c,d);return this}function hh(n,s){for(var c in n[nn]){var d=c.split(/\d/)[0];(!s||s(d))&&Va(n,d,null,null,c)}}var Fa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ba(n,s,c,d){var f=s+l(c)+(d?"_"+l(d):"");if(n[nn]&&n[nn][f])return this;var _=function(M){return c.call(d||n,M||window.event)},C=_;!J.touchNative&&J.pointer&&s.indexOf("touch")===0?_=cg(n,s,_):J.touch&&s==="dblclick"?_=_g(n,_):"addEventListener"in n?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?n.addEventListener(Fa[s]||s,_,J.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(_=function(M){M=M||window.event,Ua(n,M)&&C(M)},n.addEventListener(Fa[s],_,!1)):n.addEventListener(s,C,!1):n.attachEvent("on"+s,_),n[nn]=n[nn]||{},n[nn][f]=_}function Va(n,s,c,d,f){f=f||s+l(c)+(d?"_"+l(d):"");var _=n[nn]&&n[nn][f];if(!_)return this;!J.touchNative&&J.pointer&&s.indexOf("touch")===0?hg(n,s,_):J.touch&&s==="dblclick"?vg(n,_):"removeEventListener"in n?n.removeEventListener(Fa[s]||s,_,!1):n.detachEvent("on"+s,_),n[nn][f]=null}function oi(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function za(n){return Ba(n,"wheel",oi),this}function Tr(n){return ut(n,"mousedown touchstart dblclick contextmenu",oi),n._leaflet_disable_click=!0,this}function ie(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function si(n){return ie(n),oi(n),this}function uh(n){if(n.composedPath)return n.composedPath();for(var s=[],c=n.target;c;)s.push(c),c=c.parentNode;return s}function dh(n,s){if(!s)return new k(n.clientX,n.clientY);var c=Na(s),d=c.boundingClientRect;return new k((n.clientX-d.left)/c.x-s.clientLeft,(n.clientY-d.top)/c.y-s.clientTop)}var bg=J.linux&&J.chrome?window.devicePixelRatio:J.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fh(n){return J.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/bg:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Ua(n,s){var c=s.relatedTarget;if(!c)return!0;try{for(;c&&c!==n;)c=c.parentNode}catch{return!1}return c!==n}var Cg={__proto__:null,on:ut,off:It,stopPropagation:oi,disableScrollPropagation:za,disableClickPropagation:Tr,preventDefault:ie,stop:si,getPropagationPath:uh,getMousePosition:dh,getWheelDelta:fh,isExternalTarget:Ua,addListener:ut,removeListener:It},ph=X.extend({run:function(n,s,c,d){this.stop(),this._el=n,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=ri(n),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Z(this._animate,this),this._step()},_step:function(n){var s=+new Date-this._startTime,c=this._duration*1e3;s<c?this._runFrame(this._easeOut(s/c),n):(this._runFrame(1),this._complete())},_runFrame:function(n,s){var c=this._startPos.add(this._offset.multiplyBy(n));s&&c._round(),Ht(this._el,c),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Ct=X.extend({options:{crs:be,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,s){s=y(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(dt(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Sr&&J.any3d&&!J.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ut(this._proxy,ah,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,s,c){if(s=s===void 0?this._zoom:this._limitZoom(s),n=this._limitCenter(dt(n),s,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=e({animate:c.animate},c.zoom),c.pan=e({animate:c.animate,duration:c.duration},c.pan));var d=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,s,c.zoom):this._tryAnimatedPan(n,c.pan);if(d)return clearTimeout(this._sizeTimer),this}return this._resetView(n,s,c.pan&&c.pan.noMoveStart),this},setZoom:function(n,s){return this._loaded?this.setView(this.getCenter(),n,{zoom:s}):(this._zoom=n,this)},zoomIn:function(n,s){return n=n||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,s)},zoomOut:function(n,s){return n=n||(J.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,s)},setZoomAround:function(n,s,c){var d=this.getZoomScale(s),f=this.getSize().divideBy(2),_=n instanceof k?n:this.latLngToContainerPoint(n),C=_.subtract(f).multiplyBy(1-1/d),M=this.containerPointToLatLng(f.add(C));return this.setView(M,s,{zoom:c})},_getBoundsCenterZoom:function(n,s){s=s||{},n=n.getBounds?n.getBounds():et(n);var c=B(s.paddingTopLeft||s.padding||[0,0]),d=B(s.paddingBottomRight||s.padding||[0,0]),f=this.getBoundsZoom(n,!1,c.add(d));if(f=typeof s.maxZoom=="number"?Math.min(s.maxZoom,f):f,f===1/0)return{center:n.getCenter(),zoom:f};var _=d.subtract(c).divideBy(2),C=this.project(n.getSouthWest(),f),M=this.project(n.getNorthEast(),f),P=this.unproject(C.add(M).divideBy(2).add(_),f);return{center:P,zoom:f}},fitBounds:function(n,s){if(n=et(n),!n.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(n,s);return this.setView(c.center,c.zoom,s)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,s){return this.setView(n,this._zoom,{pan:s})},panBy:function(n,s){if(n=B(n).round(),s=s||{},!n.x&&!n.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ph,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){ft(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,c,s.duration||.25,s.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,s,c){if(c=c||{},c.animate===!1||!J.any3d)return this.setView(n,s,c);this._stop();var d=this.project(this.getCenter()),f=this.project(n),_=this.getSize(),C=this._zoom;n=dt(n),s=s===void 0?C:s;var M=Math.max(_.x,_.y),P=M*this.getZoomScale(C,s),F=f.distanceTo(d)||1,W=1.42,ot=W*W;function gt($t){var qo=$t?-1:1,hm=$t?P:M,um=P*P-M*M+qo*ot*ot*F*F,dm=2*hm*ot*F,Ja=um/dm,qh=Math.sqrt(Ja*Ja+1)-Ja,fm=qh<1e-9?-18:Math.log(qh);return fm}function de($t){return(Math.exp($t)-Math.exp(-$t))/2}function te($t){return(Math.exp($t)+Math.exp(-$t))/2}function Re($t){return de($t)/te($t)}var me=gt(0);function ki($t){return M*(te(me)/te(me+W*$t))}function sm($t){return M*(te(me)*Re(me+W*$t)-de(me))/ot}function am($t){return 1-Math.pow(1-$t,1.5)}var lm=Date.now(),Wh=(gt(1)-me)/W,cm=c.duration?1e3*c.duration:1e3*Wh*.8;function Zh(){var $t=(Date.now()-lm)/cm,qo=am($t)*Wh;$t<=1?(this._flyToFrame=Z(Zh,this),this._move(this.unproject(d.add(f.subtract(d).multiplyBy(sm(qo)/F)),C),this.getScaleZoom(M/ki(qo),C),{flyTo:!0})):this._move(n,s)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),Zh.call(this),this},flyToBounds:function(n,s){var c=this._getBoundsCenterZoom(n,s);return this.flyTo(c.center,c.zoom,s)},setMaxBounds:function(n){return n=et(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var s=this.options.minZoom;return this.options.minZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var s=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,s){this._enforcingBounds=!0;var c=this.getCenter(),d=this._limitCenter(c,this._zoom,et(n));return c.equals(d)||this.panTo(d,s),this._enforcingBounds=!1,this},panInside:function(n,s){s=s||{};var c=B(s.paddingTopLeft||s.padding||[0,0]),d=B(s.paddingBottomRight||s.padding||[0,0]),f=this.project(this.getCenter()),_=this.project(n),C=this.getPixelBounds(),M=at([C.min.add(c),C.max.subtract(d)]),P=M.getSize();if(!M.contains(_)){this._enforcingBounds=!0;var F=_.subtract(M.getCenter()),W=M.extend(_).getSize().subtract(P);f.x+=F.x<0?-W.x:W.x,f.y+=F.y<0?-W.y:W.y,this.panTo(this.unproject(f),s),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=e({animate:!1,pan:!0},n===!0?{animate:!0}:n);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),d=s.divideBy(2).round(),f=c.divideBy(2).round(),_=d.subtract(f);return!_.x&&!_.y?this:(n.animate&&n.pan?this.panBy(_):(n.pan&&this._rawPanBy(_),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=e({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=o(this._handleGeolocationResponse,this),c=o(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,c,n):navigator.geolocation.getCurrentPosition(s,c,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var s=n.code,c=n.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var s=n.coords.latitude,c=n.coords.longitude,d=new it(s,c),f=d.toBounds(n.coords.accuracy*2),_=this._locateOptions;if(_.setView){var C=this.getBoundsZoom(f);this.setView(d,_.maxZoom?Math.min(C,_.maxZoom):C)}var M={latlng:d,bounds:f,timestamp:n.timestamp};for(var P in n.coords)typeof n.coords[P]=="number"&&(M[P]=n.coords[P]);this.fire("locationfound",M)}},addHandler:function(n,s){if(!s)return this;var c=this[n]=new s(this);return this._handlers.push(c),this.options[n]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Nt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)Nt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,s){var c="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),d=Dt("div",c,s||this._mapPane);return n&&(this._panes[n]=d),d},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),s=this.unproject(n.getBottomLeft()),c=this.unproject(n.getTopRight());return new K(s,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,s,c){n=et(n),c=B(c||[0,0]);var d=this.getZoom()||0,f=this.getMinZoom(),_=this.getMaxZoom(),C=n.getNorthWest(),M=n.getSouthEast(),P=this.getSize().subtract(c),F=at(this.project(M,d),this.project(C,d)).getSize(),W=J.any3d?this.options.zoomSnap:1,ot=P.x/F.x,gt=P.y/F.y,de=s?Math.max(ot,gt):Math.min(ot,gt);return d=this.getScaleZoom(de,d),W&&(d=Math.round(d/(W/100))*(W/100),d=s?Math.ceil(d/W)*W:Math.floor(d/W)*W),Math.max(f,Math.min(_,d))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new k(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,s){var c=this._getTopLeftPoint(n,s);return new tt(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,s){var c=this.options.crs;return s=s===void 0?this._zoom:s,c.scale(n)/c.scale(s)},getScaleZoom:function(n,s){var c=this.options.crs;s=s===void 0?this._zoom:s;var d=c.zoom(n*c.scale(s));return isNaN(d)?1/0:d},project:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(dt(n),s)},unproject:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(B(n),s)},layerPointToLatLng:function(n){var s=B(n).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(n){var s=this.project(dt(n))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(dt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(et(n))},distance:function(n,s){return this.options.crs.distance(dt(n),dt(s))},containerPointToLayerPoint:function(n){return B(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return B(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var s=this.containerPointToLayerPoint(B(n));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(dt(n)))},mouseEventToContainerPoint:function(n){return dh(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var s=this._container=lh(n);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ut(s,"scroll",this._onScroll,this),this._containerId=l(s)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&J.any3d,ft(n,"leaflet-container"+(J.touch?" leaflet-touch":"")+(J.retina?" leaflet-retina":"")+(J.ielt9?" leaflet-oldie":"")+(J.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=Dr(n,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ht(this._mapPane,new k(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ft(n.markerPane,"leaflet-zoom-hide"),ft(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,s,c){Ht(this._mapPane,new k(0,0));var d=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var f=this._zoom!==s;this._moveStart(f,c)._move(n,s)._moveEnd(f),this.fire("viewreset"),d&&this.fire("load")},_moveStart:function(n,s){return n&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(n,s,c,d){s===void 0&&(s=this._zoom);var f=this._zoom!==s;return this._zoom=s,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),d?c&&c.pinch&&this.fire("zoom",c):((f||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Ht(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[l(this._container)]=this;var s=n?It:ut;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),J.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=Z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,s){for(var c=[],d,f=s==="mouseout"||s==="mouseover",_=n.target||n.srcElement,C=!1;_;){if(d=this._targets[l(_)],d&&(s==="click"||s==="preclick")&&this._draggableMoved(d)){C=!0;break}if(d&&d.listens(s,!0)&&(f&&!Ua(_,n)||(c.push(d),f))||_===this._container)break;_=_.parentNode}return!c.length&&!C&&!f&&this.listens(s,!0)&&(c=[this]),c},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var s=n.target||n.srcElement;if(!(!this._loaded||s._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(s))){var c=n.type;c==="mousedown"&&ka(s),this._fireDOMEvent(n,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,s,c){if(n.type==="click"){var d=e({},n);d.type="preclick",this._fireDOMEvent(d,d.type,c)}var f=this._findEventTargets(n,s);if(c){for(var _=[],C=0;C<c.length;C++)c[C].listens(s,!0)&&_.push(c[C]);f=_.concat(f)}if(f.length){s==="contextmenu"&&ie(n);var M=f[0],P={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var F=M.getLatLng&&(!M._radius||M._radius<=10);P.containerPoint=F?this.latLngToContainerPoint(M.getLatLng()):this.mouseEventToContainerPoint(n),P.layerPoint=this.containerPointToLayerPoint(P.containerPoint),P.latlng=F?M.getLatLng():this.layerPointToLatLng(P.layerPoint)}for(C=0;C<f.length;C++)if(f[C].fire(s,P,!0),P.originalEvent._stopped||f[C].options.bubblingMouseEvents===!1&&A(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,s=this._handlers.length;n<s;n++)this._handlers[n].disable()},whenReady:function(n,s){return this._loaded?n.call(s||this,{target:this}):this.on("load",n,s),this},_getMapPanePos:function(){return ri(this._mapPane)||new k(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,s){var c=n&&s!==void 0?this._getNewPixelOrigin(n,s):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,s){var c=this.getSize()._divideBy(2);return this.project(n,s)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,s,c){var d=this._getNewPixelOrigin(c,s);return this.project(n,s)._subtract(d)},_latLngBoundsToNewLayerBounds:function(n,s,c){var d=this._getNewPixelOrigin(c,s);return at([this.project(n.getSouthWest(),s)._subtract(d),this.project(n.getNorthWest(),s)._subtract(d),this.project(n.getSouthEast(),s)._subtract(d),this.project(n.getNorthEast(),s)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,s,c){if(!c)return n;var d=this.project(n,s),f=this.getSize().divideBy(2),_=new tt(d.subtract(f),d.add(f)),C=this._getBoundsOffset(_,c,s);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?n:this.unproject(d.add(C),s)},_limitOffset:function(n,s){if(!s)return n;var c=this.getPixelBounds(),d=new tt(c.min.add(n),c.max.add(n));return n.add(this._getBoundsOffset(d,s))},_getBoundsOffset:function(n,s,c){var d=at(this.project(s.getNorthEast(),c),this.project(s.getSouthWest(),c)),f=d.min.subtract(n.min),_=d.max.subtract(n.max),C=this._rebound(f.x,-_.x),M=this._rebound(f.y,-_.y);return new k(C,M)},_rebound:function(n,s){return n+s>0?Math.round(n-s)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(s))},_limitZoom:function(n){var s=this.getMinZoom(),c=this.getMaxZoom(),d=J.any3d?this.options.zoomSnap:1;return d&&(n=Math.round(n/d)*d),Math.max(s,Math.min(c,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){jt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,s){var c=this._getCenterOffset(n)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,s),!0)},_createAnimProxy:function(){var n=this._proxy=Dt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(s){var c=Ta,d=this._proxy.style[c];ii(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),d===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Nt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),s=this.getZoom();ii(this._proxy,this.project(n,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,s,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(s),f=this._getCenterOffset(n)._divideBy(1-1/d);return c.animate!==!0&&!this.getSize().contains(f)?!1:(Z(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(n,s,!0)},this),!0)},_animateZoom:function(n,s,c,d){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=s,ft(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:s,noUpdate:d}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&jt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Sg(n,s){return new Ct(n,s)}var ze=q.extend({options:{position:"topright"},initialize:function(n){y(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var s=this._map;return s&&s.removeControl(this),this.options.position=n,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var s=this._container=this.onAdd(n),c=this.getPosition(),d=n._controlCorners[c];return ft(s,"leaflet-control"),c.indexOf("bottom")!==-1?d.insertBefore(s,d.firstChild):d.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Nt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Pr=function(n){return new ze(n)};Ct.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},s="leaflet-",c=this._controlContainer=Dt("div",s+"control-container",this._container);function d(f,_){var C=s+f+" "+s+_;n[f+_]=Dt("div",C,c)}d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)Nt(this._controlCorners[n]);Nt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var gh=ze.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,s,c,d){return c<d?-1:d<c?1:0}},initialize:function(n,s,c){y(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var d in n)this._addLayer(n[d],d);for(d in s)this._addLayer(s[d],d,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return ze.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,s){return this._addLayer(n,s),this._map?this._update():this},addOverlay:function(n,s){return this._addLayer(n,s,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var s=this._getLayer(l(n));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){ft(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(ft(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):jt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return jt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",s=this._container=Dt("div",n),c=this.options.collapsed;s.setAttribute("aria-haspopup",!0),Tr(s),za(s);var d=this._section=Dt("section",n+"-list");c&&(this._map.on("click",this.collapse,this),ut(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var f=this._layersLink=Dt("a",n+"-toggle",s);f.href="#",f.title="Layers",f.setAttribute("role","button"),ut(f,{keydown:function(_){_.keyCode===13&&this._expandSafely()},click:function(_){ie(_),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=Dt("div",n+"-base",d),this._separator=Dt("div",n+"-separator",d),this._overlaysList=Dt("div",n+"-overlays",d),s.appendChild(d)},_getLayer:function(n){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&l(this._layers[s].layer)===n)return this._layers[s]},_addLayer:function(n,s,c){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:s,overlay:c}),this.options.sortLayers&&this._layers.sort(o(function(d,f){return this.options.sortFunction(d.layer,f.layer,d.name,f.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Oo(this._baseLayersList),Oo(this._overlaysList),this._layerControlInputs=[];var n,s,c,d,f=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),s=s||d.overlay,n=n||!d.overlay,f+=d.overlay?0:1;return this.options.hideSingleBase&&(n=n&&f>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=s&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var s=this._getLayer(l(n.target)),c=s.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;c&&this._map.fire(c,s)},_createRadioElement:function(n,s){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(s?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(n){var s=document.createElement("label"),c=this._map.hasLayer(n.layer),d;n.overlay?(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers_"+l(this),c),this._layerControlInputs.push(d),d.layerId=l(n.layer),ut(d,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+n.name;var _=document.createElement("span");s.appendChild(_),_.appendChild(d),_.appendChild(f);var C=n.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,s,c,d=[],f=[];this._handlingClick=!0;for(var _=n.length-1;_>=0;_--)s=n[_],c=this._getLayer(s.layerId).layer,s.checked?d.push(c):s.checked||f.push(c);for(_=0;_<f.length;_++)this._map.hasLayer(f[_])&&this._map.removeLayer(f[_]);for(_=0;_<d.length;_++)this._map.hasLayer(d[_])||this._map.addLayer(d[_]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,s,c,d=this._map.getZoom(),f=n.length-1;f>=0;f--)s=n[f],c=this._getLayer(s.layerId).layer,s.disabled=c.options.minZoom!==void 0&&d<c.options.minZoom||c.options.maxZoom!==void 0&&d>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,ut(n,"click",ie),this.expand();var s=this;setTimeout(function(){It(n,"click",ie),s._preventClick=!1})}}),Dg=function(n,s,c){return new gh(n,s,c)},Ga=ze.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var s="leaflet-control-zoom",c=Dt("div",s+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,s+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,s+"-out",c,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,s,c,d,f){var _=Dt("a",c,d);return _.innerHTML=n,_.href="#",_.title=s,_.setAttribute("role","button"),_.setAttribute("aria-label",s),Tr(_),ut(_,"click",si),ut(_,"click",f,this),ut(_,"click",this._refocusOnMap,this),_},_updateDisabled:function(){var n=this._map,s="leaflet-disabled";jt(this._zoomInButton,s),jt(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(ft(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(ft(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ga,this.addControl(this.zoomControl))});var xg=function(n){return new Ga(n)},mh=ze.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var s="leaflet-control-scale",c=Dt("div",s),d=this.options;return this._addScales(d,s+"-line",c),n.on(d.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),c},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,s,c){n.metric&&(this._mScale=Dt("div",s,c)),n.imperial&&(this._iScale=Dt("div",s,c))},_update:function(){var n=this._map,s=n.getSize().y/2,c=n.distance(n.containerPointToLatLng([0,s]),n.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(c)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var s=this._getRoundNum(n),c=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,c,s/n)},_updateImperial:function(n){var s=n*3.2808399,c,d,f;s>5280?(c=s/5280,d=this._getRoundNum(c),this._updateScale(this._iScale,d+" mi",d/c)):(f=this._getRoundNum(s),this._updateScale(this._iScale,f+" ft",f/s))},_updateScale:function(n,s,c){n.style.width=Math.round(this.options.maxWidth*c)+"px",n.innerHTML=s},_getRoundNum:function(n){var s=Math.pow(10,(Math.floor(n)+"").length-1),c=n/s;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,s*c}}),Eg=function(n){return new mh(n)},Mg='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ja=ze.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(J.inlineSvg?Mg+" ":"")+"Leaflet</a>"},initialize:function(n){y(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=Dt("div","leaflet-control-attribution"),Tr(this._container);for(var s in n._layers)n._layers[s].getAttribution&&this.addAttribution(n._layers[s].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var s in this._attributions)this._attributions[s]&&n.push(s);var c=[];this.options.prefix&&c.push(this.options.prefix),n.length&&c.push(n.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new ja().addTo(this)});var Tg=function(n){return new ja(n)};ze.Layers=gh,ze.Zoom=Ga,ze.Scale=mh,ze.Attribution=ja,Pr.layers=Dg,Pr.zoom=xg,Pr.scale=Eg,Pr.attribution=Tg;var rn=q.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});rn.addTo=function(n,s){return n.addHandler(s,this),this};var Pg={Events:Q},_h=J.touch?"touchstart mousedown":"mousedown",In=X.extend({options:{clickTolerance:3},initialize:function(n,s,c,d){y(this,d),this._element=n,this._dragStartTarget=s||n,this._preventOutline=c},enable:function(){this._enabled||(ut(this._dragStartTarget,_h,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(In._dragging===this&&this.finishDrag(!0),It(this._dragStartTarget,_h,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!Pa(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){In._dragging===this&&this.finishDrag();return}if(!(In._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(In._dragging=this,this._preventOutline&&ka(this._element),Oa(),xr(),!this._moving)){this.fire("down");var s=n.touches?n.touches[0]:n,c=ch(this._element);this._startPoint=new k(s.clientX,s.clientY),this._startPos=ri(this._element),this._parentScale=Na(c);var d=n.type==="mousedown";ut(document,d?"mousemove":"touchmove",this._onMove,this),ut(document,d?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var s=n.touches&&n.touches.length===1?n.touches[0]:n,c=new k(s.clientX,s.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,ie(n),this._moved||(this.fire("dragstart"),this._moved=!0,ft(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ft(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Ht(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){jt(document.body,"leaflet-dragging"),this._lastTarget&&(jt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),It(document,"mousemove touchmove",this._onMove,this),It(document,"mouseup touchend touchcancel",this._onUp,this),Ia(),Er();var s=this._moved&&this._moving;this._moving=!1,In._dragging=!1,s&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function vh(n,s,c){var d,f=[1,4,2,8],_,C,M,P,F,W,ot,gt;for(_=0,W=n.length;_<W;_++)n[_]._code=ai(n[_],s);for(M=0;M<4;M++){for(ot=f[M],d=[],_=0,W=n.length,C=W-1;_<W;C=_++)P=n[_],F=n[C],P._code&ot?F._code&ot||(gt=Fo(F,P,ot,s,c),gt._code=ai(gt,s),d.push(gt)):(F._code&ot&&(gt=Fo(F,P,ot,s,c),gt._code=ai(gt,s),d.push(gt)),d.push(P));n=d}return n}function yh(n,s){var c,d,f,_,C,M,P,F,W;if(!n||n.length===0)throw new Error("latlngs not passed");Ae(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var ot=dt([0,0]),gt=et(n),de=gt.getNorthWest().distanceTo(gt.getSouthWest())*gt.getNorthEast().distanceTo(gt.getNorthWest());de<1700&&(ot=Ha(n));var te=n.length,Re=[];for(c=0;c<te;c++){var me=dt(n[c]);Re.push(s.project(dt([me.lat-ot.lat,me.lng-ot.lng])))}for(M=P=F=0,c=0,d=te-1;c<te;d=c++)f=Re[c],_=Re[d],C=f.y*_.x-_.y*f.x,P+=(f.x+_.x)*C,F+=(f.y+_.y)*C,M+=C*3;M===0?W=Re[0]:W=[P/M,F/M];var ki=s.unproject(B(W));return dt([ki.lat+ot.lat,ki.lng+ot.lng])}function Ha(n){for(var s=0,c=0,d=0,f=0;f<n.length;f++){var _=dt(n[f]);s+=_.lat,c+=_.lng,d++}return dt([s/d,c/d])}var Ag={__proto__:null,clipPolygon:vh,polygonCenter:yh,centroid:Ha};function wh(n,s){if(!s||!n.length)return n.slice();var c=s*s;return n=Ig(n,c),n=Og(n,c),n}function bh(n,s,c){return Math.sqrt(Ar(n,s,c,!0))}function Rg(n,s,c){return Ar(n,s,c)}function Og(n,s){var c=n.length,d=typeof Uint8Array<"u"?Uint8Array:Array,f=new d(c);f[0]=f[c-1]=1,$a(n,f,s,0,c-1);var _,C=[];for(_=0;_<c;_++)f[_]&&C.push(n[_]);return C}function $a(n,s,c,d,f){var _=0,C,M,P;for(M=d+1;M<=f-1;M++)P=Ar(n[M],n[d],n[f],!0),P>_&&(C=M,_=P);_>c&&(s[C]=1,$a(n,s,c,d,C),$a(n,s,c,C,f))}function Ig(n,s){for(var c=[n[0]],d=1,f=0,_=n.length;d<_;d++)Lg(n[d],n[f])>s&&(c.push(n[d]),f=d);return f<_-1&&c.push(n[_-1]),c}var Ch;function Sh(n,s,c,d,f){var _=d?Ch:ai(n,c),C=ai(s,c),M,P,F;for(Ch=C;;){if(!(_|C))return[n,s];if(_&C)return!1;M=_||C,P=Fo(n,s,M,c,f),F=ai(P,c),M===_?(n=P,_=F):(s=P,C=F)}}function Fo(n,s,c,d,f){var _=s.x-n.x,C=s.y-n.y,M=d.min,P=d.max,F,W;return c&8?(F=n.x+_*(P.y-n.y)/C,W=P.y):c&4?(F=n.x+_*(M.y-n.y)/C,W=M.y):c&2?(F=P.x,W=n.y+C*(P.x-n.x)/_):c&1&&(F=M.x,W=n.y+C*(M.x-n.x)/_),new k(F,W,f)}function ai(n,s){var c=0;return n.x<s.min.x?c|=1:n.x>s.max.x&&(c|=2),n.y<s.min.y?c|=4:n.y>s.max.y&&(c|=8),c}function Lg(n,s){var c=s.x-n.x,d=s.y-n.y;return c*c+d*d}function Ar(n,s,c,d){var f=s.x,_=s.y,C=c.x-f,M=c.y-_,P=C*C+M*M,F;return P>0&&(F=((n.x-f)*C+(n.y-_)*M)/P,F>1?(f=c.x,_=c.y):F>0&&(f+=C*F,_+=M*F)),C=n.x-f,M=n.y-_,d?C*C+M*M:new k(f,_)}function Ae(n){return!x(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Dh(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ae(n)}function xh(n,s){var c,d,f,_,C,M,P,F;if(!n||n.length===0)throw new Error("latlngs not passed");Ae(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var W=dt([0,0]),ot=et(n),gt=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());gt<1700&&(W=Ha(n));var de=n.length,te=[];for(c=0;c<de;c++){var Re=dt(n[c]);te.push(s.project(dt([Re.lat-W.lat,Re.lng-W.lng])))}for(c=0,d=0;c<de-1;c++)d+=te[c].distanceTo(te[c+1])/2;if(d===0)F=te[0];else for(c=0,_=0;c<de-1;c++)if(C=te[c],M=te[c+1],f=C.distanceTo(M),_+=f,_>d){P=(_-d)/f,F=[M.x-P*(M.x-C.x),M.y-P*(M.y-C.y)];break}var me=s.unproject(B(F));return dt([me.lat+W.lat,me.lng+W.lng])}var kg={__proto__:null,simplify:wh,pointToSegmentDistance:bh,closestPointOnSegment:Rg,clipSegment:Sh,_getEdgeIntersection:Fo,_getBitCode:ai,_sqClosestPointOnSegment:Ar,isFlat:Ae,_flat:Dh,polylineCenter:xh},Wa={project:function(n){return new k(n.lng,n.lat)},unproject:function(n){return new it(n.y,n.x)},bounds:new tt([-180,-90],[180,90])},Za={R:6378137,R_MINOR:6356752314245179e-9,bounds:new tt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var s=Math.PI/180,c=this.R,d=n.lat*s,f=this.R_MINOR/c,_=Math.sqrt(1-f*f),C=_*Math.sin(d),M=Math.tan(Math.PI/4-d/2)/Math.pow((1-C)/(1+C),_/2);return d=-c*Math.log(Math.max(M,1e-10)),new k(n.lng*s*c,d)},unproject:function(n){for(var s=180/Math.PI,c=this.R,d=this.R_MINOR/c,f=Math.sqrt(1-d*d),_=Math.exp(-n.y/c),C=Math.PI/2-2*Math.atan(_),M=0,P=.1,F;M<15&&Math.abs(P)>1e-7;M++)F=f*Math.sin(C),F=Math.pow((1-F)/(1+F),f/2),P=Math.PI/2-2*Math.atan(_*F)-C,C+=P;return new it(C*s,n.x*s/c)}},Ng={__proto__:null,LonLat:Wa,Mercator:Za,SphericalMercator:he},Fg=e({},ce,{code:"EPSG:3395",projection:Za,transformation:(function(){var n=.5/(Math.PI*Za.R);return ne(n,.5,-n,.5)})()}),Eh=e({},ce,{code:"EPSG:4326",projection:Wa,transformation:ne(1/180,1,-1/180,.5)}),Bg=e({},ge,{projection:Wa,transformation:ne(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,s){var c=s.lng-n.lng,d=s.lat-n.lat;return Math.sqrt(c*c+d*d)},infinite:!0});ge.Earth=ce,ge.EPSG3395=Fg,ge.EPSG3857=be,ge.EPSG900913=Ce,ge.EPSG4326=Eh,ge.Simple=Bg;var Ue=X.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[l(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[l(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var s=n.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var c=this.getEvents();s.on(c,this),this.once("remove",function(){s.off(c,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var s=l(n);return this._layers[s]?this:(this._layers[s]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var s=l(n);return this._layers[s]?(this._loaded&&n.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return l(n)in this._layers},eachLayer:function(n,s){for(var c in this._layers)n.call(s,this._layers[c]);return this},_addLayers:function(n){n=n?x(n)?n:[n]:[];for(var s=0,c=n.length;s<c;s++)this.addLayer(n[s])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[l(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var s=l(n);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,s=-1/0,c=this._getZoomSpan();for(var d in this._zoomBoundLayers){var f=this._zoomBoundLayers[d].options;n=f.minZoom===void 0?n:Math.min(n,f.minZoom),s=f.maxZoom===void 0?s:Math.max(s,f.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=n===1/0?void 0:n,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ai=Ue.extend({initialize:function(n,s){y(this,s),this._layers={};var c,d;if(n)for(c=0,d=n.length;c<d;c++)this.addLayer(n[c])},addLayer:function(n){var s=this.getLayerId(n);return this._layers[s]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var s=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(n){var s=typeof n=="number"?n:this.getLayerId(n);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var s=Array.prototype.slice.call(arguments,1),c,d;for(c in this._layers)d=this._layers[c],d[n]&&d[n].apply(d,s);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,s){for(var c in this._layers)n.call(s,this._layers[c]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return l(n)}}),Vg=function(n,s){return new Ai(n,s)},vn=Ai.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Ai.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Ai.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new K;for(var s in this._layers){var c=this._layers[s];n.extend(c.getBounds?c.getBounds():c.getLatLng())}return n}}),zg=function(n,s){return new vn(n,s)},Ri=q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){y(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,s){var c=this._getIconUrl(n);if(!c){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(d,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),d},_setIconStyles:function(n,s){var c=this.options,d=c[s+"Size"];typeof d=="number"&&(d=[d,d]);var f=B(d),_=B(s==="shadow"&&c.shadowAnchor||c.iconAnchor||f&&f.divideBy(2,!0));n.className="leaflet-marker-"+s+" "+(c.className||""),_&&(n.style.marginLeft=-_.x+"px",n.style.marginTop=-_.y+"px"),f&&(n.style.width=f.x+"px",n.style.height=f.y+"px")},_createImg:function(n,s){return s=s||document.createElement("img"),s.src=n,s},_getIconUrl:function(n){return J.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ug(n){return new Ri(n)}var Rr=Ri.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Rr.imagePath!="string"&&(Rr.imagePath=this._detectIconPath()),(this.options.imagePath||Rr.imagePath)+Ri.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var s=function(c,d,f){var _=d.exec(c);return _&&_[f]};return n=s(n,/^url\((['"])?(.+)\1\)$/,2),n&&s(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Dt("div","leaflet-default-icon-path",document.body),s=Dr(n,"background-image")||Dr(n,"backgroundImage");if(document.body.removeChild(n),s=this._stripUrl(s),s)return s;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),Mh=rn.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new In(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ft(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&jt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var s=this._marker,c=s._map,d=this._marker.options.autoPanSpeed,f=this._marker.options.autoPanPadding,_=ri(s._icon),C=c.getPixelBounds(),M=c.getPixelOrigin(),P=at(C.min._subtract(M).add(f),C.max._subtract(M).subtract(f));if(!P.contains(_)){var F=B((Math.max(P.max.x,_.x)-P.max.x)/(C.max.x-P.max.x)-(Math.min(P.min.x,_.x)-P.min.x)/(C.min.x-P.min.x),(Math.max(P.max.y,_.y)-P.max.y)/(C.max.y-P.max.y)-(Math.min(P.min.y,_.y)-P.min.y)/(C.min.y-P.min.y)).multiplyBy(d);c.panBy(F,{animate:!1}),this._draggable._newPos._add(F),this._draggable._startPos._add(F),Ht(s._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=Z(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=Z(this._adjustPan.bind(this,n)))},_onDrag:function(n){var s=this._marker,c=s._shadow,d=ri(s._icon),f=s._map.layerPointToLatLng(d);c&&Ht(c,d),s._latlng=f,n.latlng=f,n.oldLatLng=this._oldLatLng,s.fire("move",n).fire("drag",n)},_onDragEnd:function(n){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Bo=Ue.extend({options:{icon:new Rr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,s){y(this,s),this._latlng=dt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var s=this._latlng;return this._latlng=dt(n),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=n.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,n.title&&(c.title=n.title),c.tagName==="IMG"&&(c.alt=n.alt||"")),ft(c,s),n.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ut(c,"focus",this._panOnFocus,this);var f=n.icon.createShadow(this._shadow),_=!1;f!==this._shadow&&(this._removeShadow(),_=!0),f&&(ft(f,s),f.alt=""),this._shadow=f,n.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&_&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&It(this._icon,"focus",this._panOnFocus,this),Nt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Nt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Ht(this._icon,n),this._shadow&&Ht(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(ft(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Mh)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Mh(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Pe(this._icon,n),this._shadow&&Pe(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var s=this.options.icon.options,c=s.iconSize?B(s.iconSize):B(0,0),d=s.iconAnchor?B(s.iconAnchor):B(0,0);n.panInside(this._latlng,{paddingTopLeft:d,paddingBottomRight:c.subtract(d)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Gg(n,s){return new Bo(n,s)}var Ln=Ue.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return y(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Vo=Ln.extend({options:{fill:!0,radius:10},initialize:function(n,s){y(this,s),this._latlng=dt(n),this._radius=this.options.radius},setLatLng:function(n){var s=this._latlng;return this._latlng=dt(n),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var s=n&&n.radius||this._radius;return Ln.prototype.setStyle.call(this,n),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,s=this._radiusY||n,c=this._clickTolerance(),d=[n+c,s+c];this._pxBounds=new tt(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jg(n,s){return new Vo(n,s)}var qa=Vo.extend({initialize:function(n,s,c){if(typeof s=="number"&&(s=e({},c,{radius:s})),y(this,s),this._latlng=dt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new K(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:Ln.prototype.setStyle,_project:function(){var n=this._latlng.lng,s=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===ce.distance){var f=Math.PI/180,_=this._mRadius/ce.R/f,C=c.project([s+_,n]),M=c.project([s-_,n]),P=C.add(M).divideBy(2),F=c.unproject(P).lat,W=Math.acos((Math.cos(_*f)-Math.sin(s*f)*Math.sin(F*f))/(Math.cos(s*f)*Math.cos(F*f)))/f;(isNaN(W)||W===0)&&(W=_/Math.cos(Math.PI/180*s)),this._point=P.subtract(c.getPixelOrigin()),this._radius=isNaN(W)?0:P.x-c.project([F,n-W]).x,this._radiusY=P.y-C.y}else{var ot=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(ot).x}this._updateBounds()}});function Hg(n,s,c){return new qa(n,s,c)}var yn=Ln.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,s){y(this,s),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var s=1/0,c=null,d=Ar,f,_,C=0,M=this._parts.length;C<M;C++)for(var P=this._parts[C],F=1,W=P.length;F<W;F++){f=P[F-1],_=P[F];var ot=d(n,f,_,!0);ot<s&&(s=ot,c=d(n,f,_))}return c&&(c.distance=Math.sqrt(s)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xh(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,s){return s=s||this._defaultShape(),n=dt(n),s.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new K,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Ae(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var s=[],c=Ae(n),d=0,f=n.length;d<f;d++)c?(s[d]=dt(n[d]),this._bounds.extend(s[d])):s[d]=this._convertLatLngs(n[d]);return s},_project:function(){var n=new tt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),s=new k(n,n);this._rawPxBounds&&(this._pxBounds=new tt([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(n,s,c){var d=n[0]instanceof it,f=n.length,_,C;if(d){for(C=[],_=0;_<f;_++)C[_]=this._map.latLngToLayerPoint(n[_]),c.extend(C[_]);s.push(C)}else for(_=0;_<f;_++)this._projectLatlngs(n[_],s,c)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,c,d,f,_,C,M,P;for(c=0,f=0,_=this._rings.length;c<_;c++)for(P=this._rings[c],d=0,C=P.length;d<C-1;d++)M=Sh(P[d],P[d+1],n,d,!0),M&&(s[f]=s[f]||[],s[f].push(M[0]),(M[1]!==P[d+1]||d===C-2)&&(s[f].push(M[1]),f++))}},_simplifyPoints:function(){for(var n=this._parts,s=this.options.smoothFactor,c=0,d=n.length;c<d;c++)n[c]=wh(n[c],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,s){var c,d,f,_,C,M,P=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(c=0,_=this._parts.length;c<_;c++)for(M=this._parts[c],d=0,C=M.length,f=C-1;d<C;f=d++)if(!(!s&&d===0)&&bh(n,M[f],M[d])<=P)return!0;return!1}});function $g(n,s){return new yn(n,s)}yn._flat=Dh;var Oi=yn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return yh(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var s=yn.prototype._convertLatLngs.call(this,n),c=s.length;return c>=2&&s[0]instanceof it&&s[0].equals(s[c-1])&&s.pop(),s},_setLatLngs:function(n){yn.prototype._setLatLngs.call(this,n),Ae(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ae(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,s=this.options.weight,c=new k(s,s);if(n=new tt(n.min.subtract(c),n.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var d=0,f=this._rings.length,_;d<f;d++)_=vh(this._rings[d],n,!0),_.length&&this._parts.push(_)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var s=!1,c,d,f,_,C,M,P,F;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(_=0,P=this._parts.length;_<P;_++)for(c=this._parts[_],C=0,F=c.length,M=F-1;C<F;M=C++)d=c[C],f=c[M],d.y>n.y!=f.y>n.y&&n.x<(f.x-d.x)*(n.y-d.y)/(f.y-d.y)+d.x&&(s=!s);return s||yn.prototype._containsPoint.call(this,n,!0)}});function Wg(n,s){return new Oi(n,s)}var wn=vn.extend({initialize:function(n,s){y(this,s),this._layers={},n&&this.addData(n)},addData:function(n){var s=x(n)?n:n.features,c,d,f;if(s){for(c=0,d=s.length;c<d;c++)f=s[c],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}var _=this.options;if(_.filter&&!_.filter(n))return this;var C=zo(n,_);return C?(C.feature=jo(n),C.defaultOptions=C.options,this.resetStyle(C),_.onEachFeature&&_.onEachFeature(n,C),this.addLayer(C)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=e({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(s){this._setLayerStyle(s,n)},this)},_setLayerStyle:function(n,s){n.setStyle&&(typeof s=="function"&&(s=s(n.feature)),n.setStyle(s))}});function zo(n,s){var c=n.type==="Feature"?n.geometry:n,d=c?c.coordinates:null,f=[],_=s&&s.pointToLayer,C=s&&s.coordsToLatLng||Ya,M,P,F,W;if(!d&&!c)return null;switch(c.type){case"Point":return M=C(d),Th(_,n,M,s);case"MultiPoint":for(F=0,W=d.length;F<W;F++)M=C(d[F]),f.push(Th(_,n,M,s));return new vn(f);case"LineString":case"MultiLineString":return P=Uo(d,c.type==="LineString"?0:1,C),new yn(P,s);case"Polygon":case"MultiPolygon":return P=Uo(d,c.type==="Polygon"?1:2,C),new Oi(P,s);case"GeometryCollection":for(F=0,W=c.geometries.length;F<W;F++){var ot=zo({geometry:c.geometries[F],type:"Feature",properties:n.properties},s);ot&&f.push(ot)}return new vn(f);case"FeatureCollection":for(F=0,W=c.features.length;F<W;F++){var gt=zo(c.features[F],s);gt&&f.push(gt)}return new vn(f);default:throw new Error("Invalid GeoJSON object.")}}function Th(n,s,c,d){return n?n(s,c):new Bo(c,d&&d.markersInheritOptions&&d)}function Ya(n){return new it(n[1],n[0],n[2])}function Uo(n,s,c){for(var d=[],f=0,_=n.length,C;f<_;f++)C=s?Uo(n[f],s-1,c):(c||Ya)(n[f]),d.push(C);return d}function Xa(n,s){return n=dt(n),n.alt!==void 0?[g(n.lng,s),g(n.lat,s),g(n.alt,s)]:[g(n.lng,s),g(n.lat,s)]}function Go(n,s,c,d){for(var f=[],_=0,C=n.length;_<C;_++)f.push(s?Go(n[_],Ae(n[_])?0:s-1,c,d):Xa(n[_],d));return!s&&c&&f.length>0&&f.push(f[0].slice()),f}function Ii(n,s){return n.feature?e({},n.feature,{geometry:s}):jo(s)}function jo(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Ka={toGeoJSON:function(n){return Ii(this,{type:"Point",coordinates:Xa(this.getLatLng(),n)})}};Bo.include(Ka),qa.include(Ka),Vo.include(Ka),yn.include({toGeoJSON:function(n){var s=!Ae(this._latlngs),c=Go(this._latlngs,s?1:0,!1,n);return Ii(this,{type:(s?"Multi":"")+"LineString",coordinates:c})}}),Oi.include({toGeoJSON:function(n){var s=!Ae(this._latlngs),c=s&&!Ae(this._latlngs[0]),d=Go(this._latlngs,c?2:s?1:0,!0,n);return s||(d=[d]),Ii(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}}),Ai.include({toMultiPoint:function(n){var s=[];return this.eachLayer(function(c){s.push(c.toGeoJSON(n).geometry.coordinates)}),Ii(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(n){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(n);var c=s==="GeometryCollection",d=[];return this.eachLayer(function(f){if(f.toGeoJSON){var _=f.toGeoJSON(n);if(c)d.push(_.geometry);else{var C=jo(_);C.type==="FeatureCollection"?d.push.apply(d,C.features):d.push(C)}}}),c?Ii(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});function Ph(n,s){return new wn(n,s)}var Zg=Ph,Ho=Ue.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,s,c){this._url=n,this._bounds=et(s),y(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ft(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Nt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Ti(this._image),this},bringToBack:function(){return this._map&&Pi(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=et(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",s=this._image=n?this._url:Dt("img");if(ft(s,"leaflet-image-layer"),this._zoomAnimated&&ft(s,"leaflet-zoom-animated"),this.options.className&&ft(s,this.options.className),s.onselectstart=p,s.onmousemove=p,s.onload=o(this.fire,this,"load"),s.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(n){var s=this._map.getZoomScale(n.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;ii(this._image,c,s)},_reset:function(){var n=this._image,s=new tt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=s.getSize();Ht(n,s.min),n.style.width=c.x+"px",n.style.height=c.y+"px"},_updateOpacity:function(){Pe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),qg=function(n,s,c){return new Ho(n,s,c)},Ah=Ho.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",s=this._image=n?this._url:Dt("video");if(ft(s,"leaflet-image-layer"),this._zoomAnimated&&ft(s,"leaflet-zoom-animated"),this.options.className&&ft(s,this.options.className),s.onselectstart=p,s.onmousemove=p,s.onloadeddata=o(this.fire,this,"load"),n){for(var c=s.getElementsByTagName("source"),d=[],f=0;f<c.length;f++)d.push(c[f].src);this._url=c.length>0?d:[s.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var _=0;_<this._url.length;_++){var C=Dt("source");C.src=this._url[_],s.appendChild(C)}}});function Yg(n,s,c){return new Ah(n,s,c)}var Rh=Ho.extend({_initImage:function(){var n=this._image=this._url;ft(n,"leaflet-image-layer"),this._zoomAnimated&&ft(n,"leaflet-zoom-animated"),this.options.className&&ft(n,this.options.className),n.onselectstart=p,n.onmousemove=p}});function Xg(n,s,c){return new Rh(n,s,c)}var on=Ue.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,s){n&&(n instanceof it||x(n))?(this._latlng=dt(n),y(this,s)):(y(this,n),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Pe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Pe(this._container,1),this.bringToFront(),this.options.interactive&&(ft(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Pe(this._container,0),this._removeTimeout=setTimeout(o(Nt,void 0,this._container),200)):Nt(this._container),this.options.interactive&&(jt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=dt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ti(this._container),this},bringToBack:function(){return this._map&&Pi(this._container),this},_prepareOpen:function(n){var s=this._source;if(!s._map)return!1;if(s instanceof vn){s=null;var c=this._source._layers;for(var d in c)if(c[d]._map){s=c[d];break}if(!s)return!1;this._source=s}if(!n)if(s.getCenter)n=s.getCenter();else if(s.getLatLng)n=s.getLatLng();else if(s.getBounds)n=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")n.innerHTML=s;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),s=B(this.options.offset),c=this._getAnchor();this._zoomAnimated?Ht(this._container,n.add(c)):s=s.add(n).add(c);var d=this._containerBottom=-s.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=d+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(n,s,c,d){var f=s;return f instanceof n||(f=new n(d).setContent(s)),c&&f.setLatLng(c),f}}),Ue.include({_initOverlay:function(n,s,c,d){var f=c;return f instanceof n?(y(f,d),f._source=this):(f=s&&!d?s:new n(d,this),f.setContent(c)),f}});var $o=on.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,on.prototype.openOn.call(this,n)},onAdd:function(n){on.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ln||this._source.on("preclick",oi))},onRemove:function(n){on.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ln||this._source.off("preclick",oi))},getEvents:function(){var n=on.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",s=this._container=Dt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=Dt("div",n+"-content-wrapper",s);if(this._contentNode=Dt("div",n+"-content",c),Tr(s),za(this._contentNode),ut(s,"contextmenu",oi),this._tipContainer=Dt("div",n+"-tip-container",s),this._tip=Dt("div",n+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=Dt("a",n+"-close-button",s);d.setAttribute("role","button"),d.setAttribute("aria-label","Close popup"),d.href="#close",d.innerHTML='<span aria-hidden="true">&#215;</span>',ut(d,"click",function(f){ie(f),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,s=n.style;s.width="",s.whiteSpace="nowrap";var c=n.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),s.width=c+1+"px",s.whiteSpace="",s.height="";var d=n.offsetHeight,f=this.options.maxHeight,_="leaflet-popup-scrolled";f&&d>f?(s.height=f+"px",ft(n,_)):jt(n,_),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),c=this._getAnchor();Ht(this._container,s.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,s=parseInt(Dr(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+s,d=this._containerWidth,f=new k(this._containerLeft,-c-this._containerBottom);f._add(ri(this._container));var _=n.layerPointToContainerPoint(f),C=B(this.options.autoPanPadding),M=B(this.options.autoPanPaddingTopLeft||C),P=B(this.options.autoPanPaddingBottomRight||C),F=n.getSize(),W=0,ot=0;_.x+d+P.x>F.x&&(W=_.x+d-F.x+P.x),_.x-W-M.x<0&&(W=_.x-M.x),_.y+c+P.y>F.y&&(ot=_.y+c-F.y+P.y),_.y-ot-M.y<0&&(ot=_.y-M.y),(W||ot)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([W,ot]))}},_getAnchor:function(){return B(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Kg=function(n,s){return new $o(n,s)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(n,s,c){return this._initOverlay($o,n,s,c).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Ue.include({bindPopup:function(n,s){return this._popup=this._initOverlay($o,this._popup,n,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof vn||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){si(n);var s=n.layer||n.target;if(this._popup._source===s&&!(s instanceof Ln)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=s,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Wo=on.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){on.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){on.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=on.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",s=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Dt("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var s,c,d=this._map,f=this._container,_=d.latLngToContainerPoint(d.getCenter()),C=d.layerPointToContainerPoint(n),M=this.options.direction,P=f.offsetWidth,F=f.offsetHeight,W=B(this.options.offset),ot=this._getAnchor();M==="top"?(s=P/2,c=F):M==="bottom"?(s=P/2,c=0):M==="center"?(s=P/2,c=F/2):M==="right"?(s=0,c=F/2):M==="left"?(s=P,c=F/2):C.x<_.x?(M="right",s=0,c=F/2):(M="left",s=P+(W.x+ot.x)*2,c=F/2),n=n.subtract(B(s,c,!0)).add(W).add(ot),jt(f,"leaflet-tooltip-right"),jt(f,"leaflet-tooltip-left"),jt(f,"leaflet-tooltip-top"),jt(f,"leaflet-tooltip-bottom"),ft(f,"leaflet-tooltip-"+M),Ht(f,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Pe(this._container,n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(s)},_getAnchor:function(){return B(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Jg=function(n,s){return new Wo(n,s)};Ct.include({openTooltip:function(n,s,c){return this._initOverlay(Wo,n,s,c).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Ue.include({bindTooltip:function(n,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Wo,this._tooltip,n,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var s=n?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[s](c),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof vn||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&(ut(s,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),ut(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var s=n.latlng,c,d;this._tooltip.options.sticky&&n.originalEvent&&(c=this._map.mouseEventToContainerPoint(n.originalEvent),d=this._map.containerPointToLayerPoint(c),s=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(s)}});var Oh=Ri.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var s=n&&n.tagName==="DIV"?n:document.createElement("div"),c=this.options;if(c.html instanceof Element?(Oo(s),s.appendChild(c.html)):s.innerHTML=c.html!==!1?c.html:"",c.bgPos){var d=B(c.bgPos);s.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function Qg(n){return new Oh(n)}Ri.Default=Rr;var Or=Ue.extend({options:{tileSize:256,opacity:1,updateWhenIdle:J.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){y(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),Nt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ti(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Pi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof k?n:new k(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var s=this.getPane().children,c=-n(-1/0,1/0),d=0,f=s.length,_;d<f;d++)_=s[d].style.zIndex,s[d]!==this._container&&_&&(c=n(c,+_));isFinite(c)&&(this.options.zIndex=c+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!J.ielt9){Pe(this._container,this.options.opacity);var n=+new Date,s=!1,c=!1;for(var d in this._tiles){var f=this._tiles[d];if(!(!f.current||!f.loaded)){var _=Math.min(1,(n-f.loaded)/200);Pe(f.el,_),_<1?s=!0:(f.active?c=!0:this._onOpaqueTile(f),f.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),s&&(Y(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Dt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,s=this.options.maxZoom;if(n!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===n?(this._levels[c].el.style.zIndex=s-Math.abs(n-c),this._onUpdateLevel(c)):(Nt(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var d=this._levels[n],f=this._map;return d||(d=this._levels[n]={},d.el=Dt("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=s,d.origin=f.project(f.unproject(f.getPixelOrigin()),n).round(),d.zoom=n,this._setZoomTransform(d,f.getCenter(),f.getZoom()),p(d.el.offsetWidth),this._onCreateLevel(d)),this._level=d,d}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var n,s,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)s=this._tiles[n],s.retain=s.current;for(n in this._tiles)if(s=this._tiles[n],s.current&&!s.active){var d=s.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var s in this._tiles)this._tiles[s].coords.z===n&&this._removeTile(s)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)Nt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,s,c,d){var f=Math.floor(n/2),_=Math.floor(s/2),C=c-1,M=new k(+f,+_);M.z=+C;var P=this._tileCoordsToKey(M),F=this._tiles[P];return F&&F.active?(F.retain=!0,!0):(F&&F.loaded&&(F.retain=!0),C>d?this._retainParent(f,_,C,d):!1)},_retainChildren:function(n,s,c,d){for(var f=2*n;f<2*n+2;f++)for(var _=2*s;_<2*s+2;_++){var C=new k(f,_);C.z=c+1;var M=this._tileCoordsToKey(C),P=this._tiles[M];if(P&&P.active){P.retain=!0;continue}else P&&P.loaded&&(P.retain=!0);c+1<d&&this._retainChildren(f,_,c+1,d)}},_resetView:function(n){var s=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var s=this.options;return s.minNativeZoom!==void 0&&n<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<n?s.maxNativeZoom:n},_setView:function(n,s,c,d){var f=Math.round(s);this.options.maxZoom!==void 0&&f>this.options.maxZoom||this.options.minZoom!==void 0&&f<this.options.minZoom?f=void 0:f=this._clampZoom(f);var _=this.options.updateWhenZooming&&f!==this._tileZoom;(!d||_)&&(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==void 0&&this._update(n),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(n,s)},_setZoomTransforms:function(n,s){for(var c in this._levels)this._setZoomTransform(this._levels[c],n,s)},_setZoomTransform:function(n,s,c){var d=this._map.getZoomScale(c,n.zoom),f=n.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(s,c)).round();J.any3d?ii(n.el,f,d):Ht(n.el,f)},_resetGrid:function(){var n=this._map,s=n.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,f=this._map.getPixelWorldBounds(this._tileZoom);f&&(this._globalTileRange=this._pxBoundsToTileRange(f)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,s.wrapLng[0]],d).x/c.x),Math.ceil(n.project([0,s.wrapLng[1]],d).x/c.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([s.wrapLat[0],0],d).y/c.x),Math.ceil(n.project([s.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var s=this._map,c=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),d=s.getZoomScale(c,this._tileZoom),f=s.project(n,this._tileZoom).floor(),_=s.getSize().divideBy(d*2);return new tt(f.subtract(_),f.add(_))},_update:function(n){var s=this._map;if(s){var c=this._clampZoom(s.getZoom());if(n===void 0&&(n=s.getCenter()),this._tileZoom!==void 0){var d=this._getTiledPixelBounds(n),f=this._pxBoundsToTileRange(d),_=f.getCenter(),C=[],M=this.options.keepBuffer,P=new tt(f.getBottomLeft().subtract([M,-M]),f.getTopRight().add([M,-M]));if(!(isFinite(f.min.x)&&isFinite(f.min.y)&&isFinite(f.max.x)&&isFinite(f.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var F in this._tiles){var W=this._tiles[F].coords;(W.z!==this._tileZoom||!P.contains(new k(W.x,W.y)))&&(this._tiles[F].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(n,c);return}for(var ot=f.min.y;ot<=f.max.y;ot++)for(var gt=f.min.x;gt<=f.max.x;gt++){var de=new k(gt,ot);if(de.z=this._tileZoom,!!this._isValidTile(de)){var te=this._tiles[this._tileCoordsToKey(de)];te?te.current=!0:C.push(de)}}if(C.sort(function(me,ki){return me.distanceTo(_)-ki.distanceTo(_)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Re=document.createDocumentFragment();for(gt=0;gt<C.length;gt++)this._addTile(C[gt],Re);this._level.el.appendChild(Re)}}}},_isValidTile:function(n){var s=this._map.options.crs;if(!s.infinite){var c=this._globalTileRange;if(!s.wrapLng&&(n.x<c.min.x||n.x>c.max.x)||!s.wrapLat&&(n.y<c.min.y||n.y>c.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(n);return et(this.options.bounds).overlaps(d)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var s=this._map,c=this.getTileSize(),d=n.scaleBy(c),f=d.add(c),_=s.unproject(d,n.z),C=s.unproject(f,n.z);return[_,C]},_tileCoordsToBounds:function(n){var s=this._tileCoordsToNwSe(n),c=new K(s[0],s[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var s=n.split(":"),c=new k(+s[0],+s[1]);return c.z=+s[2],c},_removeTile:function(n){var s=this._tiles[n];s&&(Nt(s.el),delete this._tiles[n],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){ft(n,"leaflet-tile");var s=this.getTileSize();n.style.width=s.x+"px",n.style.height=s.y+"px",n.onselectstart=p,n.onmousemove=p,J.ielt9&&this.options.opacity<1&&Pe(n,this.options.opacity)},_addTile:function(n,s){var c=this._getTilePos(n),d=this._tileCoordsToKey(n),f=this.createTile(this._wrapCoords(n),o(this._tileReady,this,n));this._initTile(f),this.createTile.length<2&&Z(o(this._tileReady,this,n,null,f)),Ht(f,c),this._tiles[d]={el:f,coords:n,current:!0},s.appendChild(f),this.fire("tileloadstart",{tile:f,coords:n})},_tileReady:function(n,s,c){s&&this.fire("tileerror",{error:s,tile:c,coords:n});var d=this._tileCoordsToKey(n);c=this._tiles[d],c&&(c.loaded=+new Date,this._map._fadeAnimated?(Pe(c.el,0),Y(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),s||(ft(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),J.ielt9||!this._map._fadeAnimated?Z(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var s=new k(this._wrapX?u(n.x,this._wrapX):n.x,this._wrapY?u(n.y,this._wrapY):n.y);return s.z=n.z,s},_pxBoundsToTileRange:function(n){var s=this.getTileSize();return new tt(n.min.unscaleBy(s).floor(),n.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function tm(n){return new Or(n)}var Li=Or.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,s){this._url=n,s=y(this,s),s.detectRetina&&J.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,s){return this._url===n&&s===void 0&&(s=!0),this._url=n,s||this.redraw(),this},createTile:function(n,s){var c=document.createElement("img");return ut(c,"load",o(this._tileOnLoad,this,s,c)),ut(c,"error",o(this._tileOnError,this,s,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(n),c},getTileUrl:function(n){var s={r:J.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-n.y;this.options.tms&&(s.y=c),s["-y"]=c}return D(this._url,e(s,this.options))},_tileOnLoad:function(n,s){J.ielt9?setTimeout(o(n,this,null,s),0):n(null,s)},_tileOnError:function(n,s,c){var d=this.options.errorTileUrl;d&&s.getAttribute("src")!==d&&(s.src=d),n(c,s)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,s=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset;return c&&(n=s-n),n+d},_getSubdomain:function(n){var s=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var n,s;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(s=this._tiles[n].el,s.onload=p,s.onerror=p,!s.complete)){s.src=T;var c=this._tiles[n].coords;Nt(s),delete this._tiles[n],this.fire("tileabort",{tile:s,coords:c})}},_removeTile:function(n){var s=this._tiles[n];if(s)return s.el.setAttribute("src",T),Or.prototype._removeTile.call(this,n)},_tileReady:function(n,s,c){if(!(!this._map||c&&c.getAttribute("src")===T))return Or.prototype._tileReady.call(this,n,s,c)}});function Ih(n,s){return new Li(n,s)}var Lh=Li.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,s){this._url=n;var c=e({},this.defaultWmsParams);for(var d in s)d in this.options||(c[d]=s[d]);s=y(this,s);var f=s.detectRetina&&J.retina?2:1,_=this.getTileSize();c.width=_.x*f,c.height=_.y*f,this.wmsParams=c},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,Li.prototype.onAdd.call(this,n)},getTileUrl:function(n){var s=this._tileCoordsToNwSe(n),c=this._crs,d=at(c.project(s[0]),c.project(s[1])),f=d.min,_=d.max,C=(this._wmsVersion>=1.3&&this._crs===Eh?[f.y,f.x,_.y,_.x]:[f.x,f.y,_.x,_.y]).join(","),M=Li.prototype.getTileUrl.call(this,n);return M+b(this.wmsParams,M,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(n,s){return e(this.wmsParams,n),s||this.redraw(),this}});function em(n,s){return new Lh(n,s)}Li.WMS=Lh,Ih.wms=em;var bn=Ue.extend({options:{padding:.1},initialize:function(n){y(this,n),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ft(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,s){var c=this._map.getZoomScale(s,this._zoom),d=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,s),_=d.multiplyBy(-c).add(f).subtract(this._map._getNewPixelOrigin(n,s));J.any3d?ii(this._container,_,c):Ht(this._container,_)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,s=this._map.getSize(),c=this._map.containerPointToLayerPoint(s.multiplyBy(-n)).round();this._bounds=new tt(c,c.add(s.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),kh=bn.extend({options:{tolerance:0},getEvents:function(){var n=bn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){bn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");ut(n,"mousemove",this._onMouseMove,this),ut(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ut(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,Nt(this._container),It(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var s in this._layers)n=this._layers[s],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bn.prototype._update.call(this);var n=this._bounds,s=this._container,c=n.getSize(),d=J.retina?2:1;Ht(s,n.min),s.width=d*c.x,s.height=d*c.y,s.style.width=c.x+"px",s.style.height=c.y+"px",J.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){bn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[l(n)]=n;var s=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var s=n._order,c=s.next,d=s.prev;c?c.prev=d:this._drawLast=d,d?d.next=c:this._drawFirst=c,delete n._order,delete this._layers[l(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var s=n.options.dashArray.split(/[, ]+/),c=[],d,f;for(f=0;f<s.length;f++){if(d=Number(s[f]),isNaN(d))return;c.push(d)}n.options._dashArray=c}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||Z(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var s=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new tt,this._redrawBounds.extend(n._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(n._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var s=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,s=this._redrawBounds;if(this._ctx.save(),s){var c=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)n=d.layer,(!s||n._pxBounds&&n._pxBounds.intersects(s))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,s){if(this._drawing){var c,d,f,_,C=n._parts,M=C.length,P=this._ctx;if(M){for(P.beginPath(),c=0;c<M;c++){for(d=0,f=C[c].length;d<f;d++)_=C[c][d],P[d?"lineTo":"moveTo"](_.x,_.y);s&&P.closePath()}this._fillStroke(P,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var s=n._point,c=this._ctx,d=Math.max(Math.round(n._radius),1),f=(Math.max(Math.round(n._radiusY),1)||d)/d;f!==1&&(c.save(),c.scale(1,f)),c.beginPath(),c.arc(s.x,s.y/f,d,0,Math.PI*2,!1),f!==1&&c.restore(),this._fillStroke(c,n)}},_fillStroke:function(n,s){var c=s.options;c.fill&&(n.globalAlpha=c.fillOpacity,n.fillStyle=c.fillColor||c.color,n.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(n.setLineDash&&n.setLineDash(s.options&&s.options._dashArray||[]),n.globalAlpha=c.opacity,n.lineWidth=c.weight,n.strokeStyle=c.color,n.lineCap=c.lineCap,n.lineJoin=c.lineJoin,n.stroke())},_onClick:function(n){for(var s=this._map.mouseEventToLayerPoint(n),c,d,f=this._drawFirst;f;f=f.next)c=f.layer,c.options.interactive&&c._containsPoint(s)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(c))&&(d=c);this._fireEvent(d?[d]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,s)}},_handleMouseOut:function(n){var s=this._hoveredLayer;s&&(jt(this._container,"leaflet-interactive"),this._fireEvent([s],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,s){if(!this._mouseHoverThrottled){for(var c,d,f=this._drawFirst;f;f=f.next)c=f.layer,c.options.interactive&&c._containsPoint(s)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(n),d&&(ft(this._container,"leaflet-interactive"),this._fireEvent([d],n,"mouseover"),this._hoveredLayer=d)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,s,c){this._map._fireDOMEvent(s,c||s.type,n)},_bringToFront:function(n){var s=n._order;if(s){var c=s.next,d=s.prev;if(c)c.prev=d;else return;d?d.next=c:c&&(this._drawFirst=c),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(n)}},_bringToBack:function(n){var s=n._order;if(s){var c=s.next,d=s.prev;if(d)d.next=c;else return;c?c.prev=d:d&&(this._drawLast=d),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(n)}}});function Nh(n){return J.canvas?new kh(n):null}var Ir=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),nm={_initContainer:function(){this._container=Dt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(bn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var s=n._container=Ir("shape");ft(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",n._path=Ir("path"),s.appendChild(n._path),this._updateStyle(n),this._layers[l(n)]=n},_addPath:function(n){var s=n._container;this._container.appendChild(s),n.options.interactive&&n.addInteractiveTarget(s)},_removePath:function(n){var s=n._container;Nt(s),n.removeInteractiveTarget(s),delete this._layers[l(n)]},_updateStyle:function(n){var s=n._stroke,c=n._fill,d=n.options,f=n._container;f.stroked=!!d.stroke,f.filled=!!d.fill,d.stroke?(s||(s=n._stroke=Ir("stroke")),f.appendChild(s),s.weight=d.weight+"px",s.color=d.color,s.opacity=d.opacity,d.dashArray?s.dashStyle=x(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=d.lineCap.replace("butt","flat"),s.joinstyle=d.lineJoin):s&&(f.removeChild(s),n._stroke=null),d.fill?(c||(c=n._fill=Ir("fill")),f.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(f.removeChild(c),n._fill=null)},_updateCircle:function(n){var s=n._point.round(),c=Math.round(n._radius),d=Math.round(n._radiusY||c);this._setPath(n,n._empty()?"M0 0":"AL "+s.x+","+s.y+" "+c+","+d+" 0,"+65535*360)},_setPath:function(n,s){n._path.v=s},_bringToFront:function(n){Ti(n._container)},_bringToBack:function(n){Pi(n._container)}},Zo=J.vml?Ir:Ft,Lr=bn.extend({_initContainer:function(){this._container=Zo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Zo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Nt(this._container),It(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bn.prototype._update.call(this);var n=this._bounds,s=n.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,c.setAttribute("width",s.x),c.setAttribute("height",s.y)),Ht(c,n.min),c.setAttribute("viewBox",[n.min.x,n.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(n){var s=n._path=Zo("path");n.options.className&&ft(s,n.options.className),n.options.interactive&&ft(s,"leaflet-interactive"),this._updateStyle(n),this._layers[l(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){Nt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[l(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var s=n._path,c=n.options;s&&(c.stroke?(s.setAttribute("stroke",c.color),s.setAttribute("stroke-opacity",c.opacity),s.setAttribute("stroke-width",c.weight),s.setAttribute("stroke-linecap",c.lineCap),s.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?s.setAttribute("stroke-dasharray",c.dashArray):s.removeAttribute("stroke-dasharray"),c.dashOffset?s.setAttribute("stroke-dashoffset",c.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),c.fill?(s.setAttribute("fill",c.fillColor||c.color),s.setAttribute("fill-opacity",c.fillOpacity),s.setAttribute("fill-rule",c.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(n,s){this._setPath(n,Ut(n._parts,s))},_updateCircle:function(n){var s=n._point,c=Math.max(Math.round(n._radius),1),d=Math.max(Math.round(n._radiusY),1)||c,f="a"+c+","+d+" 0 1,0 ",_=n._empty()?"M0 0":"M"+(s.x-c)+","+s.y+f+c*2+",0 "+f+-c*2+",0 ";this._setPath(n,_)},_setPath:function(n,s){n._path.setAttribute("d",s)},_bringToFront:function(n){Ti(n._path)},_bringToBack:function(n){Pi(n._path)}});J.vml&&Lr.include(nm);function Fh(n){return J.svg||J.vml?new Lr(n):null}Ct.include({getRenderer:function(n){var s=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var s=this._paneRenderers[n];return s===void 0&&(s=this._createRenderer({pane:n}),this._paneRenderers[n]=s),s},_createRenderer:function(n){return this.options.preferCanvas&&Nh(n)||Fh(n)}});var Bh=Oi.extend({initialize:function(n,s){Oi.prototype.initialize.call(this,this._boundsToLatLngs(n),s)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=et(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function im(n,s){return new Bh(n,s)}Lr.create=Zo,Lr.pointsToPath=Ut,wn.geometryToLayer=zo,wn.coordsToLatLng=Ya,wn.coordsToLatLngs=Uo,wn.latLngToCoords=Xa,wn.latLngsToCoords=Go,wn.getFeature=Ii,wn.asFeature=jo,Ct.mergeOptions({boxZoom:!0});var Vh=rn.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){ut(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){It(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Nt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),xr(),Oa(),this._startPoint=this._map.mouseEventToContainerPoint(n),ut(document,{contextmenu:si,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=Dt("div","leaflet-zoom-box",this._container),ft(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var s=new tt(this._point,this._startPoint),c=s.getSize();Ht(this._box,s.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(Nt(this._box),jt(this._container,"leaflet-crosshair")),Er(),Ia(),It(document,{contextmenu:si,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var s=new K(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",Vh),Ct.mergeOptions({doubleClickZoom:!0});var zh=rn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var s=this._map,c=s.getZoom(),d=s.options.zoomDelta,f=n.originalEvent.shiftKey?c-d:c+d;s.options.doubleClickZoom==="center"?s.setZoom(f):s.setZoomAround(n.containerPoint,f)}});Ct.addInitHook("addHandler","doubleClickZoom",zh),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Uh=rn.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new In(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}ft(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){jt(this._map._container,"leaflet-grab"),jt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=et(this._map.options.maxBounds);this._offsetLimit=at(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var s=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(s),this._prunePositions(s)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,s){return n-(n-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;n.x<s.min.x&&(n.x=this._viscousLimit(n.x,s.min.x)),n.y<s.min.y&&(n.y=this._viscousLimit(n.y,s.min.y)),n.x>s.max.x&&(n.x=this._viscousLimit(n.x,s.max.x)),n.y>s.max.y&&(n.y=this._viscousLimit(n.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,s=Math.round(n/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,f=(d-s+c)%n+s-c,_=(d+s+c)%n-s-c,C=Math.abs(f+c)<Math.abs(_+c)?f:_;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(n){var s=this._map,c=s.options,d=!c.inertia||n.noInertia||this._times.length<2;if(s.fire("dragend",n),d)s.fire("moveend");else{this._prunePositions(+new Date);var f=this._lastPos.subtract(this._positions[0]),_=(this._lastTime-this._times[0])/1e3,C=c.easeLinearity,M=f.multiplyBy(C/_),P=M.distanceTo([0,0]),F=Math.min(c.inertiaMaxSpeed,P),W=M.multiplyBy(F/P),ot=F/(c.inertiaDeceleration*C),gt=W.multiplyBy(-ot/2).round();!gt.x&&!gt.y?s.fire("moveend"):(gt=s._limitOffset(gt,s.options.maxBounds),Z(function(){s.panBy(gt,{duration:ot,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",Uh),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Gh=rn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),ut(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),It(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,s=document.documentElement,c=n.scrollTop||s.scrollTop,d=n.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(d,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var s=this._panKeys={},c=this.keyCodes,d,f;for(d=0,f=c.left.length;d<f;d++)s[c.left[d]]=[-1*n,0];for(d=0,f=c.right.length;d<f;d++)s[c.right[d]]=[n,0];for(d=0,f=c.down.length;d<f;d++)s[c.down[d]]=[0,n];for(d=0,f=c.up.length;d<f;d++)s[c.up[d]]=[0,-1*n]},_setZoomDelta:function(n){var s=this._zoomKeys={},c=this.keyCodes,d,f;for(d=0,f=c.zoomIn.length;d<f;d++)s[c.zoomIn[d]]=n;for(d=0,f=c.zoomOut.length;d<f;d++)s[c.zoomOut[d]]=-n},_addHooks:function(){ut(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){It(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var s=n.keyCode,c=this._map,d;if(s in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(d=this._panKeys[s],n.shiftKey&&(d=B(d).multiplyBy(3)),c.options.maxBounds&&(d=c._limitOffset(B(d),c.options.maxBounds)),c.options.worldCopyJump){var f=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(d)));c.panTo(f)}else c.panBy(d)}else if(s in this._zoomKeys)c.setZoom(c.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;si(n)}}});Ct.addInitHook("addHandler","keyboard",Gh),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var jh=rn.extend({addHooks:function(){ut(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){It(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var s=fh(n),c=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),d),si(n)},_performZoom:function(){var n=this._map,s=n.getZoom(),c=this._map.options.zoomSnap||0;n._stop();var d=this._delta/(this._map.options.wheelPxPerZoomLevel*4),f=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,_=c?Math.ceil(f/c)*c:f,C=n._limitZoom(s+(this._delta>0?_:-_))-s;this._delta=0,this._startTime=null,C&&(n.options.scrollWheelZoom==="center"?n.setZoom(s+C):n.setZoomAround(this._lastMousePos,s+C))}});Ct.addInitHook("addHandler","scrollWheelZoom",jh);var rm=600;Ct.mergeOptions({tapHold:J.touchNative&&J.safari&&J.mobile,tapTolerance:15});var Hh=rn.extend({addHooks:function(){ut(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){It(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var s=n.touches[0];this._startPos=this._newPos=new k(s.clientX,s.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(ut(document,"touchend",ie),ut(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),rm),ut(document,"touchend touchcancel contextmenu",this._cancel,this),ut(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){It(document,"touchend",ie),It(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),It(document,"touchend touchcancel contextmenu",this._cancel,this),It(document,"touchmove",this._onMove,this)},_onMove:function(n){var s=n.touches[0];this._newPos=new k(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,s){var c=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});c._simulated=!0,s.target.dispatchEvent(c)}});Ct.addInitHook("addHandler","tapHold",Hh),Ct.mergeOptions({touchZoom:J.touch,bounceAtZoomLimits:!0});var $h=rn.extend({addHooks:function(){ft(this._map._container,"leaflet-touch-zoom"),ut(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){jt(this._map._container,"leaflet-touch-zoom"),It(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var s=this._map;if(!(!n.touches||n.touches.length!==2||s._animatingZoom||this._zooming)){var c=s.mouseEventToContainerPoint(n.touches[0]),d=s.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(c.add(d)._divideBy(2))),this._startDist=c.distanceTo(d),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),ut(document,"touchmove",this._onTouchMove,this),ut(document,"touchend touchcancel",this._onTouchEnd,this),ie(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var s=this._map,c=s.mouseEventToContainerPoint(n.touches[0]),d=s.mouseEventToContainerPoint(n.touches[1]),f=c.distanceTo(d)/this._startDist;if(this._zoom=s.getScaleZoom(f,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&f<1||this._zoom>s.getMaxZoom()&&f>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,f===1)return}else{var _=c._add(d)._divideBy(2)._subtract(this._centerPoint);if(f===1&&_.x===0&&_.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(_),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var C=o(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Z(C,this,!0),ie(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),It(document,"touchmove",this._onTouchMove,this),It(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",$h),Ct.BoxZoom=Vh,Ct.DoubleClickZoom=zh,Ct.Drag=Uh,Ct.Keyboard=Gh,Ct.ScrollWheelZoom=jh,Ct.TapHold=Hh,Ct.TouchZoom=$h,r.Bounds=tt,r.Browser=J,r.CRS=ge,r.Canvas=kh,r.Circle=qa,r.CircleMarker=Vo,r.Class=q,r.Control=ze,r.DivIcon=Oh,r.DivOverlay=on,r.DomEvent=Cg,r.DomUtil=wg,r.Draggable=In,r.Evented=X,r.FeatureGroup=vn,r.GeoJSON=wn,r.GridLayer=Or,r.Handler=rn,r.Icon=Ri,r.ImageOverlay=Ho,r.LatLng=it,r.LatLngBounds=K,r.Layer=Ue,r.LayerGroup=Ai,r.LineUtil=kg,r.Map=Ct,r.Marker=Bo,r.Mixin=Pg,r.Path=Ln,r.Point=k,r.PolyUtil=Ag,r.Polygon=Oi,r.Polyline=yn,r.Popup=$o,r.PosAnimation=ph,r.Projection=Ng,r.Rectangle=Bh,r.Renderer=bn,r.SVG=Lr,r.SVGOverlay=Rh,r.TileLayer=Li,r.Tooltip=Wo,r.Transformation=ti,r.Util=pt,r.VideoOverlay=Ah,r.bind=o,r.bounds=at,r.canvas=Nh,r.circle=Hg,r.circleMarker=jg,r.control=Pr,r.divIcon=Qg,r.extend=e,r.featureGroup=zg,r.geoJSON=Ph,r.geoJson=Zg,r.gridLayer=tm,r.icon=Ug,r.imageOverlay=qg,r.latLng=dt,r.latLngBounds=et,r.layerGroup=Vg,r.map=Sg,r.marker=Gg,r.point=B,r.polygon=Wg,r.polyline=$g,r.popup=Kg,r.rectangle=im,r.setOptions=y,r.stamp=l,r.svg=Fh,r.svgOverlay=Xg,r.tileLayer=Ih,r.tooltip=Jg,r.transformation=ne,r.version=t,r.videoOverlay=Yg;var om=window.L;r.noConflict=function(){return window.L=om,this},window.L=r})});var xu=null;function Ne(){return xu}function dl(r){xu??=r}var Gr=class{},ji=(()=>{class r{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(Eu),providedIn:"platform"})}return r})();var Eu=(()=>{class r extends ji{_location;_history;_doc=G(Xt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ne().getBaseHref(this._doc)}onPopState(e){let i=Ne().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){let i=Ne().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,o){this._history.pushState(e,i,o)}replaceState(e,i,o){this._history.replaceState(e,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>new r,providedIn:"platform"})}return r})();function Pu(r,t){return r?t?r.endsWith("/")?t.startsWith("/")?r+t.slice(1):r+t:t.startsWith("/")?r+t:`${r}/${t}`:r:t}function Mu(r){let t=r.search(/#|\?|$/);return r[t-1]==="/"?r.slice(0,t-1)+r.slice(t):r}function Gn(r){return r&&r[0]!=="?"?`?${r}`:r}var as=(()=>{class r{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(_m),providedIn:"root"})}return r})(),mm=new yt(""),_m=(()=>{class r extends as{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??G(Xt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Pu(this._baseHref,e)}path(e=!1){let i=this._platformLocation.pathname+Gn(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${i}${o}`:i}pushState(e,i,o,a){let l=this.prepareExternalUrl(o+Gn(a));this._platformLocation.pushState(e,i,l)}replaceState(e,i,o,a){let l=this.prepareExternalUrl(o+Gn(a));this._platformLocation.replaceState(e,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||r)(_t(ji),_t(mm,8))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Hi=(()=>{class r{_subject=new sn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let i=this._locationStrategy.getBaseHref();this._basePath=wm(Mu(Tu(i))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Gn(i))}normalize(e){return r.stripTrailingSlash(ym(this._basePath,Tu(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",o=null){this._locationStrategy.pushState(o,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Gn(i)),o)}replaceState(e,i="",o=null){this._locationStrategy.replaceState(o,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Gn(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(o=>o(e,i))}subscribe(e,i,o){return this._subject.subscribe({next:e,error:i??void 0,complete:o??void 0})}static normalizeQueryParams=Gn;static joinWithSlash=Pu;static stripTrailingSlash=Mu;static \u0275fac=function(i){return new(i||r)(_t(as))};static \u0275prov=nt({token:r,factory:()=>vm(),providedIn:"root"})}return r})();function vm(){return new Hi(_t(as))}function ym(r,t){if(!r||!t.startsWith(r))return t;let e=t.substring(r.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function Tu(r){return r.replace(/\/index.html$/,"")}function wm(r){if(new RegExp("^(https?:)?//").test(r)){let[,e]=r.split(/\/\/[^\/]+/);return e}return r}var ee=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Dn({type:r});static \u0275inj=Sn({})}return r})();function jr(r,t){t=encodeURIComponent(t);for(let e of r.split(";")){let i=e.indexOf("="),[o,a]=i==-1?[e,""]:[e.slice(0,i),e.slice(i+1)];if(o.trim()===t)return decodeURIComponent(a)}return null}var fi=class{};var fl="browser";function pl(r){return r===fl}var Hr=class{_doc;constructor(t){this._doc=t}manager},ls=(()=>{class r extends Hr{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,o,a){return e.addEventListener(i,o,a),()=>this.removeEventListener(e,i,o,a)}removeEventListener(e,i,o,a){return e.removeEventListener(i,o,a)}static \u0275fac=function(i){return new(i||r)(_t(Xt))};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),us=new yt(""),vl=(()=>{class r{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,i){this._zone=i,e.forEach(l=>{l.manager=this});let o=e.filter(l=>!(l instanceof ls));this._plugins=o.slice().reverse();let a=e.find(l=>l instanceof ls);a&&this._plugins.push(a)}addEventListener(e,i,o,a){return this._findPluginFor(i).addEventListener(e,i,o,a)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(a=>a.supports(e)),!i)throw new xt(5101,!1);return this._eventNameToPlugin.set(e,i),i}static \u0275fac=function(i){return new(i||r)(_t(us),_t(li))};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),gl="ng-app-id";function Au(r){for(let t of r)t.remove()}function Ru(r,t){let e=t.createElement("style");return e.textContent=r,e}function Cm(r,t,e,i){let o=r.head?.querySelectorAll(`style[${gl}="${t}"],link[${gl}="${t}"]`);if(o)for(let a of o)a.removeAttribute(gl),a instanceof HTMLLinkElement?i.set(a.href.slice(a.href.lastIndexOf("/")+1),{usage:0,elements:[a]}):a.textContent&&e.set(a.textContent,{usage:0,elements:[a]})}function _l(r,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",r),e}var yl=(()=>{class r{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,i,o,a={}){this.doc=e,this.appId=i,this.nonce=o,Cm(e,i,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,i){for(let o of e)this.addUsage(o,this.inline,Ru);i?.forEach(o=>this.addUsage(o,this.external,_l))}removeStyles(e,i){for(let o of e)this.removeUsage(o,this.inline);i?.forEach(o=>this.removeUsage(o,this.external))}addUsage(e,i,o){let a=i.get(e);a?a.usage++:i.set(e,{usage:1,elements:[...this.hosts].map(l=>this.addElement(l,o(e,this.doc)))})}removeUsage(e,i){let o=i.get(e);o&&(o.usage--,o.usage<=0&&(Au(o.elements),i.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])Au(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[i,{elements:o}]of this.inline)o.push(this.addElement(e,Ru(i,this.doc)));for(let[i,{elements:o}]of this.external)o.push(this.addElement(e,_l(i,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,i){return this.nonce&&i.setAttribute("nonce",this.nonce),e.appendChild(i)}static \u0275fac=function(i){return new(i||r)(_t(Xt),_t(ol),_t(sl,8),_t(Ui))};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),ml={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},wl=/%COMP%/g;var Iu="%COMP%",Sm=`_nghost-${Iu}`,Dm=`_ngcontent-${Iu}`,xm=!0,Em=new yt("",{factory:()=>xm});function Mm(r){return Dm.replace(wl,r)}function Tm(r){return Sm.replace(wl,r)}function Lu(r,t){return t.map(e=>e.replace(wl,r))}var Zr=(()=>{class r{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(e,i,o,a,l,h,u=null,p=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=a,this.doc=l,this.ngZone=h,this.nonce=u,this.tracingService=p,this.defaultRenderer=new $r(e,l,h,this.tracingService)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;let o=this.getOrCreateRenderer(e,i);return o instanceof hs?o.applyToHost(e):o instanceof Wr&&o.applyStyles(),o}getOrCreateRenderer(e,i){let o=this.rendererByCompId,a=o.get(i.id);if(!a){let l=this.doc,h=this.ngZone,u=this.eventManager,p=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,m=this.tracingService;switch(i.encapsulation){case es.Emulated:a=new hs(u,p,i,this.appId,g,l,h,m);break;case es.ShadowDom:return new cs(u,e,i,l,h,this.nonce,m,p);case es.ExperimentalIsolatedShadowDom:return new cs(u,e,i,l,h,this.nonce,m);default:a=new Wr(u,p,i,g,l,h,m);break}o.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(i){return new(i||r)(_t(vl),_t(yl),_t(ol),_t(Em),_t(Xt),_t(li),_t(sl),_t(ns,8))};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),$r=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,i,o){this.eventManager=t,this.doc=e,this.ngZone=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(ml[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(Ou(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(Ou(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){e.remove()}selectRootElement(t,e){let i=typeof t=="string"?this.doc.querySelector(t):t;if(!i)throw new xt(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,o){if(o){e=o+":"+e;let a=ml[o];a?t.setAttributeNS(a,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){let o=ml[i];o?t.removeAttributeNS(o,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,o){o&(Vr.DashCase|Vr.Important)?t.style.setProperty(e,i,o&Vr.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Vr.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t!=null&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i,o){if(typeof t=="string"&&(t=Ne().getGlobalEventTarget(this.doc,t),!t))throw new xt(5102,!1);let a=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(a=this.tracingService.wrapEventListener(t,e,a)),this.eventManager.addEventListener(t,e,a,o)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;t(e)===!1&&e.preventDefault()}}};function Ou(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var cs=class extends $r{hostEl;sharedStylesHost;shadowRoot;constructor(t,e,i,o,a,l,h,u){super(t,o,a,h),this.hostEl=e,this.sharedStylesHost=u,this.shadowRoot=e.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let p=i.styles;p=Lu(i.id,p);for(let m of p){let v=document.createElement("style");l&&v.setAttribute("nonce",l),v.textContent=m,this.shadowRoot.appendChild(v)}let g=i.getExternalStyles?.();if(g)for(let m of g){let v=_l(m,o);l&&v.setAttribute("nonce",l),this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Wr=class extends $r{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,i,o,a,l,h,u){super(t,a,l,h),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=o;let p=i.styles;this.styles=u?Lu(u,p):p,this.styleUrls=i.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&du.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},hs=class extends Wr{contentAttr;hostAttr;constructor(t,e,i,o,a,l,h,u){let p=o+"-"+i.id;super(t,e,i,a,l,h,u,p),this.contentAttr=Mm(p),this.hostAttr=Tm(p)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}};var ds=class r extends Gr{supportsDOMEvents=!0;static makeCurrent(){dl(new r)}onAndCancel(t,e,i,o){return t.addEventListener(e,i,o),()=>{t.removeEventListener(e,i,o)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=Pm();return e==null?null:Am(e)}resetBaseElement(){qr=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return jr(document.cookie,t)}},qr=null;function Pm(){return qr=qr||document.head.querySelector("base"),qr?qr.getAttribute("href"):null}function Am(r){return new URL(r,document.baseURI).pathname}var Rm=(()=>{class r{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),ku=["alt","control","meta","shift"],Om={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Im={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},Nu=(()=>{class r extends Hr{constructor(e){super(e)}supports(e){return r.parseEventName(e)!=null}addEventListener(e,i,o,a){let l=r.parseEventName(i),h=r.eventCallback(l.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ne().onAndCancel(e,l.domEventName,h,a))}static parseEventName(e){let i=e.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let a=r._normalizeKey(i.pop()),l="",h=i.indexOf("code");if(h>-1&&(i.splice(h,1),l="code."),ku.forEach(p=>{let g=i.indexOf(p);g>-1&&(i.splice(g,1),l+=p+".")}),l+=a,i.length!=0||a.length===0)return null;let u={};return u.domEventName=o,u.fullKey=l,u}static matchEventFullKeyCode(e,i){let o=Om[e.key]||e.key,a="";return i.indexOf("code.")>-1&&(o=e.code,a="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),ku.forEach(l=>{if(l!==o){let h=Im[l];h(e)&&(a+=l+".")}}),a+=o,a===i)}static eventCallback(e,i,o){return a=>{r.matchEventFullKeyCode(a,e)&&o.runGuarded(()=>i(a))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(i){return new(i||r)(_t(Xt))};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})();async function bl(r,t,e){let i=j({rootComponent:r},Lm(t,e));return Du(i)}function Lm(r,t){return{platformRef:t?.platformRef,appProviders:[...Vm,...r?.providers??[]],platformProviders:Bm}}function km(){ds.makeCurrent()}function Nm(){return new il}function Fm(){return cu(document),document}var Bm=[{provide:Ui,useValue:fl},{provide:hu,useValue:km,multi:!0},{provide:Xt,useFactory:Fm}];var Vm=[{provide:ou,useValue:"root"},{provide:il,useFactory:Nm},{provide:us,useClass:ls,multi:!0},{provide:us,useClass:Nu,multi:!0},Zr,yl,vl,{provide:is,useExisting:Zr},{provide:fi,useClass:Rm},[]];var jn=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{let i=e.indexOf(":");if(i>0){let o=e.slice(0,i),a=e.slice(i+1).trim();this.addHeaderEntry(o,a)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.addHeaderEntry(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){let e=new r;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){let e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(t.name,e);let o=(t.op==="a"?this.headers.get(e):void 0)||[];o.push(...i),this.headers.set(e,o);break;case"d":let a=t.value;if(!a)this.headers.delete(e),this.normalizedNames.delete(e);else{let l=this.headers.get(e);if(!l)return;l=l.filter(h=>a.indexOf(h)===-1),l.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,l)}break}}addHeaderEntry(t,e){let i=t.toLowerCase();this.maybeSetNormalizedName(t,i),this.headers.has(i)?this.headers.get(i).push(e):this.headers.set(i,[e])}setHeaderEntries(t,e){let i=(Array.isArray(e)?e:[e]).map(a=>a.toString()),o=t.toLowerCase();this.headers.set(o,i),this.maybeSetNormalizedName(t,o)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}};var ps=class{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}},gs=class{encodeKey(t){return Fu(t)}encodeValue(t){return Fu(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function zm(r,t){let e=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(o=>{let a=o.indexOf("="),[l,h]=a==-1?[t.decodeKey(o),""]:[t.decodeKey(o.slice(0,a)),t.decodeValue(o.slice(a+1))],u=e.get(l)||[];u.push(h),e.set(l,u)}),e}var Um=/%(\d[a-f0-9])/gi,Gm={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Fu(r){return encodeURIComponent(r).replace(Um,(t,e)=>Gm[e]??t)}function fs(r){return`${r}`}var En=class r{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new gs,t.fromString){if(t.fromObject)throw new xt(2805,!1);this.map=zm(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{let i=t.fromObject[e],o=Array.isArray(i)?i.map(fs):[fs(i)];this.map.set(e,o)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){let e=[];return Object.keys(t).forEach(i=>{let o=t[i];Array.isArray(o)?o.forEach(a=>{e.push({param:i,value:a,op:"a"})}):e.push({param:i,value:o,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let e=new r({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(fs(t.value)),this.map.set(t.param,e);break;case"d":if(t.value!==void 0){let i=this.map.get(t.param)||[],o=i.indexOf(fs(t.value));o!==-1&&i.splice(o,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};function jm(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Bu(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Vu(r){return typeof Blob<"u"&&r instanceof Blob}function zu(r){return typeof FormData<"u"&&r instanceof FormData}function Hm(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Uu="Content-Type",Gu="Accept",ju="text/plain",Hu="application/json",$m=`${Hu}, ${ju}, */*`,$i=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(t,e,i,o){this.url=e,this.method=t.toUpperCase();let a;if(jm(this.method)||o?(this.body=i!==void 0?i:null,a=o):a=i,a){if(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,this.keepalive=!!a.keepalive,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params),a.priority&&(this.priority=a.priority),a.cache&&(this.cache=a.cache),a.credentials&&(this.credentials=a.credentials),typeof a.timeout=="number"){if(a.timeout<1||!Number.isInteger(a.timeout))throw new xt(2822,"");this.timeout=a.timeout}a.mode&&(this.mode=a.mode),a.redirect&&(this.redirect=a.redirect),a.integrity&&(this.integrity=a.integrity),a.referrer&&(this.referrer=a.referrer),a.referrerPolicy&&(this.referrerPolicy=a.referrerPolicy),this.transferCache=a.transferCache}if(this.headers??=new jn,this.context??=new ps,!this.params)this.params=new En,this.urlWithParams=e;else{let l=this.params.toString();if(l.length===0)this.urlWithParams=e;else{let h=e.indexOf("?"),u=h===-1?"?":h<e.length-1?"&":"";this.urlWithParams=e+u+l}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Bu(this.body)||Vu(this.body)||zu(this.body)||Hm(this.body)?this.body:this.body instanceof En?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||zu(this.body)?null:Vu(this.body)?this.body.type||null:Bu(this.body)?null:typeof this.body=="string"?ju:this.body instanceof En?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Hu:null}clone(t={}){let e=t.method||this.method,i=t.url||this.url,o=t.responseType||this.responseType,a=t.keepalive??this.keepalive,l=t.priority||this.priority,h=t.cache||this.cache,u=t.mode||this.mode,p=t.redirect||this.redirect,g=t.credentials||this.credentials,m=t.referrer||this.referrer,v=t.integrity||this.integrity,y=t.referrerPolicy||this.referrerPolicy,b=t.transferCache??this.transferCache,E=t.timeout??this.timeout,D=t.body!==void 0?t.body:this.body,x=t.withCredentials??this.withCredentials,A=t.reportProgress??this.reportProgress,T=t.headers||this.headers,R=t.params||this.params,z=t.context??this.context;return t.setHeaders!==void 0&&(T=Object.keys(t.setHeaders).reduce((U,$)=>U.set($,t.setHeaders[$]),T)),t.setParams&&(R=Object.keys(t.setParams).reduce((U,$)=>U.set($,t.setParams[$]),R)),new r(e,i,D,{params:R,headers:T,context:z,reportProgress:A,responseType:o,withCredentials:x,transferCache:b,keepalive:a,cache:h,priority:l,timeout:E,mode:u,redirect:p,credentials:g,referrer:m,integrity:v,referrerPolicy:y})}},pi=(function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r})(pi||{}),Zi=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(t,e=200,i="OK"){this.headers=t.headers||new jn,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.redirected=t.redirected,this.responseType=t.responseType,this.ok=this.status>=200&&this.status<300}},ms=class r extends Zi{constructor(t={}){super(t)}type=pi.ResponseHeader;clone(t={}){return new r({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},Yr=class r extends Zi{body;constructor(t={}){super(t),this.body=t.body!==void 0?t.body:null}type=pi.Response;clone(t={}){return new r({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0,redirected:t.redirected??this.redirected,responseType:t.responseType??this.responseType})}},Wi=class extends Zi{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${t.url||"(unknown url)"}`:this.message=`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}},Wm=200,Zm=204;var qm=new yt("");var Ym=/^\)\]\}',?\n/;var Sl=(()=>{class r{xhrFactory;tracingService=G(ns,{optional:!0});constructor(e){this.xhrFactory=e}maybePropagateTrace(e){return this.tracingService?.propagate?this.tracingService.propagate(e):e}handle(e){if(e.method==="JSONP")throw new xt(-2800,!1);let i=this.xhrFactory;return mt(null).pipe(ke(()=>new Yo(a=>{let l=i.build();if(l.open(e.method,e.urlWithParams),e.withCredentials&&(l.withCredentials=!0),e.headers.forEach((D,x)=>l.setRequestHeader(D,x.join(","))),e.headers.has(Gu)||l.setRequestHeader(Gu,$m),!e.headers.has(Uu)){let D=e.detectContentTypeHeader();D!==null&&l.setRequestHeader(Uu,D)}if(e.timeout&&(l.timeout=e.timeout),e.responseType){let D=e.responseType.toLowerCase();l.responseType=D!=="json"?D:"text"}let h=e.serializeBody(),u=null,p=()=>{if(u!==null)return u;let D=l.statusText||"OK",x=new jn(l.getAllResponseHeaders()),A=l.responseURL||e.url;return u=new ms({headers:x,status:l.status,statusText:D,url:A}),u},g=this.maybePropagateTrace(()=>{let{headers:D,status:x,statusText:A,url:T}=p(),R=null;x!==Zm&&(R=typeof l.response>"u"?l.responseText:l.response),x===0&&(x=R?Wm:0);let z=x>=200&&x<300;if(e.responseType==="json"&&typeof R=="string"){let U=R;R=R.replace(Ym,"");try{R=R!==""?JSON.parse(R):null}catch($){R=U,z&&(z=!1,R={error:$,text:R})}}z?(a.next(new Yr({body:R,headers:D,status:x,statusText:A,url:T||void 0})),a.complete()):a.error(new Wi({error:R,headers:D,status:x,statusText:A,url:T||void 0}))}),m=this.maybePropagateTrace(D=>{let{url:x}=p(),A=new Wi({error:D,status:l.status||0,statusText:l.statusText||"Unknown Error",url:x||void 0});a.error(A)}),v=m;e.timeout&&(v=this.maybePropagateTrace(D=>{let{url:x}=p(),A=new Wi({error:new DOMException("Request timed out","TimeoutError"),status:l.status||0,statusText:l.statusText||"Request timeout",url:x||void 0});a.error(A)}));let y=!1,b=this.maybePropagateTrace(D=>{y||(a.next(p()),y=!0);let x={type:pi.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(x.total=D.total),e.responseType==="text"&&l.responseText&&(x.partialText=l.responseText),a.next(x)}),E=this.maybePropagateTrace(D=>{let x={type:pi.UploadProgress,loaded:D.loaded};D.lengthComputable&&(x.total=D.total),a.next(x)});return l.addEventListener("load",g),l.addEventListener("error",m),l.addEventListener("timeout",v),l.addEventListener("abort",m),e.reportProgress&&(l.addEventListener("progress",b),h!==null&&l.upload&&l.upload.addEventListener("progress",E)),l.send(h),a.next({type:pi.Sent}),()=>{l.removeEventListener("error",m),l.removeEventListener("abort",m),l.removeEventListener("load",g),l.removeEventListener("timeout",v),e.reportProgress&&(l.removeEventListener("progress",b),h!==null&&l.upload&&l.upload.removeEventListener("progress",E)),l.readyState!==l.DONE&&l.abort()}})))}static \u0275fac=function(i){return new(i||r)(_t(fi))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Xm(r,t){return t(r)}function Km(r,t,e){return(i,o)=>_e(e,()=>t(i,a=>r(a,o)))}var $u=new yt("",{factory:()=>[]}),Wu=new yt(""),Zu=new yt("",{factory:()=>!0});var Dl=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=_t(Sl),o},providedIn:"root"})}return r})();var _s=(()=>{class r{backend;injector;chain=null;pendingTasks=G(lu);contributeToStability=G(Zu);constructor(e,i){this.backend=e,this.injector=i}handle(e){if(this.chain===null){let i=Array.from(new Set([...this.injector.get($u),...this.injector.get(Wu,[])]));this.chain=i.reduceRight((o,a)=>Km(o,a,this.injector),Xm)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(e,o=>this.backend.handle(o)).pipe(Jo(i))}else return this.chain(e,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||r)(_t(Dl),_t(ln))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),xl=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=_t(_s),o},providedIn:"root"})}return r})();function Cl(r,t){return{body:t,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,credentials:r.credentials,transferCache:r.transferCache,timeout:r.timeout,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,integrity:r.integrity,referrer:r.referrer,referrerPolicy:r.referrerPolicy}}var Hn=(()=>{class r{handler;constructor(e){this.handler=e}request(e,i,o={}){let a;if(e instanceof $i)a=e;else{let u;o.headers instanceof jn?u=o.headers:u=new jn(o.headers);let p;o.params&&(o.params instanceof En?p=o.params:p=new En({fromObject:o.params})),a=new $i(e,i,o.body!==void 0?o.body:null,{headers:u,context:o.context,params:p,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache,keepalive:o.keepalive,priority:o.priority,cache:o.cache,mode:o.mode,redirect:o.redirect,credentials:o.credentials,referrer:o.referrer,referrerPolicy:o.referrerPolicy,integrity:o.integrity,timeout:o.timeout})}let l=mt(a).pipe(Nr(u=>this.handler.handle(u)));if(e instanceof $i||o.observe==="events")return l;let h=l.pipe(an(u=>u instanceof Yr));switch(o.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return h.pipe(Bt(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new xt(2806,!1);return u.body}));case"blob":return h.pipe(Bt(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new xt(2807,!1);return u.body}));case"text":return h.pipe(Bt(u=>{if(u.body!==null&&typeof u.body!="string")throw new xt(2808,!1);return u.body}));default:return h.pipe(Bt(u=>u.body))}case"response":return h;default:throw new xt(2809,!1)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:new En().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,o={}){return this.request("PATCH",e,Cl(o,i))}post(e,i,o={}){return this.request("POST",e,Cl(o,i))}put(e,i,o={}){return this.request("PUT",e,Cl(o,i))}static \u0275fac=function(i){return new(i||r)(_t(xl))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Jm=new yt("",{factory:()=>!0}),Qm="XSRF-TOKEN",t0=new yt("",{factory:()=>Qm}),e0="X-XSRF-TOKEN",n0=new yt("",{factory:()=>e0}),i0=(()=>{class r{cookieName=G(t0);doc=G(Xt);lastCookieString="";lastToken=null;parseCount=0;getToken(){let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=jr(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),qu=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=_t(i0),o},providedIn:"root"})}return r})();function r0(r,t){if(!G(Jm)||r.method==="GET"||r.method==="HEAD")return t(r);try{let o=G(ji).href,{origin:a}=new URL(o),{origin:l}=new URL(r.url,a);if(a!==l)return t(r)}catch{return t(r)}let e=G(qu).getToken(),i=G(n0);return e!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,e)})),t(r)}function El(...r){let t=[Hn,_s,{provide:xl,useExisting:_s},{provide:Dl,useFactory:()=>G(qm,{optional:!0})??G(Sl)},{provide:$u,useValue:r0,multi:!0}];for(let e of r)t.push(...e.\u0275providers);return Fi(t)}var Yu=(()=>{class r{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(i){return new(i||r)(_t(Xt))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var ht="primary",so=Symbol("RouteTitle"),Rl=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function Ji(r){return new Rl(r)}function Ml(r,t,e){for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(o[0]===":")e[o.substring(1)]=a;else if(o!==a.path)return!1}return!0}function s0(r,t,e){let i=e.path.split("/"),o=i.indexOf("**");if(o===-1){if(i.length>r.length||e.pathMatch==="full"&&(t.hasChildren()||i.length<r.length))return null;let u={},p=r.slice(0,i.length);return Ml(i,p,u)?{consumed:p,posParams:u}:null}if(o!==i.lastIndexOf("**"))return null;let a=i.slice(0,o),l=i.slice(o+1);if(a.length+l.length>r.length||e.pathMatch==="full"&&t.hasChildren()&&e.path!=="**")return null;let h={};return!Ml(a,r.slice(0,a.length),h)||!Ml(l,r.slice(r.length-l.length),h)?null:{consumed:r,posParams:h}}function Ss(r){return new Promise((t,e)=>{r.pipe(Nn()).subscribe({next:i=>t(i),error:i=>e(i)})})}function a0(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(!un(r[e],t[e]))return!1;return!0}function un(r,t){let e=r?Ol(r):void 0,i=t?Ol(t):void 0;if(!e||!i||e.length!=i.length)return!1;let o;for(let a=0;a<e.length;a++)if(o=e[a],!sd(r[o],t[o]))return!1;return!0}function Ol(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function sd(r,t){if(Array.isArray(r)&&Array.isArray(t)){if(r.length!==t.length)return!1;let e=[...r].sort(),i=[...t].sort();return e.every((o,a)=>i[a]===o)}else return r===t}function l0(r){return r.length>0?r[r.length-1]:null}function yi(r){return tl(r)?r:os(r)?Le(Promise.resolve(r)):mt(r)}function ad(r){return tl(r)?Ss(r):Promise.resolve(r)}var c0={exact:cd,subset:hd},ld={exact:h0,subset:u0,ignored:()=>!0};function Xu(r,t,e){return c0[e.paths](r.root,t.root,e.matrixParams)&&ld[e.queryParams](r.queryParams,t.queryParams)&&!(e.fragment==="exact"&&r.fragment!==t.fragment)}function h0(r,t){return un(r,t)}function cd(r,t,e){if(!mi(r.segments,t.segments)||!ws(r.segments,t.segments,e)||r.numberOfChildren!==t.numberOfChildren)return!1;for(let i in t.children)if(!r.children[i]||!cd(r.children[i],t.children[i],e))return!1;return!0}function u0(r,t){return Object.keys(t).length<=Object.keys(r).length&&Object.keys(t).every(e=>sd(r[e],t[e]))}function hd(r,t,e){return ud(r,t,t.segments,e)}function ud(r,t,e,i){if(r.segments.length>e.length){let o=r.segments.slice(0,e.length);return!(!mi(o,e)||t.hasChildren()||!ws(o,e,i))}else if(r.segments.length===e.length){if(!mi(r.segments,e)||!ws(r.segments,e,i))return!1;for(let o in t.children)if(!r.children[o]||!hd(r.children[o],t.children[o],i))return!1;return!0}else{let o=e.slice(0,r.segments.length),a=e.slice(r.segments.length);return!mi(r.segments,o)||!ws(r.segments,o,i)||!r.children[ht]?!1:ud(r.children[ht],t,a,i)}}function ws(r,t,e){return t.every((i,o)=>ld[e](r[o].parameters,i.parameters))}var dn=class{root;queryParams;fragment;_queryParamMap;constructor(t=new Mt([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Ji(this.queryParams),this._queryParamMap}toString(){return p0.serialize(this)}},Mt=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bs(this)}},gi=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=Ji(this.parameters),this._parameterMap}toString(){return fd(this)}};function d0(r,t){return mi(r,t)&&r.every((e,i)=>un(e.parameters,t[i].parameters))}function mi(r,t){return r.length!==t.length?!1:r.every((e,i)=>e.path===t[i].path)}function f0(r,t){let e=[];return Object.entries(r.children).forEach(([i,o])=>{i===ht&&(e=e.concat(t(o,i)))}),Object.entries(r.children).forEach(([i,o])=>{i!==ht&&(e=e.concat(t(o,i)))}),e}var Is=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>new _i,providedIn:"root"})}return r})(),_i=class{parse(t){let e=new Ll(t);return new dn(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${Xr(t.root,!0)}`,i=_0(t.queryParams),o=typeof t.fragment=="string"?`#${g0(t.fragment)}`:"";return`${e}${i}${o}`}},p0=new _i;function bs(r){return r.segments.map(t=>fd(t)).join("/")}function Xr(r,t){if(!r.hasChildren())return bs(r);if(t){let e=r.children[ht]?Xr(r.children[ht],!1):"",i=[];return Object.entries(r.children).forEach(([o,a])=>{o!==ht&&i.push(`${o}:${Xr(a,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}else{let e=f0(r,(i,o)=>o===ht?[Xr(r.children[ht],!1)]:[`${o}:${Xr(i,!1)}`]);return Object.keys(r.children).length===1&&r.children[ht]!=null?`${bs(r)}/${e[0]}`:`${bs(r)}/(${e.join("//")})`}}function dd(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vs(r){return dd(r).replace(/%3B/gi,";")}function g0(r){return encodeURI(r)}function Il(r){return dd(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Cs(r){return decodeURIComponent(r)}function Ku(r){return Cs(r.replace(/\+/g,"%20"))}function fd(r){return`${Il(r.path)}${m0(r.parameters)}`}function m0(r){return Object.entries(r).map(([t,e])=>`;${Il(t)}=${Il(e)}`).join("")}function _0(r){let t=Object.entries(r).map(([e,i])=>Array.isArray(i)?i.map(o=>`${vs(e)}=${vs(o)}`).join("&"):`${vs(e)}=${vs(i)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var v0=/^[^\/()?;#]+/;function Tl(r){let t=r.match(v0);return t?t[0]:""}var y0=/^[^\/()?;=#]+/;function w0(r){let t=r.match(y0);return t?t[0]:""}var b0=/^[^=?&#]+/;function C0(r){let t=r.match(b0);return t?t[0]:""}var S0=/^[^&#]+/;function D0(r){let t=r.match(S0);return t?t[0]:""}var Ll=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Mt([],{}):new Mt([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[ht]=new Mt(t,e)),i}parseSegment(){let t=Tl(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new xt(4009,!1);return this.capture(t),new gi(Cs(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=w0(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let o=Tl(this.remaining);o&&(i=o,this.capture(i))}t[Cs(e)]=Cs(i)}parseQueryParam(t){let e=C0(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let l=D0(this.remaining);l&&(i=l,this.capture(i))}let o=Ku(e),a=Ku(i);if(t.hasOwnProperty(o)){let l=t[o];Array.isArray(l)||(l=[l],t[o]=l),l.push(a)}else t[o]=a}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Tl(this.remaining),o=this.remaining[i.length];if(o!=="/"&&o!==")"&&o!==";")throw new xt(4010,!1);let a;i.indexOf(":")>-1?(a=i.slice(0,i.indexOf(":")),this.capture(a),this.capture(":")):t&&(a=ht);let l=this.parseChildren();e[a??ht]=Object.keys(l).length===1&&l[ht]?l[ht]:new Mt([],l),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new xt(4011,!1)}};function pd(r){return r.segments.length>0?new Mt([],{[ht]:r}):r}function gd(r){let t={};for(let[i,o]of Object.entries(r.children)){let a=gd(o);if(i===ht&&a.segments.length===0&&a.hasChildren())for(let[l,h]of Object.entries(a.children))t[l]=h;else(a.segments.length>0||a.hasChildren())&&(t[i]=a)}let e=new Mt(r.segments,t);return x0(e)}function x0(r){if(r.numberOfChildren===1&&r.children[ht]){let t=r.children[ht];return new Mt(r.segments.concat(t.segments),t.children)}return r}function Qi(r){return r instanceof dn}function E0(r,t,e=null,i=null,o=new _i){let a=md(r);return _d(a,t,e,i,o)}function md(r){let t;function e(a){let l={};for(let u of a.children){let p=e(u);l[u.outlet]=p}let h=new Mt(a.url,l);return a===r&&(t=h),h}let i=e(r.root),o=pd(i);return t??o}function _d(r,t,e,i,o){let a=r;for(;a.parent;)a=a.parent;if(t.length===0)return Pl(a,a,a,e,i,o);let l=M0(t);if(l.toRoot())return Pl(a,a,new Mt([],{}),e,i,o);let h=T0(l,a,r),u=h.processChildren?Jr(h.segmentGroup,h.index,l.commands):yd(h.segmentGroup,h.index,l.commands);return Pl(a,h.segmentGroup,u,e,i,o)}function Ds(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function eo(r){return typeof r=="object"&&r!=null&&r.outlets}function Ju(r,t,e){r||="\u0275";let i=new dn;return i.queryParams={[r]:t},e.parse(e.serialize(i)).queryParams[r]}function Pl(r,t,e,i,o,a){let l={};for(let[p,g]of Object.entries(i??{}))l[p]=Array.isArray(g)?g.map(m=>Ju(p,m,a)):Ju(p,g,a);let h;r===t?h=e:h=vd(r,t,e);let u=pd(gd(h));return new dn(u,l,o)}function vd(r,t,e){let i={};return Object.entries(r.children).forEach(([o,a])=>{a===t?i[o]=e:i[o]=vd(a,t,e)}),new Mt(r.segments,i)}var xs=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Ds(i[0]))throw new xt(4003,!1);let o=i.find(eo);if(o&&o!==l0(i))throw new xt(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function M0(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new xs(!0,0,r);let t=0,e=!1,i=r.reduce((o,a,l)=>{if(typeof a=="object"&&a!=null){if(a.outlets){let h={};return Object.entries(a.outlets).forEach(([u,p])=>{h[u]=typeof p=="string"?p.split("/"):p}),[...o,{outlets:h}]}if(a.segmentPath)return[...o,a.segmentPath]}return typeof a!="string"?[...o,a]:l===0?(a.split("/").forEach((h,u)=>{u==0&&h==="."||(u==0&&h===""?e=!0:h===".."?t++:h!=""&&o.push(h))}),o):[...o,a]},[]);return new xs(e,t,i)}var Yi=class{segmentGroup;processChildren;index;constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}};function T0(r,t,e){if(r.isAbsolute)return new Yi(t,!0,0);if(!e)return new Yi(t,!1,NaN);if(e.parent===null)return new Yi(e,!0,0);let i=Ds(r.commands[0])?0:1,o=e.segments.length-1+i;return P0(e,o,r.numberOfDoubleDots)}function P0(r,t,e){let i=r,o=t,a=e;for(;a>o;){if(a-=o,i=i.parent,!i)throw new xt(4005,!1);o=i.segments.length}return new Yi(i,!1,o-a)}function A0(r){return eo(r[0])?r[0].outlets:{[ht]:r}}function yd(r,t,e){if(r??=new Mt([],{}),r.segments.length===0&&r.hasChildren())return Jr(r,t,e);let i=R0(r,t,e),o=e.slice(i.commandIndex);if(i.match&&i.pathIndex<r.segments.length){let a=new Mt(r.segments.slice(0,i.pathIndex),{});return a.children[ht]=new Mt(r.segments.slice(i.pathIndex),r.children),Jr(a,0,o)}else return i.match&&o.length===0?new Mt(r.segments,{}):i.match&&!r.hasChildren()?kl(r,t,e):i.match?Jr(r,0,o):kl(r,t,e)}function Jr(r,t,e){if(e.length===0)return new Mt(r.segments,{});{let i=A0(e),o={};if(Object.keys(i).some(a=>a!==ht)&&r.children[ht]&&r.numberOfChildren===1&&r.children[ht].segments.length===0){let a=Jr(r.children[ht],t,e);return new Mt(r.segments,a.children)}return Object.entries(i).forEach(([a,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(o[a]=yd(r.children[a],t,l))}),Object.entries(r.children).forEach(([a,l])=>{i[a]===void 0&&(o[a]=l)}),new Mt(r.segments,o)}}function R0(r,t,e){let i=0,o=t,a={match:!1,pathIndex:0,commandIndex:0};for(;o<r.segments.length;){if(i>=e.length)return a;let l=r.segments[o],h=e[i];if(eo(h))break;let u=`${h}`,p=i<e.length-1?e[i+1]:null;if(o>0&&u===void 0)break;if(u&&p&&typeof p=="object"&&p.outlets===void 0){if(!td(u,p,l))return a;i+=2}else{if(!td(u,{},l))return a;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}function kl(r,t,e){let i=r.segments.slice(0,t),o=0;for(;o<e.length;){let a=e[o];if(eo(a)){let u=O0(a.outlets);return new Mt(i,u)}if(o===0&&Ds(e[0])){let u=r.segments[t];i.push(new gi(u.path,Qu(e[0]))),o++;continue}let l=eo(a)?a.outlets[ht]:`${a}`,h=o<e.length-1?e[o+1]:null;l&&h&&Ds(h)?(i.push(new gi(l,Qu(h))),o+=2):(i.push(new gi(l,{})),o++)}return new Mt(i,{})}function O0(r){let t={};return Object.entries(r).forEach(([e,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(t[e]=kl(new Mt([],{}),0,i))}),t}function Qu(r){let t={};return Object.entries(r).forEach(([e,i])=>t[e]=`${i}`),t}function td(r,t,e){return r==e.path&&un(t,e.parameters)}var Qr="imperative",oe=(function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r})(oe||{}),Fe=class{id;url;constructor(t,e){this.id=t,this.url=e}},tr=class extends Fe{type=oe.NavigationStart;navigationTrigger;restoredState;constructor(t,e,i="imperative",o=null){super(t,e),this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},$n=class extends Fe{urlAfterRedirects;type=oe.NavigationEnd;constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},pe=(function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r[r.Aborted=4]="Aborted",r})(pe||{}),Es=(function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r})(Es||{}),Ye=class extends Fe{reason;code;type=oe.NavigationCancel;constructor(t,e,i,o){super(t,e),this.reason=i,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function wd(r){return r instanceof Ye&&(r.code===pe.Redirect||r.code===pe.SupersededByNewNavigation)}var Wn=class extends Fe{reason;code;type=oe.NavigationSkipped;constructor(t,e,i,o){super(t,e),this.reason=i,this.code=o}},er=class extends Fe{error;target;type=oe.NavigationError;constructor(t,e,i,o){super(t,e),this.error=i,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},no=class extends Fe{urlAfterRedirects;state;type=oe.RoutesRecognized;constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nl=class extends Fe{urlAfterRedirects;state;type=oe.GuardsCheckStart;constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fl=class extends Fe{urlAfterRedirects;state;shouldActivate;type=oe.GuardsCheckEnd;constructor(t,e,i,o,a){super(t,e),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Bl=class extends Fe{urlAfterRedirects;state;type=oe.ResolveStart;constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vl=class extends Fe{urlAfterRedirects;state;type=oe.ResolveEnd;constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zl=class{route;type=oe.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ul=class{route;type=oe.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Gl=class{snapshot;type=oe.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jl=class{snapshot;type=oe.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Hl=class{snapshot;type=oe.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$l=class{snapshot;type=oe.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var nr=class{},ir=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function I0(r){return!(r instanceof nr)&&!(r instanceof ir)}var Wl=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new ao(this.rootInjector)}},ao=(()=>{class r{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,i){let o=this.getOrCreateContext(e);o.outlet=i,this.contexts.set(e,o)}onChildOutletDestroyed(e){let i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new Wl(this.rootInjector),this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(i){return new(i||r)(_t(ln))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ms=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=Zl(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){let e=Zl(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=ql(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return ql(t,this._root).map(e=>e.value)}};function Zl(r,t){if(r===t.value)return t;for(let e of t.children){let i=Zl(r,e);if(i)return i}return null}function ql(r,t){if(r===t.value)return[t];for(let e of t.children){let i=ql(r,e);if(i.length)return i.unshift(t),i}return[]}var De=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function qi(r){let t={};return r&&r.children.forEach(e=>t[e.value.outlet]=e),t}var Ts=class extends Ms{snapshot;constructor(t,e){super(t),this.snapshot=e,ic(this,t)}toString(){return this.snapshot.toString()}};function bd(r,t){let e=L0(r,t),i=new Oe([new gi("",{})]),o=new Oe({}),a=new Oe({}),l=new Oe({}),h=new Oe(""),u=new vi(i,o,l,h,a,ht,r,e.root);return u.snapshot=e.root,new Ts(new De(u,[]),e)}function L0(r,t){let e={},i={},o={},l=new Xi([],e,o,"",i,ht,r,null,{},t);return new As("",new De(l,[]))}var vi=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,i,o,a,l,h,u){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=o,this.dataSubject=a,this.outlet=l,this.component=h,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Bt(p=>p[so]))??mt(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=o,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Bt(t=>Ji(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Bt(t=>Ji(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Ps(r,t,e="emptyOnly"){let i,{routeConfig:o}=r;return t!==null&&(e==="always"||o?.path===""||!t.component&&!t.routeConfig?.loadComponent)?i={params:j(j({},t.params),r.params),data:j(j({},t.data),r.data),resolve:j(j(j(j({},r.data),t.data),o?.data),r._resolvedData)}:i={params:j({},r.params),data:j({},r.data),resolve:j(j({},r.data),r._resolvedData??{})},o&&Sd(o)&&(i.resolve[so]=o.title),i}var Xi=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[so]}constructor(t,e,i,o,a,l,h,u,p,g){this.url=t,this.params=e,this.queryParams=i,this.fragment=o,this.data=a,this.outlet=l,this.component=h,this.routeConfig=u,this._resolve=p,this._environmentInjector=g}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ji(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ji(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(i=>i.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},As=class extends Ms{url;constructor(t,e){super(e),this.url=t,ic(this,e)}toString(){return Cd(this._root)}};function ic(r,t){t.value._routerState=r,t.children.forEach(e=>ic(r,e))}function Cd(r){let t=r.children.length>0?` { ${r.children.map(Cd).join(", ")} } `:"";return`${r.value}${t}`}function Al(r){if(r.snapshot){let t=r.snapshot,e=r._futureSnapshot;r.snapshot=e,un(t.queryParams,e.queryParams)||r.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&r.fragmentSubject.next(e.fragment),un(t.params,e.params)||r.paramsSubject.next(e.params),a0(t.url,e.url)||r.urlSubject.next(e.url),un(t.data,e.data)||r.dataSubject.next(e.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function Yl(r,t){let e=un(r.params,t.params)&&d0(r.url,t.url),i=!r.parent!=!t.parent;return e&&!i&&(!r.parent||Yl(r.parent,t.parent))}function Sd(r){return typeof r.title=="string"||r.title===null}var k0=new yt(""),Dd=(()=>{class r{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ht;activateEvents=new Ge;deactivateEvents=new Ge;attachEvents=new Ge;detachEvents=new Ge;routerOutletData=Lt();parentContexts=G(ao);location=G(ll);changeDetector=G(Ur);inputBinder=G(Ls,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:i,previousValue:o}=e.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new xt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new xt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new xt(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new xt(4013,!1);this._activatedRoute=e;let o=this.location,l=e.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,u=new Xl(e,h,o.injector,this.routerOutletData);this.activated=o.createComponent(l,{index:o.length,injector:u,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||r)};static \u0275dir=je({type:r,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Vi]})}return r})(),Xl=class{route;childContexts;parent;outletData;constructor(t,e,i,o){this.route=t,this.childContexts=e,this.parent=i,this.outletData=o}get(t,e){return t===vi?this.route:t===ao?this.childContexts:t===k0?this.outletData:this.parent.get(t,e)}},Ls=new yt("");var xd=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275cmp=Wt({type:r,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,o){i&1&&Jt(0,"router-outlet")},dependencies:[Dd],encapsulation:2})}return r})();function rc(r){let t=r.children&&r.children.map(rc),e=t?Pt(j({},r),{children:t}):j({},r);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==ht&&(e.component=xd),e}function N0(r,t,e){let i=io(r,t._root,e?e._root:void 0);return new Ts(i,t)}function io(r,t,e){if(e&&r.shouldReuseRoute(t.value,e.value.snapshot)){let i=e.value;i._futureSnapshot=t.value;let o=F0(r,t,e);return new De(i,o)}else{if(r.shouldAttach(t.value)){let a=r.retrieve(t.value);if(a!==null){let l=a.route;return l.value._futureSnapshot=t.value,l.children=t.children.map(h=>io(r,h)),l}}let i=B0(t.value),o=t.children.map(a=>io(r,a));return new De(i,o)}}function F0(r,t,e){return t.children.map(i=>{for(let o of e.children)if(r.shouldReuseRoute(i.value,o.value.snapshot))return io(r,i,o);return io(r,i)})}function B0(r){return new vi(new Oe(r.url),new Oe(r.params),new Oe(r.queryParams),new Oe(r.fragment),new Oe(r.data),r.outlet,r.component,r)}var ro=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},Ed="ngNavigationCancelingError";function Rs(r,t){let{redirectTo:e,navigationBehaviorOptions:i}=Qi(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=Md(!1,pe.Redirect);return o.url=e,o.navigationBehaviorOptions=i,o}function Md(r,t){let e=new Error(`NavigationCancelingError: ${r||""}`);return e[Ed]=!0,e.cancellationCode=t,e}function V0(r){return Td(r)&&Qi(r.url)}function Td(r){return!!r&&r[Ed]}var Kl=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,i,o,a){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=o,this.inputBindingEnabled=a}activate(t){let e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),Al(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){let o=qi(e);t.children.forEach(a=>{let l=a.value.outlet;this.deactivateRoutes(a,o[l],i),delete o[l]}),Object.values(o).forEach(a=>{this.deactivateRouteAndItsChildren(a,i)})}deactivateRoutes(t,e,i){let o=t.value,a=e?e.value:null;if(o===a)if(o.component){let l=i.getContext(o.outlet);l&&this.deactivateChildRoutes(t,e,l.children)}else this.deactivateChildRoutes(t,e,i);else a&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let i=e.getContext(t.value.outlet),o=i&&t.value.component?i.children:e,a=qi(t);for(let l of Object.values(a))this.deactivateRouteAndItsChildren(l,o);if(i&&i.outlet){let l=i.outlet.detach(),h=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:l,route:t,contexts:h})}}deactivateRouteAndOutlet(t,e){let i=e.getContext(t.value.outlet),o=i&&t.value.component?i.children:e,a=qi(t);for(let l of Object.values(a))this.deactivateRouteAndItsChildren(l,o);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){let o=qi(e);t.children.forEach(a=>{this.activateRoutes(a,o[a.value.outlet],i),this.forwardEvent(new $l(a.value.snapshot))}),t.children.length&&this.forwardEvent(new jl(t.value.snapshot))}activateRoutes(t,e,i){let o=t.value,a=e?e.value:null;if(Al(o),o===a)if(o.component){let l=i.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,l.children)}else this.activateChildRoutes(t,e,i);else if(o.component){let l=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let h=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),Al(h.route.value),this.activateChildRoutes(t,null,l.children)}else l.attachRef=null,l.route=o,l.outlet&&l.outlet.activateWith(o,l.injector),this.activateChildRoutes(t,null,l.children)}else this.activateChildRoutes(t,null,i)}},Os=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Ki=class{component;route;constructor(t,e){this.component=t,this.route=e}};function z0(r,t,e){let i=r._root,o=t?t._root:null;return Kr(i,o,e,[i.value])}function U0(r){let t=r.routeConfig?r.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:r,guards:t}}function or(r,t){let e=Symbol(),i=t.get(r,e);return i===e?typeof r=="function"&&!ru(r)?r:t.get(r):i}function Kr(r,t,e,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let a=qi(t);return r.children.forEach(l=>{G0(l,a[l.value.outlet],e,i.concat([l.value]),o),delete a[l.value.outlet]}),Object.entries(a).forEach(([l,h])=>to(h,e.getContext(l),o)),o}function G0(r,t,e,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let a=r.value,l=t?t.value:null,h=e?e.getContext(r.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){let u=j0(l,a,a.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new Os(i)):(a.data=l.data,a._resolvedData=l._resolvedData),a.component?Kr(r,t,h?h.children:null,i,o):Kr(r,t,e,i,o),u&&h&&h.outlet&&h.outlet.isActivated&&o.canDeactivateChecks.push(new Ki(h.outlet.component,l))}else l&&to(t,h,o),o.canActivateChecks.push(new Os(i)),a.component?Kr(r,null,h?h.children:null,i,o):Kr(r,null,e,i,o);return o}function j0(r,t,e){if(typeof e=="function")return _e(t._environmentInjector,()=>e(r,t));switch(e){case"pathParamsChange":return!mi(r.url,t.url);case"pathParamsOrQueryParamsChange":return!mi(r.url,t.url)||!un(r.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Yl(r,t)||!un(r.queryParams,t.queryParams);default:return!Yl(r,t)}}function to(r,t,e){let i=qi(r),o=r.value;Object.entries(i).forEach(([a,l])=>{o.component?t?to(l,t.children.getContext(a),e):to(l,null,e):to(l,t,e)}),o.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new Ki(t.outlet.component,o)):e.canDeactivateChecks.push(new Ki(null,o)):e.canDeactivateChecks.push(new Ki(null,o))}function lo(r){return typeof r=="function"}function H0(r){return typeof r=="boolean"}function $0(r){return r&&lo(r.canLoad)}function W0(r){return r&&lo(r.canActivate)}function Z0(r){return r&&lo(r.canActivateChild)}function q0(r){return r&&lo(r.canDeactivate)}function Y0(r){return r&&lo(r.canMatch)}function Pd(r){return r instanceof Jh||r?.name==="EmptyError"}var ys=Symbol("INITIAL_VALUE");function rr(){return ke(r=>Qh(r.map(t=>t.pipe(Ni(1),iu(ys)))).pipe(Bt(t=>{for(let e of t)if(e!==!0){if(e===ys)return ys;if(e===!1||X0(e))return e}return!0}),an(t=>t!==ys),Ni(1)))}function X0(r){return Qi(r)||r instanceof ro}function Ad(r){return r.aborted?mt(void 0).pipe(Ni(1)):new Yo(t=>{let e=()=>{t.next(),t.complete()};return r.addEventListener("abort",e),()=>r.removeEventListener("abort",e)})}function Rd(r){return Qo(Ad(r))}function K0(r){return kn(t=>{let{targetSnapshot:e,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=t;return a.length===0&&o.length===0?mt(Pt(j({},t),{guardsResult:!0})):J0(a,e,i).pipe(kn(l=>l&&H0(l)?Q0(e,o,r):mt(l)),Bt(l=>Pt(j({},t),{guardsResult:l})))})}function J0(r,t,e){return Le(r).pipe(kn(i=>r_(i.component,i.route,e,t)),Nn(i=>i!==!0,!0))}function Q0(r,t,e){return Le(t).pipe(Nr(i=>tu(e_(i.route.parent,e),t_(i.route,e),i_(r,i.path),n_(r,i.route))),Nn(i=>i!==!0,!0))}function t_(r,t){return r!==null&&t&&t(new Hl(r)),mt(!0)}function e_(r,t){return r!==null&&t&&t(new Gl(r)),mt(!0)}function n_(r,t){let e=t.routeConfig?t.routeConfig.canActivate:null;if(!e||e.length===0)return mt(!0);let i=e.map(o=>Xo(()=>{let a=t._environmentInjector,l=or(o,a),h=W0(l)?l.canActivate(t,r):_e(a,()=>l(t,r));return yi(h).pipe(Nn())}));return mt(i).pipe(rr())}function i_(r,t){let e=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(a=>U0(a)).filter(a=>a!==null).map(a=>Xo(()=>{let l=a.guards.map(h=>{let u=a.node._environmentInjector,p=or(h,u),g=Z0(p)?p.canActivateChild(e,r):_e(u,()=>p(e,r));return yi(g).pipe(Nn())});return mt(l).pipe(rr())}));return mt(o).pipe(rr())}function r_(r,t,e,i){let o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||o.length===0)return mt(!0);let a=o.map(l=>{let h=t._environmentInjector,u=or(l,h),p=q0(u)?u.canDeactivate(r,t,e,i):_e(h,()=>u(r,t,e,i));return yi(p).pipe(Nn())});return mt(a).pipe(rr())}function o_(r,t,e,i,o){let a=t.canLoad;if(a===void 0||a.length===0)return mt(!0);let l=a.map(h=>{let u=or(h,r),p=$0(u)?u.canLoad(t,e):_e(r,()=>u(t,e)),g=yi(p);return o?g.pipe(Rd(o)):g});return mt(l).pipe(rr(),Od(i))}function Od(r){return Xh(Cn(t=>{if(typeof t!="boolean")throw Rs(r,t)}),Bt(t=>t===!0))}function s_(r,t,e,i,o){let a=t.canMatch;if(!a||a.length===0)return mt(!0);let l=a.map(h=>{let u=or(h,r),p=Y0(u)?u.canMatch(t,e):_e(r,()=>u(t,e));return yi(p).pipe(Rd(o))});return mt(l).pipe(rr(),Od(i))}var Mn=class r extends Error{segmentGroup;constructor(t){super(),this.segmentGroup=t||null,Object.setPrototypeOf(this,r.prototype)}},oo=class r extends Error{urlTree;constructor(t){super(),this.urlTree=t,Object.setPrototypeOf(this,r.prototype)}};function a_(r){throw new xt(4e3,!1)}function l_(r){throw Md(!1,pe.GuardRejected)}var Jl=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}async lineralizeSegments(t,e){let i=[],o=e.root;for(;;){if(i=i.concat(o.segments),o.numberOfChildren===0)return i;if(o.numberOfChildren>1||!o.children[ht])throw a_(`${t.redirectTo}`);o=o.children[ht]}}async applyRedirectCommands(t,e,i,o,a){let l=await c_(e,o,a);if(l instanceof dn)throw new oo(l);let h=this.applyRedirectCreateUrlTree(l,this.urlSerializer.parse(l),t,i);if(l[0]==="/")throw new oo(h);return h}applyRedirectCreateUrlTree(t,e,i,o){let a=this.createSegmentGroup(t,e.root,i,o);return new dn(a,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let i={};return Object.entries(t).forEach(([o,a])=>{if(typeof a=="string"&&a[0]===":"){let h=a.substring(1);i[o]=e[h]}else i[o]=a}),i}createSegmentGroup(t,e,i,o){let a=this.createSegments(t,e.segments,i,o),l={};return Object.entries(e.children).forEach(([h,u])=>{l[h]=this.createSegmentGroup(t,u,i,o)}),new Mt(a,l)}createSegments(t,e,i,o){return e.map(a=>a.path[0]===":"?this.findPosParam(t,a,o):this.findOrReturn(a,i))}findPosParam(t,e,i){let o=i[e.path.substring(1)];if(!o)throw new xt(4001,!1);return o}findOrReturn(t,e){let i=0;for(let o of e){if(o.path===t.path)return e.splice(i),o;i++}return t}};function c_(r,t,e){if(typeof r=="string")return Promise.resolve(r);let i=r,{queryParams:o,fragment:a,routeConfig:l,url:h,outlet:u,params:p,data:g,title:m,paramMap:v,queryParamMap:y}=t;return Ss(yi(_e(e,()=>i({params:p,data:g,queryParams:o,fragment:a,routeConfig:l,url:h,outlet:u,title:m,paramMap:v,queryParamMap:y}))))}function h_(r,t){return r.providers&&!r._injector&&(r._injector=cl(r.providers,t,`Route: ${r.path}`)),r._injector??t}function qe(r){return r.outlet||ht}function u_(r,t){let e=r.filter(i=>qe(i)===t);return e.push(...r.filter(i=>qe(i)!==t)),e}var Ql={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function d_(r,t,e,i,o,a){let l=Id(r,t,e);return l.matched?(i=h_(t,i),s_(i,t,e,o,a).pipe(Bt(h=>h===!0?l:j({},Ql)))):mt(l)}function Id(r,t,e){if(t.path==="")return t.pathMatch==="full"&&(r.hasChildren()||e.length>0)?j({},Ql):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let o=(t.matcher||s0)(e,r,t);if(!o)return j({},Ql);let a={};Object.entries(o.posParams??{}).forEach(([h,u])=>{a[h]=u.path});let l=o.consumed.length>0?j(j({},a),o.consumed[o.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:l,positionalParamSegments:o.posParams??{}}}function ed(r,t,e,i){return e.length>0&&g_(r,e,i)?{segmentGroup:new Mt(t,p_(i,new Mt(e,r.children))),slicedSegments:[]}:e.length===0&&m_(r,e,i)?{segmentGroup:new Mt(r.segments,f_(r,e,i,r.children)),slicedSegments:e}:{segmentGroup:new Mt(r.segments,r.children),slicedSegments:e}}function f_(r,t,e,i){let o={};for(let a of e)if(ks(r,t,a)&&!i[qe(a)]){let l=new Mt([],{});o[qe(a)]=l}return j(j({},i),o)}function p_(r,t){let e={};e[ht]=t;for(let i of r)if(i.path===""&&qe(i)!==ht){let o=new Mt([],{});e[qe(i)]=o}return e}function g_(r,t,e){return e.some(i=>ks(r,t,i)&&qe(i)!==ht)}function m_(r,t,e){return e.some(i=>ks(r,t,i))}function ks(r,t,e){return(r.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function __(r,t,e){return t.length===0&&!r.children[e]}var tc=class{};async function v_(r,t,e,i,o,a,l="emptyOnly",h){return new ec(r,t,e,i,o,l,a,h).recognize()}var y_=31,ec=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,i,o,a,l,h,u){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=o,this.urlTree=a,this.paramsInheritanceStrategy=l,this.urlSerializer=h,this.abortSignal=u,this.applyRedirects=new Jl(this.urlSerializer,this.urlTree)}noMatchError(t){return new xt(4002,`'${t.segmentGroup}'`)}async recognize(){let t=ed(this.urlTree.root,[],[],this.config).segmentGroup,{children:e,rootSnapshot:i}=await this.match(t),o=new De(i,e),a=new As("",o),l=E0(i,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(l),{state:a,tree:l}}async match(t){let e=new Xi([],Object.freeze({}),Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ht,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,t,ht,e),rootSnapshot:e}}catch(i){if(i instanceof oo)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Mn?this.noMatchError(i):i}}async processSegmentGroup(t,e,i,o,a){if(i.segments.length===0&&i.hasChildren())return this.processChildren(t,e,i,a);let l=await this.processSegment(t,e,i,i.segments,o,!0,a);return l instanceof De?[l]:[]}async processChildren(t,e,i,o){let a=[];for(let u of Object.keys(i.children))u==="primary"?a.unshift(u):a.push(u);let l=[];for(let u of a){let p=i.children[u],g=u_(e,u),m=await this.processSegmentGroup(t,g,p,u,o);l.push(...m)}let h=Ld(l);return w_(h),h}async processSegment(t,e,i,o,a,l,h){for(let u of e)try{return await this.processSegmentAgainstRoute(u._injector??t,e,u,i,o,a,l,h)}catch(p){if(p instanceof Mn||Pd(p))continue;throw p}if(__(i,o,a))return new tc;throw new Mn(i)}async processSegmentAgainstRoute(t,e,i,o,a,l,h,u){if(qe(i)!==l&&(l===ht||!ks(o,a,i)))throw new Mn(o);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(t,o,i,a,l,u);if(this.allowRedirects&&h)return this.expandSegmentAgainstRouteUsingRedirect(t,o,e,i,a,l,u);throw new Mn(o)}async expandSegmentAgainstRouteUsingRedirect(t,e,i,o,a,l,h){let{matched:u,parameters:p,consumedSegments:g,positionalParamSegments:m,remainingSegments:v}=Id(e,o,a);if(!u)throw new Mn(e);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>y_&&(this.allowRedirects=!1));let y=new Xi(a,p,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,nd(o),qe(o),o.component??o._loadedComponent??null,o,id(o),t),b=Ps(y,h,this.paramsInheritanceStrategy);if(y.params=Object.freeze(b.params),y.data=Object.freeze(b.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let E=await this.applyRedirects.applyRedirectCommands(g,o.redirectTo,m,y,t),D=await this.applyRedirects.lineralizeSegments(o,E);return this.processSegment(t,i,e,D.concat(v),l,!1,h)}async matchSegmentAgainstRoute(t,e,i,o,a,l){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let h=await Ss(d_(e,i,o,t,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(e.children={}),!h?.matched)throw new Mn(e);t=i._injector??t;let{routes:u}=await this.getChildConfig(t,i,o),p=i._loadedInjector??t,{parameters:g,consumedSegments:m,remainingSegments:v}=h,y=new Xi(m,g,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,nd(i),qe(i),i.component??i._loadedComponent??null,i,id(i),t),b=Ps(y,l,this.paramsInheritanceStrategy);y.params=Object.freeze(b.params),y.data=Object.freeze(b.data);let{segmentGroup:E,slicedSegments:D}=ed(e,m,v,u);if(D.length===0&&E.hasChildren()){let T=await this.processChildren(p,u,E,y);return new De(y,T)}if(u.length===0&&D.length===0)return new De(y,[]);let x=qe(i)===a,A=await this.processSegment(p,u,E,D,x?ht:a,!0,y);return new De(y,A instanceof De?[A]:[])}async getChildConfig(t,e,i){if(e.children)return{routes:e.children,injector:t};if(e.loadChildren){if(e._loadedRoutes!==void 0){let a=e._loadedNgModuleFactory;return a&&!e._loadedInjector&&(e._loadedInjector=a.create(t).injector),{routes:e._loadedRoutes,injector:e._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Ss(o_(t,e,i,this.urlSerializer,this.abortSignal))){let a=await this.configLoader.loadChildren(t,e);return e._loadedRoutes=a.routes,e._loadedInjector=a.injector,e._loadedNgModuleFactory=a.factory,a}throw l_(e)}return{routes:[],injector:t}}};function w_(r){r.sort((t,e)=>t.value.outlet===ht?-1:e.value.outlet===ht?1:t.value.outlet.localeCompare(e.value.outlet))}function b_(r){let t=r.value.routeConfig;return t&&t.path===""}function Ld(r){let t=[],e=new Set;for(let i of r){if(!b_(i)){t.push(i);continue}let o=t.find(a=>i.value.routeConfig===a.value.routeConfig);o!==void 0?(o.children.push(...i.children),e.add(o)):t.push(i)}for(let i of e){let o=Ld(i.children);t.push(new De(i.value,o))}return t.filter(i=>!e.has(i))}function nd(r){return r.data||{}}function id(r){return r.resolve||{}}function C_(r,t,e,i,o,a,l){return kn(async h=>{let{state:u,tree:p}=await v_(r,t,e,i,h.extractedUrl,o,a,l);return Pt(j({},h),{targetSnapshot:u,urlAfterRedirects:p})})}function S_(r){return kn(t=>{let{targetSnapshot:e,guards:{canActivateChecks:i}}=t;if(!i.length)return mt(t);let o=new Set(i.map(h=>h.route)),a=new Set;for(let h of o)if(!a.has(h))for(let u of kd(h))a.add(u);let l=0;return Le(a).pipe(Nr(h=>o.has(h)?D_(h,e,r):(h.data=Ps(h,h.parent,r).resolve,mt(void 0))),Cn(()=>l++),el(1),kn(h=>l===a.size?mt(t):Ie))})}function kd(r){let t=r.children.map(e=>kd(e)).flat();return[r,...t]}function D_(r,t,e){let i=r.routeConfig,o=r._resolve;return i?.title!==void 0&&!Sd(i)&&(o[so]=i.title),Xo(()=>(r.data=Ps(r,r.parent,e).resolve,x_(o,r,t).pipe(Bt(a=>(r._resolvedData=a,r.data=j(j({},r.data),a),null)))))}function x_(r,t,e){let i=Ol(r);if(i.length===0)return mt({});let o={};return Le(i).pipe(kn(a=>E_(r[a],t,e).pipe(Nn(),Cn(l=>{if(l instanceof ro)throw Rs(new _i,l);o[a]=l}))),el(1),Bt(()=>o),kr(a=>Pd(a)?Ie:Kh(a)))}function E_(r,t,e){let i=t._environmentInjector,o=or(r,i),a=o.resolve?o.resolve(t,e):_e(i,()=>o(t,e));return yi(a)}function rd(r){return ke(t=>{let e=r(t);return e?Le(e).pipe(Bt(()=>t)):mt(t)})}var Nd=(()=>{class r{buildTitle(e){let i,o=e.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(a=>a.outlet===ht);return i}getResolvedTitleForRoute(e){return e.data[so]}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(M_),providedIn:"root"})}return r})(),M_=(()=>{class r extends Nd{title;constructor(e){super(),this.title=e}updateTitle(e){let i=this.buildTitle(e);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||r)(_t(Yu))};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ns=new yt("",{factory:()=>({})}),Fs=new yt(""),Fd=(()=>{class r{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=G(Cu);async loadComponent(e,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let o=(async()=>{try{let a=await ad(_e(e,()=>i.loadComponent())),l=await Vd(Bd(a));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=l,l}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,o),o}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=(async()=>{try{let a=await T_(i,this.compiler,e,this.onLoadEndListener);return i._loadedRoutes=a.routes,i._loadedInjector=a.injector,i._loadedNgModuleFactory=a.factory,a}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,o),o}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();async function T_(r,t,e,i){let o=await ad(_e(e,()=>r.loadChildren())),a=await Vd(Bd(o)),l;a instanceof pu||Array.isArray(a)?l=a:l=await t.compileModuleAsync(a),i&&i(r);let h,u,p=!1,g;return Array.isArray(l)?(u=l,p=!0):(h=l.create(e).injector,g=l,u=h.get(Fs,[],{optional:!0,self:!0}).flat()),{routes:u.map(rc),injector:h,factory:g}}function P_(r){return r&&typeof r=="object"&&"default"in r}function Bd(r){return P_(r)?r.default:r}async function Vd(r){return r}var oc=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(A_),providedIn:"root"})}return r})(),A_=(()=>{class r{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),zd=new yt("");var R_=()=>{},Ud=new yt(""),Gd=(()=>{class r{currentNavigation=wt(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=wt(null);events=new sn;transitionAbortWithErrorSubject=new sn;configLoader=G(Fd);environmentInjector=G(ln);destroyRef=G(Br);urlSerializer=G(Is);rootContexts=G(ao);location=G(Hi);inputBindingEnabled=G(Ls,{optional:!0})!==null;titleStrategy=G(Nd);options=G(Ns,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=G(oc);createViewTransition=G(zd,{optional:!0});navigationErrorHandler=G(Ud,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>mt(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=o=>this.events.next(new zl(o)),i=o=>this.events.next(new Ul(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let i=++this.navigationId;re(()=>{this.transitions?.next(Pt(j({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(e){return this.transitions=new Oe(null),this.transitions.pipe(an(i=>i!==null),ke(i=>{let o=!1,a=new AbortController,l=()=>!o&&this.currentTransition?.id===i.id;return mt(i).pipe(ke(h=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",pe.SupersededByNewNavigation),Ie;this.currentTransition=i;let u=this.lastSuccessfulNavigation();this.currentNavigation.set({id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,targetBrowserUrl:typeof h.extras.browserUrl=="string"?this.urlSerializer.parse(h.extras.browserUrl):h.extras.browserUrl,trigger:h.source,extras:h.extras,previousNavigation:u?Pt(j({},u),{previousNavigation:null}):null,abort:()=>a.abort()});let p=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),g=h.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!p&&g!=="reload")return this.events.next(new Wn(h.id,this.urlSerializer.serialize(h.rawUrl),"",Es.IgnoredSameUrlNavigation)),h.resolve(!1),Ie;if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return mt(h).pipe(ke(m=>(this.events.next(new tr(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),m.id!==this.navigationId?Ie:Promise.resolve(m))),C_(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy,a.signal),Cn(m=>{i.targetSnapshot=m.targetSnapshot,i.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation.update(y=>(y.finalUrl=m.urlAfterRedirects,y));let v=new no(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}));if(p&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:m,extractedUrl:v,source:y,restoredState:b,extras:E}=h,D=new tr(m,this.urlSerializer.serialize(v),y,b);this.events.next(D);let x=bd(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=Pt(j({},h),{targetSnapshot:x,urlAfterRedirects:v,extras:Pt(j({},E),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(A=>(A.finalUrl=v,A)),mt(i)}else return this.events.next(new Wn(h.id,this.urlSerializer.serialize(h.extractedUrl),"",Es.IgnoredByUrlHandlingStrategy)),h.resolve(!1),Ie}),Bt(h=>{let u=new Nl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);return this.events.next(u),this.currentTransition=i=Pt(j({},h),{guards:z0(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),i}),K0(h=>this.events.next(h)),ke(h=>{if(i.guardsResult=h.guardsResult,h.guardsResult&&typeof h.guardsResult!="boolean")throw Rs(this.urlSerializer,h.guardsResult);let u=new Fl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);if(this.events.next(u),!l())return Ie;if(!h.guardsResult)return this.cancelNavigationTransition(h,"",pe.GuardRejected),Ie;if(h.guards.canActivateChecks.length===0)return mt(h);let p=new Bl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);if(this.events.next(p),!l())return Ie;let g=!1;return mt(h).pipe(S_(this.paramsInheritanceStrategy),Cn({next:()=>{g=!0;let m=new Vl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)},complete:()=>{g||this.cancelNavigationTransition(h,"",pe.NoDataFromResolver)}}))}),rd(h=>{let u=g=>{let m=[];if(g.routeConfig?._loadedComponent)g.component=g.routeConfig?._loadedComponent;else if(g.routeConfig?.loadComponent){let v=g._environmentInjector;m.push(this.configLoader.loadComponent(v,g.routeConfig).then(y=>{g.component=y}))}for(let v of g.children)m.push(...u(v));return m},p=u(h.targetSnapshot.root);return p.length===0?mt(h):Le(Promise.all(p).then(()=>h))}),rd(()=>this.afterPreactivation()),ke(()=>{let{currentSnapshot:h,targetSnapshot:u}=i,p=this.createViewTransition?.(this.environmentInjector,h.root,u.root);return p?Le(p).pipe(Bt(()=>i)):mt(i)}),Ni(1),Bt(h=>{let u=N0(e.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);this.currentTransition=i=h=Pt(j({},h),{targetRouterState:u}),this.currentNavigation.update(p=>(p.targetRouterState=u,p)),this.events.next(new nr),l()&&(new Kl(e.routeReuseStrategy,i.targetRouterState,i.currentRouterState,p=>this.events.next(p),this.inputBindingEnabled).activate(this.rootContexts),l()&&(o=!0,this.currentNavigation.update(p=>(p.abort=R_,p)),this.lastSuccessfulNavigation.set(re(this.currentNavigation)),this.events.next(new $n(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)))}),Qo(Ad(a.signal).pipe(an(()=>!o&&!i.targetRouterState),Cn(()=>{this.cancelNavigationTransition(i,a.signal.reason+"",pe.Aborted)}))),Cn({complete:()=>{o=!0}}),Qo(this.transitionAbortWithErrorSubject.pipe(Cn(h=>{throw h}))),Jo(()=>{a.abort(),o||this.cancelNavigationTransition(i,"",pe.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),kr(h=>{if(o=!0,this.destroyed)return i.resolve(!1),Ie;if(Td(h))this.events.next(new Ye(i.id,this.urlSerializer.serialize(i.extractedUrl),h.message,h.cancellationCode)),V0(h)?this.events.next(new ir(h.url,h.navigationBehaviorOptions)):i.resolve(!1);else{let u=new er(i.id,this.urlSerializer.serialize(i.extractedUrl),h,i.targetSnapshot??void 0);try{let p=_e(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(p instanceof ro){let{message:g,cancellationCode:m}=Rs(this.urlSerializer,p);this.events.next(new Ye(i.id,this.urlSerializer.serialize(i.extractedUrl),g,m)),this.events.next(new ir(p.redirectTo,p.navigationBehaviorOptions))}else throw this.events.next(u),h}catch(p){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(p)}}return Ie}))}))}cancelNavigationTransition(e,i,o){let a=new Ye(e.id,this.urlSerializer.serialize(e.extractedUrl),i,o);this.events.next(a),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=re(this.currentNavigation),o=i?.targetBrowserUrl??i?.extractedUrl;return e.toString()!==o?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function O_(r){return r!==Qr}var jd=new yt("");var I_=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(L_),providedIn:"root"})}return r})(),nc=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}shouldDestroyInjector(t){return!0}},L_=(()=>{class r extends nc{static \u0275fac=(()=>{let e;return function(o){return(e||(e=zi(r)))(o||r)}})();static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),sc=(()=>{class r{urlSerializer=G(Is);options=G(Ns,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=G(Hi);urlHandlingStrategy=G(oc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new dn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:i,targetBrowserUrl:o}){let a=e!==void 0?this.urlHandlingStrategy.merge(e,i):i,l=o??a;return l instanceof dn?this.urlSerializer.serialize(l):l}commitTransition({targetRouterState:e,finalUrl:i,initialUrl:o}){i&&e?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,o),this.routerState=e):this.rawUrlTree=o}routerState=bd(null,G(ln));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:()=>G(k_),providedIn:"root"})}return r})(),k_=(()=>{class r extends sc{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{e(i.url,i.state,"popstate")})})}handleRouterEvent(e,i){e instanceof tr?this.updateStateMemento():e instanceof Wn?this.commitTransition(i):e instanceof no?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof nr?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof Ye&&!wd(e)?this.restoreHistory(i):e instanceof er?this.restoreHistory(i,!0):e instanceof $n&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:i,id:o}){let{replaceUrl:a,state:l}=i;if(this.location.isCurrentPathEqualTo(e)||a){let h=this.browserPageId,u=j(j({},l),this.generateNgRouterState(o,h));this.location.replaceState(e,"",u)}else{let h=j(j({},l),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(e,"",h)}}restoreHistory(e,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,a=this.currentPageId-o;a!==0?this.location.historyGo(a):this.getCurrentUrlTree()===e.finalUrl&&a===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(o){return(e||(e=zi(r)))(o||r)}})();static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Hd(r,t){r.events.pipe(an(e=>e instanceof $n||e instanceof Ye||e instanceof er||e instanceof Wn),Bt(e=>e instanceof $n||e instanceof Wn?0:(e instanceof Ye?e.code===pe.Redirect||e.code===pe.SupersededByNewNavigation:!1)?2:1),an(e=>e!==2),Ni(1)).subscribe(()=>{t()})}var $d={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wd={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ac=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=G(gu);stateManager=G(sc);options=G(Ns,{optional:!0})||{};pendingTasks=G(su);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=G(Gd);urlSerializer=G(Is);location=G(Hi);urlHandlingStrategy=G(oc);injector=G(ln);_events=new sn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=G(I_);injectorCleanup=G(jd,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=G(Fs,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!G(Ls,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Yh;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,a=re(this.navigationTransitions.currentNavigation);if(o!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Ye&&i.code!==pe.Redirect&&i.code!==pe.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof $n)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof ir){let l=i.navigationBehaviorOptions,h=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),u=j({scroll:o.extras.scroll,browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||O_(o.source)},l);this.scheduleNavigation(h,Qr,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}I0(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortWithErrorSubject.next(o)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qr,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,i,o)=>{this.navigateToSyncWithBrowser(e,o,i)})}navigateToSyncWithBrowser(e,i,o){let a={replaceUrl:!0},l=o?.navigationId?o:null;if(o){let u=j({},o);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(a.state=u)}let h=this.parseUrl(e);this.scheduleNavigation(h,i,l,a).catch(u=>{this.disposed||this.injector.get(rl)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return re(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(rc),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){let{relativeTo:o,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:u}=i,p=u?this.currentUrlTree.fragment:l,g=null;switch(h??this.options.defaultQueryParamsHandling){case"merge":g=j(j({},this.currentUrlTree.queryParams),a);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=a||null}g!==null&&(g=this.removeEmptyProps(g));let m;try{let v=o?o.snapshot:this.routerState.snapshot.root;m=md(v)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),m=this.currentUrlTree.root}return _d(m,e,g,p??null,this.urlSerializer)}navigateByUrl(e,i={skipLocationChange:!1}){let o=Qi(e)?e:this.parseUrl(e),a=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(a,Qr,null,i)}navigate(e,i={skipLocationChange:!1}){return N_(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.console.warn(nl(4018,!1)),this.urlSerializer.parse("/")}}isActive(e,i){let o;if(i===!0?o=j({},$d):i===!1?o=j({},Wd):o=i,Qi(e))return Xu(this.currentUrlTree,e,o);let a=this.parseUrl(e);return Xu(this.currentUrlTree,a,o)}removeEmptyProps(e){return Object.entries(e).reduce((i,[o,a])=>(a!=null&&(i[o]=a),i),{})}scheduleNavigation(e,i,o,a,l){if(this.disposed)return Promise.resolve(!1);let h,u,p;l?(h=l.resolve,u=l.reject,p=l.promise):p=new Promise((m,v)=>{h=m,u=v});let g=this.pendingTasks.add();return Hd(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:a,resolve:h,reject:u,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(m=>Promise.reject(m))}static \u0275fac=function(i){return new(i||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function N_(r){for(let t=0;t<r.length;t++)if(r[t]==null)throw new xt(4008,!1)}var F_=new yt("");function lc(r,...t){return Fi([{provide:Fs,multi:!0,useValue:r},[],{provide:vi,useFactory:B_},{provide:mu,multi:!0,useFactory:V_},t.map(e=>e.\u0275providers)])}function B_(){return G(ac).routerState.root}function V_(){let r=G(Bi);return t=>{let e=r.get(hl);if(t!==e.components[0])return;let i=r.get(ac),o=r.get(z_);r.get(U_)===1&&i.initialNavigation(),r.get(G_,null,{optional:!0})?.setUpPreloading(),r.get(F_,null,{optional:!0})?.init(),i.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var z_=new yt("",{factory:()=>new sn}),U_=new yt("",{factory:()=>1});var G_=new yt("");var H_="@",$_=(()=>{class r{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=G(Bi);loadingSchedulerFn=G(W_,{optional:!0});_engine;constructor(e,i,o,a,l){this.doc=e,this.delegate=i,this.zone=o,this.animationType=a,this.moduleImpl=l}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-4VA5DAP7.js").then(o=>o),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(e):i=e(),i.catch(o=>{throw new xt(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:a})=>{this._engine=o(this.animationType,this.doc);let l=new a(this.delegate,this._engine,this.zone);return this.delegate=l,l})}createRenderer(e,i){let o=this.delegate.createRenderer(e,i);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let a=new cc(o);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(l=>{let h=l.createRenderer(e,i);a.use(h),this.scheduler??=this.injector.get(au,null,{optional:!0}),this.scheduler?.notify(10)}).catch(l=>{a.use(o)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(i){fu()};static \u0275prov=nt({token:r,factory:r.\u0275fac})}return r})(),cc=class{delegate;replay=[];\u0275type=1;constructor(t){this.delegate=t}use(t){if(this.delegate=t,this.replay!==null){for(let e of this.replay)e(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,e){this.delegate.appendChild(t,e)}insertBefore(t,e,i,o){this.delegate.insertBefore(t,e,i,o)}removeChild(t,e,i,o){this.delegate.removeChild(t,e,i,o)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,o){this.delegate.setAttribute(t,e,i,o)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,o){this.delegate.setStyle(t,e,i,o)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){this.shouldReplay(e)&&this.replay.push(o=>o.setProperty(t,e,i)),this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i,o){return this.shouldReplay(e)&&this.replay.push(a=>a.listen(t,e,i,o)),this.delegate.listen(t,e,i,o)}shouldReplay(t){return this.replay!==null&&t.startsWith(H_)}},W_=new yt("");function Zd(r="animations"){return al("NgAsyncAnimations"),Fi([{provide:is,useFactory:()=>new $_(G(Xt),G(Zr),G(li),r)},{provide:uu,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var qd=[];var Yd={providers:[Su(),lc(qd),El(),Zd()]};var sr=class r{http=G(Hn);baseUrl="https://nominatim.openstreetmap.org/search";search(t){let e={q:t,format:"json",addressdetails:"1",limit:"5"};return this.http.get(this.baseUrl,{params:e})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})};var Zn=class r{http=G(Hn);themesPath="assets/themes/";availableThemes=["autumn","blueprint","contrast_zones","copper_patina","feature_based","forest","gradient_roads","japanese_ink","midnight_blue","monochrome_blue","neon_cyberpunk","noir","ocean","pastel_dream","sunset","terracotta","warm_beige"];getAvailableThemes(){return this.availableThemes}loadTheme(t){return this.http.get(`${this.themesPath}${t}.json`)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})};var Bs=class r{http=G(Hn);baseUrl="https://overpass.kumi.systems/api/interpreter";getBbox(t,e,i,o){let l=o/6378137*(180/Math.PI),h=i/6378137*(180/Math.PI)/Math.cos(t*Math.PI/180),u=t-l,p=t+l,g=e-h,m=e+h;return`${u},${g},${p},${m}`}fetchRoads(t,e=!1){let o=`
      [out:json][timeout:180];
      (
        ${(e?'way["highway"]["highway"!~"footway|path|cycleway|steps|pedestrian|track|service"](${bbox});':'way["highway"](${bbox});').replace("${bbox}",t)}
      );
      out body;
      >;
      out skel qt;
    `;return this.http.post(this.baseUrl,`data=${encodeURIComponent(o)}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}fetchWater(t){let e=`
      [out:json][timeout:180];
      (
        way["natural"="water"](${t});
        relation["natural"="water"](${t});
        way["waterway"](${t});
      );
      out body;
      >;
      out skel qt;
    `;return this.http.post(this.baseUrl,`data=${encodeURIComponent(e)}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}fetchParks(t){let e=`
      [out:json][timeout:180];
      (
        way["leisure"="park"](${t});
        relation["leisure"="park"](${t});
        way["landuse"="grass"](${t});
        relation["landuse"="grass"](${t});
      );
      out body;
      >;
      out skel qt;
    `;return this.http.post(this.baseUrl,`data=${encodeURIComponent(e)}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})};var ar=gm(Kd());var Z_=["map"],zs=class r{lat=Lt(48.8566);lon=Lt(2.3522);distance=Lt(1e4);mapContainer;map;rectangle;platformId=G(Ui);constructor(){Bn(()=>{let t=this.lat(),e=this.lon(),i=this.distance();pl(this.platformId)&&this.map&&this.updateMap(t,e,i)})}ngAfterViewInit(){pl(this.platformId)&&this.initMap()}ngOnDestroy(){this.map&&this.map.remove()}initMap(){this.map=ar.map(this.mapContainer.nativeElement).setView([this.lat(),this.lon()],12),ar.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.updateMap(this.lat(),this.lon(),this.distance())}updateMap(t,e,i){if(!this.map)return;this.map.setView([t,e]),this.rectangle&&this.map.removeLayer(this.rectangle);let o=this.getBounds(t,e,i);this.rectangle=ar.rectangle(o,{color:"#ff7800",weight:1}).addTo(this.map),this.map.fitBounds(o)}getBounds(t,e,i){let o=i*1.3333333333333333,a=6378137,l=i/a*(180/Math.PI)/Math.cos(t*Math.PI/180),h=o/a*(180/Math.PI);return[[t-h,e-l],[t+h,e+l]]}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-map-preview"]],viewQuery:function(e,i){if(e&1&&Gi(Z_,5),e&2){let o;hi(o=ui())&&(i.mapContainer=o.first)}},inputs:{lat:[1,"lat"],lon:[1,"lon"],distance:[1,"distance"]},decls:2,vars:0,consts:[["map",""],[1,"map-container"]],template:function(e,i){e&1&&We(0,"div",1,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.map-container[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0})};var q_=Math.PI/180;function Y_(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}var Yn=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},V={_global:Yn,version:"10.2.0",isBrowser:Y_(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return V.angleDeg?r*q_:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return V.DD.isDragging},isTransforming(){var r,t;return(t=(r=V.Transformer)===null||r===void 0?void 0:r.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!V.DD.node},releaseCanvasOnDestroy:!0,document:Yn.document,_injectGlobal(r){typeof Yn.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Yn.Konva=r}},lt=r=>{V[r.prototype.getClassName()]=r};V._injectGlobal(V);var X_=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Jd=()=>{if(typeof document>"u")throw new Error(X_)},se=class r{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){let e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){let e=Math.cos(t),i=Math.sin(t),o=this.m[0]*e+this.m[2]*i,a=this.m[1]*e+this.m[3]*i,l=this.m[0]*-i+this.m[2]*e,h=this.m[1]*-i+this.m[3]*e;return this.m[0]=o,this.m[1]=a,this.m[2]=l,this.m[3]=h,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){let i=this.m[0]+this.m[2]*e,o=this.m[1]+this.m[3]*e,a=this.m[2]+this.m[0]*t,l=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=o,this.m[2]=a,this.m[3]=l,this}multiply(t){let e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],o=this.m[0]*t.m[2]+this.m[2]*t.m[3],a=this.m[1]*t.m[2]+this.m[3]*t.m[3],l=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],h=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=o,this.m[3]=a,this.m[4]=l,this.m[5]=h,this}invert(){let t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,o=-this.m[2]*t,a=this.m[0]*t,l=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),h=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=o,this.m[3]=a,this.m[4]=l,this.m[5]=h,this}getMatrix(){return this.m}decompose(){let t=this.m[0],e=this.m[1],i=this.m[2],o=this.m[3],a=this.m[4],l=this.m[5],h=t*o-e*i,u={x:a,y:l,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){let p=Math.sqrt(t*t+e*e);u.rotation=e>0?Math.acos(t/p):-Math.acos(t/p),u.scaleX=p,u.scaleY=h/p,u.skewX=(t*i+e*o)/h,u.skewY=0}else if(i!=0||o!=0){let p=Math.sqrt(i*i+o*o);u.rotation=Math.PI/2-(o>0?Math.acos(-i/p):-Math.acos(i/p)),u.scaleX=h/p,u.scaleY=p,u.skewX=0,u.skewY=(t*i+e*o)/h}return u.rotation=S._getRotation(u.rotation),u}},K_="[object Array]",J_="[object Number]",Q_="[object String]",tv="[object Boolean]",ev=Math.PI/180,nv=180/Math.PI,co="#",iv="",rv="0",ov="Konva warning: ",Qd="Konva error: ",sv="rgb(",hc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},av=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Us=[],ho=null,lv=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(r){setTimeout(r,16)},S={_isElement(r){return!!(r&&r.nodeType==1)},_isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)},_isPlainObject(r){return!!r&&r.constructor===Object},_isArray(r){return Object.prototype.toString.call(r)===K_},_isNumber(r){return Object.prototype.toString.call(r)===J_&&!isNaN(r)&&isFinite(r)},_isString(r){return Object.prototype.toString.call(r)===Q_},_isBoolean(r){return Object.prototype.toString.call(r)===tv},isObject(r){return r instanceof Object},isValidSelector(r){if(typeof r!="string")return!1;let t=r[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(r){return r===0||r>0?1:-1},requestAnimFrame(r){Us.push(r),Us.length===1&&lv(function(){let t=Us;Us=[],t.forEach(function(e){e()})})},createCanvasElement(){Jd();let r=document.createElement("canvas");try{r.style=r.style||{}}catch{}return r},createImageElement(){return Jd(),document.createElement("img")},_isInDocument(r){for(;r=r.parentNode;)if(r==document)return!0;return!1},_urlToImage(r,t){let e=S.createImageElement();e.onload=function(){t(e)},e.src=r},_rgbToHex(r,t,e){return((1<<24)+(r<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(r){r=r.replace(co,iv);let t=parseInt(r,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let r=(Math.random()*16777215<<0).toString(16);for(;r.length<6;)r=rv+r;return co+r},isCanvasFarblingActive(){if(ho!==null)return ho;if(typeof document>"u")return ho=!1,!1;let r=this.createCanvasElement();r.width=10,r.height=10;let t=r.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,10,10),t.fillStyle="#282828",t.fillRect(0,0,10,10);let e=t.getImageData(0,0,10,10).data,i=!1;for(let o=0;o<100;o++)if(e[o*4]!==40||e[o*4+1]!==40||e[o*4+2]!==40||e[o*4+3]!==255){i=!0;break}return ho=i,this.releaseCanvas(r),ho},getHitColor(){let r=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(r):r},getHitColorKey(r,t,e){return this.isCanvasFarblingActive()&&(r=Math.round(r/5)*5,t=Math.round(t/5)*5,e=Math.round(e/5)*5),co+this._rgbToHex(r,t,e)},getSnappedHexColor(r){let t=this._hexToRgb(r);return co+this._rgbToHex(Math.round(t.r/5)*5,Math.round(t.g/5)*5,Math.round(t.b/5)*5)},getRGB(r){let t;return r in hc?(t=hc[r],{r:t[0],g:t[1],b:t[2]}):r[0]===co?this._hexToRgb(r.substring(1)):r.substr(0,4)===sv?(t=av.exec(r.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(r){return r=r||"black",S._namedColorToRBA(r)||S._hex3ColorToRGBA(r)||S._hex4ColorToRGBA(r)||S._hex6ColorToRGBA(r)||S._hex8ColorToRGBA(r)||S._rgbColorToRGBA(r)||S._rgbaColorToRGBA(r)||S._hslColorToRGBA(r)},_namedColorToRBA(r){let t=hc[r.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(r){if(r.indexOf("rgb(")===0){r=r.match(/rgb\(([^)]+)\)/)[1];let t=r.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(r){if(r.indexOf("rgba(")===0){r=r.match(/rgba\(([^)]+)\)/)[1];let t=r.split(/ *, */).map((e,i)=>e.slice(-1)==="%"?i===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(r){if(r[0]==="#"&&r.length===9)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:parseInt(r.slice(7,9),16)/255}},_hex6ColorToRGBA(r){if(r[0]==="#"&&r.length===7)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:1}},_hex4ColorToRGBA(r){if(r[0]==="#"&&r.length===5)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:parseInt(r[4]+r[4],16)/255}},_hex3ColorToRGBA(r){if(r[0]==="#"&&r.length===4)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:1}},_hslColorToRGBA(r){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(r)){let[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(r),i=Number(e[0])/360,o=Number(e[1])/100,a=Number(e[2])/100,l,h,u;if(o===0)return u=a*255,{r:Math.round(u),g:Math.round(u),b:Math.round(u),a:1};a<.5?l=a*(1+o):l=a+o-a*o;let p=2*a-l,g=[0,0,0];for(let m=0;m<3;m++)h=i+1/3*-(m-1),h<0&&h++,h>1&&h--,6*h<1?u=p+(l-p)*6*h:2*h<1?u=l:3*h<2?u=p+(l-p)*(2/3-h)*6:u=p,g[m]=u*255;return{r:Math.round(g[0]),g:Math.round(g[1]),b:Math.round(g[2]),a:1}}},haveIntersection(r,t){return!(t.x>r.x+r.width||t.x+t.width<r.x||t.y>r.y+r.height||t.y+t.height<r.y)},cloneObject(r){let t={};for(let e in r)this._isPlainObject(r[e])?t[e]=this.cloneObject(r[e]):this._isArray(r[e])?t[e]=this.cloneArray(r[e]):t[e]=r[e];return t},cloneArray(r){return r.slice(0)},degToRad(r){return r*ev},radToDeg(r){return r*nv},_degToRad(r){return S.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),S.degToRad(r)},_radToDeg(r){return S.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),S.radToDeg(r)},_getRotation(r){return V.angleDeg?S.radToDeg(r):r},_capitalize(r){return r.charAt(0).toUpperCase()+r.slice(1)},throw(r){throw new Error(Qd+r)},error(r){console.error(Qd+r)},warn(r){V.showWarnings&&console.warn(ov+r)},each(r,t){for(let e in r)t(e,r[e])},_inRange(r,t,e){return t<=r&&r<e},_getProjectionToSegment(r,t,e,i,o,a){let l,h,u,p=(r-e)*(r-e)+(t-i)*(t-i);if(p==0)l=r,h=t,u=(o-e)*(o-e)+(a-i)*(a-i);else{let g=((o-r)*(e-r)+(a-t)*(i-t))/p;g<0?(l=r,h=t,u=(r-o)*(r-o)+(t-a)*(t-a)):g>1?(l=e,h=i,u=(e-o)*(e-o)+(i-a)*(i-a)):(l=r+g*(e-r),h=t+g*(i-t),u=(l-o)*(l-o)+(h-a)*(h-a))}return[l,h,u]},_getProjectionToLine(r,t,e){let i=S.cloneObject(r),o=Number.MAX_VALUE;return t.forEach(function(a,l){if(!e&&l===t.length-1)return;let h=t[(l+1)%t.length],u=S._getProjectionToSegment(a.x,a.y,h.x,h.y,r.x,r.y),p=u[0],g=u[1],m=u[2];m<o&&(i.x=p,i.y=g,o=m)}),i},_prepareArrayForTween(r,t,e){let i=[],o=[];if(r.length>t.length){let l=t;t=r,r=l}for(let l=0;l<r.length;l+=2)i.push({x:r[l],y:r[l+1]});for(let l=0;l<t.length;l+=2)o.push({x:t[l],y:t[l+1]});let a=[];return o.forEach(function(l){let h=S._getProjectionToLine(l,i,e);a.push(h.x),a.push(h.y)}),a},_prepareToStringify(r){let t;r.visitedByCircularReferenceRemoval=!0;for(let e in r)if(r.hasOwnProperty(e)&&r[e]&&typeof r[e]=="object"){if(t=Object.getOwnPropertyDescriptor(r,e),r[e].visitedByCircularReferenceRemoval||S._isElement(r[e]))if(t.configurable)delete r[e];else return null;else if(S._prepareToStringify(r[e])===null)if(t.configurable)delete r[e];else return null}return delete r.visitedByCircularReferenceRemoval,r},_assign(r,t){for(let e in t)r[e]=t[e];return r},_getFirstPointerId(r){return r.touches?r.changedTouches[0].identifier:r.pointerId||999},releaseCanvas(...r){V.releaseCanvasOnDestroy&&r.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(r,t,e,i){let o=t<0?t:0,a=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let l=0,h=0,u=0,p=0;typeof i=="number"?l=h=u=p=Math.min(i,t/2,e/2):(l=Math.min(i[0]||0,t/2,e/2),h=Math.min(i[1]||0,t/2,e/2),p=Math.min(i[2]||0,t/2,e/2),u=Math.min(i[3]||0,t/2,e/2)),r.moveTo(o+l,a),r.lineTo(o+t-h,a),r.arc(o+t-h,a+h,h,Math.PI*3/2,0,!1),r.lineTo(o+t,a+e-p),r.arc(o+t-p,a+e-p,p,0,Math.PI/2,!1),r.lineTo(o+u,a+e),r.arc(o+u,a+e-u,u,Math.PI/2,Math.PI,!1),r.lineTo(o,a+l),r.arc(o+l,a+l,l,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(r,t,e,i,o){i=Math.abs(i);for(let a=0;a<e;a++){let l=t[(a-1+e)%e],h=t[a],u=t[(a+1)%e],p={x:h.x-l.x,y:h.y-l.y},g={x:u.x-h.x,y:u.y-h.y},m=Math.hypot(p.x,p.y),v=Math.hypot(g.x,g.y),y;typeof o=="number"?y=o:y=a<o.length?o[a]:0,y=i*Math.cos(Math.PI/e)*Math.min(1,y/i*2);let E={x:p.x/m,y:p.y/m},D={x:g.x/v,y:g.y/v},x={x:h.x-E.x*y,y:h.y-E.y*y},A={x:h.x+D.x*y,y:h.y+D.y*y};a===0?r.moveTo(x.x,x.y):r.lineTo(x.x,x.y),r.arcTo(h.x,h.y,A.x,A.y,y)}}};function cv(r){let t=[],e=r.length,i=S;for(let o=0;o<e;o++){let a=r[o];i._isNumber(a)?a=Math.round(a*1e3)/1e3:i._isString(a)||(a=a+""),t.push(a)}return t}var tf=",",hv="(",uv=")",dv="([",fv="])",pv=";",gv="()",mv="=",ef=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],_v=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],vv=100,Gs=null;function uc(){if(Gs!==null)return Gs;try{let t=S.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Gs=!1,!1)}catch{return Gs=!1,!1}}var wi=class{constructor(t){this.canvas=t,V.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let i=this.traceArr,o=i.length,a="",l,h,u,p;for(l=0;l<o;l++)h=i[l],u=h.method,u?(p=h.args,a+=u,t?a+=gv:S._isArray(p[0])?a+=dv+p.join(tf)+fv:(e&&(p=p.map(g=>typeof g=="number"?Math.floor(g):g)),a+=hv+p.join(tf)+uv)):(a+=h.property,t||(a+=mv+h.val)),a+=pv;return a}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,i;e.push(t),i=e.length,i>=vv&&e.shift()}reset(){let t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){let e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){let e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){let e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){let e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){let e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,o,a,l){this._context.arc(t,e,i,o,a,l)}arcTo(t,e,i,o,a){this._context.arcTo(t,e,i,o,a)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,o,a,l){this._context.bezierCurveTo(t,e,i,o,a,l)}clearRect(t,e,i,o){this._context.clearRect(t,e,i,o)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){let i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,o){return this._context.createLinearGradient(t,e,i,o)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,o,a,l){return this._context.createRadialGradient(t,e,i,o,a,l)}drawImage(t,e,i,o,a,l,h,u,p){let g=arguments,m=this._context;g.length===3?m.drawImage(t,e,i):g.length===5?m.drawImage(t,e,i,o,a):g.length===9&&m.drawImage(t,e,i,o,a,l,h,u,p)}ellipse(t,e,i,o,a,l,h,u){this._context.ellipse(t,e,i,o,a,l,h,u)}isPointInPath(t,e,i,o){return i?this._context.isPointInPath(i,t,e,o):this._context.isPointInPath(t,e,o)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,o){this._context.fillRect(t,e,i,o)}strokeRect(t,e,i,o){this._context.strokeRect(t,e,i,o)}fillText(t,e,i,o){o?this._context.fillText(t,e,i,o):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,o){return this._context.getImageData(t,e,i,o)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,o){this._context.rect(t,e,i,o)}roundRect(t,e,i,o,a){this._context.roundRect(t,e,i,o,a)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,o){this._context.quadraticCurveTo(t,e,i,o)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,o,a,l){this._context.setTransform(t,e,i,o,a,l)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,o){this._context.strokeText(t,e,i,o)}transform(t,e,i,o,a,l){this._context.transform(t,e,i,o,a,l)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=ef.length,i=this.setAttr,o,a,l=function(h){let u=t[h],p;t[h]=function(){return a=cv(Array.prototype.slice.call(arguments,0)),p=u.apply(t,arguments),t._trace({method:h,args:a}),p}};for(o=0;o<e;o++)l(ef[o]);t.setAttr=function(){i.apply(t,arguments);let h=arguments[0],u=arguments[1];(h==="shadowOffsetX"||h==="shadowOffsetY"||h==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),t._trace({property:h,val:u})}}_applyGlobalCompositeOperation(t){let e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}};_v.forEach(function(r){Object.defineProperty(wi.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});var js=class extends wi{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){let e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){let e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){let e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){let e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}let o=t.getFillPatternImage();if(o&&i==="pattern"){this._fillPattern(t);return}let a=t.getFillLinearGradientColorStops();if(a&&i==="linear-gradient"){this._fillLinearGradient(t);return}let l=t.getFillRadialGradientColorStops();if(l&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):o?this._fillPattern(t):a?this._fillLinearGradient(t):l&&this._fillRadialGradient(t)}_strokeLinearGradient(t){let e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),o=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(e.x,e.y,i.x,i.y);if(o){for(let l=0;l<o.length;l+=2)a.addColorStop(o[l],o[l+1]);this.setAttr("strokeStyle",a)}}_stroke(t){let e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();let a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,o;let a=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",l=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,h=(o=t.getShadowOffset())!==null&&o!==void 0?o:{x:0,y:0},u=t.getAbsoluteScale(),p=this.canvas.getPixelRatio(),g=u.x*p,m=u.y*p;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",l*Math.min(Math.abs(g),Math.abs(m))),this.setAttr("shadowOffsetX",h.x*g),this.setAttr("shadowOffsetY",h.y*m)}},Hs=class extends wi{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){let e=t.getStrokeScaleEnabled();if(!e){this.save();let a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(t);let i=t.hitStrokeWidth(),o=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",o),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}};var $s;function yv(){if($s)return $s;let r=S.createCanvasElement(),t=r.getContext("2d");return $s=(function(){let e=V._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i})(),S.releaseCanvas(r),$s}var lr=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let i=(t||{}).pixelRatio||V.pixelRatio||yv();this.pixelRatio=i,this._canvas=S.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){let e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";let e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(o){return S.error("Unable to get data URL. "+o.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}},xe=class extends lr{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new js(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}},Xn=class extends lr{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Hs(this),this.setSize(t.width,t.height)}};var St={get isDragging(){let r=!1;return St._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return St._dragElements.forEach(t=>{r=t.node}),r},_dragElements:new Map,_drag(r){let t=[];St._dragElements.forEach((e,i)=>{let{node:o}=e,a=o.getStage();a.setPointersPositions(r),e.pointerId===void 0&&(e.pointerId=S._getFirstPointerId(r));let l=a._changedPointerPositions.find(h=>h.id===e.pointerId);if(l){if(e.dragStatus!=="dragging"){let h=o.dragDistance();if(Math.max(Math.abs(l.x-e.startPointerPos.x),Math.abs(l.y-e.startPointerPos.y))<h||(o.startDrag({evt:r}),!o.isDragging()))return}o._setDragPosition(r,e),t.push(o)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:r},!0)})},_endDragBefore(r){let t=[];St._dragElements.forEach(e=>{let{node:i}=e,o=i.getStage();if(r&&o.setPointersPositions(r),!o._changedPointerPositions.find(h=>h.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(St.justDragged=!0,V._mouseListenClick=!1,V._touchListenClick=!1,V._pointerListenClick=!1,e.dragStatus="stopped");let l=e.node.getLayer()||e.node instanceof V.Stage&&e.node;l&&t.indexOf(l)===-1&&t.push(l)}),t.forEach(e=>{e.draw()})},_endDragAfter(r){St._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:r},!0),t.dragStatus!=="dragging"&&St._dragElements.delete(e)})}};V.isBrowser&&(window.addEventListener("mouseup",St._endDragBefore,!0),window.addEventListener("touchend",St._endDragBefore,!0),window.addEventListener("touchcancel",St._endDragBefore,!0),window.addEventListener("mousemove",St._drag),window.addEventListener("touchmove",St._drag),window.addEventListener("mouseup",St._endDragAfter,!1),window.addEventListener("touchend",St._endDragAfter,!1),window.addEventListener("touchcancel",St._endDragAfter,!1));function Kn(r){return S._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||S._isBoolean(r)?r:Object.prototype.toString.call(r)}function Ws(r){return r>255?255:r<0?0:Math.round(r)}function O(){if(V.isUnminified)return function(r,t){return S._isNumber(r)||S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}function Jn(r){if(V.isUnminified)return function(t,e){let i=S._isNumber(t),o=S._isArray(t)&&t.length==r;return!i&&!o&&S.warn(Kn(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+r+")"),t}}function uo(){if(V.isUnminified)return function(r,t){return S._isNumber(r)||r==="auto"||S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}function fn(){if(V.isUnminified)return function(r,t){return S._isString(r)||S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}function dc(){if(V.isUnminified)return function(r,t){let e=S._isString(r),i=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return e||i||S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}function nf(){if(V.isUnminified)return function(r,t){let e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&r instanceof e||(S._isArray(r)?r.forEach(function(i){S._isNumber(i)||S.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}function ae(){if(V.isUnminified)return function(r,t){return r===!0||r===!1||S.warn(Kn(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}function rf(r){if(V.isUnminified)return function(t,e){return t==null||S.isObject(t)||S.warn(Kn(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+r),t}}var fo="get",po="set",w={addGetterSetter(r,t,e,i,o){w.addGetter(r,t,e),w.addSetter(r,t,i,o),w.addOverloadedGetterSetter(r,t)},addGetter(r,t,e){let i=fo+S._capitalize(t);r.prototype[i]=r.prototype[i]||function(){let o=this.attrs[t];return o===void 0?e:o}},addSetter(r,t,e,i){let o=po+S._capitalize(t);r.prototype[o]||w.overWriteSetter(r,t,e,i)},overWriteSetter(r,t,e,i){let o=po+S._capitalize(t);r.prototype[o]=function(a){return e&&a!==void 0&&a!==null&&(a=e.call(this,a,t)),this._setAttr(t,a),i&&i.call(this),this}},addComponentsGetterSetter(r,t,e,i,o){let a=e.length,l=S._capitalize,h=fo+l(t),u=po+l(t);r.prototype[h]=function(){let g={};for(let m=0;m<a;m++){let v=e[m];g[v]=this.getAttr(t+l(v))}return g};let p=rf(e);r.prototype[u]=function(g){let m=this.attrs[t];i&&(g=i.call(this,g,t)),p&&p.call(this,g,t);for(let v in g)g.hasOwnProperty(v)&&this._setAttr(t+l(v),g[v]);return g||e.forEach(v=>{this._setAttr(t+l(v),void 0)}),this._fireChangeEvent(t,m,g),o&&o.call(this),this},w.addOverloadedGetterSetter(r,t)},addOverloadedGetterSetter(r,t){let e=S._capitalize(t),i=po+e,o=fo+e;r.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter(r,t,e,i){S.error("Adding deprecated "+t);let o=fo+S._capitalize(t),a=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[o]=function(){S.error(a);let l=this.attrs[t];return l===void 0?e:l},w.addSetter(r,t,i,function(){S.error(a)}),w.addOverloadedGetterSetter(r,t)},backCompat(r,t){S.each(t,function(e,i){let o=r.prototype[i],a=fo+S._capitalize(e),l=po+S._capitalize(e);function h(){o.apply(this,arguments),S.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}r.prototype[e]=h,r.prototype[a]=h,r.prototype[l]=h})},afterSetFilter(){this._filterUpToDate=!1}};function wv(r){let t=/(\w+)\(([^)]+)\)/g,e;for(;(e=t.exec(r))!==null;){let[,i,o]=e;switch(i){case"blur":{let a=parseFloat(o.replace("px",""));return function(l){this.blurRadius(a*.5);let h=V.Filters;h&&h.Blur&&h.Blur.call(this,l)}}case"brightness":{let a=o.includes("%")?parseFloat(o)/100:parseFloat(o);return function(l){this.brightness(a);let h=V.Filters;h&&h.Brightness&&h.Brightness.call(this,l)}}case"contrast":{let a=parseFloat(o);return function(l){let h=100*(Math.sqrt(a)-1);this.contrast(h);let u=V.Filters;u&&u.Contrast&&u.Contrast.call(this,l)}}case"grayscale":return function(a){let l=V.Filters;l&&l.Grayscale&&l.Grayscale.call(this,a)};case"sepia":return function(a){let l=V.Filters;l&&l.Sepia&&l.Sepia.call(this,a)};case"invert":return function(a){let l=V.Filters;l&&l.Invert&&l.Invert.call(this,a)};default:S.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}var Zs="absoluteOpacity",of="allEventListeners",Tn="absoluteTransform",sf="absoluteScale",bi="canvas",bv="Change",Cv="children",Sv="konva",fc="listening",Dv="mouseenter",xv="mouseleave",Ev="pointerenter",Mv="pointerleave",Tv="touchenter",Pv="touchleave";var af="set",lf="Shape",qs=" ",cf="stage",Qn="transform",Av="Stage",pc="visible",Rv=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(qs),Ov=1,N=class r{constructor(t){this._id=Ov++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===Qn||t===Tn)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let i=this._cache.get(t);return(i===void 0||(t===Qn||t===Tn)&&i.dirty===!0)&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){let o=e.map(a=>a+"Change.konva").join(qs);this.on(o,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(bi)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Tn&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(bi)){let{scene:t,filter:e,hit:i}=this._cache.get(bi);S.releaseCanvas(t._canvas,e._canvas,i._canvas),this._cache.delete(bi)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){let e=t||{},i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let o=Math.ceil(e.width||i.width),a=Math.ceil(e.height||i.height),l=e.pixelRatio,h=e.x===void 0?Math.floor(i.x):e.x,u=e.y===void 0?Math.floor(i.y):e.y,p=e.offset||0,g=e.drawBorder||!1,m=e.hitCanvasPixelRatio||1;if(!o||!a){S.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let v=Math.abs(Math.round(i.x)-h)>.5?1:0,y=Math.abs(Math.round(i.y)-u)>.5?1:0;o+=p*2+v,a+=p*2+y,h-=p,u-=p;let b=new xe({pixelRatio:l,width:o,height:a}),E=new xe({pixelRatio:l,width:0,height:0,willReadFrequently:!0}),D=new Xn({pixelRatio:m,width:o,height:a}),x=b.getContext(),A=D.getContext(),T=new xe({width:b.width/b.pixelRatio+Math.abs(h),height:b.height/b.pixelRatio+Math.abs(u),pixelRatio:b.pixelRatio}),R=T.getContext();return D.isCache=!0,b.isCache=!0,this._cache.delete(bi),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(b.getContext()._context.imageSmoothingEnabled=!1,E.getContext()._context.imageSmoothingEnabled=!1),x.save(),A.save(),R.save(),x.translate(-h,-u),A.translate(-h,-u),R.translate(-h,-u),T.x=h,T.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Zs),this._clearSelfAndDescendantCache(sf),this.drawScene(b,this,T),this.drawHit(D,this),this._isUnderCache=!1,x.restore(),A.restore(),g&&(x.save(),x.beginPath(),x.rect(0,0,o,a),x.closePath(),x.setAttr("strokeStyle","red"),x.setAttr("lineWidth",5),x.stroke(),x.restore()),S.releaseCanvas(T._canvas),this._cache.set(bi,{scene:b,filter:E,hit:D,x:h,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(bi)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){let i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],o=1/0,a=1/0,l=-1/0,h=-1/0,u=this.getAbsoluteTransform(e);return i.forEach(function(p){let g=u.point(p);o===void 0&&(o=l=g.x,a=h=g.y),o=Math.min(o,g.x),a=Math.min(a,g.y),l=Math.max(l,g.x),h=Math.max(h,g.y)}),{x:o,y:a,width:l-o,height:h-a}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);let e=this._getCanvasCache();t.translate(e.x,e.y);let i=this._getCachedSceneCanvas(),o=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/o,i.height/o),t.restore()}_drawCachedHitCanvas(t){let e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),i=e.scene,o=e.filter,a=o.getContext(),l,h,u,p;if(!t||t.length===0)return i;if(this._filterUpToDate)return o;let g=!0;for(let v=0;v<t.length;v++){let y=typeof t[v]=="string"&&!uc();if(typeof t[v]!="string"||!uc()){g=!1;break}}let m=i.pixelRatio;if(o.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),g){let v=t.join(" ");return a.save(),a.setAttr("filter",v),a.drawImage(i._canvas,0,0,i.getWidth()/m,i.getHeight()/m),a.restore(),this._filterUpToDate=!0,o}try{for(l=t.length,a.clear(),a.drawImage(i._canvas,0,0,i.getWidth()/m,i.getHeight()/m),h=a.getImageData(0,0,o.getWidth(),o.getHeight()),u=0;u<l;u++)p=t[u],typeof p=="string"&&(p=wv(p)),p.call(this,h),a.putImageData(h,0,0)}catch(v){S.error("Unable to apply filter. "+v.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,o}on(t,e){if(this._cache&&this._cache.delete(of),arguments.length===3)return this._delegate.apply(this,arguments);let i=t.split(qs);for(let o=0;o<i.length;o++){let l=i[o].split("."),h=l[0],u=l[1]||"";this.eventListeners[h]||(this.eventListeners[h]=[]),this.eventListeners[h].push({name:u,handler:e})}return this}off(t,e){let i=(t||"").split(qs),o=i.length,a,l,h,u,p,g;if(this._cache&&this._cache.delete(of),!t)for(l in this.eventListeners)this._off(l);for(a=0;a<o;a++)if(h=i[a],u=h.split("."),p=u[0],g=u[1],p)this.eventListeners[p]&&this._off(p,g,e);else for(l in this.eventListeners)this._off(l,g,e);return this}dispatchEvent(t){let e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){let o=this;this.on(t,function(a){let l=a.target.findAncestors(e,!0,o);for(let h=0;h<l.length;h++)a=S.cloneObject(a),a.currentTarget=l[h],i.call(l[h],a)})}remove(){return this.isDragging()&&this.stopDrag(),St._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Tn),this._clearSelfAndDescendantCache(Zs),this._clearSelfAndDescendantCache(sf),this._clearSelfAndDescendantCache(cf),this._clearSelfAndDescendantCache(pc),this._clearSelfAndDescendantCache(fc)}_remove(){this._clearCaches();let t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){let e="get"+S._capitalize(t);return S._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,i;if(!t)return this;for(e in t)e!==Cv&&(i=af+S._capitalize(e),S._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(fc,this._isListening)}_isListening(t){if(!this.listening())return!1;let i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(pc,this._isVisible)}_isVisible(t){if(!this.visible())return!1;let i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);let i=this.getLayer(),o=!1;St._dragElements.forEach(l=>{l.dragStatus==="dragging"&&(l.node.nodeType==="Stage"||l.node.getLayer()===i)&&(o=!0)});let a=!e&&!V.hitOnDragEnabled&&(o||V.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,i=0,o,a,l,h;function u(g){for(o=[],a=g.length,l=0;l<a;l++)h=g[l],i++,h.nodeType!==lf&&(o=o.concat(h.getChildren().slice())),h._id===e._id&&(l=a);o.length>0&&o[0].getDepth()<=t&&u(o)}let p=this.getStage();return e.nodeType!==Av&&p&&u(p.getChildren()),i}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Qn),this._clearSelfAndDescendantCache(Tn)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let t=this.getStage();if(!t)return null;let e=t.getPointerPosition();if(!e)return null;let i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);let o=this.getAbsoluteTransform(t).getMatrix(),a=new se,l=this.offset();return a.m=o.slice(),a.translate(l.x,l.y),a.getTranslation()}setAbsolutePosition(t){let l=this._clearTransform(),{x:e,y:i}=l,o=Qa(l,["x","y"]);this.attrs.x=e,this.attrs.y=i,this._clearCache(Qn);let a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(t.x,t.y),t={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(o),this.setPosition({x:t.x,y:t.y}),this._clearCache(Qn),this._clearSelfAndDescendantCache(Tn),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){let t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,i=t.y,o=this.x(),a=this.y();return e!==void 0&&(o+=e),i!==void 0&&(a+=i),this.setPosition({x:o,y:a}),this}_eachAncestorReverse(t,e){let i=[],o=this.getParent(),a,l;if(!(e&&e._id===this._id)){for(i.unshift(this);o&&(!e||o._id!==e._id);)i.unshift(o),o=o.parent;for(a=i.length,l=0;l<a;l++)t(i[l])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return S.warn("Node has no parent. moveToTop function is ignored."),!1;let t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return S.warn("Node has no parent. moveUp function is ignored."),!1;let t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return S.warn("Node has no parent. moveDown function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return S.warn("Node has no parent. moveToBottom function is ignored."),!1;let t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return S.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&S.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Zs,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,i,o,a,l,h={attrs:{},className:this.getClassName()};for(e in t)i=t[e],l=S.isObject(i)&&!S._isPlainObject(i)&&!S._isArray(i),!l&&(o=typeof this[e]=="function"&&this[e],delete t[e],a=o?o.call(this):null,t[e]=i,a!==i&&(h.attrs[e]=i));return S._prepareToStringify(h)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){let o=[];e&&this._isMatch(t)&&o.push(this);let a=this.parent;for(;a;){if(a===i)return o;a._isMatch(t)&&o.push(a),a=a.parent}return o}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),i=e.length,o,a;for(o=0;o<i;o++)if(a=e[o],S.isValidSelector(a)||(S.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),S.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),S.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){let t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(cf,this._getStage)}_getStage(){let t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Tn,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new se,this._eachAncestorReverse(function(i){let o=i.transformsEnabled();o==="all"?e.multiply(i.getTransform()):o==="position"&&e.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),e;{e=this._cache.get(Tn)||new se,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();let i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){let o=this.attrs.x||0,a=this.attrs.y||0,l=this.attrs.offsetX||0,h=this.attrs.offsetY||0;e.translate(o-l,a-h)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();let o=this.getAbsoluteTransform(t).decompose();return{x:o.scaleX,y:o.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Qn,this._getTransform)}_getTransform(){var t,e;let i=this._cache.get(Qn)||new se;i.reset();let o=this.x(),a=this.y(),l=V.getAngle(this.rotation()),h=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,u=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,p=this.attrs.skewX||0,g=this.attrs.skewY||0,m=this.attrs.offsetX||0,v=this.attrs.offsetY||0;return(o!==0||a!==0)&&i.translate(o,a),l!==0&&i.rotate(l),(p!==0||g!==0)&&i.skew(p,g),(h!==1||u!==1)&&i.scale(h,u),(m!==0||v!==0)&&i.translate(-1*m,-1*v),i.dirty=!1,i}clone(t){let e=S.cloneObject(this.attrs),i,o,a,l,h;for(i in t)e[i]=t[i];let u=new this.constructor(e);for(i in this.eventListeners)for(o=this.eventListeners[i],a=o.length,l=0;l<a;l++)h=o[l],h.name.indexOf(Sv)<0&&(u.eventListeners[i]||(u.eventListeners[i]=[]),u.eventListeners[i].push(h));return u}_toKonvaCanvas(t){t=t||{};let e=this.getClientRect(),i=this.getStage(),o=t.x!==void 0?t.x:Math.floor(e.x),a=t.y!==void 0?t.y:Math.floor(e.y),l=t.pixelRatio||1,h=new xe({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:l}),u=h.getContext(),p=new xe({width:h.width/h.pixelRatio+Math.abs(o),height:h.height/h.pixelRatio+Math.abs(a),pixelRatio:h.pixelRatio});return t.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(o||a)&&u.translate(-1*o,-1*a),this.drawScene(h,void 0,p),u.restore(),h}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};let e=t.mimeType||null,i=t.quality||null,o=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(o),o}toImage(t){return new Promise((e,i)=>{try{let o=t?.callback;o&&delete t.callback,S._urlToImage(this.toDataURL(t),function(a){e(a),o?.(a)})}catch(o){i(o)}})}toBlob(t){return new Promise((e,i)=>{try{let o=t?.callback;o&&delete t.callback,this.toCanvas(t).toBlob(a=>{e(a),o?.(a)},t?.mimeType,t?.quality)}catch(o){i(o)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():V.dragDistance}_off(t,e,i){let o=this.eventListeners[t],a,l,h;for(a=0;a<o.length;a++)if(l=o[a].name,h=o[a].handler,(l!=="konva"||e==="konva")&&(!e||l===e)&&(!i||i===h)){if(o.splice(a,1),o.length===0){delete this.eventListeners[t];break}a--}}_fireChangeEvent(t,e,i){this._fire(t+bv,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){let e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;let e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){let e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){let i=this[af+S._capitalize(t)];return S._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(V.autoDrawEnabled){let t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){let i=this.attrs[t];i===e&&!S.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){let o;i!==void 0&&(o=this.attrs[t],o||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,o,i))}_fireAndBubble(t,e,i){e&&this.nodeType===lf&&(e.target=this);let o=[Dv,xv,Ev,Mv,Tv,Pv];if(!(o.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,e);let l=o.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!l&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i;let{nodeType:o}=this,a=r.protoListenerMap.get(o)||{},l=a?.[t];if(l===void 0){l=[];let h=Object.getPrototypeOf(this);for(;h;){let u=(i=(e=h.eventListeners)===null||e===void 0?void 0:e[t])!==null&&i!==void 0?i:[];l.push(...u),h=Object.getPrototypeOf(h)}a[t]=l,r.protoListenerMap.set(o,a)}return l}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;let i=this._getProtoListeners(t);if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,e);let o=this.eventListeners[t];if(o)for(let a=0;a<o.length;a++)o[a].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){let e=t?t.pointerId:void 0,i=this.getStage(),o=this.getAbsolutePosition();if(!i)return;let a=i._getPointerById(e)||i._changedPointerPositions[0]||o;St._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-o.x,y:a.y-o.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){St._dragElements.has(this._id)||this._createDragElement(t);let i=St._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){let i=this.getStage()._getPointerById(e.pointerId);if(!i)return;let o={x:i.x-e.offset.x,y:i.y-e.offset.y},a=this.dragBoundFunc();if(a!==void 0){let l=a.call(this,o,t);l?o=l:S.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==o.x||this._lastPos.y!==o.y)&&(this.setAbsolutePosition(o),this._requestDraw()),this._lastPos=o}stopDrag(t){let e=St._dragElements.get(this._id);e&&(e.dragStatus="stopped"),St._endDragBefore(t),St._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){let t=St._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||V.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let o=!1;St._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(o=!0)}),o||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let e=St._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",o=e&&e.dragStatus==="ready";i?this.stopDrag():o&&St._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){let e=this.getStage();if(!e)return!1;let i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return S.haveIntersection(i,this.getClientRect())}static create(t,e){return S._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let i=r.prototype.getClassName.call(t),o=t.children,a,l,h;e&&(t.attrs.container=e),V[i]||(S.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");let u=V[i];if(a=new u(t.attrs),o)for(l=o.length,h=0;h<l;h++)a.add(r._createNode(o[h]));return a}};N.protoListenerMap=new Map;N.prototype.nodeType="Node";N.prototype._attrsAffectingSize=[];N.prototype.eventListeners={};N.prototype.on.call(N.prototype,Rv,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Qn),this._clearSelfAndDescendantCache(Tn)});N.prototype.on.call(N.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(pc)});N.prototype.on.call(N.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(fc)});N.prototype.on.call(N.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Zs)});var Ot=w.addGetterSetter;Ot(N,"zIndex");Ot(N,"absolutePosition");Ot(N,"position");Ot(N,"x",0,O());Ot(N,"y",0,O());Ot(N,"globalCompositeOperation","source-over",fn());Ot(N,"opacity",1,O());Ot(N,"name","",fn());Ot(N,"id","",fn());Ot(N,"rotation",0,O());w.addComponentsGetterSetter(N,"scale",["x","y"]);Ot(N,"scaleX",1,O());Ot(N,"scaleY",1,O());w.addComponentsGetterSetter(N,"skew",["x","y"]);Ot(N,"skewX",0,O());Ot(N,"skewY",0,O());w.addComponentsGetterSetter(N,"offset",["x","y"]);Ot(N,"offsetX",0,O());Ot(N,"offsetY",0,O());Ot(N,"dragDistance",void 0,O());Ot(N,"width",0,O());Ot(N,"height",0,O());Ot(N,"listening",!0,ae());Ot(N,"preventDefault",!0,ae());Ot(N,"filters",void 0,function(r){return this._filterUpToDate=!1,r});Ot(N,"visible",!0,ae());Ot(N,"transformsEnabled","all",fn());Ot(N,"size");Ot(N,"dragBoundFunc");Ot(N,"draggable",!1,ae());w.backCompat(N,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Qt=class extends N{constructor(){super(...arguments),this.children=[]}getChildren(t){let e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}let e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){let e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){let i=[];return this._descendants(o=>{let a=o._isMatch(t);return a&&i.push(o),!!(a&&e)}),i}_descendants(t){let e=!1,i=this.getChildren();for(let o of i){if(e=t(o),e)return!0;if(o.hasChildren()&&(e=o._descendants(t),e))return!0}return!1}toObject(){let t=N.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){let e=N.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){let e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e,i){let o=this.getLayer(),a=t||o&&o.getCanvas(),l=a&&a.getContext(),h=this._getCanvasCache(),u=h&&h.scene,p=a&&a.isCache;if(!this.isVisible()&&!p)return this;if(u){l.save();let g=this.getAbsoluteTransform(e).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedSceneCanvas(l),l.restore()}else this._drawChildren("drawScene",a,e,i);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;let i=this.getLayer(),o=t||i&&i.hitCanvas,a=o&&o.getContext(),l=this._getCanvasCache();if(l&&l.hit){a.save();let u=this.getAbsoluteTransform(e).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",o,e);return this}_drawChildren(t,e,i,o){var a;let l=e&&e.getContext(),h=this.clipWidth(),u=this.clipHeight(),p=this.clipFunc(),g=typeof h=="number"&&typeof u=="number"||p,m=i===this;if(g){l.save();let y=this.getAbsoluteTransform(i),b=y.getMatrix();l.transform(b[0],b[1],b[2],b[3],b[4],b[5]),l.beginPath();let E;if(p)E=p.call(this,l,this);else{let D=this.clipX(),x=this.clipY();l.rect(D||0,x||0,h,u)}l.clip.apply(l,E),b=y.copy().invert().getMatrix(),l.transform(b[0],b[1],b[2],b[3],b[4],b[5])}let v=!m&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";v&&(l.save(),l._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(y){y[t](e,i,o)}),v&&l.restore(),g&&l.restore()}getClientRect(t={}){var e;let i=t.skipTransform,o=t.relativeTo,a,l,h,u,p={x:1/0,y:1/0,width:0,height:0},g=this;(e=this.children)===null||e===void 0||e.forEach(function(y){if(!y.visible())return;let b=y.getClientRect({relativeTo:g,skipShadow:t.skipShadow,skipStroke:t.skipStroke});b.width===0&&b.height===0||(a===void 0?(a=b.x,l=b.y,h=b.x+b.width,u=b.y+b.height):(a=Math.min(a,b.x),l=Math.min(l,b.y),h=Math.max(h,b.x+b.width),u=Math.max(u,b.y+b.height)))});let m=this.find("Shape"),v=!1;for(let y=0;y<m.length;y++)if(m[y]._isVisible(this)){v=!0;break}return v&&a!==void 0?p={x:a,y:l,width:h-a,height:u-l}:p={x:0,y:0,width:0,height:0},i?p:this._transformedRect(p,o)}};w.addComponentsGetterSetter(Qt,"clip",["x","y","width","height"]);w.addGetterSetter(Qt,"clipX",void 0,O());w.addGetterSetter(Qt,"clipY",void 0,O());w.addGetterSetter(Qt,"clipWidth",void 0,O());w.addGetterSetter(Qt,"clipHeight",void 0,O());w.addGetterSetter(Qt,"clipFunc");var go=new Map,hf=V._global.PointerEvent!==void 0;function Ys(r){return go.get(r)}function Xs(r){return{evt:r,pointerId:r.pointerId}}function Ks(r,t){return go.get(r)===t}function Js(r,t){Ci(r),t.getStage()&&(go.set(r,t),hf&&t._fire("gotpointercapture",Xs(new PointerEvent("gotpointercapture"))))}function Ci(r,t){let e=go.get(r);if(!e)return;let i=e.getStage();i&&i.content,go.delete(r),hf&&e._fire("lostpointercapture",Xs(new PointerEvent("lostpointercapture")))}var Iv="Stage",Lv="string",df="px",kv="mouseout",pf="mouseleave",gf="mouseover",mf="mouseenter",_f="mousemove",vf="mousedown",yf="mouseup",mo="pointermove",_o="pointerdown",hr="pointerup",vo="pointercancel",Nv="lostpointercapture",Qs="pointerout",yo="pointerleave",ta="pointerover",ea="pointerenter",mc="contextmenu",wf="touchstart",bf="touchend",Cf="touchmove",Sf="touchcancel",_c="wheel",Fv=5,Bv=[[mf,"_pointerenter"],[vf,"_pointerdown"],[_f,"_pointermove"],[yf,"_pointerup"],[pf,"_pointerleave"],[wf,"_pointerdown"],[Cf,"_pointermove"],[bf,"_pointerup"],[Sf,"_pointercancel"],[gf,"_pointerover"],[_c,"_wheel"],[mc,"_contextmenu"],[_o,"_pointerdown"],[mo,"_pointermove"],[hr,"_pointerup"],[vo,"_pointercancel"],[yo,"_pointerleave"],[Nv,"_lostpointercapture"]],gc={mouse:{[Qs]:kv,[yo]:pf,[ta]:gf,[ea]:mf,[mo]:_f,[_o]:vf,[hr]:yf,[vo]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Qs]:"touchout",[yo]:"touchleave",[ta]:"touchover",[ea]:"touchenter",[mo]:Cf,[_o]:wf,[hr]:bf,[vo]:Sf,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Qs]:Qs,[yo]:yo,[ta]:ta,[ea]:ea,[mo]:mo,[_o]:_o,[hr]:hr,[vo]:vo,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},wo=r=>r.indexOf("pointer")>=0?"pointer":r.indexOf("touch")>=0?"touch":"mouse",cr=r=>{let t=wo(r);if(t==="pointer")return V.pointerEventsEnabled&&gc.pointer;if(t==="touch")return gc.touch;if(t==="mouse")return gc.mouse};function ff(r={}){return(r.clipFunc||r.clipWidth||r.clipHeight)&&S.warn("Stage does not support clipping. Please use clip for Layers or Groups."),r}var Vv="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",ur=[],Si=class extends Qt{constructor(t){super(ff(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),ur.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ff(this.attrs)}),this._checkVisibility()}_validateAdd(t){let e=t.getType()==="Layer",i=t.getType()==="FastLayer";e||i||S.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===Lv){let e;if(t.charAt(0)==="."){let i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let t=this.children,e=t.length;for(let i=0;i<e;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),Qt.prototype.clone.call(this,t)}destroy(){super.destroy();let t=this.content;t&&S._isInDocument(t)&&this.container().removeChild(t);let e=ur.indexOf(this);return e>-1&&ur.splice(e,1),S.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(S.warn(Vv),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=j({},t),t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();let e=new xe({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,o=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),o.forEach(function(a){if(!a.isVisible())return;let l=a._toKonvaCanvas(t);i.drawImage(l._canvas,t.x,t.y,l.getWidth()/l.getPixelRatio(),l.getHeight()/l.getPixelRatio())}),e}getIntersection(t){if(!t)return null;let e=this.children,i=e.length,o=i-1;for(let a=o;a>=0;a--){let l=e[a].getIntersection(t);if(l)return l}return null}_resizeDOM(){let t=this.width(),e=this.height();this.content&&(this.content.style.width=t+df,this.content.style.height=e+df),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(i=>{i.setSize({width:t,height:e}),i.draw()})}add(t,...e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}super.add(t);let i=this.children.length;return i>Fv&&S.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),V.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Ks(t,this)}setPointerCapture(t){Js(t,this)}releaseCapture(t){Ci(t,this)}getLayers(){return this.children}_bindContentEvents(){V.isBrowser&&Bv.forEach(([t,e])=>{this.content.addEventListener(t,i=>{this[e](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);let e=cr(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);let e=cr(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){let e=cr(t.type),i=wo(t.type);if(!e)return;this.setPointersPositions(t);let o=this._getTargetShape(i),a=!(V.isDragging()||V.isTransforming())||V.hitOnDragEnabled;o&&a?(o._fireAndBubble(e.pointerout,{evt:t}),o._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):a&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){let e=cr(t.type),i=wo(t.type);if(!e)return;this.setPointersPositions(t);let o=!1;this._changedPointerPositions.forEach(a=>{let l=this.getIntersection(a);if(St.justDragged=!1,V["_"+i+"ListenClick"]=!0,!l||!l.isListening()){this[i+"ClickStartShape"]=void 0;return}V.capturePointerEventsEnabled&&l.setPointerCapture(a.id),this[i+"ClickStartShape"]=l,l._fireAndBubble(e.pointerdown,{evt:t,pointerId:a.id}),o=!0;let h=t.type.indexOf("touch")>=0;l.preventDefault()&&t.cancelable&&h&&t.preventDefault()}),o||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){let e=cr(t.type),i=wo(t.type);if(!e)return;let o=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(V.isDragging()&&St.node.preventDefault()&&t.cancelable&&o&&t.preventDefault(),this.setPointersPositions(t),!(!(V.isDragging()||V.isTransforming())||V.hitOnDragEnabled))return;let l={},h=!1,u=this._getTargetShape(i);this._changedPointerPositions.forEach(p=>{let g=Ys(p.id)||this.getIntersection(p),m=p.id,v={evt:t,pointerId:m},y=u!==g;if(y&&u&&(u._fireAndBubble(e.pointerout,j({},v),g),u._fireAndBubble(e.pointerleave,j({},v),g)),g){if(l[g._id])return;l[g._id]=!0}g&&g.isListening()?(h=!0,y&&(g._fireAndBubble(e.pointerover,j({},v),u),g._fireAndBubble(e.pointerenter,j({},v),u),this[i+"targetShape"]=g),g._fireAndBubble(e.pointermove,j({},v))):u&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:m}),this[i+"targetShape"]=null)}),h||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){let e=cr(t.type),i=wo(t.type);if(!e)return;this.setPointersPositions(t);let o=this[i+"ClickStartShape"],a=this[i+"ClickEndShape"],l={},h=!1;this._changedPointerPositions.forEach(u=>{let p=Ys(u.id)||this.getIntersection(u);if(p){if(p.releaseCapture(u.id),l[p._id])return;l[p._id]=!0}let g=u.id,m={evt:t,pointerId:g},v=!1;V["_"+i+"InDblClickWindow"]?(v=!0,clearTimeout(this[i+"DblTimeout"])):St.justDragged||(V["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){V["_"+i+"InDblClickWindow"]=!1},V.dblClickWindow),p&&p.isListening()?(h=!0,this[i+"ClickEndShape"]=p,p._fireAndBubble(e.pointerup,j({},m)),V["_"+i+"ListenClick"]&&o&&o===p&&(p._fireAndBubble(e.pointerclick,j({},m)),v&&a&&a===p&&p._fireAndBubble(e.pointerdblclick,j({},m)))):(this[i+"ClickEndShape"]=null,h||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),h=!0),V["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:g}),v&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:g}))}),h||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),V["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(mc,{evt:t}):this._fire(mc,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);let e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(_c,{evt:t}):this._fire(_c,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);let e=Ys(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(hr,Xs(t)),Ci(t.pointerId)}_lostpointercapture(t){Ci(t.pointerId)}setPointersPositions(t){let e=this._getContentPosition(),i=null,o=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,a=>{this._pointerPositions.push({id:a.identifier,x:(a.clientX-e.left)/e.scaleX,y:(a.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,a=>{this._changedPointerPositions.push({id:a.identifier,x:(a.clientX-e.left)/e.scaleX,y:(a.clientY-e.top)/e.scaleY})})):(i=(t.clientX-e.left)/e.scaleX,o=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:o},this._pointerPositions=[{x:i,y:o,id:S._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:o,id:S._getFirstPointerId(t)}])}_setPointerPosition(t){S.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new xe({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Xn({pixelRatio:1,width:this.width(),height:this.height()}),!V.isBrowser)return;let t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return S.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Si.prototype.nodeType=Iv;lt(Si);w.addGetterSetter(Si,"container");V.isBrowser&&document.addEventListener("visibilitychange",()=>{ur.forEach(r=>{r.batchDraw()})});var Df="hasShadow",xf="shadowRGBA",Ef="patternImage",Mf="linearGradient",Tf="radialGradient",na;function vc(){return na||(na=S.createCanvasElement().getContext("2d"),na)}var Di={};function zv(r){let t=this.attrs.fillRule;t?r.fill(t):r.fill()}function Uv(r){r.stroke()}function Gv(r){let t=this.attrs.fillRule;t?r.fill(t):r.fill()}function jv(r){r.stroke()}function Hv(){this._clearCache(Df)}function $v(){this._clearCache(xf)}function Wv(){this._clearCache(Ef)}function Zv(){this._clearCache(Mf)}function qv(){this._clearCache(Tf)}var I=class extends N{constructor(t){super(t);let e,i=0;for(;e=S.getHitColor(),!(e&&!(e in Di));)if(i++,i>=1e4){S.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),e=S.getRandomColor();break}this.colorKey=e,Di[e]=this}getContext(){return S.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return S.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Df,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Ef,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let e=vc().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){let i=new se;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(V.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let o=i.getMatrix(),a=typeof DOMMatrix>"u"?{a:o[0],b:o[1],c:o[2],d:o[3],e:o[4],f:o[5]}:new DOMMatrix(o);e.setTransform(a)}return e}}_getLinearGradient(){return this._getCache(Mf,this.__getLinearGradient)}__getLinearGradient(){let t=this.fillLinearGradientColorStops();if(t){let e=vc(),i=this.fillLinearGradientStartPoint(),o=this.fillLinearGradientEndPoint(),a=e.createLinearGradient(i.x,i.y,o.x,o.y);for(let l=0;l<t.length;l+=2)a.addColorStop(t[l],t[l+1]);return a}}_getRadialGradient(){return this._getCache(Tf,this.__getRadialGradient)}__getRadialGradient(){let t=this.fillRadialGradientColorStops();if(t){let e=vc(),i=this.fillRadialGradientStartPoint(),o=this.fillRadialGradientEndPoint(),a=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),o.x,o.y,this.fillRadialGradientEndRadius());for(let l=0;l<t.length;l+=2)a.addColorStop(t[l],t[l+1]);return a}}getShadowRGBA(){return this._getCache(xf,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let t=S.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){let e=this.getStage();if(!e)return!1;let i=e.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return N.prototype.destroy.call(this),delete Di[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;let o=t||this.hasFill(),a=this.hasStroke(),l=this.getAbsoluteOpacity()!==1;if(o&&a&&l)return!0;let h=this.hasShadow(),u=this.shadowForStrokeEnabled();return!!(o&&a&&h&&u)}setStrokeHitEnabled(t){S.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,i=this.getParent();for(;i;){if(i.isCached()){e=!0;break}i=i.getParent()}let o=t.skipTransform,a=t.relativeTo||e&&this.getStage()||void 0,l=this.getSelfRect(),u=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,p=l.width+u,g=l.height+u,m=!t.skipShadow&&this.hasShadow(),v=m?this.shadowOffsetX():0,y=m?this.shadowOffsetY():0,b=p+Math.abs(v),E=g+Math.abs(y),D=m&&this.shadowBlur()||0,x=b+D*2,A=E+D*2,T={width:x,height:A,x:-(u/2+D)+Math.min(v,0)+l.x,y:-(u/2+D)+Math.min(y,0)+l.y};return o?T:this._transformedRect(T,a)}drawScene(t,e,i){let o=this.getLayer(),a=t||o.getCanvas(),l=a.getContext(),h=this._getCanvasCache(),u=this.getSceneFunc(),p=this.hasShadow(),g,m=!1,v=e===this;if(!this.isVisible()&&!v)return this;if(h){l.save();let y=this.getAbsoluteTransform(e).getMatrix();return l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(l),l.restore(),this}if(!u)return this;if(l.save(),this._useBufferCanvas()&&!m){g=this.getStage();let y=i||g.bufferCanvas,b=y.getContext();i?(b.save(),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,y.width,y.height),b.restore()):b.clear(),b.save(),b._applyLineJoin(this),b._applyMiterLimit(this);let E=this.getAbsoluteTransform(e).getMatrix();b.transform(E[0],E[1],E[2],E[3],E[4],E[5]),u.call(this,b,this),b.restore();let D=y.pixelRatio;p&&l._applyShadow(this),v||(l._applyOpacity(this),l._applyGlobalCompositeOperation(this)),l.drawImage(y._canvas,y.x||0,y.y||0,y.width/D,y.height/D)}else{if(l._applyLineJoin(this),l._applyMiterLimit(this),!v){let y=this.getAbsoluteTransform(e).getMatrix();l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),l._applyOpacity(this),l._applyGlobalCompositeOperation(this)}p&&l._applyShadow(this),u.call(this,l,this)}return l.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;let o=this.getLayer(),a=t||o.hitCanvas,l=a&&a.getContext(),h=this.hitFunc()||this.sceneFunc(),u=this._getCanvasCache(),p=u&&u.hit;if(this.colorKey||S.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),p){l.save();let m=this.getAbsoluteTransform(e).getMatrix();return l.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(l),l.restore(),this}if(!h)return this;if(l.save(),l._applyLineJoin(this),l._applyMiterLimit(this),!(this===e)){let m=this.getAbsoluteTransform(e).getMatrix();l.transform(m[0],m[1],m[2],m[3],m[4],m[5])}return h.call(this,l,this),l.restore(),this}drawHitFromCache(t=0){let e=this._getCanvasCache(),i=this._getCachedSceneCanvas(),o=e.hit,a=o.getContext(),l=o.getWidth(),h=o.getHeight();a.clear(),a.drawImage(i._canvas,0,0,l,h);try{let u=a.getImageData(0,0,l,h),p=u.data,g=p.length,m=S._hexToRgb(this.colorKey);for(let v=0;v<g;v+=4)p[v+3]>t?(p[v]=m.r,p[v+1]=m.g,p[v+2]=m.b,p[v+3]=255):p[v+3]=0;a.putImageData(u,0,0)}catch(u){S.error("Unable to draw hit graph from cached scene canvas. "+u.message)}return this}hasPointerCapture(t){return Ks(t,this)}setPointerCapture(t){Js(t,this)}releaseCapture(t){Ci(t,this)}};I.prototype._fillFunc=zv;I.prototype._strokeFunc=Uv;I.prototype._fillFuncHit=Gv;I.prototype._strokeFuncHit=jv;I.prototype._centroid=!1;I.prototype.nodeType="Shape";lt(I);I.prototype.eventListeners={};I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Hv);I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",$v);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",Wv);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",Zv);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",qv);w.addGetterSetter(I,"stroke",void 0,dc());w.addGetterSetter(I,"strokeWidth",2,O());w.addGetterSetter(I,"fillAfterStrokeEnabled",!1);w.addGetterSetter(I,"hitStrokeWidth","auto",uo());w.addGetterSetter(I,"strokeHitEnabled",!0,ae());w.addGetterSetter(I,"perfectDrawEnabled",!0,ae());w.addGetterSetter(I,"shadowForStrokeEnabled",!0,ae());w.addGetterSetter(I,"lineJoin");w.addGetterSetter(I,"lineCap");w.addGetterSetter(I,"miterLimit");w.addGetterSetter(I,"sceneFunc");w.addGetterSetter(I,"hitFunc");w.addGetterSetter(I,"dash");w.addGetterSetter(I,"dashOffset",0,O());w.addGetterSetter(I,"shadowColor",void 0,fn());w.addGetterSetter(I,"shadowBlur",0,O());w.addGetterSetter(I,"shadowOpacity",1,O());w.addComponentsGetterSetter(I,"shadowOffset",["x","y"]);w.addGetterSetter(I,"shadowOffsetX",0,O());w.addGetterSetter(I,"shadowOffsetY",0,O());w.addGetterSetter(I,"fillPatternImage");w.addGetterSetter(I,"fill",void 0,dc());w.addGetterSetter(I,"fillPatternX",0,O());w.addGetterSetter(I,"fillPatternY",0,O());w.addGetterSetter(I,"fillLinearGradientColorStops");w.addGetterSetter(I,"strokeLinearGradientColorStops");w.addGetterSetter(I,"fillRadialGradientStartRadius",0);w.addGetterSetter(I,"fillRadialGradientEndRadius",0);w.addGetterSetter(I,"fillRadialGradientColorStops");w.addGetterSetter(I,"fillPatternRepeat","repeat");w.addGetterSetter(I,"fillEnabled",!0);w.addGetterSetter(I,"strokeEnabled",!0);w.addGetterSetter(I,"shadowEnabled",!0);w.addGetterSetter(I,"dashEnabled",!0);w.addGetterSetter(I,"strokeScaleEnabled",!0);w.addGetterSetter(I,"fillPriority","color");w.addComponentsGetterSetter(I,"fillPatternOffset",["x","y"]);w.addGetterSetter(I,"fillPatternOffsetX",0,O());w.addGetterSetter(I,"fillPatternOffsetY",0,O());w.addComponentsGetterSetter(I,"fillPatternScale",["x","y"]);w.addGetterSetter(I,"fillPatternScaleX",1,O());w.addGetterSetter(I,"fillPatternScaleY",1,O());w.addComponentsGetterSetter(I,"fillLinearGradientStartPoint",["x","y"]);w.addComponentsGetterSetter(I,"strokeLinearGradientStartPoint",["x","y"]);w.addGetterSetter(I,"fillLinearGradientStartPointX",0);w.addGetterSetter(I,"strokeLinearGradientStartPointX",0);w.addGetterSetter(I,"fillLinearGradientStartPointY",0);w.addGetterSetter(I,"strokeLinearGradientStartPointY",0);w.addComponentsGetterSetter(I,"fillLinearGradientEndPoint",["x","y"]);w.addComponentsGetterSetter(I,"strokeLinearGradientEndPoint",["x","y"]);w.addGetterSetter(I,"fillLinearGradientEndPointX",0);w.addGetterSetter(I,"strokeLinearGradientEndPointX",0);w.addGetterSetter(I,"fillLinearGradientEndPointY",0);w.addGetterSetter(I,"strokeLinearGradientEndPointY",0);w.addComponentsGetterSetter(I,"fillRadialGradientStartPoint",["x","y"]);w.addGetterSetter(I,"fillRadialGradientStartPointX",0);w.addGetterSetter(I,"fillRadialGradientStartPointY",0);w.addComponentsGetterSetter(I,"fillRadialGradientEndPoint",["x","y"]);w.addGetterSetter(I,"fillRadialGradientEndPointX",0);w.addGetterSetter(I,"fillRadialGradientEndPointY",0);w.addGetterSetter(I,"fillPatternRotation",0);w.addGetterSetter(I,"fillRule",void 0,fn());w.backCompat(I,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var Yv="beforeDraw",Xv="draw",Pf=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Kv=Pf.length,Xe=class extends Qt{constructor(t){super(t),this.canvas=new xe,this.hitCanvas=new Xn({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){N.prototype.moveToTop.call(this);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!N.prototype.moveUp.call(this))return!1;let e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(N.prototype.moveDown.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(N.prototype.moveToBottom.call(this)){let t=this.getStage();if(t){let e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let t=this.getNativeCanvasElement();return N.prototype.remove.call(this),t&&t.parentNode&&S._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){let e=t.getType();e!=="Group"&&e!=="Shape"&&S.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=j({},t),t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),N.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){S.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){S.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,S.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,i=!1;for(;;){for(let o=0;o<Kv;o++){let a=Pf[o],l=this._getIntersection({x:t.x+a.x*e,y:t.y+a.y*e}),h=l.shape;if(h)return h;if(i=!!l.antialiased,!l.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){let e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,o=i[3];if(o===255){let a=S.getHitColorKey(i[0],i[1],i[2]),l=Di[a];return l?{shape:l}:{antialiased:!0}}else if(o>0)return{antialiased:!0};return{}}drawScene(t,e,i){let o=this.getLayer(),a=t||o&&o.getCanvas();return this._fire(Yv,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),Qt.prototype.drawScene.call(this,a,e,i),this._fire(Xv,{node:this}),this}drawHit(t,e){let i=this.getLayer(),o=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Qt.prototype.drawHit.call(this,o,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){S.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return S.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return S.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Xe.prototype.nodeType="Layer";lt(Xe);w.addGetterSetter(Xe,"imageSmoothingEnabled",!0);w.addGetterSetter(Xe,"clearBeforeDraw",!0);w.addGetterSetter(Xe,"hitGraphEnabled",!0,ae());var dr=class extends Xe{constructor(t){super(t),this.listening(!1),S.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};dr.prototype.nodeType="FastLayer";lt(dr);var Ke=class extends Qt{_validateAdd(t){let e=t.getType();e!=="Group"&&e!=="Shape"&&S.throw("You may only add groups and shapes to groups.")}};Ke.prototype.nodeType="Group";lt(Ke);var yc=(function(){return Yn.performance&&Yn.performance.now?function(){return Yn.performance.now()}:function(){return new Date().getTime()}})(),fr=(()=>{class r{constructor(e,i){this.id=r.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:yc(),frameRate:0},this.func=e,this.setLayers(i)}setLayers(e){let i=[];return e&&(i=Array.isArray(e)?e:[e]),this.layers=i,this}getLayers(){return this.layers}addLayer(e){let i=this.layers,o=i.length;for(let a=0;a<o;a++)if(i[a]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){let i=r.animations,o=i.length;for(let a=0;a<o;a++)if(i[a].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=yc(),r._addAnimation(this),this}stop(){return r._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){let i=e.id,o=this.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===i){this.animations.splice(l,1);break}}static _runFrames(){let e={},i=this.animations;for(let o=0;o<i.length;o++){let a=i[o],l=a.layers,h=a.func;a._updateFrameObject(yc());let u=l.length,p;if(h?p=h.call(a,a.frame)!==!1:p=!0,!!p)for(let g=0;g<u;g++){let m=l[g];m._id!==void 0&&(e[m._id]=m)}}for(let o in e)e.hasOwnProperty(o)&&e[o].batchDraw()}static _animationLoop(){let e=r;e.animations.length?(e._runFrames(),S.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,S.requestAnimFrame(this._animationLoop))}}return r.animations=[],r.animIdCounter=0,r.animRunning=!1,r})();var Jv={node:1,duration:1,easing:1,onFinish:1,yoyo:1},Qv=1,Af=2,Rf=3,Of=["fill","stroke","shadowColor"],t1=0,wc=class{constructor(t,e,i,o,a,l,h){this.prop=t,this.propFunc=e,this.begin=o,this._pos=o,this.duration=l,this._change=0,this.prevPos=0,this.yoyo=h,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=a-this.begin,this.pause()}fire(t){let e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Af,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Rf,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let t=this.getTimer()-this._startTime;this.state===Af?this.setTime(t):this.state===Rf&&this.setTime(this.duration-t)}pause(){this.state=Qv,this.fire("onPause")}getTimer(){return new Date().getTime()}},bc=(()=>{class r{constructor(e){let i=this,o=e.node,a=o._id,l=e.easing||pr.Linear,h=!!e.yoyo,u,p;typeof e.duration>"u"?u=.3:e.duration===0?u=.001:u=e.duration,this.node=o,this._id=t1++;let g=o.getLayer()||(o instanceof V.Stage?o.getLayers():null);g||S.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new fr(function(){i.tween.onEnterFrame()},g),this.tween=new wc(p,function(m){i._tweenFunc(m)},l,0,1,u*1e3,h),this._addListeners(),r.attrs[a]||(r.attrs[a]={}),r.attrs[a][this._id]||(r.attrs[a][this._id]={}),r.tweens[a]||(r.tweens[a]={});for(p in e)Jv[p]===void 0&&this._addAttr(p,e[p]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,i){let o=this.node,a=o._id,l,h,u,p,g,m=r.tweens[a][e];m&&delete r.attrs[a][m][e];let v=o.getAttr(e);if(S._isArray(i))if(l=[],h=Math.max(i.length,v.length),e==="points"&&i.length!==v.length&&(i.length>v.length?(p=v,v=S._prepareArrayForTween(v,i,o.closed())):(u=i,i=S._prepareArrayForTween(i,v,o.closed()))),e.indexOf("fill")===0)for(let y=0;y<h;y++)if(y%2===0)l.push(i[y]-v[y]);else{let b=S.colorToRGBA(v[y]);g=S.colorToRGBA(i[y]),v[y]=b,l.push({r:g.r-b.r,g:g.g-b.g,b:g.b-b.b,a:g.a-b.a})}else for(let y=0;y<h;y++)l.push(i[y]-v[y]);else Of.indexOf(e)!==-1?(v=S.colorToRGBA(v),g=S.colorToRGBA(i),l={r:g.r-v.r,g:g.g-v.g,b:g.b-v.b,a:g.a-v.a}):l=i-v;r.attrs[a][this._id][e]={start:v,diff:l,end:i,trueEnd:u,trueStart:p},r.tweens[a][e]=this._id}_tweenFunc(e){let i=this.node,o=r.attrs[i._id][this._id],a,l,h,u,p,g,m,v;for(a in o){if(l=o[a],h=l.start,u=l.diff,v=l.end,S._isArray(h))if(p=[],m=Math.max(h.length,v.length),a.indexOf("fill")===0)for(g=0;g<m;g++)g%2===0?p.push((h[g]||0)+u[g]*e):p.push("rgba("+Math.round(h[g].r+u[g].r*e)+","+Math.round(h[g].g+u[g].g*e)+","+Math.round(h[g].b+u[g].b*e)+","+(h[g].a+u[g].a*e)+")");else for(g=0;g<m;g++)p.push((h[g]||0)+u[g]*e);else Of.indexOf(a)!==-1?p="rgba("+Math.round(h.r+u.r*e)+","+Math.round(h.g+u.g*e)+","+Math.round(h.b+u.b*e)+","+(h.a+u.a*e)+")":p=h+u*e;i.setAttr(a,p)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let e=this.node,i=r.attrs[e._id][this._id];i.points&&i.points.trueEnd&&e.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let e=this.node,i=r.attrs[e._id][this._id];i.points&&i.points.trueStart&&e.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let e=this.node._id,i=this._id,o=r.tweens[e];this.pause(),this.anim&&this.anim.stop();for(let a in o)delete r.tweens[e][a];delete r.attrs[e][i],r.tweens[e]&&(Object.keys(r.tweens[e]).length===0&&delete r.tweens[e],Object.keys(r.attrs[e]).length===0&&delete r.attrs[e])}}return r.attrs={},r.tweens={},r})();N.prototype.to=function(r){let t=r.onFinish;r.node=this,r.onFinish=function(){this.destroy(),t&&t()},new bc(r).play()};var pr={BackEaseIn(r,t,e,i){return e*(r/=i)*r*((1.70158+1)*r-1.70158)+t},BackEaseOut(r,t,e,i){return e*((r=r/i-1)*r*((1.70158+1)*r+1.70158)+1)+t},BackEaseInOut(r,t,e,i){let o=1.70158;return(r/=i/2)<1?e/2*(r*r*(((o*=1.525)+1)*r-o))+t:e/2*((r-=2)*r*(((o*=1.525)+1)*r+o)+2)+t},ElasticEaseIn(r,t,e,i,o,a){let l=0;return r===0?t:(r/=i)===1?t+e:(a||(a=i*.3),!o||o<Math.abs(e)?(o=e,l=a/4):l=a/(2*Math.PI)*Math.asin(e/o),-(o*Math.pow(2,10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a))+t)},ElasticEaseOut(r,t,e,i,o,a){let l=0;return r===0?t:(r/=i)===1?t+e:(a||(a=i*.3),!o||o<Math.abs(e)?(o=e,l=a/4):l=a/(2*Math.PI)*Math.asin(e/o),o*Math.pow(2,-10*r)*Math.sin((r*i-l)*(2*Math.PI)/a)+e+t)},ElasticEaseInOut(r,t,e,i,o,a){let l=0;return r===0?t:(r/=i/2)===2?t+e:(a||(a=i*(.3*1.5)),!o||o<Math.abs(e)?(o=e,l=a/4):l=a/(2*Math.PI)*Math.asin(e/o),r<1?-.5*(o*Math.pow(2,10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a))+t:o*Math.pow(2,-10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a)*.5+e+t)},BounceEaseOut(r,t,e,i){return(r/=i)<1/2.75?e*(7.5625*r*r)+t:r<2/2.75?e*(7.5625*(r-=1.5/2.75)*r+.75)+t:r<2.5/2.75?e*(7.5625*(r-=2.25/2.75)*r+.9375)+t:e*(7.5625*(r-=2.625/2.75)*r+.984375)+t},BounceEaseIn(r,t,e,i){return e-pr.BounceEaseOut(i-r,0,e,i)+t},BounceEaseInOut(r,t,e,i){return r<i/2?pr.BounceEaseIn(r*2,0,e,i)*.5+t:pr.BounceEaseOut(r*2-i,0,e,i)*.5+e*.5+t},EaseIn(r,t,e,i){return e*(r/=i)*r+t},EaseOut(r,t,e,i){return-e*(r/=i)*(r-2)+t},EaseInOut(r,t,e,i){return(r/=i/2)<1?e/2*r*r+t:-e/2*(--r*(r-2)-1)+t},StrongEaseIn(r,t,e,i){return e*(r/=i)*r*r*r*r+t},StrongEaseOut(r,t,e,i){return e*((r=r/i-1)*r*r*r*r+1)+t},StrongEaseInOut(r,t,e,i){return(r/=i/2)<1?e/2*r*r*r*r*r+t:e/2*((r-=2)*r*r*r*r+2)+t},Linear(r,t,e,i){return e*r/i+t}};var Cc=S._assign(V,{Util:S,Transform:se,Node:N,Container:Qt,Stage:Si,stages:ur,Layer:Xe,FastLayer:dr,Group:Ke,DD:St,Shape:I,shapes:Di,Animation:fr,Tween:bc,Easings:pr,Context:wi,Canvas:lr});var Be=class extends I{_sceneFunc(t){let e=V.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){let t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),o=V.getAngle(i?360-this.angle():this.angle()),a=Math.cos(Math.min(o,Math.PI)),l=1,h=Math.sin(Math.min(Math.max(Math.PI,o),3*Math.PI/2)),u=Math.sin(Math.min(o,Math.PI/2)),p=a*(a>0?t:e),g=l*(l>0?e:t),m=h*(h>0?t:e),v=u*(u>0?e:t);return{x:p,y:i?-1*v:m,width:g-p,height:v-m}}};Be.prototype._centroid=!0;Be.prototype.className="Arc";Be.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];lt(Be);w.addGetterSetter(Be,"innerRadius",0,O());w.addGetterSetter(Be,"outerRadius",0,O());w.addGetterSetter(Be,"angle",0,O());w.addGetterSetter(Be,"clockwise",!1,ae());function Sc(r,t,e,i,o,a,l){let h=Math.sqrt(Math.pow(e-r,2)+Math.pow(i-t,2)),u=Math.sqrt(Math.pow(o-e,2)+Math.pow(a-i,2)),p=l*h/(h+u),g=l*u/(h+u),m=e-p*(o-r),v=i-p*(a-t),y=e+g*(o-r),b=i+g*(a-t);return[m,v,y,b]}function If(r,t){let e=r.length,i=[];for(let o=2;o<e-2;o+=2){let a=Sc(r[o-2],r[o-1],r[o],r[o+1],r[o+2],r[o+3],t);isNaN(a[0])||(i.push(a[0]),i.push(a[1]),i.push(r[o]),i.push(r[o+1]),i.push(a[2]),i.push(a[3]))}return i}function e1(r){let t=[[r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]]],e=[];for(let i of t){let o=-3*i[0]+9*i[1]-9*i[2]+3*i[3];if(o!==0){let a=6*i[0]-12*i[1]+6*i[2],l=-3*i[0]+3*i[1],h=a*a-4*o*l;if(h>=0){let u=Math.sqrt(h);e.push((-a+u)/(2*o)),e.push((-a-u)/(2*o))}}}return e.filter(i=>i>0&&i<1).flatMap(i=>t.map(o=>{let a=1-i;return a*a*a*o[0]+3*a*a*i*o[1]+3*a*i*i*o[2]+i*i*i*o[3]}))}var Ee=class extends I{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){let e=this.points(),i=e.length,o=this.tension(),a=this.closed(),l=this.bezier();if(!i)return;let h=0;if(t.beginPath(),t.moveTo(e[0],e[1]),o!==0&&i>4){let u=this.getTensionPoints(),p=u.length;for(h=a?0:4,a||t.quadraticCurveTo(u[0],u[1],u[2],u[3]);h<p-2;)t.bezierCurveTo(u[h++],u[h++],u[h++],u[h++],u[h++],u[h++]);a||t.quadraticCurveTo(u[p-2],u[p-1],e[i-2],e[i-1])}else if(l)for(h=2;h<i;)t.bezierCurveTo(e[h++],e[h++],e[h++],e[h++],e[h++],e[h++]);else for(h=2;h<i;h+=2)t.lineTo(e[h],e[h+1]);a?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():If(this.points(),this.tension())}_getTensionPointsClosed(){let t=this.points(),e=t.length,i=this.tension(),o=Sc(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),a=Sc(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),l=If(t,i);return[o[2],o[3]].concat(l).concat([a[0],a[1],t[e-2],t[e-1],a[2],a[3],o[0],o[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.bezier()?t=[t[0],t[1],...e1(this.points()),t[t.length-2],t[t.length-1]]:t=this.points();let e=t[0],i=t[0],o=t[1],a=t[1],l,h;for(let u=0;u<t.length/2;u++)l=t[u*2],h=t[u*2+1],e=Math.min(e,l),i=Math.max(i,l),o=Math.min(o,h),a=Math.max(a,h);return{x:e,y:o,width:i-e,height:a-o}}};Ee.prototype.className="Line";Ee.prototype._attrsAffectingSize=["points","bezier","tension"];lt(Ee);w.addGetterSetter(Ee,"closed",!1);w.addGetterSetter(Ee,"bezier",!1);w.addGetterSetter(Ee,"tension",0,O());w.addGetterSetter(Ee,"points",[],nf());var n1=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],i1=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r1=[[1],[1,1],[1,2,1],[1,3,3,1]],xc=(r,t,e)=>{let i,o,l=e/2;i=0;for(let h=0;h<20;h++)o=l*n1[20][h]+l,i+=i1[20][h]*o1(r,t,o);return l*i},Ec=(r,t,e)=>{e===void 0&&(e=1);let i=r[0]-2*r[1]+r[2],o=t[0]-2*t[1]+t[2],a=2*r[1]-2*r[0],l=2*t[1]-2*t[0],h=4*(i*i+o*o),u=4*(i*a+o*l),p=a*a+l*l;if(h===0)return e*Math.sqrt(Math.pow(r[2]-r[0],2)+Math.pow(t[2]-t[0],2));let g=u/(2*h),m=p/h,v=e+g,y=m-g*g,b=v*v+y>0?Math.sqrt(v*v+y):0,E=g*g+y>0?Math.sqrt(g*g+y):0,D=g+Math.sqrt(g*g+y)!==0?y*Math.log(Math.abs((v+b)/(g+E))):0;return Math.sqrt(h)/2*(v*b-g*E+D)};function o1(r,t,e){let i=Dc(1,e,r),o=Dc(1,e,t),a=i*i+o*o;return Math.sqrt(a)}var Dc=(r,t,e)=>{let i=e.length-1,o,a;if(i===0)return 0;if(r===0){a=0;for(let l=0;l<=i;l++)a+=r1[i][l]*Math.pow(1-t,i-l)*Math.pow(t,l)*e[l];return a}else{o=new Array(i);for(let l=0;l<i;l++)o[l]=i*(e[l+1]-e[l]);return Dc(r-1,t,o)}},Mc=(r,t,e)=>{let i=1,o=r/t,a=(r-e(o))/t,l=0;for(;i>.001;){let h=e(o+a),u=Math.abs(r-h)/t;if(u<i)i=u,o+=a;else{let p=e(o-a),g=Math.abs(r-p)/t;g<i?(i=g,o-=a):a/=2}if(l++,l>500)break}return o};var le=class r extends I{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=r.parsePathData(this.data()),this.pathLength=r.getPathLength(this.dataArray)}_sceneFunc(t){let e=this.dataArray;t.beginPath();let i=!1;for(let o=0;o<e.length;o++){let a=e[o].command,l=e[o].points;switch(a){case"L":t.lineTo(l[0],l[1]);break;case"M":t.moveTo(l[0],l[1]);break;case"C":t.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"Q":t.quadraticCurveTo(l[0],l[1],l[2],l[3]);break;case"A":let h=l[0],u=l[1],p=l[2],g=l[3],m=l[4],v=l[5],y=l[6],b=l[7],E=p>g?p:g,D=p>g?1:p/g,x=p>g?g/p:1;t.translate(h,u),t.rotate(y),t.scale(D,x),t.arc(0,0,E,m,m+v,1-b),t.scale(1/D,1/x),t.rotate(-y),t.translate(-h,-u);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(u){if(u.command==="A"){let p=u.points[4],g=u.points[5],m=u.points[4]+g,v=Math.PI/180;if(Math.abs(p-m)<v&&(v=Math.abs(p-m)),g<0)for(let y=p-v;y>m;y-=v){let b=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);t.push(b.x,b.y)}else for(let y=p+v;y<m;y+=v){let b=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);t.push(b.x,b.y)}}else if(u.command==="C")for(let p=0;p<=1;p+=.01){let g=r.getPointOnCubicBezier(p,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);t.push(g.x,g.y)}else t=t.concat(u.points)});let e=t[0],i=t[0],o=t[1],a=t[1],l,h;for(let u=0;u<t.length/2;u++)l=t[u*2],h=t[u*2+1],isNaN(l)||(e=Math.min(e,l),i=Math.max(i,l)),isNaN(h)||(o=Math.min(o,h),a=Math.max(a,h));return{x:e,y:o,width:i-e,height:a-o}}getLength(){return this.pathLength}getPointAtLength(t){return r.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,o){return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))}static getPathLength(t){let e=0;for(let i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let i,o=0,a=e.length;if(!a)return null;for(;o<a&&t>e[o].pathLength;)t-=e[o].pathLength,++o;if(o===a)return i=e[o-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return e[o].command==="M"?(i=e[o].points.slice(0,2),{x:i[0],y:i[1]}):{x:e[o].start.x,y:e[o].start.y};let l=e[o],h=l.points;switch(l.command){case"L":return r.getPointOnLine(t,l.start.x,l.start.y,h[0],h[1]);case"C":return r.getPointOnCubicBezier(Mc(t,r.getPathLength(e),E=>xc([l.start.x,h[0],h[2],h[4]],[l.start.y,h[1],h[3],h[5]],E)),l.start.x,l.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return r.getPointOnQuadraticBezier(Mc(t,r.getPathLength(e),E=>Ec([l.start.x,h[0],h[2]],[l.start.y,h[1],h[3]],E)),l.start.x,l.start.y,h[0],h[1],h[2],h[3]);case"A":let u=h[0],p=h[1],g=h[2],m=h[3],v=h[5],y=h[6],b=h[4];return b+=v*t/l.pathLength,r.getPointOnEllipticalArc(u,p,g,m,b,y)}return null}static getPointOnLine(t,e,i,o,a,l,h){l=l??e,h=h??i;let u=this.getLineLength(e,i,o,a);if(u<1e-10)return{x:e,y:i};if(o===e)return{x:l,y:h+(a>i?t:-t)};let p=(a-i)/(o-e),g=Math.sqrt(t*t/(1+p*p))*(o<e?-1:1),m=p*g;if(Math.abs(h-i-p*(l-e))<1e-10)return{x:l+g,y:h+m};let v=((l-e)*(o-e)+(h-i)*(a-i))/(u*u),y=e+v*(o-e),b=i+v*(a-i),E=this.getLineLength(l,h,y,b),D=Math.sqrt(t*t-E*E),x=Math.sqrt(D*D/(1+p*p))*(o<e?-1:1),A=p*x;return{x:y+x,y:b+A}}static getPointOnCubicBezier(t,e,i,o,a,l,h,u,p){function g(D){return D*D*D}function m(D){return 3*D*D*(1-D)}function v(D){return 3*D*(1-D)*(1-D)}function y(D){return(1-D)*(1-D)*(1-D)}let b=u*g(t)+l*m(t)+o*v(t)+e*y(t),E=p*g(t)+h*m(t)+a*v(t)+i*y(t);return{x:b,y:E}}static getPointOnQuadraticBezier(t,e,i,o,a,l,h){function u(y){return y*y}function p(y){return 2*y*(1-y)}function g(y){return(1-y)*(1-y)}let m=l*u(t)+o*p(t)+e*g(t),v=h*u(t)+a*p(t)+i*g(t);return{x:m,y:v}}static getPointOnEllipticalArc(t,e,i,o,a,l){let h=Math.cos(l),u=Math.sin(l),p={x:i*Math.cos(a),y:o*Math.sin(a)};return{x:t+(p.x*h-p.y*u),y:e+(p.x*u+p.y*h)}}static parsePathData(t){if(!t)return[];let e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let m=0;m<i.length;m++)e=e.replace(new RegExp(i[m],"g"),"|"+i[m]);let o=e.split("|"),a=[],l=[],h=0,u=0,p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,g;for(let m=1;m<o.length;m++){let v=o[m],y=v.charAt(0);for(v=v.slice(1),l.length=0;g=p.exec(v);)l.push(g[0]);let b=[],E=y==="A"||y==="a"?0:-1;for(let D=0,x=l.length;D<x;D++){let A=l[D];if(A==="00"){b.push(0,0),E>=0&&(E+=2,E>=7&&(E-=7));continue}if(E>=0){if(E===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(A)){b.push(parseInt(A[0],10)),b.push(parseInt(A[1],10)),b.push(parseFloat(A.slice(2))),E+=3,E>=7&&(E-=7);continue}if(A==="11"||A==="10"||A==="01"){b.push(parseInt(A[0],10)),b.push(parseInt(A[1],10)),E+=2,E>=7&&(E-=7);continue}if(A==="0"||A==="1"){b.push(parseInt(A,10)),E+=1,E>=7&&(E-=7);continue}}else if(E===4){if(/^[01]\d+(?:\.\d+)?$/.test(A)){b.push(parseInt(A[0],10)),b.push(parseFloat(A.slice(1))),E+=2,E>=7&&(E-=7);continue}if(A==="0"||A==="1"){b.push(parseInt(A,10)),E+=1,E>=7&&(E-=7);continue}}let T=parseFloat(A);isNaN(T)?b.push(0):b.push(T),E+=1,E>=7&&(E-=7)}else{let T=parseFloat(A);isNaN(T)?b.push(0):b.push(T)}}for(;b.length>0&&!isNaN(b[0]);){let D="",x=[],A=h,T=u,R,z,U,$,H,Z,Y,pt,q,vt;switch(y){case"l":h+=b.shift(),u+=b.shift(),D="L",x.push(h,u);break;case"L":h=b.shift(),u=b.shift(),x.push(h,u);break;case"m":let Q=b.shift(),X=b.shift();if(h+=Q,u+=X,D="M",a.length>2&&a[a.length-1].command==="z"){for(let k=a.length-2;k>=0;k--)if(a[k].command==="M"){h=a[k].points[0]+Q,u=a[k].points[1]+X;break}}x.push(h,u),y="l";break;case"M":h=b.shift(),u=b.shift(),D="M",x.push(h,u),y="L";break;case"h":h+=b.shift(),D="L",x.push(h,u);break;case"H":h=b.shift(),D="L",x.push(h,u);break;case"v":u+=b.shift(),D="L",x.push(h,u);break;case"V":u=b.shift(),D="L",x.push(h,u);break;case"C":x.push(b.shift(),b.shift(),b.shift(),b.shift()),h=b.shift(),u=b.shift(),x.push(h,u);break;case"c":x.push(h+b.shift(),u+b.shift(),h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="C",x.push(h,u);break;case"S":z=h,U=u,R=a[a.length-1],R.command==="C"&&(z=h+(h-R.points[2]),U=u+(u-R.points[3])),x.push(z,U,b.shift(),b.shift()),h=b.shift(),u=b.shift(),D="C",x.push(h,u);break;case"s":z=h,U=u,R=a[a.length-1],R.command==="C"&&(z=h+(h-R.points[2]),U=u+(u-R.points[3])),x.push(z,U,h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="C",x.push(h,u);break;case"Q":x.push(b.shift(),b.shift()),h=b.shift(),u=b.shift(),x.push(h,u);break;case"q":x.push(h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="Q",x.push(h,u);break;case"T":z=h,U=u,R=a[a.length-1],R.command==="Q"&&(z=h+(h-R.points[0]),U=u+(u-R.points[1])),h=b.shift(),u=b.shift(),D="Q",x.push(z,U,h,u);break;case"t":z=h,U=u,R=a[a.length-1],R.command==="Q"&&(z=h+(h-R.points[0]),U=u+(u-R.points[1])),h+=b.shift(),u+=b.shift(),D="Q",x.push(z,U,h,u);break;case"A":$=b.shift(),H=b.shift(),Z=b.shift(),Y=b.shift(),pt=b.shift(),q=h,vt=u,h=b.shift(),u=b.shift(),D="A",x=this.convertEndpointToCenterParameterization(q,vt,h,u,Y,pt,$,H,Z);break;case"a":$=b.shift(),H=b.shift(),Z=b.shift(),Y=b.shift(),pt=b.shift(),q=h,vt=u,h+=b.shift(),u+=b.shift(),D="A",x=this.convertEndpointToCenterParameterization(q,vt,h,u,Y,pt,$,H,Z);break}a.push({command:D||y,points:x,start:{x:A,y:T},pathLength:this.calcLength(A,T,D||y,x)})}(y==="z"||y==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,e,i,o){let a,l,h,u,p=r;switch(i){case"L":return p.getLineLength(t,e,o[0],o[1]);case"C":return xc([t,o[0],o[2],o[4]],[e,o[1],o[3],o[5]],1);case"Q":return Ec([t,o[0],o[2]],[e,o[1],o[3]],1);case"A":a=0;let g=o[4],m=o[5],v=o[4]+m,y=Math.PI/180;if(Math.abs(g-v)<y&&(y=Math.abs(g-v)),l=p.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],g,0),m<0)for(u=g-y;u>v;u-=y)h=p.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],u,0),a+=p.getLineLength(l.x,l.y,h.x,h.y),l=h;else for(u=g+y;u<v;u+=y)h=p.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],u,0),a+=p.getLineLength(l.x,l.y,h.x,h.y),l=h;return h=p.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],v,0),a+=p.getLineLength(l.x,l.y,h.x,h.y),a}return 0}static convertEndpointToCenterParameterization(t,e,i,o,a,l,h,u,p){let g=p*(Math.PI/180),m=Math.cos(g)*(t-i)/2+Math.sin(g)*(e-o)/2,v=-1*Math.sin(g)*(t-i)/2+Math.cos(g)*(e-o)/2,y=m*m/(h*h)+v*v/(u*u);y>1&&(h*=Math.sqrt(y),u*=Math.sqrt(y));let b=Math.sqrt((h*h*(u*u)-h*h*(v*v)-u*u*(m*m))/(h*h*(v*v)+u*u*(m*m)));a===l&&(b*=-1),isNaN(b)&&(b=0);let E=b*h*v/u,D=b*-u*m/h,x=(t+i)/2+Math.cos(g)*E-Math.sin(g)*D,A=(e+o)/2+Math.sin(g)*E+Math.cos(g)*D,T=function(Y){return Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1])},R=function(Y,pt){return(Y[0]*pt[0]+Y[1]*pt[1])/(T(Y)*T(pt))},z=function(Y,pt){return(Y[0]*pt[1]<Y[1]*pt[0]?-1:1)*Math.acos(R(Y,pt))},U=z([1,0],[(m-E)/h,(v-D)/u]),$=[(m-E)/h,(v-D)/u],H=[(-1*m-E)/h,(-1*v-D)/u],Z=z($,H);return R($,H)<=-1&&(Z=Math.PI),R($,H)>=1&&(Z=0),l===0&&Z>0&&(Z=Z-2*Math.PI),l===1&&Z<0&&(Z=Z+2*Math.PI),[x,A,h,u,U,Z,g,l]}};le.prototype.className="Path";le.prototype._attrsAffectingSize=["data"];lt(le);w.addGetterSetter(le,"data");var pn=class extends Ee{_sceneFunc(t){super._sceneFunc(t);let e=Math.PI*2,i=this.points(),o=i,a=this.tension()!==0&&i.length>4;a&&(o=this.getTensionPoints());let l=this.pointerLength(),h=i.length,u,p;if(a){let v=[o[o.length-4],o[o.length-3],o[o.length-2],o[o.length-1],i[h-2],i[h-1]],y=le.calcLength(o[o.length-4],o[o.length-3],"C",v),b=le.getPointOnQuadraticBezier(Math.min(1,1-l/y),v[0],v[1],v[2],v[3],v[4],v[5]);u=i[h-2]-b.x,p=i[h-1]-b.y}else u=i[h-2]-i[h-4],p=i[h-1]-i[h-3];let g=(Math.atan2(p,u)+e)%e,m=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[h-2],i[h-1]),t.rotate(g),t.moveTo(0,0),t.lineTo(-l,m/2),t.lineTo(-l,-m/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),a?(u=(o[0]+o[2])/2-i[0],p=(o[1]+o[3])/2-i[1]):(u=i[2]-i[0],p=i[3]-i[1]),t.rotate((Math.atan2(-p,-u)+e)%e),t.moveTo(0,0),t.lineTo(-l,m/2),t.lineTo(-l,-m/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){let e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){let t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x,y:t.y-e,width:t.width,height:t.height+e*2}}};pn.prototype.className="Arrow";lt(pn);w.addGetterSetter(pn,"pointerLength",10,O());w.addGetterSetter(pn,"pointerWidth",10,O());w.addGetterSetter(pn,"pointerAtBeginning",!1);w.addGetterSetter(pn,"pointerAtEnding",!0);var Pn=class extends I{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Pn.prototype._centroid=!0;Pn.prototype.className="Circle";Pn.prototype._attrsAffectingSize=["radius"];lt(Pn);w.addGetterSetter(Pn,"radius",0,O());var Je=class extends I{_sceneFunc(t){let e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};Je.prototype.className="Ellipse";Je.prototype._centroid=!0;Je.prototype._attrsAffectingSize=["radiusX","radiusY"];lt(Je);w.addComponentsGetterSetter(Je,"radius",["x","y"]);w.addGetterSetter(Je,"radiusX",0,O());w.addGetterSetter(Je,"radiusY",0,O());var we=class r extends I{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let t=!!this.cornerRadius(),e=this.hasShadow();return t&&e?!0:super._useBufferCanvas(!0)}_sceneFunc(t){let e=this.getWidth(),i=this.getHeight(),o=this.cornerRadius(),a=this.attrs.image,l;if(a){let h=this.attrs.cropWidth,u=this.attrs.cropHeight;h&&u?l=[a,this.cropX(),this.cropY(),h,u,0,0,e,i]:l=[a,0,0,e,i]}(this.hasFill()||this.hasStroke()||o)&&(t.beginPath(),o?S.drawRoundedRectPath(t,e,i,o):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),a&&(o&&t.clip(),t.drawImage.apply(t,l))}_hitFunc(t){let e=this.width(),i=this.height(),o=this.cornerRadius();t.beginPath(),o?S.drawRoundedRectPath(t,e,i,o):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width)!==null&&i!==void 0?i:0}getHeight(){var t,e,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height)!==null&&i!==void 0?i:0}static fromURL(t,e,i=null){let o=S.createImageElement();o.onload=function(){let a=new r({image:o});e(a)},o.onerror=i,o.crossOrigin="Anonymous",o.src=t}};we.prototype.className="Image";we.prototype._attrsAffectingSize=["image"];lt(we);w.addGetterSetter(we,"cornerRadius",0,Jn(4));w.addGetterSetter(we,"image");w.addComponentsGetterSetter(we,"crop",["x","y","width","height"]);w.addGetterSetter(we,"cropX",0,O());w.addGetterSetter(we,"cropY",0,O());w.addGetterSetter(we,"cropWidth",0,O());w.addGetterSetter(we,"cropHeight",0,O());var Lf=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],s1="Change.konva",a1="none",Tc="up",Pc="right",Ac="down",Rc="left",l1=Lf.length,gr=class extends Ke{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,i,o=function(){e._sync()};for(i=0;i<l1;i++)t.on(Lf[i]+s1,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),i,o,a,l,h,u,p;if(t&&e){switch(i=t.width(),o=t.height(),a=e.pointerDirection(),l=e.pointerWidth(),p=e.pointerHeight(),h=0,u=0,a){case Tc:h=i/2,u=-1*p;break;case Pc:h=i+l,u=o/2;break;case Ac:h=i/2,u=o+p;break;case Rc:h=-1*l,u=o/2;break}e.setAttrs({x:-1*h,y:-1*u,width:i,height:o}),t.setAttrs({x:-1*h,y:-1*u})}}};gr.prototype.className="Label";lt(gr);var gn=class extends I{_sceneFunc(t){let e=this.width(),i=this.height(),o=this.pointerDirection(),a=this.pointerWidth(),l=this.pointerHeight(),h=this.cornerRadius(),u=0,p=0,g=0,m=0;typeof h=="number"?u=p=g=m=Math.min(h,e/2,i/2):(u=Math.min(h[0]||0,e/2,i/2),p=Math.min(h[1]||0,e/2,i/2),m=Math.min(h[2]||0,e/2,i/2),g=Math.min(h[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(u,0),o===Tc&&(t.lineTo((e-a)/2,0),t.lineTo(e/2,-1*l),t.lineTo((e+a)/2,0)),t.lineTo(e-p,0),t.arc(e-p,p,p,Math.PI*3/2,0,!1),o===Pc&&(t.lineTo(e,(i-l)/2),t.lineTo(e+a,i/2),t.lineTo(e,(i+l)/2)),t.lineTo(e,i-m),t.arc(e-m,i-m,m,0,Math.PI/2,!1),o===Ac&&(t.lineTo((e+a)/2,i),t.lineTo(e/2,i+l),t.lineTo((e-a)/2,i)),t.lineTo(g,i),t.arc(g,i-g,g,Math.PI/2,Math.PI,!1),o===Rc&&(t.lineTo(0,(i+l)/2),t.lineTo(-1*a,i/2),t.lineTo(0,(i-l)/2)),t.lineTo(0,u),t.arc(u,u,u,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,i=this.pointerWidth(),o=this.pointerHeight(),a=this.pointerDirection(),l=this.width(),h=this.height();return a===Tc?(e-=o,h+=o):a===Ac?h+=o:a===Rc?(t-=i*1.5,l+=i):a===Pc&&(l+=i*1.5),{x:t,y:e,width:l,height:h}}};gn.prototype.className="Tag";lt(gn);w.addGetterSetter(gn,"pointerDirection",a1);w.addGetterSetter(gn,"pointerWidth",0,O());w.addGetterSetter(gn,"pointerHeight",0,O());w.addGetterSetter(gn,"cornerRadius",0,Jn(4));var An=class extends I{_sceneFunc(t){let e=this.cornerRadius(),i=this.width(),o=this.height();t.beginPath(),e?S.drawRoundedRectPath(t,i,o,e):t.rect(0,0,i,o),t.closePath(),t.fillStrokeShape(this)}};An.prototype.className="Rect";lt(An);w.addGetterSetter(An,"cornerRadius",0,Jn(4));var Qe=class extends I{_sceneFunc(t){let e=this._getPoints(),i=this.radius(),o=this.sides(),a=this.cornerRadius();if(t.beginPath(),a)S.drawRoundedPolygonPath(t,e,o,i,a);else{t.moveTo(e[0].x,e[0].y);for(let l=1;l<e.length;l++)t.lineTo(e[l].x,e[l].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){let t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(let o=0;o<t;o++)i.push({x:e*Math.sin(o*2*Math.PI/t),y:-1*e*Math.cos(o*2*Math.PI/t)});return i}getSelfRect(){let t=this._getPoints(),e=t[0].x,i=t[0].x,o=t[0].y,a=t[0].y;return t.forEach(l=>{e=Math.min(e,l.x),i=Math.max(i,l.x),o=Math.min(o,l.y),a=Math.max(a,l.y)}),{x:e,y:o,width:i-e,height:a-o}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};Qe.prototype.className="RegularPolygon";Qe.prototype._centroid=!0;Qe.prototype._attrsAffectingSize=["radius"];lt(Qe);w.addGetterSetter(Qe,"radius",0,O());w.addGetterSetter(Qe,"sides",0,O());w.addGetterSetter(Qe,"cornerRadius",0,Jn(4));var kf=Math.PI*2,mn=class extends I{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,kf,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),kf,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};mn.prototype.className="Ring";mn.prototype._centroid=!0;mn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];lt(mn);w.addGetterSetter(mn,"innerRadius",0,O());w.addGetterSetter(mn,"outerRadius",0,O());var Me=class extends I{constructor(t){super(t),this._updated=!0,this.anim=new fr(()=>{let e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){let e=this.animation(),i=this.frameIndex(),o=i*4,a=this.animations()[e],l=this.frameOffsets(),h=a[o+0],u=a[o+1],p=a[o+2],g=a[o+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,p,g),t.closePath(),t.fillStrokeShape(this)),m)if(l){let v=l[e],y=i*2;t.drawImage(m,h,u,p,g,v[y+0],v[y+1],p,g)}else t.drawImage(m,h,u,p,g,0,0,p,g)}_hitFunc(t){let e=this.animation(),i=this.frameIndex(),o=i*4,a=this.animations()[e],l=this.frameOffsets(),h=a[o+2],u=a[o+3];if(t.beginPath(),l){let p=l[e],g=i*2;t.rect(p[g+0],p[g+1],h,u)}else t.rect(0,0,h,u);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let t=this.frameIndex(),e=this.animation(),i=this.animations(),o=i[e],a=o.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)}};Me.prototype.className="Sprite";lt(Me);w.addGetterSetter(Me,"animation");w.addGetterSetter(Me,"animations");w.addGetterSetter(Me,"frameOffsets");w.addGetterSetter(Me,"image");w.addGetterSetter(Me,"frameIndex",0,O());w.addGetterSetter(Me,"frameRate",17,O());w.backCompat(Me,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var tn=class extends I{_sceneFunc(t){let e=this.innerRadius(),i=this.outerRadius(),o=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let a=1;a<o*2;a++){let l=a%2===0?i:e,h=l*Math.sin(a*Math.PI/o),u=-1*l*Math.cos(a*Math.PI/o);t.lineTo(h,u)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}};tn.prototype.className="Star";tn.prototype._centroid=!0;tn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];lt(tn);w.addGetterSetter(tn,"numPoints",5,O());w.addGetterSetter(tn,"innerRadius",0,O());w.addGetterSetter(tn,"outerRadius",0,O());function Rn(r){return[...r].reduce((t,e,i,o)=>{if(new RegExp("\\p{Emoji}","u").test(e)){let a=o[i+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(t.push(e+a),o[i+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(o[i+1]||""))?t.push(e+o[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}var mr="auto",c1="center",zf="inherit",bo="justify",h1="Change.konva",u1="2d",Nf="-",Uf="left",d1="text",f1="Text",p1="top",g1="bottom",Ff="middle",Gf="normal",m1="px ",ia=" ",_1="right",Bf="rtl",v1="word",y1="char",Vf="none",Oc="\u2026",jf=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],w1=jf.length;function b1(r){return r.split(",").map(t=>{t=t.trim();let e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}var ra;function Ic(){return ra||(ra=S.createCanvasElement().getContext(u1),ra)}function C1(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function S1(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function D1(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}var Tt=class extends I{constructor(t){super(D1(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<w1;e++)this.on(jf[e]+h1,this._setTextData);this._setTextData()}_sceneFunc(t){var e,i;let o=this.textArr,a=o.length;if(!this.text())return;let l=this.padding(),h=this.fontSize(),u=this.lineHeight()*h,p=this.verticalAlign(),g=this.direction(),m=0,v=this.align(),y=this.getWidth(),b=this.letterSpacing(),E=this.charRenderFunc(),D=this.fill(),x=this.textDecoration(),A=this.underlineOffset(),T=x.indexOf("underline")!==-1,R=x.indexOf("line-through")!==-1,z;g=g===zf?t.direction:g;let U=u/2,$=Ff;if(!V.legacyTextRendering){let H=this.measureSize("M");$="alphabetic";let Z=(e=H.fontBoundingBoxAscent)!==null&&e!==void 0?e:H.actualBoundingBoxAscent,Y=(i=H.fontBoundingBoxDescent)!==null&&i!==void 0?i:H.actualBoundingBoxDescent;U=(Z-Y)/2+u/2}for(g===Bf&&t.setAttr("direction",g),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",$),t.setAttr("textAlign",Uf),p===Ff?m=(this.getHeight()-a*u-l*2)/2:p===g1&&(m=this.getHeight()-a*u-l*2),t.translate(l,m+l),z=0;z<a;z++){let H=0,Z=0,Y=o[z],pt=Y.text,q=Y.width,vt=Y.lastInParagraph;if(t.save(),v===_1?H+=y-q-l*2:v===c1&&(H+=(y-q-l*2)/2),T){t.save(),t.beginPath();let X=A??(V.legacyTextRendering?Math.round(h/2):Math.round(h/4)),k=H,Et=U+Z+X;t.moveTo(k,Et);let B=v===bo&&!vt?y-l*2:q;t.lineTo(k+Math.round(B),Et),t.lineWidth=h/15;let tt=this._getLinearGradient();t.strokeStyle=tt||D,t.stroke(),t.restore()}let Q=H;if(g!==Bf&&(b!==0||v===bo||E)){let X=pt.split(" ").length-1,k=Rn(pt);for(let Et=0;Et<k.length;Et++){let B=k[Et];if(B===" "&&!vt&&v===bo&&(H+=(y-l*2-q)/X),this._partialTextX=H,this._partialTextY=U+Z,this._partialText=B,E){t.save();let at=o.slice(0,z).reduce((et,it)=>et+Rn(it.text).length,0),K=Et+at;E({char:B,index:K,x:H,y:U+Z,lineIndex:z,column:Et,isLastInLine:vt,width:this.measureSize(B).width,context:t})}t.fillStrokeShape(this),E&&t.restore(),H+=this.measureSize(B).width+b}}else b!==0&&t.setAttr("letterSpacing",`${b}px`),this._partialTextX=H,this._partialTextY=U+Z,this._partialText=pt,t.fillStrokeShape(this);if(R){t.save(),t.beginPath();let X=V.legacyTextRendering?0:-Math.round(h/4),k=Q;t.moveTo(k,U+Z+X);let Et=v===bo&&!vt?y-l*2:q;t.lineTo(k+Math.round(Et),U+Z+X),t.lineWidth=h/15;let B=this._getLinearGradient();t.strokeStyle=B||D,t.stroke(),t.restore()}t.restore(),a>1&&(U+=u)}}_hitFunc(t){let e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){let e=S._isString(t)?t:t==null?"":t+"";return this._setAttr(d1,e),this}getWidth(){return this.attrs.width===mr||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===mr||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return S.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i,o,a,l,h,u,p,g,m,v;let y=Ic(),b=this.fontSize(),E;y.save(),y.font=this._getContextFont(),E=y.measureText(t),y.restore();let D=b/100;return{actualBoundingBoxAscent:(e=E.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*D,actualBoundingBoxDescent:(i=E.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(o=E.actualBoundingBoxLeft)!==null&&o!==void 0?o:-7.421875*D,actualBoundingBoxRight:(a=E.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*D,alphabeticBaseline:(l=E.alphabeticBaseline)!==null&&l!==void 0?l:0,emHeightAscent:(h=E.emHeightAscent)!==null&&h!==void 0?h:100*D,emHeightDescent:(u=E.emHeightDescent)!==null&&u!==void 0?u:-20*D,fontBoundingBoxAscent:(p=E.fontBoundingBoxAscent)!==null&&p!==void 0?p:91*D,fontBoundingBoxDescent:(g=E.fontBoundingBoxDescent)!==null&&g!==void 0?g:21*D,hangingBaseline:(m=E.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*D,ideographicBaseline:(v=E.ideographicBaseline)!==null&&v!==void 0?v:-21*D,width:E.width,height:b}}_getContextFont(){return this.fontStyle()+ia+this.fontVariant()+ia+(this.fontSize()+m1)+b1(this.fontFamily())}_addTextLine(t){this.align()===bo&&(t=t.trim());let i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){let e=this.letterSpacing(),i=t.length;return Ic().measureText(t).width+e*i}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),i=0,o=this.lineHeight()*e,a=this.attrs.width,l=this.attrs.height,h=a!==mr&&a!==void 0,u=l!==mr&&l!==void 0,p=this.padding(),g=a-p*2,m=l-p*2,v=0,y=this.wrap(),b=y!==Vf,E=y!==y1&&b,D=this.ellipsis();this.textArr=[],Ic().font=this._getContextFont();let x=D?this._getTextWidth(Oc):0;for(let A=0,T=t.length;A<T;++A){let R=t[A],z=this._getTextWidth(R);if(h&&z>g)for(;R.length>0;){let U=0,$=Rn(R).length,H="",Z=0;for(;U<$;){let Y=U+$>>>1,pt=Rn(R),q=pt.slice(0,Y+1).join(""),vt=this._getTextWidth(q);(D&&u&&v+o>m?vt+x:vt)<=g?(U=Y+1,H=q,Z=vt):$=Y}if(H){if(E){let q=Rn(R),vt=Rn(H),Q=q[vt.length],X=Q===ia||Q===Nf,k;if(X&&Z<=g)k=vt.length;else{let Et=vt.lastIndexOf(ia),B=vt.lastIndexOf(Nf);k=Math.max(Et,B)+1}k>0&&(U=k,H=q.slice(0,U).join(""),Z=this._getTextWidth(H))}if(H=H.trimRight(),this._addTextLine(H),i=Math.max(i,Z),v+=o,this._shouldHandleEllipsis(v)){this._tryToAddEllipsisToLastLine();break}if(R=Rn(R).slice(U).join("").trimLeft(),R.length>0&&(z=this._getTextWidth(R),z<=g)){this._addTextLine(R),v+=o,i=Math.max(i,z);break}}else break}else this._addTextLine(R),v+=o,i=Math.max(i,z),this._shouldHandleEllipsis(v)&&A<T-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&v+o>m)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){let e=+this.fontSize(),i=this.lineHeight()*e,o=this.attrs.height,a=o!==mr&&o!==void 0,l=this.padding(),h=o-l*2;return!(this.wrap()!==Vf)||a&&t+i>h}_tryToAddEllipsisToLastLine(){let t=this.attrs.width,e=t!==mr&&t!==void 0,i=this.padding(),o=t-i*2,a=this.ellipsis(),l=this.textArr[this.textArr.length-1];!l||!a||(e&&(this._getTextWidth(l.text+Oc)<o||(l.text=l.text.slice(0,l.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(l.text+Oc))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}};Tt.prototype._fillFunc=C1;Tt.prototype._strokeFunc=S1;Tt.prototype.className=f1;Tt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];lt(Tt);w.overWriteSetter(Tt,"width",uo());w.overWriteSetter(Tt,"height",uo());w.addGetterSetter(Tt,"direction",zf);w.addGetterSetter(Tt,"fontFamily","Arial");w.addGetterSetter(Tt,"fontSize",12,O());w.addGetterSetter(Tt,"fontStyle",Gf);w.addGetterSetter(Tt,"fontVariant",Gf);w.addGetterSetter(Tt,"padding",0,O());w.addGetterSetter(Tt,"align",Uf);w.addGetterSetter(Tt,"verticalAlign",p1);w.addGetterSetter(Tt,"lineHeight",1,O());w.addGetterSetter(Tt,"wrap",v1);w.addGetterSetter(Tt,"ellipsis",!1,ae());w.addGetterSetter(Tt,"letterSpacing",0,O());w.addGetterSetter(Tt,"text","",fn());w.addGetterSetter(Tt,"textDecoration","");w.addGetterSetter(Tt,"underlineOffset",void 0,O());w.addGetterSetter(Tt,"charRenderFunc",void 0);var x1="",Hf="normal";function $f(r){r.fillText(this.partialText,0,0)}function Wf(r){r.strokeText(this.partialText,0,0)}var zt=class extends I{constructor(t){super(t),this.dummyCanvas=S.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return le.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;let e=this.pathLength;return t>e?null:le.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=le.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();let e=this.textDecoration(),i=this.fill(),o=this.fontSize(),a=this.glyphInfo,l=e.indexOf("underline")!==-1,h=e.indexOf("line-through")!==-1;l&&t.beginPath();for(let u=0;u<a.length;u++){t.save();let p=a[u].p0;t.translate(p.x,p.y),t.rotate(a[u].rotation),this.partialText=a[u].text,t.fillStrokeShape(this),l&&(u===0&&t.moveTo(0,o/2+1),t.lineTo(a[u].width,o/2+1)),t.restore()}if(l&&(t.strokeStyle=i,t.lineWidth=o/20,t.stroke()),h){t.beginPath();for(let u=0;u<a.length;u++){t.save();let p=a[u].p0;t.translate(p.x,p.y),t.rotate(a[u].rotation),u===0&&t.moveTo(0,0),t.lineTo(a[u].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=o/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();let e=this.glyphInfo;if(e.length>=1){let i=e[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<e.length;i++){let o=e[i].p1;t.lineTo(o.x,o.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return S.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Tt.prototype.setText.call(this,t)}_getContextFont(){return Tt.prototype._getContextFont.call(this)}_getTextSize(t){let i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();let o=i.measureText(t);return i.restore(),{width:o.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let t=Rn(this.text()),e=[],i=0;for(let m=0;m<t.length;m++)e.push({char:t[m],width:this._getTextSize(t[m]).width}),i+=e[m].width;let{height:o}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=o,this.glyphInfo=[],!this.attrs.data)return null;let a=this.letterSpacing(),l=this.align(),h=this.kerningFunc(),u=Math.max(this.textWidth+((this.attrs.text||"").length-1)*a,0),p=0;l==="center"&&(p=Math.max(0,this.pathLength/2-u/2)),l==="right"&&(p=Math.max(0,this.pathLength-u));let g=p;for(let m=0;m<e.length;m++){let v=this._getPointAtLength(g);if(!v)return;let y=e[m].char,b=e[m].width+a;if(y===" "&&l==="justify"){let R=this.text().split(" ").length-1;b+=(this.pathLength-u)/R}let E=this._getPointAtLength(g+b);if(!E)return;let D=le.getLineLength(v.x,v.y,E.x,E.y),x=0;if(h)try{x=h(e[m-1].char,y)*this.fontSize()}catch{x=0}v.x+=x,E.x+=x,this.textWidth+=x;let A=le.getPointOnLine(x+D/2,v.x,v.y,E.x,E.y),T=Math.atan2(E.y-v.y,E.x-v.x);this.glyphInfo.push({transposeX:A.x,transposeY:A.y,text:t[m],rotation:T,p0:v,p1:E,width:D}),g+=b}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let t=[];this.glyphInfo.forEach(function(p){t.push(p.p0.x),t.push(p.p0.y),t.push(p.p1.x),t.push(p.p1.y)});let e=t[0]||0,i=t[0]||0,o=t[1]||0,a=t[1]||0,l,h;for(let p=0;p<t.length/2;p++)l=t[p*2],h=t[p*2+1],e=Math.min(e,l),i=Math.max(i,l),o=Math.min(o,h),a=Math.max(a,h);let u=this.fontSize();return{x:e-u/2,y:o-u/2,width:i-e+u,height:a-o+u}}destroy(){return S.releaseCanvas(this.dummyCanvas),super.destroy()}};zt.prototype._fillFunc=$f;zt.prototype._strokeFunc=Wf;zt.prototype._fillFuncHit=$f;zt.prototype._strokeFuncHit=Wf;zt.prototype.className="TextPath";zt.prototype._attrsAffectingSize=["text","fontSize","data"];lt(zt);w.addGetterSetter(zt,"data");w.addGetterSetter(zt,"fontFamily","Arial");w.addGetterSetter(zt,"fontSize",12,O());w.addGetterSetter(zt,"fontStyle",Hf);w.addGetterSetter(zt,"align","left");w.addGetterSetter(zt,"letterSpacing",0,O());w.addGetterSetter(zt,"textBaseline","middle");w.addGetterSetter(zt,"fontVariant",Hf);w.addGetterSetter(zt,"text",x1);w.addGetterSetter(zt,"textDecoration","");w.addGetterSetter(zt,"kerningFunc",void 0);var Yf="tr-konva",E1=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Yf}`).join(" "),Zf="nodesRect",M1=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],T1={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},P1="ontouchstart"in V._global;function A1(r,t,e){if(r==="rotater")return e;t+=S.degToRad(T1[r]||0);let i=(S.radToDeg(t)%360+360)%360;return S._inRange(i,315+22.5,360)||S._inRange(i,0,22.5)?"ns-resize":S._inRange(i,45-22.5,45+22.5)?"nesw-resize":S._inRange(i,90-22.5,90+22.5)?"ew-resize":S._inRange(i,135-22.5,135+22.5)?"nwse-resize":S._inRange(i,180-22.5,180+22.5)?"ns-resize":S._inRange(i,225-22.5,225+22.5)?"nesw-resize":S._inRange(i,270-22.5,270+22.5)?"ew-resize":S._inRange(i,315-22.5,315+22.5)?"nwse-resize":(S.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var oa=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],qf=1e8;function R1(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function Xf(r,t,e){let i=e.x+(r.x-e.x)*Math.cos(t)-(r.y-e.y)*Math.sin(t),o=e.y+(r.x-e.x)*Math.sin(t)+(r.y-e.y)*Math.cos(t);return Pt(j({},r),{rotation:r.rotation+t,x:i,y:o})}function O1(r,t){let e=R1(r);return Xf(r,t,e)}function I1(r,t,e){let i=t;for(let o=0;o<r.length;o++){let a=V.getAngle(r[o]),l=Math.abs(a-t)%(Math.PI*2);Math.min(l,Math.PI*2-l)<e&&(i=a)}return i}var Lc=0,bt=(()=>{class r extends Ke{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(E1,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return S.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Yf+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();let i=e.filter(a=>a.isAncestorOf(this)?(S.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=i,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(a=>{let l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(a._attrsAffectingSize.length){let h=a._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");a.on(h,l)}a.on(M1.map(h=>h+`.${this._getEventNamespace()}`).join(" "),l),a.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(a)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let i;e.on(`dragstart.${this._getEventNamespace()}`,o=>{i=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(o,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,o=>{if(!i)return;let a=e.getAbsolutePosition(),l=a.x-i.x,h=a.y-i.y;this.nodes().forEach(u=>{if(u===e||u.isDragging())return;let p=u.getAbsolutePosition();u.setAbsolutePosition({x:p.x+l,y:p.y+h}),u.startDrag(o)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Zf),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Zf,this.__getNodeRect)}__getNodeShape(e,i=this.rotation(),o){let a=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=e.getAbsoluteScale(o),h=e.getAbsolutePosition(o),u=a.x*l.x-e.offsetX()*l.x,p=a.y*l.y-e.offsetY()*l.y,g=(V.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),m={x:h.x+u*Math.cos(g)+p*Math.sin(-g),y:h.y+p*Math.cos(g)+u*Math.sin(g),width:a.width*l.x,height:a.height*l.y,rotation:g};return Xf(m,-V.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-qf,y:-qf,width:0,height:0,rotation:0};let i=[];this.nodes().map(g=>{let m=g.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),v=[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}],y=g.getAbsoluteTransform();v.forEach(function(b){let E=y.point(b);i.push(E)})});let o=new se;o.rotate(-V.getAngle(this.rotation()));let a=1/0,l=1/0,h=-1/0,u=-1/0;i.forEach(function(g){let m=o.point(g);a===void 0&&(a=h=m.x,l=u=m.y),a=Math.min(a,m.x),l=Math.min(l,m.y),h=Math.max(h,m.x),u=Math.max(u,m.y)}),o.invert();let p=o.point({x:a,y:l});return{x:p.x,y:p.y,width:h-a,height:u-l,rotation:V.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),oa.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){let i=new An({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:P1?10:"auto"}),o=this;i.on("mousedown touchstart",function(a){o._handleMouseDown(a)}),i.on("dragstart",a=>{i.stopDrag(),a.cancelBubble=!0}),i.on("dragend",a=>{a.cancelBubble=!0}),i.on("mouseenter",()=>{let a=V.getAngle(this.rotation()),l=this.rotateAnchorCursor(),h=A1(e,a,l);i.getStage().content&&(i.getStage().content.style.cursor=h),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let e=new I({name:"back",width:0,height:0,sceneFunc(i,o){let a=o.getParent(),l=a.padding(),h=o.width(),u=o.height();if(i.beginPath(),i.rect(-l,-l,h+l*2,u+l*2),a.rotateEnabled()&&a.rotateLineVisible()){let p=a.rotateAnchorAngle(),g=a.rotateAnchorOffset(),m=S.degToRad(p),v=Math.sin(m),y=-Math.cos(m),b=h/2,E=u/2,D=1/0;y<0?D=Math.min(D,-E/y):y>0&&(D=Math.min(D,(u-E)/y)),v<0?D=Math.min(D,-b/v):v>0&&(D=Math.min(D,(h-b)/v));let x=b+v*D,A=E+y*D,T=S._sign(u),R=x+v*g*T,z=A+y*g*T;i.moveTo(x,A),i.lineTo(R,z)}i.fillStrokeShape(o)},hitFunc:(i,o)=>{if(!this.shouldOverdrawWholeArea())return;let a=this.padding();i.beginPath(),i.rect(-a,-a,o.width()+a*2,o.height()+a*2),i.fillStrokeShape(o)}});this.add(e),this._proxyDrag(e),e.on("dragstart",i=>{i.cancelBubble=!0}),e.on("dragmove",i=>{i.cancelBubble=!0}),e.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];let i=this._getNodeRect(),o=i.width,a=i.height,l=Math.sqrt(Math.pow(o,2)+Math.pow(a,2));this.sin=Math.abs(a/l),this.cos=Math.abs(o/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let h=e.target.getAbsolutePosition(),u=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-h.x,y:u.y-h.y},Lc++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(p=>{p._fire("transformstart",{evt:e.evt,target:p})})}_handleMouseMove(e){let i,o,a,l=this.findOne("."+this._movingAnchorName),h=l.getStage();h.setPointersPositions(e);let u=h.getPointerPosition(),p={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y},g=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(p=this.anchorDragBoundFunc()(g,p,e)),l.setAbsolutePosition(p);let m=l.getAbsolutePosition();if(g.x===m.x&&g.y===m.y)return;if(this._movingAnchorName==="rotater"){let T=this._getNodeRect();i=l.x()-T.width/2,o=-l.y()+T.height/2;let R=V.getAngle(this.rotateAnchorAngle()),z=Math.atan2(-o,i)+Math.PI/2-R;T.height<0&&(z-=Math.PI);let $=V.getAngle(this.rotation())+z,H=V.getAngle(this.rotationSnapTolerance()),Y=I1(this.rotationSnaps(),$,H)-T.rotation,pt=O1(T,Y);this._fitNodesInto(pt,e);return}let v=this.shiftBehavior(),y;v==="inverted"?y=this.keepRatio()&&!e.shiftKey:v==="none"?y=this.keepRatio():y=this.keepRatio()||e.shiftKey;let b=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};a=Math.sqrt(Math.pow(T.x-l.x(),2)+Math.pow(T.y-l.y(),2));let R=this.findOne(".top-left").x()>T.x?-1:1,z=this.findOne(".top-left").y()>T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".top-left").x(T.x-i),this.findOne(".top-left").y(T.y-o)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};a=Math.sqrt(Math.pow(l.x()-T.x,2)+Math.pow(T.y-l.y(),2));let R=this.findOne(".top-right").x()<T.x?-1:1,z=this.findOne(".top-right").y()>T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".top-right").x(T.x+i),this.findOne(".top-right").y(T.y-o)}var E=l.position();this.findOne(".top-left").y(E.y),this.findOne(".bottom-right").x(E.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};a=Math.sqrt(Math.pow(T.x-l.x(),2)+Math.pow(l.y()-T.y,2));let R=T.x<l.x()?-1:1,z=l.y()<T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,l.x(T.x-i),l.y(T.y+o)}E=l.position(),this.findOne(".top-left").x(E.x),this.findOne(".bottom-right").y(E.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};a=Math.sqrt(Math.pow(l.x()-T.x,2)+Math.pow(l.y()-T.y,2));let R=this.findOne(".bottom-right").x()<T.x?-1:1,z=this.findOne(".bottom-right").y()<T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".bottom-right").x(T.x+i),this.findOne(".bottom-right").y(T.y+o)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(b=this.centeredScaling()||e.altKey,b){let T=this.findOne(".top-left"),R=this.findOne(".bottom-right"),z=T.x(),U=T.y(),$=this.getWidth()-R.x(),H=this.getHeight()-R.y();R.move({x:-z,y:-U}),T.move({x:$,y:H})}let D=this.findOne(".top-left").getAbsolutePosition();i=D.x,o=D.y;let x=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),A=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:o,width:x,height:A,rotation:V.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let o=this.getNode();Lc--,this._fire("transformend",{evt:e,target:o}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),o&&this._nodes.forEach(a=>{var l;a._fire("transformend",{evt:e,target:a}),(l=a.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,i){let o=this._getNodeRect(),a=1;if(S._inRange(e.width,-this.padding()*2-a,a)){this.update();return}if(S._inRange(e.height,-this.padding()*2-a,a)){this.update();return}let l=new se;if(l.rotate(V.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){let y=l.point({x:-this.padding()*2,y:0});e.x+=y.x,e.y+=y.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){let y=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){let y=l.point({x:0,y:-this.padding()*2});e.x+=y.x,e.y+=y.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let y=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){let y=this.boundBoxFunc()(o,e);y?e=y:S.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let h=1e7,u=new se;u.translate(o.x,o.y),u.rotate(o.rotation),u.scale(o.width/h,o.height/h);let p=new se,g=e.width/h,m=e.height/h;this.flipEnabled()===!1?(p.translate(e.x,e.y),p.rotate(e.rotation),p.translate(e.width<0?e.width:0,e.height<0?e.height:0),p.scale(Math.abs(g),Math.abs(m))):(p.translate(e.x,e.y),p.rotate(e.rotation),p.scale(g,m));let v=p.multiply(u.invert());this._nodes.forEach(y=>{var b;if(!y.getStage())return;let E=y.getParent().getAbsoluteTransform(),D=y.getTransform().copy();D.translate(y.offsetX(),y.offsetY());let x=new se;x.multiply(E.copy().invert()).multiply(v).multiply(E).multiply(D);let A=x.decompose();y.setAttrs(A),(b=y.getLayer())===null||b===void 0||b.batchDraw()}),this.rotation(S._getRotation(e.rotation)),this._nodes.forEach(y=>{this._fire("transform",{evt:i,target:y}),y._fire("transform",{evt:i,target:y})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,i){this.findOne(e).setAttrs(i)}update(){var e;let i=this._getNodeRect();this.rotation(S._getRotation(i.rotation));let o=i.width,a=i.height,l=this.enabledAnchors(),h=this.resizeEnabled(),u=this.padding(),p=this.anchorSize(),g=this.find("._anchor");g.forEach($=>{$.setAttrs({width:p,height:p,offsetX:p/2,offsetY:p/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:p/2+u,offsetY:p/2+u,visible:h&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:o/2,y:0,offsetY:p/2+u,visible:h&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:o,y:0,offsetX:p/2-u,offsetY:p/2+u,visible:h&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:a/2,offsetX:p/2+u,visible:h&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:o,y:a/2,offsetX:p/2-u,visible:h&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:a,offsetX:p/2+u,offsetY:p/2-u,visible:h&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:o/2,y:a,offsetY:p/2-u,visible:h&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:o,y:a,offsetX:p/2-u,offsetY:p/2-u,visible:h&&l.indexOf("bottom-right")>=0});let m=this.rotateAnchorAngle(),v=this.rotateAnchorOffset(),y=S.degToRad(m),b=Math.sin(y),E=-Math.cos(y),D=o/2,x=a/2,A=1/0;E<0?A=Math.min(A,-x/E):E>0&&(A=Math.min(A,(a-x)/E)),b<0?A=Math.min(A,-D/b):b>0&&(A=Math.min(A,(o-D)/b));let T=D+b*A,R=x+E*A,z=S._sign(a);this._batchChangeChild(".rotater",{x:T+b*v*z,y:R+E*v*z-u*E,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:o,height:a,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some($=>$.draggable()),x:0,y:0});let U=this.anchorStyleFunc();U&&g.forEach($=>{U($)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Ke.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return N.prototype.toObject.call(this)}clone(e){return N.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}return r.isTransforming=()=>Lc>0,r})();function L1(r){return r instanceof Array||S.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){oa.indexOf(t)===-1&&S.warn("Unknown anchor name: "+t+". Available names are: "+oa.join(", "))}),r||[]}bt.prototype.className="Transformer";lt(bt);w.addGetterSetter(bt,"enabledAnchors",oa,L1);w.addGetterSetter(bt,"flipEnabled",!0,ae());w.addGetterSetter(bt,"resizeEnabled",!0);w.addGetterSetter(bt,"anchorSize",10,O());w.addGetterSetter(bt,"rotateEnabled",!0);w.addGetterSetter(bt,"rotateLineVisible",!0);w.addGetterSetter(bt,"rotationSnaps",[]);w.addGetterSetter(bt,"rotateAnchorOffset",50,O());w.addGetterSetter(bt,"rotateAnchorAngle",0,O());w.addGetterSetter(bt,"rotateAnchorCursor","crosshair");w.addGetterSetter(bt,"rotationSnapTolerance",5,O());w.addGetterSetter(bt,"borderEnabled",!0);w.addGetterSetter(bt,"anchorStroke","rgb(0, 161, 255)");w.addGetterSetter(bt,"anchorStrokeWidth",1,O());w.addGetterSetter(bt,"anchorFill","white");w.addGetterSetter(bt,"anchorCornerRadius",0,O());w.addGetterSetter(bt,"borderStroke","rgb(0, 161, 255)");w.addGetterSetter(bt,"borderStrokeWidth",1,O());w.addGetterSetter(bt,"borderDash");w.addGetterSetter(bt,"keepRatio",!0);w.addGetterSetter(bt,"shiftBehavior","default");w.addGetterSetter(bt,"centeredScaling",!1);w.addGetterSetter(bt,"ignoreStroke",!1);w.addGetterSetter(bt,"padding",0,O());w.addGetterSetter(bt,"nodes");w.addGetterSetter(bt,"node");w.addGetterSetter(bt,"boundBoxFunc");w.addGetterSetter(bt,"anchorDragBoundFunc");w.addGetterSetter(bt,"anchorStyleFunc");w.addGetterSetter(bt,"shouldOverdrawWholeArea",!1);w.addGetterSetter(bt,"useSingleNodeRotation",!0);w.backCompat(bt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Ve=class extends I{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,V.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}};Ve.prototype.className="Wedge";Ve.prototype._centroid=!0;Ve.prototype._attrsAffectingSize=["radius"];lt(Ve);w.addGetterSetter(Ve,"radius",0,O());w.addGetterSetter(Ve,"angle",0,O());w.addGetterSetter(Ve,"clockwise",!1);w.backCompat(Ve,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Kf(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var k1=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],N1=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function F1(r,t){let e=r.data,i=r.width,o=r.height,a,l,h,u,p,g,m,v,y,b,E,D,x,A,T,R,z,U,$,H,Z=t+t+1,Y=i-1,pt=o-1,q=t+1,vt=q*(q+1)/2,Q=new Kf,X=k1[t],k=N1[t],Et=null,B=Q,tt=null,at=null;for(let K=1;K<Z;K++)B=B.next=new Kf,K===q&&(Et=B);B.next=Q,h=l=0;for(let K=0;K<o;K++){D=x=A=T=u=p=g=m=0,v=q*(R=e[l]),y=q*(z=e[l+1]),b=q*(U=e[l+2]),E=q*($=e[l+3]),u+=vt*R,p+=vt*z,g+=vt*U,m+=vt*$,B=Q;for(let et=0;et<q;et++)B.r=R,B.g=z,B.b=U,B.a=$,B=B.next;for(let et=1;et<q;et++)a=l+((Y<et?Y:et)<<2),u+=(B.r=R=e[a])*(H=q-et),p+=(B.g=z=e[a+1])*H,g+=(B.b=U=e[a+2])*H,m+=(B.a=$=e[a+3])*H,D+=R,x+=z,A+=U,T+=$,B=B.next;tt=Q,at=Et;for(let et=0;et<i;et++)e[l+3]=$=m*X>>k,$!==0?($=255/$,e[l]=(u*X>>k)*$,e[l+1]=(p*X>>k)*$,e[l+2]=(g*X>>k)*$):e[l]=e[l+1]=e[l+2]=0,u-=v,p-=y,g-=b,m-=E,v-=tt.r,y-=tt.g,b-=tt.b,E-=tt.a,a=h+((a=et+t+1)<Y?a:Y)<<2,D+=tt.r=e[a],x+=tt.g=e[a+1],A+=tt.b=e[a+2],T+=tt.a=e[a+3],u+=D,p+=x,g+=A,m+=T,tt=tt.next,v+=R=at.r,y+=z=at.g,b+=U=at.b,E+=$=at.a,D-=R,x-=z,A-=U,T-=$,at=at.next,l+=4;h+=i}for(let K=0;K<i;K++){x=A=T=D=p=g=m=u=0,l=K<<2,v=q*(R=e[l]),y=q*(z=e[l+1]),b=q*(U=e[l+2]),E=q*($=e[l+3]),u+=vt*R,p+=vt*z,g+=vt*U,m+=vt*$,B=Q;for(let it=0;it<q;it++)B.r=R,B.g=z,B.b=U,B.a=$,B=B.next;let et=i;for(let it=1;it<=t;it++)l=et+K<<2,u+=(B.r=R=e[l])*(H=q-it),p+=(B.g=z=e[l+1])*H,g+=(B.b=U=e[l+2])*H,m+=(B.a=$=e[l+3])*H,D+=R,x+=z,A+=U,T+=$,B=B.next,it<pt&&(et+=i);l=K,tt=Q,at=Et;for(let it=0;it<o;it++)a=l<<2,e[a+3]=$=m*X>>k,$>0?($=255/$,e[a]=(u*X>>k)*$,e[a+1]=(p*X>>k)*$,e[a+2]=(g*X>>k)*$):e[a]=e[a+1]=e[a+2]=0,u-=v,p-=y,g-=b,m-=E,v-=tt.r,y-=tt.g,b-=tt.b,E-=tt.a,a=K+((a=it+q)<pt?a:pt)*i<<2,u+=D+=tt.r=e[a],p+=x+=tt.g=e[a+1],g+=A+=tt.b=e[a+2],m+=T+=tt.a=e[a+3],tt=tt.next,v+=R=at.r,y+=z=at.g,b+=U=at.b,E+=$=at.a,D-=R,x-=z,A-=U,T-=$,at=at.next,l+=i}}var Jf=function(t){let e=Math.round(this.blurRadius());e>0&&F1(t,e)};w.addGetterSetter(N,"blurRadius",0,O(),w.afterSetFilter);var Qf=function(r){let t=this.brightness()*255,e=r.data,i=e.length;for(let o=0;o<i;o+=4)e[o]+=t,e[o+1]+=t,e[o+2]+=t};w.addGetterSetter(N,"brightness",0,O(),w.afterSetFilter);var tp=function(r){let t=this.brightness(),e=r.data,i=e.length;for(let o=0;o<i;o+=4)e[o]=Math.min(255,e[o]*t),e[o+1]=Math.min(255,e[o+1]*t),e[o+2]=Math.min(255,e[o+2]*t)};var ep=function(r){let t=Math.pow((this.contrast()+100)/100,2),e=r.data,i=e.length,o=150,a=150,l=150;for(let h=0;h<i;h+=4)o=e[h],a=e[h+1],l=e[h+2],o/=255,o-=.5,o*=t,o+=.5,o*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,o=o<0?0:o>255?255:o,a=a<0?0:a>255?255:a,l=l<0?0:l>255?255:l,e[h]=o,e[h+1]=a,e[h+2]=l};w.addGetterSetter(N,"contrast",0,O(),w.afterSetFilter);var np=function(r){var t,e,i,o,a,l,h,u,p;let g=r.data,m=r.width,v=r.height,y=Math.min(1,Math.max(0,(e=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&e!==void 0?e:.5)),b=Math.min(1,Math.max(0,(o=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&o!==void 0?o:.5)),D=(h={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(l=(a=this.embossDirection)===null||a===void 0?void 0:a.call(this))!==null&&l!==void 0?l:"top-left"])!==null&&h!==void 0?h:315,x=!!((p=(u=this.embossBlend)===null||u===void 0?void 0:u.call(this))!==null&&p!==void 0&&p),A=y*10,T=b*255,R=D*Math.PI/180,z=Math.cos(R),U=Math.sin(R),$=128/1020*A,H=new Uint8ClampedArray(g),Z=new Float32Array(m*v);for(let Q=0,X=0;X<g.length;X+=4,Q++)Z[Q]=.2126*H[X]+.7152*H[X+1]+.0722*H[X+2];let Y=[-1,0,1,-2,0,2,-1,0,1],pt=[-1,-2,-1,0,0,0,1,2,1],q=[-m-1,-m,-m+1,-1,0,1,m-1,m,m+1],vt=Q=>Q<0?0:Q>255?255:Q;for(let Q=1;Q<v-1;Q++)for(let X=1;X<m-1;X++){let k=Q*m+X,Et=0,B=0;Et+=Z[k+q[0]]*Y[0],B+=Z[k+q[0]]*pt[0],Et+=Z[k+q[1]]*Y[1],B+=Z[k+q[1]]*pt[1],Et+=Z[k+q[2]]*Y[2],B+=Z[k+q[2]]*pt[2],Et+=Z[k+q[3]]*Y[3],B+=Z[k+q[3]]*pt[3],Et+=Z[k+q[5]]*Y[5],B+=Z[k+q[5]]*pt[5],Et+=Z[k+q[6]]*Y[6],B+=Z[k+q[6]]*pt[6],Et+=Z[k+q[7]]*Y[7],B+=Z[k+q[7]]*pt[7],Et+=Z[k+q[8]]*Y[8],B+=Z[k+q[8]]*pt[8];let tt=z*Et+U*B,at=vt(T+tt*$),K=k*4;if(x){let et=at-T;g[K]=vt(H[K]+et),g[K+1]=vt(H[K+1]+et),g[K+2]=vt(H[K+2]+et),g[K+3]=H[K+3]}else g[K]=g[K+1]=g[K+2]=at,g[K+3]=H[K+3]}for(let Q=0;Q<m;Q++){let X=Q*4,k=((v-1)*m+Q)*4;g[X]=H[X],g[X+1]=H[X+1],g[X+2]=H[X+2],g[X+3]=H[X+3],g[k]=H[k],g[k+1]=H[k+1],g[k+2]=H[k+2],g[k+3]=H[k+3]}for(let Q=1;Q<v-1;Q++){let X=Q*m*4,k=(Q*m+(m-1))*4;g[X]=H[X],g[X+1]=H[X+1],g[X+2]=H[X+2],g[X+3]=H[X+3],g[k]=H[k],g[k+1]=H[k+1],g[k+2]=H[k+2],g[k+3]=H[k+3]}return r};w.addGetterSetter(N,"embossStrength",.5,O(),w.afterSetFilter);w.addGetterSetter(N,"embossWhiteLevel",.5,O(),w.afterSetFilter);w.addGetterSetter(N,"embossDirection","top-left",void 0,w.afterSetFilter);w.addGetterSetter(N,"embossBlend",!1,void 0,w.afterSetFilter);function kc(r,t,e,i,o){let a=e-t,l=o-i;if(a===0)return i+l/2;if(l===0)return i;let h=(r-t)/a;return h=l*h+i,h}var ip=function(r){let t=r.data,e=t.length,i=t[0],o=i,a,l=t[1],h=l,u,p=t[2],g=p,m,v=this.enhance();if(v===0)return;for(let T=0;T<e;T+=4)a=t[T+0],a<i?i=a:a>o&&(o=a),u=t[T+1],u<l?l=u:u>h&&(h=u),m=t[T+2],m<p?p=m:m>g&&(g=m);o===i&&(o=255,i=0),h===l&&(h=255,l=0),g===p&&(g=255,p=0);let y,b,E,D,x,A;if(v>0)y=o+v*(255-o),b=i-v*(i-0),E=h+v*(255-h),D=l-v*(l-0),x=g+v*(255-g),A=p-v*(p-0);else{let T=(o+i)*.5;y=o+v*(o-T),b=i+v*(i-T);let R=(h+l)*.5;E=h+v*(h-R),D=l+v*(l-R);let z=(g+p)*.5;x=g+v*(g-z),A=p+v*(p-z)}for(let T=0;T<e;T+=4)t[T+0]=kc(t[T+0],i,o,b,y),t[T+1]=kc(t[T+1],l,h,D,E),t[T+2]=kc(t[T+2],p,g,A,x)};w.addGetterSetter(N,"enhance",0,O(),w.afterSetFilter);var rp=function(r){let t=r.data,e=t.length;for(let i=0;i<e;i+=4){let o=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=o,t[i+1]=o,t[i+2]=o}};w.addGetterSetter(N,"hue",0,O(),w.afterSetFilter);w.addGetterSetter(N,"saturation",0,O(),w.afterSetFilter);w.addGetterSetter(N,"luminance",0,O(),w.afterSetFilter);var op=function(r){let t=r.data,e=t.length,i=1,o=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,l=this.luminance()*127,h=i*o*Math.cos(a*Math.PI/180),u=i*o*Math.sin(a*Math.PI/180),p=.299*i+.701*h+.167*u,g=.587*i-.587*h+.33*u,m=.114*i-.114*h-.497*u,v=.299*i-.299*h-.328*u,y=.587*i+.413*h+.035*u,b=.114*i-.114*h+.293*u,E=.299*i-.3*h+1.25*u,D=.587*i-.586*h-1.05*u,x=.114*i+.886*h-.2*u,A,T,R,z;for(let U=0;U<e;U+=4)A=t[U+0],T=t[U+1],R=t[U+2],z=t[U+3],t[U+0]=p*A+g*T+m*R+l,t[U+1]=v*A+y*T+b*R+l,t[U+2]=E*A+D*T+x*R+l,t[U+3]=z};var sp=function(r){let t=r.data,e=t.length,i=Math.pow(2,this.value()),o=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,l=i*o*Math.cos(a*Math.PI/180),h=i*o*Math.sin(a*Math.PI/180),u=.299*i+.701*l+.167*h,p=.587*i-.587*l+.33*h,g=.114*i-.114*l-.497*h,m=.299*i-.299*l-.328*h,v=.587*i+.413*l+.035*h,y=.114*i-.114*l+.293*h,b=.299*i-.3*l+1.25*h,E=.587*i-.586*l-1.05*h,D=.114*i+.886*l-.2*h;for(let x=0;x<e;x+=4){let A=t[x+0],T=t[x+1],R=t[x+2],z=t[x+3];t[x+0]=u*A+p*T+g*R,t[x+1]=m*A+v*T+y*R,t[x+2]=b*A+E*T+D*R,t[x+3]=z}};w.addGetterSetter(N,"hue",0,O(),w.afterSetFilter);w.addGetterSetter(N,"saturation",0,O(),w.afterSetFilter);w.addGetterSetter(N,"value",0,O(),w.afterSetFilter);var ap=function(r){let t=r.data,e=t.length;for(let i=0;i<e;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]};var B1=function(r,t,e){let i=r.data,o=t.data,a=r.width,l=r.height,h=e.polarCenterX||a/2,u=e.polarCenterY||l/2,p=Math.sqrt(h*h+u*u),g=a-h,m=l-u,v=Math.sqrt(g*g+m*m);p=v>p?v:p;let y=l,b=a,E=360/b*Math.PI/180;for(let D=0;D<b;D+=1){let x=Math.sin(D*E),A=Math.cos(D*E);for(let T=0;T<y;T+=1){g=Math.floor(h+p*T/y*A),m=Math.floor(u+p*T/y*x);let R=(m*a+g)*4,z=i[R+0],U=i[R+1],$=i[R+2],H=i[R+3];R=(D+T*a)*4,o[R+0]=z,o[R+1]=U,o[R+2]=$,o[R+3]=H}}},V1=function(r,t,e){let i=r.data,o=t.data,a=r.width,l=r.height,h=e.polarCenterX||a/2,u=e.polarCenterY||l/2,p=Math.sqrt(h*h+u*u),g=a-h,m=l-u,v=Math.sqrt(g*g+m*m);p=v>p?v:p;let y=l,b=a,E=e.polarRotation||0,D,x;for(g=0;g<a;g+=1)for(m=0;m<l;m+=1){let A=g-h,T=m-u,R=Math.sqrt(A*A+T*T)*y/p,z=(Math.atan2(T,A)*180/Math.PI+360+E)%360;z=z*b/360,D=Math.floor(z),x=Math.floor(R);let U=(x*a+D)*4,$=i[U+0],H=i[U+1],Z=i[U+2],Y=i[U+3];U=(m*a+g)*4,o[U+0]=$,o[U+1]=H,o[U+2]=Z,o[U+3]=Y}},lp=function(r){let t=r.width,e=r.height,i,o,a,l,h,u,p,g,m,v,y=Math.round(this.kaleidoscopePower()),b=Math.round(this.kaleidoscopeAngle()),E=Math.floor(t*(b%360)/360);if(y<1)return;let D=S.createCanvasElement();D.width=t,D.height=e;let x=D.getContext("2d").getImageData(0,0,t,e);S.releaseCanvas(D),B1(r,x,{polarCenterX:t/2,polarCenterY:e/2});let A=t/Math.pow(2,y);for(;A<=8;)A=A*2,y-=1;A=Math.ceil(A);let T=A,R=0,z=T,U=1;for(E+A>t&&(R=T,z=0,U=-1),o=0;o<e;o+=1)for(i=R;i!==z;i+=U)a=Math.round(i+E)%t,m=(t*o+a)*4,h=x.data[m+0],u=x.data[m+1],p=x.data[m+2],g=x.data[m+3],v=(t*o+i)*4,x.data[v+0]=h,x.data[v+1]=u,x.data[v+2]=p,x.data[v+3]=g;for(o=0;o<e;o+=1)for(T=Math.floor(A),l=0;l<y;l+=1){for(i=0;i<T+1;i+=1)m=(t*o+i)*4,h=x.data[m+0],u=x.data[m+1],p=x.data[m+2],g=x.data[m+3],v=(t*o+T*2-i-1)*4,x.data[v+0]=h,x.data[v+1]=u,x.data[v+2]=p,x.data[v+3]=g;T*=2}V1(x,r,{polarRotation:0})};w.addGetterSetter(N,"kaleidoscopePower",2,O(),w.afterSetFilter);w.addGetterSetter(N,"kaleidoscopeAngle",0,O(),w.afterSetFilter);function sa(r,t,e){let i=(e*r.width+t)*4,o=[];return o.push(r.data[i++],r.data[i++],r.data[i++],r.data[i++]),o}function Co(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function z1(r){let t=[0,0,0];for(let e=0;e<r.length;e++)t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function U1(r,t){let e=sa(r,0,0),i=sa(r,r.width-1,0),o=sa(r,0,r.height-1),a=sa(r,r.width-1,r.height-1),l=t||10;if(Co(e,i)<l&&Co(i,a)<l&&Co(a,o)<l&&Co(o,e)<l){let h=z1([i,e,a,o]),u=[];for(let p=0;p<r.width*r.height;p++){let g=Co(h,[r.data[p*4],r.data[p*4+1],r.data[p*4+2]]);u[p]=g<l?0:255}return u}}function G1(r,t){for(let e=0;e<r.width*r.height;e++)r.data[4*e+3]=t[e]}function j1(r,t,e){let i=[1,1,1,1,0,1,1,1,1],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<e;h++)for(let u=0;u<t;u++){let p=h*t+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<e&&b>=0&&b<t){let E=y*t+b,D=i[m*o+v];g+=r[E]*D}}l[p]=g===2040?255:0}return l}function H1(r,t,e){let i=[1,1,1,1,1,1,1,1,1],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<e;h++)for(let u=0;u<t;u++){let p=h*t+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<e&&b>=0&&b<t){let E=y*t+b,D=i[m*o+v];g+=r[E]*D}}l[p]=g>=1020?255:0}return l}function $1(r,t,e){let i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<e;h++)for(let u=0;u<t;u++){let p=h*t+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<e&&b>=0&&b<t){let E=y*t+b,D=i[m*o+v];g+=r[E]*D}}l[p]=g}return l}var cp=function(r){let t=this.threshold(),e=U1(r,t);return e&&(e=j1(e,r.width,r.height),e=H1(e,r.width,r.height),e=$1(e,r.width,r.height),G1(r,e)),r};w.addGetterSetter(N,"threshold",0,O(),w.afterSetFilter);var hp=function(r){let t=this.noise()*255,e=r.data,i=e.length,o=t/2;for(let a=0;a<i;a+=4)e[a+0]+=o-2*o*Math.random(),e[a+1]+=o-2*o*Math.random(),e[a+2]+=o-2*o*Math.random()};w.addGetterSetter(N,"noise",.2,O(),w.afterSetFilter);var up=function(r){let t=Math.ceil(this.pixelSize()),e=r.width,i=r.height,o=Math.ceil(e/t),a=Math.ceil(i/t),l=r.data;if(t<=0){S.error("pixelSize value can not be <= 0");return}for(let h=0;h<o;h+=1)for(let u=0;u<a;u+=1){let p=0,g=0,m=0,v=0,y=h*t,b=y+t,E=u*t,D=E+t,x=0;for(let A=y;A<b;A+=1)if(!(A>=e))for(let T=E;T<D;T+=1){if(T>=i)continue;let R=(e*T+A)*4;p+=l[R+0],g+=l[R+1],m+=l[R+2],v+=l[R+3],x+=1}p=p/x,g=g/x,m=m/x,v=v/x;for(let A=y;A<b;A+=1)if(!(A>=e))for(let T=E;T<D;T+=1){if(T>=i)continue;let R=(e*T+A)*4;l[R+0]=p,l[R+1]=g,l[R+2]=m,l[R+3]=v}}};w.addGetterSetter(N,"pixelSize",8,O(),w.afterSetFilter);var dp=function(r){let t=Math.round(this.levels()*254)+1,e=r.data,i=e.length,o=255/t;for(let a=0;a<i;a+=1)e[a]=Math.floor(e[a]/o)*o};w.addGetterSetter(N,"levels",.5,O(),w.afterSetFilter);var fp=function(r){let t=r.data,e=t.length,i=this.red(),o=this.green(),a=this.blue();for(let l=0;l<e;l+=4){let h=(.34*t[l]+.5*t[l+1]+.16*t[l+2])/255;t[l]=h*i,t[l+1]=h*o,t[l+2]=h*a,t[l+3]=t[l+3]}};w.addGetterSetter(N,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(N,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(N,"blue",0,Ws,w.afterSetFilter);var pp=function(r){let t=r.data,e=t.length,i=this.red(),o=this.green(),a=this.blue(),l=this.alpha();for(let h=0;h<e;h+=4){let u=1-l;t[h]=i*l+t[h]*u,t[h+1]=o*l+t[h+1]*u,t[h+2]=a*l+t[h+2]*u}};w.addGetterSetter(N,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(N,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(N,"blue",0,Ws,w.afterSetFilter);w.addGetterSetter(N,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var gp=function(r){let t=r.data,e=t.length;for(let i=0;i<e;i+=4){let o=t[i+0],a=t[i+1],l=t[i+2];t[i+0]=Math.min(255,o*.393+a*.769+l*.189),t[i+1]=Math.min(255,o*.349+a*.686+l*.168),t[i+2]=Math.min(255,o*.272+a*.534+l*.131)}};var mp=function(r){let e=r.data;for(let i=0;i<e.length;i+=4){let o=e[i],a=e[i+1],l=e[i+2];.2126*o+.7152*a+.0722*l>=128&&(e[i]=255-o,e[i+1]=255-a,e[i+2]=255-l)}return r};var _p=function(r){let t=this.threshold()*255,e=r.data,i=e.length;for(let o=0;o<i;o+=1)e[o]=e[o]<t?0:255};w.addGetterSetter(N,"threshold",.5,O(),w.afterSetFilter);var vp=Cc.Util._assign(Cc,{Arc:Be,Arrow:pn,Circle:Pn,Ellipse:Je,Image:we,Label:gr,Tag:gn,Line:Ee,Path:le,Rect:An,RegularPolygon:Qe,Ring:mn,Sprite:Me,Star:tn,Text:Tt,TextPath:zt,Transformer:bt,Wedge:Ve,Filters:{Blur:Jf,Brightness:tp,Brighten:Qf,Contrast:ep,Emboss:np,Enhance:ip,Grayscale:rp,HSL:op,HSV:sp,Invert:ap,Kaleidoscope:lp,Mask:cp,Noise:hp,Pixelate:up,Posterize:dp,RGB:fp,RGBA:pp,Sepia:gp,Solarize:mp,Threshold:_p}});var Te=vp;var aa=class r{constructor(){}createNodeMap(t){let e=new Map;for(let i of t)i.type==="node"&&i.lat!==void 0&&i.lon!==void 0&&e.set(i.id,{lat:i.lat,lon:i.lon});return e}async generatePoster(t,e,i,o,a,l,h,u,p,g,m=1200,v=1600){let y=new Te.Stage({container:t,width:m,height:v}),b=new Te.Layer;y.add(b);let E=new Te.Rect({x:0,y:0,width:m,height:v,fill:a.bg});b.add(E);let D=6378137,x=85.05112878,A=(at,K)=>{let et=Math.max(Math.min(at,x),-x),it=D*(K*Math.PI/180),dt=D*Math.log(Math.tan(Math.PI/4+et*Math.PI/180/2));return{x:it,y:dt}},T=A(u.lat,u.lon),R=1/Math.cos(u.lat*Math.PI/180),z=p*R,U=v/m,$=T.x-z,H=T.x+z,Z=T.y-z*U,Y=T.y+z*U,pt=H-$,q=Y-Z,vt={x:$,y:Z},Q=m/pt,X=q*Q,k=(m-pt*Q)/2,Et=(v-X)/2,B=(at,K)=>{let et=A(at,K);return{x:(et.x-vt.x)*Q+k,y:v-((et.y-vt.y)*Q+Et)}},tt=async(at,K,et,it)=>{let dt=this.createNodeMap(at.elements),ge=at.elements.filter(ne=>ne.type==="way"),ce=ge.length;if(ce===0)return;let _n=[],he=new Map,ti=1e3;for(let ne=0;ne<ce;ne++){if(ne%ti===0){let Ft=et+ne/ce*(it-et);g&&g(`Processing ${K}...`,Math.round(Ft)),await new Promise(Ut=>setTimeout(Ut,0))}let be=ge[ne];if(!be.nodes||be.nodes.length<2)continue;let Ce=[];for(let Ft of be.nodes){let Ut=dt.get(Ft);if(Ut){let Zt=B(Ut.lat,Ut.lon);Ce.push(Zt.x,Zt.y)}}if(!(Ce.length<4))if(K==="road"){let Ft=be.tags?.highway||"unclassified",Ut=a.road_default,Zt=1,Gt=0;["motorway","motorway_link"].includes(Ft)?(Ut=a.road_motorway,Zt=3,Gt=0):["trunk","trunk_link","primary","primary_link"].includes(Ft)?(Ut=a.road_primary,Zt=2.5,Gt=1):["secondary","secondary_link"].includes(Ft)?(Ut=a.road_secondary,Zt=2,Gt=2):["tertiary","tertiary_link"].includes(Ft)?(Ut=a.road_tertiary,Zt=1.5,Gt=3):["residential","living_street","unclassified"].includes(Ft)&&(Ut=a.road_residential,Zt=1,Gt=4);let ue=`${Ut}|${Zt}|${Gt}`;he.has(ue)||he.set(ue,[]),he.get(ue).push(Ce)}else _n.push(Ce)}if(dt.clear(),K==="water"||K==="park"){if(_n.length===0)return;let ne=K==="water"?a.water:a.parks,be=_n.slice();_n.length=0;let Ce=new Te.Shape({fill:ne,strokeEnabled:!1,listening:!1,sceneFunc:function(Ft,Ut){let Zt=be;Ft.beginPath();for(let Gt of Zt){Ft.moveTo(Gt[0],Gt[1]);for(let ue=2;ue<Gt.length;ue+=2)Ft.lineTo(Gt[ue],Gt[ue+1]);Ft.closePath()}Ft.fillStrokeShape(Ut)}});b.add(Ce)}if(K==="road"){if(he.size===0)return;let ne=Array.from(he.keys()).sort((Ce,Ft)=>{let Ut=parseInt(Ce.split("|")[2],10),Zt=parseInt(Ft.split("|")[2],10);return Ut-Zt}),be=2e3;for(let Ce of ne){let[Ft,Ut]=Ce.split("|"),Zt=parseFloat(Ut),Gt=he.get(Ce);for(let ue=0;ue<Gt.length;ue+=be){let Po=Gt.slice(ue,ue+be),br=new Te.Shape({stroke:Ft,strokeWidth:Zt,lineCap:"round",lineJoin:"round",listening:!1,sceneFunc:function(ei,Ao){let Da=Po;ei.beginPath();for(let ni of Da){ei.moveTo(ni[0],ni[1]);for(let On=2;On<ni.length;On+=2)ei.lineTo(ni[On],ni[On+1])}ei.fillStrokeShape(Ao)}});b.add(br)}Gt.length=0}he.clear()}b.batchDraw()};return(async()=>{try{g&&g("Water",10),await tt(i,"water",0,20),g&&g("Parks",20),await tt(o,"park",20,40),g&&g("Roads",40),await tt(e,"road",40,90),g&&g("Finalizing",95),await new Promise(ti=>setTimeout(ti,0));let at=new Te.Rect({x:0,y:0,width:m,height:v*.25,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:v*.25},fillLinearGradientColorStops:[0,a.gradient_color,1,"rgba(0,0,0,0)"]});b.add(at);let K=new Te.Rect({x:0,y:v*.75,width:m,height:v*.25,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:v*.25},fillLinearGradientColorStops:[0,"rgba(0,0,0,0)",1,a.gradient_color]});b.add(K);let et=new Te.Text({x:m/2,y:v*.86-50,text:l.toUpperCase().split("").join("  "),fontSize:60,fontFamily:"Roboto",fontStyle:"bold",fill:a.text,align:"center"});et.offsetX(et.width()/2),b.add(et);let it=new Te.Text({x:m/2,y:v*.9,text:h.toUpperCase(),fontSize:22,fontFamily:"Roboto",fontStyle:"normal",fill:a.text,align:"center"});it.offsetX(it.width()/2),b.add(it);let dt=u.lat>=0?`${u.lat.toFixed(4)}\xB0 N`:`${Math.abs(u.lat).toFixed(4)}\xB0 S`,ge=u.lon>=0?`${u.lon.toFixed(4)}\xB0 E`:`${Math.abs(u.lon).toFixed(4)}\xB0 W`,ce=new Te.Text({x:m/2,y:v*.93,text:`${dt} / ${ge}`,fontSize:14,fontFamily:"Roboto",fill:a.text,opacity:.7,align:"center"});ce.offsetX(ce.width()/2),b.add(ce);let _n=new Te.Line({points:[m*.4,v*.88,m*.6,v*.88],stroke:a.text,strokeWidth:1});b.add(_n);let he=new Te.Text({x:m-10,y:v-20,text:"\xA9 OpenStreetMap contributors",fontSize:10,fontFamily:"Roboto",fill:a.text,opacity:.5,align:"right"});he.offsetX(he.width()),b.add(he),b.batchDraw(),g&&g("Done",100)}catch(at){console.error("Background rendering error",at),g&&g("Error",0)}})(),y}static \u0275fac=function(e){return new(e||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})};var W1=["posterContainer"],Z1=["posterWrapper"];function q1(r,t){if(r&1&&(Se(0,"div",4),We(1,"div",7),$e()),r&2){let e,i=Rt();st(),vu("width",i.loadingProgress(),"%")("background-color",((e=i.theme())==null?null:e.text)||"#ffffff")}}var So=class r{roadsData=Lt(null);waterData=Lt(null);parksData=Lt(null);theme=Lt(null);city=Lt("");country=Lt("");coords=Lt(null);distance=Lt(1e4);isLoading=Lt(!1);posterContainer;posterWrapper;posterService=G(aa);stage=wt(null);loadingProgress=wt(0);loadingMessage=wt("Generating...");viewReady=wt(!1);resizeObserver;constructor(){Bn(async()=>{let t=this.roadsData(),e=this.waterData(),i=this.parksData(),o=this.theme(),a=this.coords(),l=this.distance(),h=this.isLoading(),u=this.viewReady();if(t&&e&&i&&o&&a&&!h&&u&&this.posterContainer){let p=re(()=>this.stage());p&&p.destroy(),this.loadingProgress.set(0),this.loadingMessage.set("Starting...");try{let g=await this.posterService.generatePoster(this.posterContainer.nativeElement.id,t,e,i,o,this.city(),this.country(),a,l,(m,v)=>{this.loadingProgress.set(v),re(()=>this.loadingMessage())!==m&&(console.log(`[Poster Generation] ${m} (${v}%)`),this.loadingMessage.set(m))});this.stage.set(g),this.loadingProgress.set(100),this.loadingMessage.set("Done"),setTimeout(()=>this.updateScale(),0)}catch(g){console.error("Poster Generation Error:",g),this.loadingMessage.set("Error generating poster"),this.loadingProgress.set(0)}}})}ngAfterViewInit(){this.viewReady.set(!0),this.posterWrapper&&(this.resizeObserver=new ResizeObserver(()=>{this.updateScale()}),this.resizeObserver.observe(this.posterWrapper.nativeElement))}ngOnDestroy(){this.resizeObserver?.disconnect();let t=this.stage();t&&(t.getLayers().forEach(e=>{e.destroyChildren(),e.destroy()}),t.destroy(),this.stage.set(null))}updateScale(){let t=this.stage();if(!t||!this.posterContainer||!this.posterWrapper)return;let e=this.posterWrapper.nativeElement.getBoundingClientRect(),i=t.width(),o=t.height();if(e.width===0||e.height===0)return;let a=60,l=e.width-a,h=e.height-a,u=Math.min(l/i,h/o),p=this.posterContainer.nativeElement;p.style.width=`${i}px`,p.style.height=`${o}px`,p.style.transform=`scale(${u})`,p.style.transformOrigin="top left";let g=p.parentElement;g&&(g.style.width=`${i*u}px`,g.style.height=`${o*u}px`)}download(t=2){let e=this.stage();if(e){let i=t,o=e.toDataURL({pixelRatio:i}),a=document.createElement("a"),l=i===1?"HD":i===2?"QHD":"4K";a.download=`${this.city()}_${this.theme()?.name||"style"}_${l}.png`,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a)}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-poster-view"]],viewQuery:function(e,i){if(e&1&&Gi(W1,5)(Z1,5),e&2){let o;hi(o=ui())&&(i.posterContainer=o.first),hi(o=ui())&&(i.posterWrapper=o.first)}},inputs:{roadsData:[1,"roadsData"],waterData:[1,"waterData"],parksData:[1,"parksData"],theme:[1,"theme"],city:[1,"city"],country:[1,"country"],coords:[1,"coords"],distance:[1,"distance"],isLoading:[1,"isLoading"]},decls:7,vars:1,consts:[["posterWrapper",""],["posterContainer",""],[1,"poster-wrapper"],[1,"w-full","h-full","flex","items-center","justify-center","overflow-hidden","bg-black","relative"],[1,"absolute","top-0","left-0","w-full","h-1","z-[99999]"],["id","poster-container-wrapper",1,"poster-container-wrapper"],["id","poster-container",1,"poster-container"],[1,"loading-bar","transition-all","duration-300","ease-out","shadow-[0_0_10px_rgba(255,255,255,0.5)]"]],template:function(e,i){e&1&&(Se(0,"div",2,0)(2,"div",3),ve(3,q1,2,4,"div",4),Se(4,"div",5),We(5,"div",6,1),$e()()()),e&2&&(st(3),ye(i.isLoading()||i.loadingProgress()<100?3:-1))},dependencies:[ee],styles:[".poster-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden;padding:20px}.poster-container-wrapper[_ngcontent-%COMP%]{position:relative;display:block;box-shadow:0 4px 50px #00000080}.poster-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;transform-origin:top left;background:#fff}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#121212e6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:200;color:#fff}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;font-family:Roboto,sans-serif;font-size:1.2rem;letter-spacing:1px;font-weight:300}.loading-bar[_ngcontent-%COMP%]{height:5px}"],changeDetection:0})};var Ep=(()=>{class r{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,i){this._renderer=e,this._elementRef=i}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(i){return new(i||r)(Kt(rs),Kt(ts))};static \u0275dir=je({type:r})}return r})(),Mp=(()=>{class r extends Ep{static \u0275fac=(()=>{let e;return function(o){return(e||(e=zi(r)))(o||r)}})();static \u0275dir=je({type:r,features:[ci]})}return r})(),fa=new yt("");var Y1={provide:fa,useExisting:Fr(()=>yr),multi:!0};function X1(){let r=Ne()?Ne().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var K1=new yt(""),yr=(()=>{class r extends Ep{_compositionMode;_composing=!1;constructor(e,i,o){super(e,i),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!X1())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(i){return new(i||r)(Kt(rs),Kt(ts),Kt(K1,8))};static \u0275dir=je({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&kt("input",function(l){return o._handleInput(l.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(l){return o._compositionEnd(l.target.value)})},standalone:!1,features:[zr([Y1]),ci]})}return r})();var Tp=new yt(""),Pp=new yt("");function Ap(r){return r!=null}function Rp(r){return os(r)?Le(r):r}function Op(r){let t={};return r.forEach(e=>{t=e!=null?j(j({},t),e):t}),Object.keys(t).length===0?null:t}function Ip(r,t){return t.map(e=>e(r))}function J1(r){return!r.validate}function Lp(r){return r.map(t=>J1(t)?t:e=>t.validate(e))}function Q1(r){if(!r)return null;let t=r.filter(Ap);return t.length==0?null:function(e){return Op(Ip(e,t))}}function kp(r){return r!=null?Q1(Lp(r)):null}function ty(r){if(!r)return null;let t=r.filter(Ap);return t.length==0?null:function(e){let i=Ip(e,t).map(Rp);return Ko(i).pipe(Bt(Op))}}function Np(r){return r!=null?ty(Lp(r)):null}function yp(r,t){return r===null?[t]:Array.isArray(r)?[...r,t]:[r,t]}function Fp(r){return r._rawValidators}function Bp(r){return r._rawAsyncValidators}function Nc(r){return r?Array.isArray(r)?r:[r]:[]}function ca(r,t){return Array.isArray(r)?r.includes(t):r===t}function wp(r,t){let e=Nc(t);return Nc(r).forEach(o=>{ca(e,o)||e.push(o)}),e}function bp(r,t){return Nc(t).filter(e=>!ca(r,e))}var ha=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=kp(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Np(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},Fc=class extends ha{name;get formDirective(){return null}get path(){return null}},xi=class extends ha{_parent=null;name=null;valueAccessor=null},Bc=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var pa=(()=>{class r extends Bc{constructor(e){super(e)}static \u0275fac=function(i){return new(i||r)(Kt(xi,2))};static \u0275dir=je({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&hn("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[ci]})}return r})();var Do="VALID",la="INVALID",_r="PENDING",xo="DISABLED",Ei=class{},ua=class extends Ei{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Eo=class extends Ei{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Mo=class extends Ei{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},vr=class extends Ei{status;source;constructor(t,e){super(),this.status=t,this.source=e}};var Vc=class extends Ei{source;constructor(t){super(),this.source=t}};function ey(r){return(ga(r)?r.validators:r)||null}function ny(r){return Array.isArray(r)?kp(r):r||null}function iy(r,t){return(ga(t)?t.asyncValidators:r)||null}function ry(r){return Array.isArray(r)?Np(r):r||null}function ga(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}var zc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return re(this.statusReactive)}set status(t){re(()=>this.statusReactive.set(t))}_status=di(()=>this.statusReactive());statusReactive=wt(void 0);get valid(){return this.status===Do}get invalid(){return this.status===la}get pending(){return this.status==_r}get disabled(){return this.status===xo}get enabled(){return this.status!==xo}errors;get pristine(){return re(this.pristineReactive)}set pristine(t){re(()=>this.pristineReactive.set(t))}_pristine=di(()=>this.pristineReactive());pristineReactive=wt(!0);get dirty(){return!this.pristine}get touched(){return re(this.touchedReactive)}set touched(t){re(()=>this.touchedReactive.set(t))}_touched=di(()=>this.touchedReactive());touchedReactive=wt(!1);get untouched(){return!this.touched}_events=new sn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(wp(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(wp(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(bp(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(bp(t,this._rawAsyncValidators))}hasValidator(t){return ca(this._rawValidators,t)}hasAsyncValidator(t){return ca(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(Pt(j({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Mo(!0,i))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new Mo(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(Pt(j({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Eo(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new Eo(!0,i))}markAsPending(t={}){this.status=_r;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new vr(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(Pt(j({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=xo,this.errors=null,this._forEachChild(o=>{o.disable(Pt(j({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ua(this.value,i)),this._events.next(new vr(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Pt(j({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Do,this._forEachChild(i=>{i.enable(Pt(j({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Pt(j({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Do||this.status===_r)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ua(this.value,e)),this._events.next(new vr(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(Pt(j({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xo:Do}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=_r,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1,shouldHaveEmitted:t!==!1};let i=Rp(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,o)=>i&&i._find(o),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new vr(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new Ge,this.statusChanges=new Ge}_calculateStatus(){return this._allControlsDisabled()?xo:this.errors?la:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_r)?_r:this._anyControlsHaveStatus(la)?la:Do}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),o&&this._events.next(new Eo(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Mo(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){ga(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=ny(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=ry(this._rawAsyncValidators)}};var ma=new yt("",{factory:()=>_a}),_a="always";function oy(r,t){return[...t.path,r]}function Vp(r,t,e=_a){ay(r,t),t.valueAccessor.writeValue(r.value),(r.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(r.disabled),cy(r,t),uy(r,t),hy(r,t),sy(r,t)}function Cp(r,t,e=!0){let i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),ly(r,t),r&&(t._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function da(r,t){r.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function sy(r,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};r.registerOnDisabledChange(e),t._registerOnDestroy(()=>{r._unregisterOnDisabledChange(e)})}}function ay(r,t){let e=Fp(r);t.validator!==null?r.setValidators(yp(e,t.validator)):typeof e=="function"&&r.setValidators([e]);let i=Bp(r);t.asyncValidator!==null?r.setAsyncValidators(yp(i,t.asyncValidator)):typeof i=="function"&&r.setAsyncValidators([i]);let o=()=>r.updateValueAndValidity();da(t._rawValidators,o),da(t._rawAsyncValidators,o)}function ly(r,t){let e=!1;if(r!==null){if(t.validator!==null){let o=Fp(r);if(Array.isArray(o)&&o.length>0){let a=o.filter(l=>l!==t.validator);a.length!==o.length&&(e=!0,r.setValidators(a))}}if(t.asyncValidator!==null){let o=Bp(r);if(Array.isArray(o)&&o.length>0){let a=o.filter(l=>l!==t.asyncValidator);a.length!==o.length&&(e=!0,r.setAsyncValidators(a))}}}let i=()=>{};return da(t._rawValidators,i),da(t._rawAsyncValidators,i),e}function cy(r,t){t.valueAccessor.registerOnChange(e=>{r._pendingValue=e,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&zp(r,t)})}function hy(r,t){t.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&zp(r,t),r.updateOn!=="submit"&&r.markAsTouched()})}function zp(r,t){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function uy(r,t){let e=(i,o)=>{t.valueAccessor.writeValue(i),o&&t.viewToModelUpdate(i)};r.registerOnChange(e),t._registerOnDestroy(()=>{r._unregisterOnChange(e)})}function Up(r,t){if(!r.hasOwnProperty("model"))return!1;let e=r.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function dy(r){return Object.getPrototypeOf(r.constructor)===Mp}function Gp(r,t){if(!t)return null;Array.isArray(t);let e,i,o;return t.forEach(a=>{a.constructor===yr?e=a:dy(a)?i=a:o=a}),o||i||e||null}function Sp(r,t){let e=r.indexOf(t);e>-1&&r.splice(e,1)}function Dp(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var Uc=class extends zc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,i){super(ey(e),iy(i,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ga(e)&&(e.nonNullable||e.initialValueIsDefault)&&(Dp(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),e.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,e?.emitEvent!==!1&&this._events.next(new Vc(this))}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Sp(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Sp(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){Dp(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var fy={provide:xi,useExisting:Fr(()=>Gc)},xp=Promise.resolve(),Gc=(()=>{class r extends xi{_changeDetectorRef;callSetDisabledState;control=new Uc;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Ge;constructor(e,i,o,a,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this._parent=e,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=Gp(this,a)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),Up(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Vp(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){xp.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,o=i!==0&&ul(i);xp.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?oy(e,this._parent):[e]}static \u0275fac=function(i){return new(i||r)(Kt(Fc,9),Kt(Tp,10),Kt(Pp,10),Kt(fa,10),Kt(Ur,8),Kt(ma,8))};static \u0275dir=je({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[zr([fy]),ci,Vi]})}return r})();var py={provide:fa,useExisting:Fr(()=>jc),multi:!0},jc=(()=>{class r extends Mp{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let e;return function(o){return(e||(e=zi(r)))(o||r)}})();static \u0275dir=je({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(i,o){i&1&&kt("change",function(l){return o.onChange(l.target.value)})("input",function(l){return o.onChange(l.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[zr([py]),ci]})}return r})();var jp=new yt(""),gy={provide:xi,useExisting:Fr(()=>Hc)},Hc=(()=>{class r extends xi{_ngModelWarningConfig;callSetDisabledState;viewModel;form;set isDisabled(e){}model;update=new Ge;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,i,o,a,l){super(),this._ngModelWarningConfig=a,this.callSetDisabledState=l,this._setValidators(e),this._setAsyncValidators(i),this.valueAccessor=Gp(this,o)}ngOnChanges(e){if(this._isControlChanged(e)){let i=e.form.previousValue;i&&Cp(i,this,!1),Vp(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}Up(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Cp(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}static \u0275fac=function(i){return new(i||r)(Kt(Tp,10),Kt(Pp,10),Kt(fa,10),Kt(jp,8),Kt(ma,8))};static \u0275dir=je({type:r,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],standalone:!1,features:[zr([gy]),ci,Vi]})}return r})();var Hp=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=Dn({type:r});static \u0275inj=Sn({})}return r})();var $p=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:ma,useValue:e.callSetDisabledState??_a}]}}static \u0275fac=function(i){return new(i||r)};static \u0275mod=Dn({type:r});static \u0275inj=Sn({imports:[Hp]})}return r})(),Wp=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:jp,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:ma,useValue:e.callSetDisabledState??_a}]}}static \u0275fac=function(i){return new(i||r)};static \u0275mod=Dn({type:r});static \u0275inj=Sn({imports:[Hp]})}return r})();var my=(r,t)=>t.place_id;function _y(r,t){if(r&1){let e=Ze();rt(0,"button",8),kt("click",function(){qt(e);let o=Rt();return Yt(o.clearSearch())}),At(1,"\xD7"),ct()}}function vy(r,t){if(r&1){let e=Ze();rt(0,"li",9),kt("click",function(){let o=qt(e).$implicit,a=Rt(2);return Yt(a.selectSuggestion(o))}),rt(1,"span",10),At(2),ct(),rt(3,"span",11),At(4),ct()()}if(r&2){let e=t.$implicit;st(2),xn(e.display_name.split(",")[0]),st(2),xn(e.display_name)}}function yy(r,t){if(r&1&&(rt(0,"ul",7),Vn(1,vy,5,2,"li",null,my),ct()),r&2){let e=Rt();st(),zn(e.suggestions())}}var va=class r{geocoding=G(sr);searchControl=new Uc("");suggestions=wt([]);showSuggestions=wt(!1);locationSelected=Un();constructor(){this.searchControl.valueChanges.pipe(eu(300),nu(),an(t=>(t?.length??0)>2),ke(t=>this.geocoding.search(t))).subscribe(t=>{this.suggestions.set(t),this.showSuggestions.set(!0)})}selectSuggestion(t){this.searchControl.setValue(t.display_name.split(",")[0],{emitEvent:!1}),this.showSuggestions.set(!1),this.locationSelected.emit(t)}clearSearch(){this.searchControl.setValue(""),this.suggestions.set([])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-search-bar"]],outputs:{locationSelected:"locationSelected"},decls:8,vars:3,consts:[[1,"search-container"],[1,"input-wrapper"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["placeholder","Search for a city...","type","text",3,"focus","formControl"],[1,"clear-btn"],[1,"suggestions-list"],[1,"clear-btn",3,"click"],[3,"click"],[1,"main-text"],[1,"sub-text"]],template:function(e,i){e&1&&(rt(0,"div",0)(1,"div",1),cn(),rt(2,"svg",2),Jt(3,"circle",3)(4,"line",4),ct(),Fn(),rt(5,"input",5),kt("focus",function(){return i.showSuggestions.set(!0)}),ct(),ve(6,_y,2,0,"button",6),ct(),ve(7,yy,3,0,"ul",7),ct()),e&2&&(st(5),fe("formControl",i.searchControl),st(),ye(i.searchControl.value?6:-1),st(),ye(i.showSuggestions()&&i.suggestions().length>0?7:-1))},dependencies:[ee,Wp,yr,pa,Hc],styles:[".search-container[_ngcontent-%COMP%]{position:absolute;top:20px;left:50%;transform:translate(-50%);width:90%;max-width:400px;z-index:2000;font-family:Inter,sans-serif}.input-wrapper[_ngcontent-%COMP%]{background:#1e1e1ee6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:25px;padding:10px 20px;display:flex;align-items:center;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1)}.icon[_ngcontent-%COMP%]{color:#aaa;margin-right:10px;width:18px;height:18px}input[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;width:100%;font-size:16px;outline:none}.clear-btn[_ngcontent-%COMP%]{background:none;border:none;color:#aaa;font-size:20px;cursor:pointer;padding:0 5px}.suggestions-list[_ngcontent-%COMP%]{list-style:none;margin:10px 0 0;padding:0;background:#1e1e1ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1)}li[_ngcontent-%COMP%]{padding:12px 20px;cursor:pointer;border-bottom:1px solid rgba(255,255,255,.05);display:flex;flex-direction:column}li[_ngcontent-%COMP%]:last-child{border-bottom:none}li[_ngcontent-%COMP%]:hover{background:#ffffff1a}.main-text[_ngcontent-%COMP%]{color:#fff;font-weight:500;font-size:15px}.sub-text[_ngcontent-%COMP%]{color:#aaa;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})};function wy(r,t){if(r&1&&(cn(),Se(0,"svg",0),We(1,"rect",2)(2,"path",3)(3,"path",4)(4,"path",5),Se(5,"g",6),We(6,"path",7)(7,"path",8)(8,"path",9)(9,"path",10),$e(),Se(10,"g",11),We(11,"path",12)(12,"path",13)(13,"path",14)(14,"path",15),$e(),We(15,"path",16),Se(16,"text",17),At(17,"MAP"),$e(),Se(18,"text",18),At(19,"PREVIEW"),$e()()),r&2){let e=t;st(),He("fill",e.bg),st(),He("fill",e.water),st(),He("fill",e.water),st(),He("fill",e.parks),st(),He("stroke",e.road_primary),st(5),He("stroke",e.road_secondary),st(5),He("stroke",e.road_motorway),st(),He("fill",e.text),st(2),He("fill",e.text)}}function by(r,t){r&1&&We(0,"div",1)}var wr=class r{theme=Lt(null);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-theme-preview-svg"]],inputs:{theme:[1,"theme"]},decls:2,vars:1,consts:[["viewBox","0 0 100 140","xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid slice",1,"preview-svg"],[1,"skeleton"],["width","100","height","140"],["d","M0,60 C30,50 40,80 60,75 S90,60 100,70 L100,140 L0,140 Z","opacity","0.3"],["d","M-10,120 C20,115 50,125 100,110 L100,140 L-10,140 Z"],["d","M10,20 Q25,10 40,25 T70,30 Q80,10 90,25 L95,60 Q80,70 60,65 T20,80 Z","opacity","0.8"],["stroke-width","2","fill","none","stroke-linecap","round"],["d","M30,-5 L30,145"],["d","M70,-5 L70,145"],["d","M-5,40 L105,50"],["d","M-5,90 L105,80"],["stroke-width","1","fill","none","stroke-opacity","0.8"],["d","M50,-5 L50,145"],["d","M-5,20 L105,25"],["d","M-5,60 L105,65"],["d","M-5,110 L105,105"],["d","M-5,100 C30,95 60,105 105,90","stroke-width","3","fill","none"],["x","50","y","125","font-family","sans-serif","font-size","8","font-weight","bold","text-anchor","middle","letter-spacing","1"],["x","50","y","133","font-family","sans-serif","font-size","4","font-weight","normal","text-anchor","middle","letter-spacing","0.5","opacity","0.7"]],template:function(e,i){if(e&1&&ve(0,wy,20,9,":svg:svg",0)(1,by,1,0,"div",1),e&2){let o;ye((o=i.theme())?0:1,o)}},dependencies:[ee],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.preview-svg[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:inherit}.skeleton[_ngcontent-%COMP%]{width:100%;height:100%;background:#444;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.6}50%{opacity:1}to{opacity:.6}}"]})};function Cy(r,t){if(r&1){let e=Ze();rt(0,"div",6),kt("click",function(){let o=qt(e).$implicit,a=Rt();return Yt(a.selectTheme(o))}),rt(1,"div",7),Jt(2,"app-theme-preview-svg",8),rt(3,"span",9),At(4),ct()()()}if(r&2){let e=t.$implicit,i=Rt();hn("active",i.currentTheme()===e),st(2),fe("theme",i.themeData()[e]),st(2),xn(e)}}var ya=class r{themeService=G(Zn);themes=Lt([]);currentTheme=Lt("");themeSelected=Un();themeData=wt({});constructor(){Bn(()=>{let t=this.themes();t.length>0&&this.loadThemes(t)})}loadThemes(t){t.forEach(e=>{this.themeData()[e]||this.themeService.loadTheme(e).subscribe(i=>{this.themeData.update(o=>Pt(j({},o),{[e]:i}))})})}selectTheme(t){this.themeSelected.emit(t)}onWheel(t,e){t.deltaY!==0&&(t.preventDefault(),e.scrollLeft+=t.deltaY+t.deltaX)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-style-selector"]],inputs:{themes:[1,"themes"],currentTheme:[1,"currentTheme"]},outputs:{themeSelected:"themeSelected"},decls:10,vars:0,consts:[["scrollContainer",""],[1,"selector-container"],[1,"header"],[1,"badge"],[1,"styles-scroll",3,"wheel"],[1,"style-card",3,"active"],[1,"style-card",3,"click"],[1,"preview"],[3,"theme"],[1,"theme-name"]],template:function(e,i){if(e&1){let o=Ze();rt(0,"div",1)(1,"div",2)(2,"h3"),At(3,"Styles"),ct(),rt(4,"span",3),At(5,"Curated"),ct()(),rt(6,"div",4,0),kt("wheel",function(l){qt(o);let h=_u(7);return Yt(i.onWheel(l,h))}),Vn(8,Cy,5,4,"div",5,ss),ct()()}e&2&&(st(8),zn(i.themes()))},dependencies:[ee,wr],styles:[".selector-container[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;background:#141414f2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-top-left-radius:25px;border-top-right-radius:25px;padding:20px 0;z-index:1000;box-shadow:0 -5px 20px #00000080;font-family:Inter,sans-serif}.header[_ngcontent-%COMP%]{padding:0 25px 15px;display:flex;align-items:center;gap:10px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:18px;font-weight:600}.header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#ffffff1a;color:#aaa;font-size:11px;padding:2px 8px;border-radius:10px}.styles-scroll[_ngcontent-%COMP%]{display:flex;gap:15px;overflow-x:auto;padding:0 25px 10px;scroll-behavior:smooth}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff4d}.style-card[_ngcontent-%COMP%]{flex:0 0 100px;cursor:pointer;transition:transform .2s}.style-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.style-card.active[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border:2px solid #fff;transform:scale(1.05)}.preview[_ngcontent-%COMP%]{height:140px;border-radius:18px;display:flex;align-items:flex-end;padding:10px;background:#333;position:relative;overflow:hidden;border:2px solid transparent;transition:all .2s}app-theme-preview-svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0}.theme-name[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:500;text-shadow:0 1px 3px rgb(0,0,0);z-index:1;position:relative;text-transform:capitalize}"]})};var wa=class r{distance=Lt.required();distanceChange=Un();displayValue=di(()=>(this.distance()/1e3).toFixed(1));onValueChange(t){this.distanceChange.emit(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-distance-control"]],inputs:{distance:[1,"distance"]},outputs:{distanceChange:"distanceChange"},decls:13,vars:2,consts:[[1,"distance-container"],[1,"label"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["d","M21 6H3"],["d","M21 18H3"],["d","M3 6v12"],["d","M21 6v12"],["d","M7 6v12"],["d","M17 6v12"],[1,"slider-wrapper"],["type","range","min","1000","max","25000","step","500",1,"custom-range",3,"ngModelChange","ngModel"]],template:function(e,i){e&1&&(rt(0,"div",0)(1,"div",1),cn(),rt(2,"svg",2),Jt(3,"path",3)(4,"path",4)(5,"path",5)(6,"path",6)(7,"path",7)(8,"path",8),ct(),Fn(),rt(9,"span"),At(10),ct()(),rt(11,"div",9)(12,"input",10),kt("ngModelChange",function(a){return i.onValueChange(a)}),ct()()()),e&2&&(st(10),wu("Distance: ",i.displayValue()," km"),st(2),fe("ngModel",i.distance()))},dependencies:[ee,$p,yr,jc,pa,Gc],styles:[".distance-container[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;left:auto;transform:none;width:250px;z-index:1000;background:var(--surface-glass, rgba(30, 30, 30, .9));backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:20px;padding:15px 20px;box-shadow:var(--shadow-glass, 0 8px 32px 0 rgba(0, 0, 0, .37));border:1px solid var(--border-glass, rgba(255, 255, 255, .1));display:flex;flex-direction:column;gap:10px;transition:opacity .3s}.label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--text-secondary, #aaa);font-size:13px;font-weight:500}.label[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:16px;height:16px}.slider-wrapper[_ngcontent-%COMP%]{width:100%;padding:5px 0}.custom-range[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:6px;background:#444;border-radius:3px;outline:none;cursor:pointer}.custom-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:18px;height:18px;background:var(--primary-color, #6200ee);border-radius:50%;border:2px solid white;box-shadow:0 2px 5px #0000004d;transition:transform .1s}.custom-range[_ngcontent-%COMP%]::-webkit-slider-thumb:hover{transform:scale(1.1)}.custom-range[_ngcontent-%COMP%]::-moz-range-thumb{width:18px;height:18px;background:var(--primary-color, #6200ee);border-radius:50%;border:2px solid white;cursor:pointer;box-shadow:0 2px 5px #0000004d}"]})};var Sy=(r,t)=>t.id;function Dy(r,t){if(r&1&&(Se(0,"div",2)(1,"span"),At(2),$e()()),r&2){let e=t.$implicit;yu(e.type),st(2),xn(e.message)}}var To=class r{toasts=wt([]);show(t,e="info"){let i=Date.now();this.toasts.update(o=>[...o,{id:i,message:t,type:e}]),setTimeout(()=>this.remove(i),3e3)}remove(t){this.toasts.update(e=>e.filter(i=>i.id!==t))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=nt({token:r,factory:r.\u0275fac,providedIn:"root"})},ba=class r{toastService=G(To);toasts=this.toastService.toasts;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-toast-container"]],decls:3,vars:0,consts:[[1,"toast-container"],[1,"toast",3,"class"],[1,"toast"]],template:function(e,i){e&1&&(Se(0,"div",0),Vn(1,Dy,3,3,"div",1,Sy),$e()),e&2&&(st(),zn(i.toasts()))},dependencies:[ee],styles:[".toast-container[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);display:flex;flex-direction:column;gap:10px;z-index:9999;pointer-events:none}.toast[_ngcontent-%COMP%]{background:#1e1e1ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#fff;padding:12px 24px;border-radius:12px;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1);font-size:14px;animation:_ngcontent-%COMP%_slideUp .3s ease-out;display:flex;align-items:center}.toast.error[_ngcontent-%COMP%]{border-left:4px solid #cf6679}.toast.success[_ngcontent-%COMP%]{border-left:4px solid #03dac6}.toast.info[_ngcontent-%COMP%]{border-left:4px solid #6200ee}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};function xy(r,t){if(r&1&&Jt(0,"app-theme-preview-svg",5),r&2){let e=Rt().$implicit,i=Rt();fe("theme",i.themeData()[e])}}function Ey(r,t){if(r&1){let e=Ze();rt(0,"div",3),kt("click",function(){let o=qt(e).$implicit,a=Rt();return Yt(a.selectTheme(o))}),rt(1,"div",4),ve(2,xy,1,1,"app-theme-preview-svg",5),ct(),rt(3,"div",6)(4,"span",7),At(5),ct(),rt(6,"span",8),At(7,"Click to apply"),ct()()()}if(r&2){let e=t.$implicit,i=Rt();hn("active",i.currentTheme()===e),st(2),ye(i.themeData()[e]?2:-1),st(3),xn(e.replace("_"," "))}}var Ca=class r{themeService=G(Zn);themes=Lt([]);currentTheme=Lt("");themeSelected=Un();themeData=wt({});constructor(){Bn(()=>{let t=this.themes();t.length>0&&this.loadThemes(t)})}loadThemes(t){t.forEach(e=>{this.themeData()[e]||this.themeService.loadTheme(e).subscribe(i=>{this.themeData.update(o=>Pt(j({},o),{[e]:i}))})})}selectTheme(t){this.themeSelected.emit(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-sidebar-style-selector"]],inputs:{themes:[1,"themes"],currentTheme:[1,"currentTheme"]},outputs:{themeSelected:"themeSelected"},decls:4,vars:0,consts:[[1,"sidebar-selector"],[1,"list-container"],[1,"theme-item",3,"active"],[1,"theme-item",3,"click"],[1,"preview-box"],[3,"theme"],[1,"theme-info"],[1,"name"],[1,"helper"]],template:function(e,i){e&1&&(rt(0,"div",0)(1,"div",1),Vn(2,Ey,8,4,"div",2,ss),ct()()),e&2&&(st(2),zn(i.themes()))},dependencies:[ee,wr],styles:[".sidebar-selector[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:auto;overflow-x:hidden;padding:0 5px 0 0}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding-bottom:20px}.theme-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:12px;cursor:pointer;transition:all .2s ease}.theme-item[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:#ffffff4d}.theme-item.active[_ngcontent-%COMP%]{background:rgba(var(--primary-rgb, 100, 100, 255),.2);border-color:rgba(var(--primary-rgb, 100, 100, 255),.6);box-shadow:0 0 15px rgba(var(--primary-rgb, 100, 100, 255),.1)}.theme-item.active[_ngcontent-%COMP%]   .theme-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:#fff;font-weight:700}.preview-box[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:8px;overflow:hidden;position:relative;background:#222;flex-shrink:0;border:1px solid rgba(255,255,255,.1)}.preview-box[_ngcontent-%COMP%]   app-theme-preview-svg[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.theme-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.theme-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1rem;color:#eee;text-transform:capitalize;font-weight:500;margin-bottom:2px}.theme-info[_ngcontent-%COMP%]   .helper[_ngcontent-%COMP%]{font-size:.75rem;color:#888}"],changeDetection:0})};var My=(r,t)=>({lat:r,lon:t});function Ty(r,t){if(r&1){let e=Ze();rt(0,"div",3)(1,"div",5),Jt(2,"app-poster-view",6),rt(3,"button",7),kt("click",function(){qt(e);let o=Rt();return Yt(o.closePoster())}),cn(),rt(4,"svg",8),Jt(5,"line",9)(6,"line",10),ct()()(),Fn(),rt(7,"div",11)(8,"div",12)(9,"h2"),At(10,"Your Art"),ct(),rt(11,"p"),At(12,"Ready for print"),ct()(),rt(13,"div",13)(14,"button",14),kt("click",function(){qt(e);let o=Rt();return Yt(o.downloadPoster(o.resolution()))}),cn(),rt(15,"svg",8),Jt(16,"path",15)(17,"polyline",16)(18,"line",17),ct(),At(19," Download PNG "),ct(),Fn(),rt(20,"div",18)(21,"span",19),At(22,"Resolution:"),ct(),rt(23,"div",20)(24,"button",21),kt("click",function(){qt(e);let o=Rt();return Yt(o.resolution.set(1))}),At(25,"1080p"),ct(),rt(26,"button",21),kt("click",function(){qt(e);let o=Rt();return Yt(o.resolution.set(2))}),At(27,"4K"),ct(),rt(28,"button",21),kt("click",function(){qt(e);let o=Rt();return Yt(o.resolution.set(3))}),At(29,"8K"),ct()()()(),rt(30,"div",22)(31,"h3"),At(32,"Try other styles"),ct(),rt(33,"app-sidebar-style-selector",23),kt("themeSelected",function(o){qt(e);let a=Rt();return Yt(a.onThemeSelected(o))}),ct()()()()}if(r&2){let e=Rt();st(2),fe("isLoading",e.isLoading())("city",e.city())("country",e.country())("coords",bu(17,My,e.lat(),e.lon()))("distance",e.distance())("theme",e.currentTheme())("roadsData",e.roadsData())("waterData",e.waterData())("parksData",e.parksData()),st(22),hn("active",e.resolution()===1),st(2),hn("active",e.resolution()===2),st(2),hn("active",e.resolution()===3),st(5),fe("themes",e.themes)("currentTheme",e.currentThemeName())}}function Py(r,t){r&1&&Jt(0,"div",28)}function Ay(r,t){r&1&&(cn(),rt(0,"svg",8),Jt(1,"path",29)(2,"path",30),ct(),Fn(),rt(3,"span"),At(4,"Generate Art"),ct())}function Ry(r,t){if(r&1){let e=Ze();rt(0,"app-search-bar",24),kt("locationSelected",function(o){qt(e);let a=Rt();return Yt(a.onLocationSelected(o))}),ct(),rt(1,"app-distance-control",25),kt("distanceChange",function(o){qt(e);let a=Rt();return Yt(a.distance.set(o))}),ct(),rt(2,"app-style-selector",23),kt("themeSelected",function(o){qt(e);let a=Rt();return Yt(a.onThemeSelected(o))}),ct(),rt(3,"div",26)(4,"button",27),kt("click",function(){qt(e);let o=Rt();return Yt(o.generatePoster())}),ve(5,Py,1,0,"div",28)(6,Ay,5,0),ct()()}if(r&2){let e=Rt();st(),fe("distance",e.distance()),st(),fe("themes",e.themes)("currentTheme",e.currentThemeName()),st(2),fe("disabled",e.isLoading()),st(),ye(e.isLoading()?5:6)}}function Oy(r,t){r&1&&(rt(0,"div",4)(1,"div",31),Jt(2,"div",32),rt(3,"p"),At(4,"Fetching Map Data..."),ct()()())}var Sa=class r{geocodingService=G(sr);themeService=G(Zn);overpassService=G(Bs);toastService=G(To);lat=wt(45.1885);lon=wt(5.7245);distance=wt(1e4);city=wt("Grenoble");country=wt("France");themes=this.themeService.getAvailableThemes();currentThemeName=wt("midnight_blue");currentTheme=wt(null);roadsData=wt(null);waterData=wt(null);parksData=wt(null);isLoading=wt(!1);showPoster=wt(!1);constructor(){this.loadTheme(this.currentThemeName())}onLocationSelected(t){this.lat.set(parseFloat(t.lat)),this.lon.set(parseFloat(t.lon));let e=t.display_name.split(", ");this.city.set(e[0]),this.country.set(e[e.length-1]),this.showPoster.set(!1)}onThemeSelected(t){this.currentThemeName.set(t),this.loadTheme(t),this.toastService.show(`Theme '${t}' selected.`,"info")}loadTheme(t){this.themeService.loadTheme(t).subscribe(e=>{this.currentTheme.set(e)})}posterView;closePoster(){this.showPoster.set(!1),this.roadsData.set(null),this.waterData.set(null),this.parksData.set(null)}generatePoster(){this.distance()>15e3&&this.toastService.show("\u26A0\uFE0F Large area selected. This may take a while and use significant memory.","info"),this.showPoster.set(!1),this.isLoading.set(!0);let t=this.distance()*(4/3),e=this.overpassService.getBbox(this.lat(),this.lon(),this.distance(),t),i=this.distance()>1e4;Ko({roads:this.overpassService.fetchRoads(e,i),water:this.overpassService.fetchWater(e),parks:this.overpassService.fetchParks(e)}).pipe(kr(o=>{console.error("Error fetching data",o);let a="Error fetching map data. Try a smaller area or different location.";return o.status===504?a="Server is unreachable (504). Please try again later.":o.status===429&&(a="Too many requests (429). Please wait a bit."),this.toastService.show(a,"error"),this.isLoading.set(!1),mt(null)})).subscribe(o=>{o&&(this.roadsData.set(o.roads),this.waterData.set(o.water),this.parksData.set(o.parks),this.showPoster.set(!0)),this.isLoading.set(!1)})}resolution=wt(2);downloadPoster(t){this.posterView?.download(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=Wt({type:r,selectors:[["app-root"]],viewQuery:function(e,i){if(e&1&&Gi(So,5),e&2){let o;hi(o=ui())&&(i.posterView=o.first)}},decls:7,vars:6,consts:[[1,"app-container"],[1,"map-layer"],[3,"lat","lon","distance"],[1,"poster-layer"],[1,"loading-overlay"],[1,"poster-preview-area"],[3,"isLoading","city","country","coords","distance","theme","roadsData","waterData","parksData"],[1,"close-poster-btn","custom-btn","icon-only",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"poster-sidebar"],[1,"sidebar-header"],[1,"download-section"],[1,"custom-btn","primary","full-width",3,"click"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"resolution-options"],[1,"res-label"],[1,"res-buttons"],[1,"res-btn",3,"click"],[1,"theme-section"],[3,"themeSelected","themes","currentTheme"],[3,"locationSelected"],[3,"distanceChange","distance"],[1,"actions-container"],[1,"action-btn","generate-btn","custom-btn","primary",3,"click","disabled"],[1,"spinner"],["d","M12 2a10 10 0 0 1 10 10c0 5.52-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16z"],["d","M12 6v6l4 2"],[1,"loading-content"],[1,"big-spinner"]],template:function(e,i){e&1&&(rt(0,"div",0)(1,"div",1),Jt(2,"app-map-preview",2),ct(),ve(3,Ty,34,20,"div",3),ve(4,Ry,7,5),ve(5,Oy,5,0,"div",4),Jt(6,"app-toast-container"),ct()),e&2&&(st(2),fe("lat",i.lat())("lon",i.lon())("distance",i.distance()),st(),ye(i.showPoster()?3:-1),st(),ye(i.showPoster()?-1:4),st(),ye(i.isLoading()&&!i.showPoster()?5:-1))},dependencies:[ee,zs,So,va,ya,wa,ba,Ca],styles:["[_nghost-%COMP%]{display:block;height:100vh;width:100vw;overflow:hidden;font-family:Inter,sans-serif;box-sizing:border-box;--primary-color: #6200ee;--accent-color: #03dac6;--bg-dark: #121212;--surface-glass: rgba(30, 30, 30, .85);--border-glass: rgba(255, 255, 255, .1);--text-primary: #ffffff;--text-secondary: #aaaaaa;--shadow-glass: 0 8px 32px 0 rgba(0, 0, 0, .37)}*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}.app-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background:#121212}.map-layer[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.poster-layer[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:3000;background:#000;display:flex;flex-direction:row;overflow:hidden}.poster-preview-area[_ngcontent-%COMP%]{flex:1;height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:40px;background:radial-gradient(circle at center,#1a1a1a,#000);overflow:hidden}.poster-preview-area[_ngcontent-%COMP%]   app-poster-view[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.poster-preview-area[_ngcontent-%COMP%]   .close-poster-btn[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:#00000080;color:#fff;z-index:10}.poster-preview-area[_ngcontent-%COMP%]   .close-poster-btn[_ngcontent-%COMP%]:hover{background:#000c}.poster-sidebar[_ngcontent-%COMP%]{width:400px;height:100%;background:#18181b;border-left:1px solid rgba(255,255,255,.1);display:flex;flex-direction:column;padding:30px;box-shadow:-10px 0 30px #00000080;z-index:3002}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{margin-bottom:30px}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:700;color:#fff;letter-spacing:-.5px}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#a1a1aa;font-size:1rem}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid rgba(255,255,255,.1)}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]{margin-top:15px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-label[_ngcontent-%COMP%]{display:block;color:#a1a1aa;font-size:.8rem;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn[_ngcontent-%COMP%]{flex:1;padding:8px;border:1px solid rgba(255,255,255,.1);background:#ffffff0d;color:#d4d4d8;border-radius:8px;cursor:pointer;font-size:.9rem;transition:all .2s}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn.active[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;border-color:var(--primary-color);font-weight:600}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding-top:20px}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 15px;color:#d4d4d8;font-size:.85rem;text-transform:uppercase;letter-spacing:1.5px;font-weight:600}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]   app-sidebar-style-selector[_ngcontent-%COMP%]{flex:1;width:100%;height:100%;overflow:hidden}.full-width[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:16px;font-size:1.1rem;font-weight:600;border-radius:12px}.actions-container[_ngcontent-%COMP%]{position:absolute;bottom:180px;right:20px;z-index:2000;display:flex;flex-direction:column;gap:15px}.action-btn[_ngcontent-%COMP%]{border:none;border-radius:30px;padding:12px 24px;display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:600;box-shadow:0 4px 10px #0000004d;transition:transform .2s,box-shadow .2s}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #0006}.action-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.generate-btn[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;font-size:16px;padding:15px 30px}.custom-btn[_ngcontent-%COMP%]{border:none;border-radius:12px;padding:10px 20px;font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .2s;color:#fff;background:#ffffff1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1)}.custom-btn[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-2px)}.custom-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.custom-btn.primary[_ngcontent-%COMP%]{background:var(--primary-color);box-shadow:0 4px 15px #6200ee66}.custom-btn.primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #6200ee99}.custom-btn.accent[_ngcontent-%COMP%]{background:var(--accent-color);color:#000;box-shadow:0 4px 15px #03dac666}.custom-btn.accent[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #03dac699}.custom-btn.icon-only[_ngcontent-%COMP%]{padding:10px;border-radius:50%;width:40px;height:40px;justify-content:center}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:var(--primary-color);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}svg.icon[_ngcontent-%COMP%]{width:20px;height:20px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000000b3;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:5000;display:flex;justify-content:center;align-items:center}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;color:#fff}.loading-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:500;letter-spacing:.5px}.big-spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:5px solid rgba(255,255,255,.1);border-radius:50%;border-top-color:var(--primary-color);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}"],changeDetection:0})};bl(Sa,Yd).catch(r=>console.error(r));
