import{$ as et,$a as Yt,A as ki,Aa as Qo,B as eu,Ba as es,C as qo,Ca as tt,D as Nn,Da as uu,E as Ka,Ea as rl,F as tu,Fa as du,G as Bt,Ga as ol,H as Yo,Ha as Xe,I as Dn,Ia as En,J as Te,Ja as Wt,K as Ja,Ka as li,L as kr,La as fu,M as ie,Ma as ts,N as xn,Na as pu,O as nu,Oa as sl,P as ye,Pa as Zt,Q as ve,Qa as wt,R as U,Ra as bt,S as Fi,Sa as ns,T as iu,Ta as zn,U as un,Ua as Un,V as yt,Va as gt,W as Je,Wa as oe,X as Qe,Xa as he,Y as dn,Ya as nt,Z as Bn,Za as Et,_ as Ni,_a as qt,a as j,aa as Fr,ab as Xt,b as Oe,ba as ru,bb as Ve,c as Ya,ca as $t,cb as ke,d as pm,da as ai,db as Ui,e as gm,ea as Qa,eb as ci,f as Zh,fa as el,fb as hi,g as qh,ga as De,gb as gu,h as $o,ha as ou,hb as mu,i as cn,ia as su,ib as fn,j as kt,ja as Vn,jb as _u,k as Ft,ka as lt,kb as Ie,l as Nt,la as Bi,lb as Mn,m as _e,ma as Vi,mb as vu,n as Yh,na as Xo,nb as Br,o as Xa,oa as au,ob as yu,p as Xh,pa as tl,pb as wu,q as Be,qa as lu,qb as bu,r as Kh,ra as zi,rb as ui,s as Fn,sa as cu,sb as Gn,t as Jh,ta as nl,tb as Ue,u as Wo,ua as Ko,ub as Vr,v as Zo,va as ae,vb as Cu,w as hn,wa as Nr,wb as al,x as Ir,xa as hu,y as Lr,ya as Jo,z as Qh,za as il}from"./chunk-GSN7NLYZ.js";var Yd=pm((ks,qd)=>{"use strict";(function(r,e){typeof ks=="object"&&typeof qd<"u"?e(ks):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.leaflet={}))})(ks,function(r){"use strict";var e="1.9.4";function t(n){var s,c,d,p;for(c=1,d=arguments.length;c<d;c++){p=arguments[c];for(s in p)n[s]=p[s]}return n}var i=Object.create||(function(){function n(){}return function(s){return n.prototype=s,new n}})();function o(n,s){var c=Array.prototype.slice;if(n.bind)return n.bind.apply(n,c.call(arguments,1));var d=c.call(arguments,2);return function(){return n.apply(s,d.length?d.concat(c.call(arguments)):arguments)}}var a=0;function l(n){return"_leaflet_id"in n||(n._leaflet_id=++a),n._leaflet_id}function h(n,s,c){var d,p,_,C;return C=function(){d=!1,p&&(_.apply(c,p),p=!1)},_=function(){d?p=arguments:(n.apply(c,arguments),setTimeout(C,s),d=!0)},_}function u(n,s,c){var d=s[1],p=s[0],_=d-p;return n===d&&c?n:((n-p)%_+_)%_+p}function f(){return!1}function g(n,s){if(s===!1)return n;var c=Math.pow(10,s===void 0?6:s);return Math.round(n*c)/c}function m(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function v(n){return m(n).split(/\s+/)}function y(n,s){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?i(n.options):{});for(var c in s)n.options[c]=s[c];return n.options}function b(n,s,c){var d=[];for(var p in n)d.push(encodeURIComponent(c?p.toUpperCase():p)+"="+encodeURIComponent(n[p]));return(!s||s.indexOf("?")===-1?"?":"&")+d.join("&")}var E=/\{ *([\w_ -]+) *\}/g;function D(n,s){return n.replace(E,function(c,d){var p=s[d];if(p===void 0)throw new Error("No value provided for variable "+c);return typeof p=="function"&&(p=p(s)),p})}var x=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function A(n,s){for(var c=0;c<n.length;c++)if(n[c]===s)return c;return-1}var T="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function R(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var z=0;function G(n){var s=+new Date,c=Math.max(0,16-(s-z));return z=s+c,window.setTimeout(n,c)}var $=window.requestAnimationFrame||R("RequestAnimationFrame")||G,H=window.cancelAnimationFrame||R("CancelAnimationFrame")||R("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function Z(n,s,c){if(c&&$===G)n.call(s);else return $.call(window,o(n,s))}function K(n){n&&H.call(window,n)}var ge={__proto__:null,extend:t,create:i,bind:o,get lastId(){return a},stamp:l,throttle:h,wrapNum:u,falseFn:f,formatNum:g,trim:m,splitWords:v,setOptions:y,getParamString:b,template:D,isArray:x,indexOf:A,emptyImageUrl:T,requestFn:$,cancelFn:H,requestAnimFrame:Z,cancelAnimFrame:K};function Y(){}Y.extend=function(n){var s=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=s.__super__=this.prototype,d=i(c);d.constructor=s,s.prototype=d;for(var p in this)Object.prototype.hasOwnProperty.call(this,p)&&p!=="prototype"&&p!=="__super__"&&(s[p]=this[p]);return n.statics&&t(s,n.statics),n.includes&&(we(n.includes),t.apply(null,[d].concat(n.includes))),t(d,n),delete d.statics,delete d.includes,d.options&&(d.options=c.options?i(c.options):{},t(d.options,n.options)),d._initHooks=[],d.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var _=0,C=d._initHooks.length;_<C;_++)d._initHooks[_].call(this)}},s},Y.include=function(n){var s=this.prototype.options;return t(this.prototype,n),n.options&&(this.prototype.options=s,this.mergeOptions(n.options)),this},Y.mergeOptions=function(n){return t(this.prototype.options,n),this},Y.addInitHook=function(n){var s=Array.prototype.slice.call(arguments,1),c=typeof n=="function"?n:function(){this[n].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function we(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=x(n)?n:[n];for(var s=0;s<n.length;s++)n[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var re={on:function(n,s,c){if(typeof n=="object")for(var d in n)this._on(d,n[d],s);else{n=v(n);for(var p=0,_=n.length;p<_;p++)this._on(n[p],s,c)}return this},off:function(n,s,c){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var d in n)this._off(d,n[d],s);else{n=v(n);for(var p=arguments.length===1,_=0,C=n.length;_<C;_++)p?this._off(n[_]):this._off(n[_],s,c)}return this},_on:function(n,s,c,d){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(n,s,c)===!1){c===this&&(c=void 0);var p={fn:s,ctx:c};d&&(p.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(p)}},_off:function(n,s,c){var d,p,_;if(this._events&&(d=this._events[n],!!d)){if(arguments.length===1){if(this._firingCount)for(p=0,_=d.length;p<_;p++)d[p].fn=f;delete this._events[n];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var C=this._listens(n,s,c);if(C!==!1){var M=d[C];this._firingCount&&(M.fn=f,this._events[n]=d=d.slice()),d.splice(C,1)}}},fire:function(n,s,c){if(!this.listens(n,c))return this;var d=t({},s,{type:n,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var p=this._events[n];if(p){this._firingCount=this._firingCount+1||1;for(var _=0,C=p.length;_<C;_++){var M=p[_],P=M.fn;M.once&&this.off(n,P,M.ctx),P.call(M.ctx||this,d)}this._firingCount--}}return c&&this._propagateEvent(d),this},listens:function(n,s,c,d){typeof n!="string"&&console.warn('"string" type argument expected');var p=s;typeof s!="function"&&(d=!!s,p=void 0,c=void 0);var _=this._events&&this._events[n];if(_&&_.length&&this._listens(n,p,c)!==!1)return!0;if(d){for(var C in this._eventParents)if(this._eventParents[C].listens(n,s,c,d))return!0}return!1},_listens:function(n,s,c){if(!this._events)return!1;var d=this._events[n]||[];if(!s)return!!d.length;c===this&&(c=void 0);for(var p=0,_=d.length;p<_;p++)if(d[p].fn===s&&d[p].ctx===c)return p;return!1},once:function(n,s,c){if(typeof n=="object")for(var d in n)this._on(d,n[d],s,!0);else{n=v(n);for(var p=0,_=n.length;p<_;p++)this._on(n[p],s,c,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[l(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[l(n)],this},_propagateEvent:function(n){for(var s in this._eventParents)this._eventParents[s].fire(n.type,t({layer:n.target,propagatedFrom:n.target},n),!0)}};re.addEventListener=re.on,re.removeEventListener=re.clearAllEventListeners=re.off,re.addOneTimeEventListener=re.once,re.fireEvent=re.fire,re.hasEventListeners=re.listens;var Q=Y.extend(re);function k(n,s,c){this.x=c?Math.round(n):n,this.y=c?Math.round(s):s}var Se=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};k.prototype={clone:function(){return new k(this.x,this.y)},add:function(n){return this.clone()._add(B(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(B(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new k(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new k(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Se(this.x),this.y=Se(this.y),this},distanceTo:function(n){n=B(n);var s=n.x-this.x,c=n.y-this.y;return Math.sqrt(s*s+c*c)},equals:function(n){return n=B(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=B(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function B(n,s,c){return n instanceof k?n:x(n)?new k(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new k(n.x,n.y):new k(n,s,c)}function ne(n,s){if(n)for(var c=s?[n,s]:n,d=0,p=c.length;d<p;d++)this.extend(c[d])}ne.prototype={extend:function(n){var s,c;if(!n)return this;if(n instanceof k||typeof n[0]=="number"||"x"in n)s=c=B(n);else if(n=be(n),s=n.min,c=n.max,!s||!c)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=c.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(n){return B((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return B(this.min.x,this.max.y)},getTopRight:function(){return B(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var s,c;return typeof n[0]=="number"||n instanceof k?n=B(n):n=be(n),n instanceof ne?(s=n.min,c=n.max):s=c=n,s.x>=this.min.x&&c.x<=this.max.x&&s.y>=this.min.y&&c.y<=this.max.y},intersects:function(n){n=be(n);var s=this.min,c=this.max,d=n.min,p=n.max,_=p.x>=s.x&&d.x<=c.x,C=p.y>=s.y&&d.y<=c.y;return _&&C},overlaps:function(n){n=be(n);var s=this.min,c=this.max,d=n.min,p=n.max,_=p.x>s.x&&d.x<c.x,C=p.y>s.y&&d.y<c.y;return _&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var s=this.min,c=this.max,d=Math.abs(s.x-c.x)*n,p=Math.abs(s.y-c.y)*n;return be(B(s.x-d,s.y-p),B(c.x+d,c.y+p))},equals:function(n){return n?(n=be(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function be(n,s){return!n||n instanceof ne?n:new ne(n,s)}function q(n,s){if(n)for(var c=s?[n,s]:n,d=0,p=c.length;d<p;d++)this.extend(c[d])}q.prototype={extend:function(n){var s=this._southWest,c=this._northEast,d,p;if(n instanceof X)d=n,p=n;else if(n instanceof q){if(d=n._southWest,p=n._northEast,!d||!p)return this}else return n?this.extend(te(n)||J(n)):this;return!s&&!c?(this._southWest=new X(d.lat,d.lng),this._northEast=new X(p.lat,p.lng)):(s.lat=Math.min(d.lat,s.lat),s.lng=Math.min(d.lng,s.lng),c.lat=Math.max(p.lat,c.lat),c.lng=Math.max(p.lng,c.lng)),this},pad:function(n){var s=this._southWest,c=this._northEast,d=Math.abs(s.lat-c.lat)*n,p=Math.abs(s.lng-c.lng)*n;return new q(new X(s.lat-d,s.lng-p),new X(c.lat+d,c.lng+p))},getCenter:function(){return new X((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new X(this.getNorth(),this.getWest())},getSouthEast:function(){return new X(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof X||"lat"in n?n=te(n):n=J(n);var s=this._southWest,c=this._northEast,d,p;return n instanceof q?(d=n.getSouthWest(),p=n.getNorthEast()):d=p=n,d.lat>=s.lat&&p.lat<=c.lat&&d.lng>=s.lng&&p.lng<=c.lng},intersects:function(n){n=J(n);var s=this._southWest,c=this._northEast,d=n.getSouthWest(),p=n.getNorthEast(),_=p.lat>=s.lat&&d.lat<=c.lat,C=p.lng>=s.lng&&d.lng<=c.lng;return _&&C},overlaps:function(n){n=J(n);var s=this._southWest,c=this._northEast,d=n.getSouthWest(),p=n.getNorthEast(),_=p.lat>s.lat&&d.lat<c.lat,C=p.lng>s.lng&&d.lng<c.lng;return _&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,s){return n?(n=J(n),this._southWest.equals(n.getSouthWest(),s)&&this._northEast.equals(n.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function J(n,s){return n instanceof q?n:new q(n,s)}function X(n,s,c){if(isNaN(n)||isNaN(s))throw new Error("Invalid LatLng object: ("+n+", "+s+")");this.lat=+n,this.lng=+s,c!==void 0&&(this.alt=+c)}X.prototype={equals:function(n,s){if(!n)return!1;n=te(n);var c=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return c<=(s===void 0?1e-9:s)},toString:function(n){return"LatLng("+g(this.lat,n)+", "+g(this.lng,n)+")"},distanceTo:function(n){return rt.distance(this,te(n))},wrap:function(){return rt.wrapLatLng(this)},toBounds:function(n){var s=180*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return J([this.lat-s,this.lng-c],[this.lat+s,this.lng+c])},clone:function(){return new X(this.lat,this.lng,this.alt)}};function te(n,s,c){return n instanceof X?n:x(n)&&typeof n[0]!="object"?n.length===3?new X(n[0],n[1],n[2]):n.length===2?new X(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new X(n.lat,"lng"in n?n.lng:n.lon,n.alt):s===void 0?null:new X(n,s,c)}var Ze={latLngToPoint:function(n,s){var c=this.projection.project(n),d=this.scale(s);return this.transformation._transform(c,d)},pointToLatLng:function(n,s){var c=this.scale(s),d=this.transformation.untransform(n,c);return this.projection.unproject(d)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var s=this.projection.bounds,c=this.scale(n),d=this.transformation.transform(s.min,c),p=this.transformation.transform(s.max,c);return new ne(d,p)},infinite:!1,wrapLatLng:function(n){var s=this.wrapLng?u(n.lng,this.wrapLng,!0):n.lng,c=this.wrapLat?u(n.lat,this.wrapLat,!0):n.lat,d=n.alt;return new X(c,s,d)},wrapLatLngBounds:function(n){var s=n.getCenter(),c=this.wrapLatLng(s),d=s.lat-c.lat,p=s.lng-c.lng;if(d===0&&p===0)return n;var _=n.getSouthWest(),C=n.getNorthEast(),M=new X(_.lat-d,_.lng-p),P=new X(C.lat-d,C.lng-p);return new q(M,P)}},rt=t({},Ze,{wrapLng:[-180,180],R:6371e3,distance:function(n,s){var c=Math.PI/180,d=n.lat*c,p=s.lat*c,_=Math.sin((s.lat-n.lat)*c/2),C=Math.sin((s.lng-n.lng)*c/2),M=_*_+Math.cos(d)*Math.cos(p)*C*C,P=2*Math.atan2(Math.sqrt(M),Math.sqrt(1-M));return this.R*P}}),Rt=6378137,ze={R:Rt,MAX_LATITUDE:85.0511287798,project:function(n){var s=Math.PI/180,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,n.lat),-c),p=Math.sin(d*s);return new k(this.R*n.lng*s,this.R*Math.log((1+p)/(1-p))/2)},unproject:function(n){var s=180/Math.PI;return new X((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*s,n.x*s/this.R)},bounds:(function(){var n=Rt*Math.PI;return new ne([-n,-n],[n,n])})()};function Pe(n,s,c,d){if(x(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=s,this._c=c,this._d=d}Pe.prototype={transform:function(n,s){return this._transform(n.clone(),s)},_transform:function(n,s){return s=s||1,n.x=s*(this._a*n.x+this._b),n.y=s*(this._c*n.y+this._d),n},untransform:function(n,s){return s=s||1,new k((n.x/s-this._b)/this._a,(n.y/s-this._d)/this._c)}};function Ge(n,s,c,d){return new Pe(n,s,c,d)}var ce=t({},rt,{code:"EPSG:3857",projection:ze,transformation:(function(){var n=.5/(Math.PI*ze.R);return Ge(n,.5,-n,.5)})()}),ue=t({},ce,{code:"EPSG:900913"});function Le(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Ke(n,s){var c="",d,p,_,C,M,P;for(d=0,_=n.length;d<_;d++){for(M=n[d],p=0,C=M.length;p<C;p++)P=M[p],c+=(p?"L":"M")+P.x+" "+P.y;c+=s?ee.svg?"z":"x":""}return c||"M0 0"}var Dt=document.documentElement.style,ft="ActiveXObject"in window,ti=ft&&!document.addEventListener,_t="msLaunchUri"in navigator&&!("documentMode"in document),xt=on("webkit"),Uc=on("android"),Gc=on("android 2")||on("android 3"),Wp=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Zp=Uc&&on("Google")&&Wp<537&&!("AudioNode"in window),wa=!!window.opera,jc=!_t&&on("chrome"),Hc=on("gecko")&&!xt&&!wa&&!ft,qp=!jc&&on("safari"),$c=on("phantom"),Wc="OTransition"in Dt,Yp=navigator.platform.indexOf("Win")===0,Zc=ft&&"transition"in Dt,ba="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Gc,qc="MozPerspective"in Dt,Xp=!window.L_DISABLE_3D&&(Zc||ba||qc)&&!Wc&&!$c,wr=typeof orientation<"u"||on("mobile"),Kp=wr&&xt,Jp=wr&&ba,Yc=!window.PointerEvent&&window.MSPointerEvent,Xc=!!(window.PointerEvent||Yc),Kc="ontouchstart"in window||!!window.TouchEvent,Qp=!window.L_NO_TOUCH&&(Kc||Xc),eg=wr&&wa,tg=wr&&Hc,ng=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ig=(function(){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",f,s),window.removeEventListener("testPassiveEventSupport",f,s)}catch{}return n})(),rg=(function(){return!!document.createElement("canvas").getContext})(),Ca=!!(document.createElementNS&&Le("svg").createSVGRect),og=!!Ca&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),sg=!Ca&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var s=n.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}})(),ag=navigator.platform.indexOf("Mac")===0,lg=navigator.platform.indexOf("Linux")===0;function on(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var ee={ie:ft,ielt9:ti,edge:_t,webkit:xt,android:Uc,android23:Gc,androidStock:Zp,opera:wa,chrome:jc,gecko:Hc,safari:qp,phantom:$c,opera12:Wc,win:Yp,ie3d:Zc,webkit3d:ba,gecko3d:qc,any3d:Xp,mobile:wr,mobileWebkit:Kp,mobileWebkit3d:Jp,msPointer:Yc,pointer:Xc,touch:Qp,touchNative:Kc,mobileOpera:eg,mobileGecko:tg,retina:ng,passiveEvents:ig,canvas:rg,svg:Ca,vml:sg,inlineSvg:og,mac:ag,linux:lg},Jc=ee.msPointer?"MSPointerDown":"pointerdown",Qc=ee.msPointer?"MSPointerMove":"pointermove",eh=ee.msPointer?"MSPointerUp":"pointerup",th=ee.msPointer?"MSPointerCancel":"pointercancel",Sa={touchstart:Jc,touchmove:Qc,touchend:eh,touchcancel:th},nh={touchstart:pg,touchmove:Mo,touchend:Mo,touchcancel:Mo},Ei={},ih=!1;function cg(n,s,c){return s==="touchstart"&&fg(),nh[s]?(c=nh[s].bind(this,c),n.addEventListener(Sa[s],c,!1),c):(console.warn("wrong event specified:",s),f)}function hg(n,s,c){if(!Sa[s]){console.warn("wrong event specified:",s);return}n.removeEventListener(Sa[s],c,!1)}function ug(n){Ei[n.pointerId]=n}function dg(n){Ei[n.pointerId]&&(Ei[n.pointerId]=n)}function rh(n){delete Ei[n.pointerId]}function fg(){ih||(document.addEventListener(Jc,ug,!0),document.addEventListener(Qc,dg,!0),document.addEventListener(eh,rh,!0),document.addEventListener(th,rh,!0),ih=!0)}function Mo(n,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var c in Ei)s.touches.push(Ei[c]);s.changedTouches=[s],n(s)}}function pg(n,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&at(s),Mo(n,s)}function gg(n){var s={},c,d;for(d in n)c=n[d],s[d]=c&&c.bind?c.bind(n):c;return n=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var mg=200;function _g(n,s){n.addEventListener("dblclick",s);var c=0,d;function p(_){if(_.detail!==1){d=_.detail;return}if(!(_.pointerType==="mouse"||_.sourceCapabilities&&!_.sourceCapabilities.firesTouchEvents)){var C=ch(_);if(!(C.some(function(P){return P instanceof HTMLLabelElement&&P.attributes.for})&&!C.some(function(P){return P instanceof HTMLInputElement||P instanceof HTMLSelectElement}))){var M=Date.now();M-c<=mg?(d++,d===2&&s(gg(_))):d=1,c=M}}}return n.addEventListener("click",p),{dblclick:s,simDblclick:p}}function vg(n,s){n.removeEventListener("dblclick",s.dblclick),n.removeEventListener("click",s.simDblclick)}var Da=Ao(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),br=Ao(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),oh=br==="webkitTransition"||br==="OTransition"?br+"End":"transitionend";function sh(n){return typeof n=="string"?document.getElementById(n):n}function Cr(n,s){var c=n.style[s]||n.currentStyle&&n.currentStyle[s];if((!c||c==="auto")&&document.defaultView){var d=document.defaultView.getComputedStyle(n,null);c=d?d[s]:null}return c==="auto"?null:c}function Me(n,s,c){var d=document.createElement(n);return d.className=s||"",c&&c.appendChild(d),d}function je(n){var s=n.parentNode;s&&s.removeChild(n)}function To(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Mi(n){var s=n.parentNode;s&&s.lastChild!==n&&s.appendChild(n)}function Ti(n){var s=n.parentNode;s&&s.firstChild!==n&&s.insertBefore(n,s.firstChild)}function xa(n,s){if(n.classList!==void 0)return n.classList.contains(s);var c=Po(n);return c.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(c)}function pe(n,s){if(n.classList!==void 0)for(var c=v(s),d=0,p=c.length;d<p;d++)n.classList.add(c[d]);else if(!xa(n,s)){var _=Po(n);Ea(n,(_?_+" ":"")+s)}}function We(n,s){n.classList!==void 0?n.classList.remove(s):Ea(n,m((" "+Po(n)+" ").replace(" "+s+" "," ")))}function Ea(n,s){n.className.baseVal===void 0?n.className=s:n.className.baseVal=s}function Po(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Ot(n,s){"opacity"in n.style?n.style.opacity=s:"filter"in n.style&&yg(n,s)}function yg(n,s){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=n.filters.item(d)}catch{if(s===1)return}s=Math.round(s*100),c?(c.Enabled=s!==100,c.Opacity=s):n.style.filter+=" progid:"+d+"(opacity="+s+")"}function Ao(n){for(var s=document.documentElement.style,c=0;c<n.length;c++)if(n[c]in s)return n[c];return!1}function ni(n,s,c){var d=s||new k(0,0);n.style[Da]=(ee.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")}function qe(n,s){n._leaflet_pos=s,ee.any3d?ni(n,s):(n.style.left=s.x+"px",n.style.top=s.y+"px")}function ii(n){return n._leaflet_pos||new k(0,0)}var Sr,Dr,Ma;if("onselectstart"in document)Sr=function(){fe(window,"selectstart",at)},Dr=function(){Ne(window,"selectstart",at)};else{var xr=Ao(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Sr=function(){if(xr){var n=document.documentElement.style;Ma=n[xr],n[xr]="none"}},Dr=function(){xr&&(document.documentElement.style[xr]=Ma,Ma=void 0)}}function Ta(){fe(window,"dragstart",at)}function Pa(){Ne(window,"dragstart",at)}var Ro,Aa;function Ra(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Oo(),Ro=n,Aa=n.style.outlineStyle,n.style.outlineStyle="none",fe(window,"keydown",Oo))}function Oo(){Ro&&(Ro.style.outlineStyle=Aa,Ro=void 0,Aa=void 0,Ne(window,"keydown",Oo))}function ah(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Oa(n){var s=n.getBoundingClientRect();return{x:s.width/n.offsetWidth||1,y:s.height/n.offsetHeight||1,boundingClientRect:s}}var wg={__proto__:null,TRANSFORM:Da,TRANSITION:br,TRANSITION_END:oh,get:sh,getStyle:Cr,create:Me,remove:je,empty:To,toFront:Mi,toBack:Ti,hasClass:xa,addClass:pe,removeClass:We,setClass:Ea,getClass:Po,setOpacity:Ot,testProp:Ao,setTransform:ni,setPosition:qe,getPosition:ii,get disableTextSelection(){return Sr},get enableTextSelection(){return Dr},disableImageDrag:Ta,enableImageDrag:Pa,preventOutline:Ra,restoreOutline:Oo,getSizedParentNode:ah,getScale:Oa};function fe(n,s,c,d){if(s&&typeof s=="object")for(var p in s)La(n,p,s[p],c);else{s=v(s);for(var _=0,C=s.length;_<C;_++)La(n,s[_],c,d)}return this}var sn="_leaflet_events";function Ne(n,s,c,d){if(arguments.length===1)lh(n),delete n[sn];else if(s&&typeof s=="object")for(var p in s)ka(n,p,s[p],c);else if(s=v(s),arguments.length===2)lh(n,function(M){return A(s,M)!==-1});else for(var _=0,C=s.length;_<C;_++)ka(n,s[_],c,d);return this}function lh(n,s){for(var c in n[sn]){var d=c.split(/\d/)[0];(!s||s(d))&&ka(n,d,null,null,c)}}var Ia={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function La(n,s,c,d){var p=s+l(c)+(d?"_"+l(d):"");if(n[sn]&&n[sn][p])return this;var _=function(M){return c.call(d||n,M||window.event)},C=_;!ee.touchNative&&ee.pointer&&s.indexOf("touch")===0?_=cg(n,s,_):ee.touch&&s==="dblclick"?_=_g(n,_):"addEventListener"in n?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?n.addEventListener(Ia[s]||s,_,ee.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(_=function(M){M=M||window.event,Na(n,M)&&C(M)},n.addEventListener(Ia[s],_,!1)):n.addEventListener(s,C,!1):n.attachEvent("on"+s,_),n[sn]=n[sn]||{},n[sn][p]=_}function ka(n,s,c,d,p){p=p||s+l(c)+(d?"_"+l(d):"");var _=n[sn]&&n[sn][p];if(!_)return this;!ee.touchNative&&ee.pointer&&s.indexOf("touch")===0?hg(n,s,_):ee.touch&&s==="dblclick"?vg(n,_):"removeEventListener"in n?n.removeEventListener(Ia[s]||s,_,!1):n.detachEvent("on"+s,_),n[sn][p]=null}function ri(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Fa(n){return La(n,"wheel",ri),this}function Er(n){return fe(n,"mousedown touchstart dblclick contextmenu",ri),n._leaflet_disable_click=!0,this}function at(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function oi(n){return at(n),ri(n),this}function ch(n){if(n.composedPath)return n.composedPath();for(var s=[],c=n.target;c;)s.push(c),c=c.parentNode;return s}function hh(n,s){if(!s)return new k(n.clientX,n.clientY);var c=Oa(s),d=c.boundingClientRect;return new k((n.clientX-d.left)/c.x-s.clientLeft,(n.clientY-d.top)/c.y-s.clientTop)}var bg=ee.linux&&ee.chrome?window.devicePixelRatio:ee.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function uh(n){return ee.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/bg:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Na(n,s){var c=s.relatedTarget;if(!c)return!0;try{for(;c&&c!==n;)c=c.parentNode}catch{return!1}return c!==n}var Cg={__proto__:null,on:fe,off:Ne,stopPropagation:ri,disableScrollPropagation:Fa,disableClickPropagation:Er,preventDefault:at,stop:oi,getPropagationPath:ch,getMousePosition:hh,getWheelDelta:uh,isExternalTarget:Na,addListener:fe,removeListener:Ne},dh=Q.extend({run:function(n,s,c,d){this.stop(),this._el=n,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=ii(n),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Z(this._animate,this),this._step()},_step:function(n){var s=+new Date-this._startTime,c=this._duration*1e3;s<c?this._runFrame(this._easeOut(s/c),n):(this._runFrame(1),this._complete())},_runFrame:function(n,s){var c=this._startPos.add(this._offset.multiplyBy(n));s&&c._round(),qe(this._el,c),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),xe=Q.extend({options:{crs:ce,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,s){s=y(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(te(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=br&&ee.any3d&&!ee.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),fe(this._proxy,oh,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,s,c){if(s=s===void 0?this._zoom:this._limitZoom(s),n=this._limitCenter(te(n),s,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=t({animate:c.animate},c.zoom),c.pan=t({animate:c.animate,duration:c.duration},c.pan));var d=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,s,c.zoom):this._tryAnimatedPan(n,c.pan);if(d)return clearTimeout(this._sizeTimer),this}return this._resetView(n,s,c.pan&&c.pan.noMoveStart),this},setZoom:function(n,s){return this._loaded?this.setView(this.getCenter(),n,{zoom:s}):(this._zoom=n,this)},zoomIn:function(n,s){return n=n||(ee.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,s)},zoomOut:function(n,s){return n=n||(ee.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,s)},setZoomAround:function(n,s,c){var d=this.getZoomScale(s),p=this.getSize().divideBy(2),_=n instanceof k?n:this.latLngToContainerPoint(n),C=_.subtract(p).multiplyBy(1-1/d),M=this.containerPointToLatLng(p.add(C));return this.setView(M,s,{zoom:c})},_getBoundsCenterZoom:function(n,s){s=s||{},n=n.getBounds?n.getBounds():J(n);var c=B(s.paddingTopLeft||s.padding||[0,0]),d=B(s.paddingBottomRight||s.padding||[0,0]),p=this.getBoundsZoom(n,!1,c.add(d));if(p=typeof s.maxZoom=="number"?Math.min(s.maxZoom,p):p,p===1/0)return{center:n.getCenter(),zoom:p};var _=d.subtract(c).divideBy(2),C=this.project(n.getSouthWest(),p),M=this.project(n.getNorthEast(),p),P=this.unproject(C.add(M).divideBy(2).add(_),p);return{center:P,zoom:p}},fitBounds:function(n,s){if(n=J(n),!n.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(n,s);return this.setView(c.center,c.zoom,s)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,s){return this.setView(n,this._zoom,{pan:s})},panBy:function(n,s){if(n=B(n).round(),s=s||{},!n.x&&!n.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new dh,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){pe(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,c,s.duration||.25,s.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,s,c){if(c=c||{},c.animate===!1||!ee.any3d)return this.setView(n,s,c);this._stop();var d=this.project(this.getCenter()),p=this.project(n),_=this.getSize(),C=this._zoom;n=te(n),s=s===void 0?C:s;var M=Math.max(_.x,_.y),P=M*this.getZoomScale(C,s),N=p.distanceTo(d)||1,W=1.42,se=W*W;function me(Ye){var Ho=Ye?-1:1,hm=Ye?P:M,um=P*P-M*M+Ho*se*se*N*N,dm=2*hm*se*N,qa=um/dm,Wh=Math.sqrt(qa*qa+1)-qa,fm=Wh<1e-9?-18:Math.log(Wh);return fm}function pt(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function ot(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}function Lt(Ye){return pt(Ye)/ot(Ye)}var vt=me(0);function Li(Ye){return M*(ot(vt)/ot(vt+W*Ye))}function sm(Ye){return M*(ot(vt)*Lt(vt+W*Ye)-pt(vt))/se}function am(Ye){return 1-Math.pow(1-Ye,1.5)}var lm=Date.now(),Hh=(me(1)-vt)/W,cm=c.duration?1e3*c.duration:1e3*Hh*.8;function $h(){var Ye=(Date.now()-lm)/cm,Ho=am(Ye)*Hh;Ye<=1?(this._flyToFrame=Z($h,this),this._move(this.unproject(d.add(p.subtract(d).multiplyBy(sm(Ho)/N)),C),this.getScaleZoom(M/Li(Ho),C),{flyTo:!0})):this._move(n,s)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),$h.call(this),this},flyToBounds:function(n,s){var c=this._getBoundsCenterZoom(n,s);return this.flyTo(c.center,c.zoom,s)},setMaxBounds:function(n){return n=J(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var s=this.options.minZoom;return this.options.minZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var s=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,s){this._enforcingBounds=!0;var c=this.getCenter(),d=this._limitCenter(c,this._zoom,J(n));return c.equals(d)||this.panTo(d,s),this._enforcingBounds=!1,this},panInside:function(n,s){s=s||{};var c=B(s.paddingTopLeft||s.padding||[0,0]),d=B(s.paddingBottomRight||s.padding||[0,0]),p=this.project(this.getCenter()),_=this.project(n),C=this.getPixelBounds(),M=be([C.min.add(c),C.max.subtract(d)]),P=M.getSize();if(!M.contains(_)){this._enforcingBounds=!0;var N=_.subtract(M.getCenter()),W=M.extend(_).getSize().subtract(P);p.x+=N.x<0?-W.x:W.x,p.y+=N.y<0?-W.y:W.y,this.panTo(this.unproject(p),s),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=t({animate:!1,pan:!0},n===!0?{animate:!0}:n);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),d=s.divideBy(2).round(),p=c.divideBy(2).round(),_=d.subtract(p);return!_.x&&!_.y?this:(n.animate&&n.pan?this.panBy(_):(n.pan&&this._rawPanBy(_),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=t({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=o(this._handleGeolocationResponse,this),c=o(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,c,n):navigator.geolocation.getCurrentPosition(s,c,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var s=n.code,c=n.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var s=n.coords.latitude,c=n.coords.longitude,d=new X(s,c),p=d.toBounds(n.coords.accuracy*2),_=this._locateOptions;if(_.setView){var C=this.getBoundsZoom(p);this.setView(d,_.maxZoom?Math.min(C,_.maxZoom):C)}var M={latlng:d,bounds:p,timestamp:n.timestamp};for(var P in n.coords)typeof n.coords[P]=="number"&&(M[P]=n.coords[P]);this.fire("locationfound",M)}},addHandler:function(n,s){if(!s)return this;var c=this[n]=new s(this);return this._handlers.push(c),this.options[n]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),je(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)je(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,s){var c="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),d=Me("div",c,s||this._mapPane);return n&&(this._panes[n]=d),d},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),s=this.unproject(n.getBottomLeft()),c=this.unproject(n.getTopRight());return new q(s,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,s,c){n=J(n),c=B(c||[0,0]);var d=this.getZoom()||0,p=this.getMinZoom(),_=this.getMaxZoom(),C=n.getNorthWest(),M=n.getSouthEast(),P=this.getSize().subtract(c),N=be(this.project(M,d),this.project(C,d)).getSize(),W=ee.any3d?this.options.zoomSnap:1,se=P.x/N.x,me=P.y/N.y,pt=s?Math.max(se,me):Math.min(se,me);return d=this.getScaleZoom(pt,d),W&&(d=Math.round(d/(W/100))*(W/100),d=s?Math.ceil(d/W)*W:Math.floor(d/W)*W),Math.max(p,Math.min(_,d))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new k(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,s){var c=this._getTopLeftPoint(n,s);return new ne(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,s){var c=this.options.crs;return s=s===void 0?this._zoom:s,c.scale(n)/c.scale(s)},getScaleZoom:function(n,s){var c=this.options.crs;s=s===void 0?this._zoom:s;var d=c.zoom(n*c.scale(s));return isNaN(d)?1/0:d},project:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(te(n),s)},unproject:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(B(n),s)},layerPointToLatLng:function(n){var s=B(n).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(n){var s=this.project(te(n))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(te(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(J(n))},distance:function(n,s){return this.options.crs.distance(te(n),te(s))},containerPointToLayerPoint:function(n){return B(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return B(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var s=this.containerPointToLayerPoint(B(n));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(te(n)))},mouseEventToContainerPoint:function(n){return hh(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var s=this._container=sh(n);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");fe(s,"scroll",this._onScroll,this),this._containerId=l(s)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&ee.any3d,pe(n,"leaflet-container"+(ee.touch?" leaflet-touch":"")+(ee.retina?" leaflet-retina":"")+(ee.ielt9?" leaflet-oldie":"")+(ee.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=Cr(n,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qe(this._mapPane,new k(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(pe(n.markerPane,"leaflet-zoom-hide"),pe(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,s,c){qe(this._mapPane,new k(0,0));var d=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var p=this._zoom!==s;this._moveStart(p,c)._move(n,s)._moveEnd(p),this.fire("viewreset"),d&&this.fire("load")},_moveStart:function(n,s){return n&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(n,s,c,d){s===void 0&&(s=this._zoom);var p=this._zoom!==s;return this._zoom=s,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),d?c&&c.pinch&&this.fire("zoom",c):((p||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){qe(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[l(this._container)]=this;var s=n?Ne:fe;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),ee.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=Z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,s){for(var c=[],d,p=s==="mouseout"||s==="mouseover",_=n.target||n.srcElement,C=!1;_;){if(d=this._targets[l(_)],d&&(s==="click"||s==="preclick")&&this._draggableMoved(d)){C=!0;break}if(d&&d.listens(s,!0)&&(p&&!Na(_,n)||(c.push(d),p))||_===this._container)break;_=_.parentNode}return!c.length&&!C&&!p&&this.listens(s,!0)&&(c=[this]),c},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var s=n.target||n.srcElement;if(!(!this._loaded||s._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(s))){var c=n.type;c==="mousedown"&&Ra(s),this._fireDOMEvent(n,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,s,c){if(n.type==="click"){var d=t({},n);d.type="preclick",this._fireDOMEvent(d,d.type,c)}var p=this._findEventTargets(n,s);if(c){for(var _=[],C=0;C<c.length;C++)c[C].listens(s,!0)&&_.push(c[C]);p=_.concat(p)}if(p.length){s==="contextmenu"&&at(n);var M=p[0],P={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var N=M.getLatLng&&(!M._radius||M._radius<=10);P.containerPoint=N?this.latLngToContainerPoint(M.getLatLng()):this.mouseEventToContainerPoint(n),P.layerPoint=this.containerPointToLayerPoint(P.containerPoint),P.latlng=N?M.getLatLng():this.layerPointToLatLng(P.layerPoint)}for(C=0;C<p.length;C++)if(p[C].fire(s,P,!0),P.originalEvent._stopped||p[C].options.bubblingMouseEvents===!1&&A(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,s=this._handlers.length;n<s;n++)this._handlers[n].disable()},whenReady:function(n,s){return this._loaded?n.call(s||this,{target:this}):this.on("load",n,s),this},_getMapPanePos:function(){return ii(this._mapPane)||new k(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,s){var c=n&&s!==void 0?this._getNewPixelOrigin(n,s):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,s){var c=this.getSize()._divideBy(2);return this.project(n,s)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,s,c){var d=this._getNewPixelOrigin(c,s);return this.project(n,s)._subtract(d)},_latLngBoundsToNewLayerBounds:function(n,s,c){var d=this._getNewPixelOrigin(c,s);return be([this.project(n.getSouthWest(),s)._subtract(d),this.project(n.getNorthWest(),s)._subtract(d),this.project(n.getSouthEast(),s)._subtract(d),this.project(n.getNorthEast(),s)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,s,c){if(!c)return n;var d=this.project(n,s),p=this.getSize().divideBy(2),_=new ne(d.subtract(p),d.add(p)),C=this._getBoundsOffset(_,c,s);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?n:this.unproject(d.add(C),s)},_limitOffset:function(n,s){if(!s)return n;var c=this.getPixelBounds(),d=new ne(c.min.add(n),c.max.add(n));return n.add(this._getBoundsOffset(d,s))},_getBoundsOffset:function(n,s,c){var d=be(this.project(s.getNorthEast(),c),this.project(s.getSouthWest(),c)),p=d.min.subtract(n.min),_=d.max.subtract(n.max),C=this._rebound(p.x,-_.x),M=this._rebound(p.y,-_.y);return new k(C,M)},_rebound:function(n,s){return n+s>0?Math.round(n-s)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(s))},_limitZoom:function(n){var s=this.getMinZoom(),c=this.getMaxZoom(),d=ee.any3d?this.options.zoomSnap:1;return d&&(n=Math.round(n/d)*d),Math.max(s,Math.min(c,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){We(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,s){var c=this._getCenterOffset(n)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,s),!0)},_createAnimProxy:function(){var n=this._proxy=Me("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(s){var c=Da,d=this._proxy.style[c];ni(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),d===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){je(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),s=this.getZoom();ni(this._proxy,this.project(n,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,s,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(s),p=this._getCenterOffset(n)._divideBy(1-1/d);return c.animate!==!0&&!this.getSize().contains(p)?!1:(Z(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(n,s,!0)},this),!0)},_animateZoom:function(n,s,c,d){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=s,pe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:s,noUpdate:d}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&We(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Sg(n,s){return new xe(n,s)}var jt=Y.extend({options:{position:"topright"},initialize:function(n){y(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var s=this._map;return s&&s.removeControl(this),this.options.position=n,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var s=this._container=this.onAdd(n),c=this.getPosition(),d=n._controlCorners[c];return pe(s,"leaflet-control"),c.indexOf("bottom")!==-1?d.insertBefore(s,d.firstChild):d.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(je(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Mr=function(n){return new jt(n)};xe.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},s="leaflet-",c=this._controlContainer=Me("div",s+"control-container",this._container);function d(p,_){var C=s+p+" "+s+_;n[p+_]=Me("div",C,c)}d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)je(this._controlCorners[n]);je(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fh=jt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,s,c,d){return c<d?-1:d<c?1:0}},initialize:function(n,s,c){y(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var d in n)this._addLayer(n[d],d);for(d in s)this._addLayer(s[d],d,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return jt.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,s){return this._addLayer(n,s),this._map?this._update():this},addOverlay:function(n,s){return this._addLayer(n,s,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var s=this._getLayer(l(n));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){pe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(pe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):We(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return We(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",s=this._container=Me("div",n),c=this.options.collapsed;s.setAttribute("aria-haspopup",!0),Er(s),Fa(s);var d=this._section=Me("section",n+"-list");c&&(this._map.on("click",this.collapse,this),fe(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var p=this._layersLink=Me("a",n+"-toggle",s);p.href="#",p.title="Layers",p.setAttribute("role","button"),fe(p,{keydown:function(_){_.keyCode===13&&this._expandSafely()},click:function(_){at(_),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=Me("div",n+"-base",d),this._separator=Me("div",n+"-separator",d),this._overlaysList=Me("div",n+"-overlays",d),s.appendChild(d)},_getLayer:function(n){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&l(this._layers[s].layer)===n)return this._layers[s]},_addLayer:function(n,s,c){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:s,overlay:c}),this.options.sortLayers&&this._layers.sort(o(function(d,p){return this.options.sortFunction(d.layer,p.layer,d.name,p.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;To(this._baseLayersList),To(this._overlaysList),this._layerControlInputs=[];var n,s,c,d,p=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),s=s||d.overlay,n=n||!d.overlay,p+=d.overlay?0:1;return this.options.hideSingleBase&&(n=n&&p>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=s&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var s=this._getLayer(l(n.target)),c=s.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;c&&this._map.fire(c,s)},_createRadioElement:function(n,s){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(s?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(n){var s=document.createElement("label"),c=this._map.hasLayer(n.layer),d;n.overlay?(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers_"+l(this),c),this._layerControlInputs.push(d),d.layerId=l(n.layer),fe(d,"click",this._onInputClick,this);var p=document.createElement("span");p.innerHTML=" "+n.name;var _=document.createElement("span");s.appendChild(_),_.appendChild(d),_.appendChild(p);var C=n.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,s,c,d=[],p=[];this._handlingClick=!0;for(var _=n.length-1;_>=0;_--)s=n[_],c=this._getLayer(s.layerId).layer,s.checked?d.push(c):s.checked||p.push(c);for(_=0;_<p.length;_++)this._map.hasLayer(p[_])&&this._map.removeLayer(p[_]);for(_=0;_<d.length;_++)this._map.hasLayer(d[_])||this._map.addLayer(d[_]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,s,c,d=this._map.getZoom(),p=n.length-1;p>=0;p--)s=n[p],c=this._getLayer(s.layerId).layer,s.disabled=c.options.minZoom!==void 0&&d<c.options.minZoom||c.options.maxZoom!==void 0&&d>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,fe(n,"click",at),this.expand();var s=this;setTimeout(function(){Ne(n,"click",at),s._preventClick=!1})}}),Dg=function(n,s,c){return new fh(n,s,c)},Ba=jt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var s="leaflet-control-zoom",c=Me("div",s+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,s+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,s+"-out",c,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,s,c,d,p){var _=Me("a",c,d);return _.innerHTML=n,_.href="#",_.title=s,_.setAttribute("role","button"),_.setAttribute("aria-label",s),Er(_),fe(_,"click",oi),fe(_,"click",p,this),fe(_,"click",this._refocusOnMap,this),_},_updateDisabled:function(){var n=this._map,s="leaflet-disabled";We(this._zoomInButton,s),We(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(pe(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(pe(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});xe.mergeOptions({zoomControl:!0}),xe.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ba,this.addControl(this.zoomControl))});var xg=function(n){return new Ba(n)},ph=jt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var s="leaflet-control-scale",c=Me("div",s),d=this.options;return this._addScales(d,s+"-line",c),n.on(d.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),c},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,s,c){n.metric&&(this._mScale=Me("div",s,c)),n.imperial&&(this._iScale=Me("div",s,c))},_update:function(){var n=this._map,s=n.getSize().y/2,c=n.distance(n.containerPointToLatLng([0,s]),n.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(c)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var s=this._getRoundNum(n),c=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,c,s/n)},_updateImperial:function(n){var s=n*3.2808399,c,d,p;s>5280?(c=s/5280,d=this._getRoundNum(c),this._updateScale(this._iScale,d+" mi",d/c)):(p=this._getRoundNum(s),this._updateScale(this._iScale,p+" ft",p/s))},_updateScale:function(n,s,c){n.style.width=Math.round(this.options.maxWidth*c)+"px",n.innerHTML=s},_getRoundNum:function(n){var s=Math.pow(10,(Math.floor(n)+"").length-1),c=n/s;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,s*c}}),Eg=function(n){return new ph(n)},Mg='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Va=jt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ee.inlineSvg?Mg+" ":"")+"Leaflet</a>"},initialize:function(n){y(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=Me("div","leaflet-control-attribution"),Er(this._container);for(var s in n._layers)n._layers[s].getAttribution&&this.addAttribution(n._layers[s].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var s in this._attributions)this._attributions[s]&&n.push(s);var c=[];this.options.prefix&&c.push(this.options.prefix),n.length&&c.push(n.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});xe.mergeOptions({attributionControl:!0}),xe.addInitHook(function(){this.options.attributionControl&&new Va().addTo(this)});var Tg=function(n){return new Va(n)};jt.Layers=fh,jt.Zoom=Ba,jt.Scale=ph,jt.Attribution=Va,Mr.layers=Dg,Mr.zoom=xg,Mr.scale=Eg,Mr.attribution=Tg;var an=Y.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});an.addTo=function(n,s){return n.addHandler(s,this),this};var Pg={Events:re},gh=ee.touch?"touchstart mousedown":"mousedown",Ln=Q.extend({options:{clickTolerance:3},initialize:function(n,s,c,d){y(this,d),this._element=n,this._dragStartTarget=s||n,this._preventOutline=c},enable:function(){this._enabled||(fe(this._dragStartTarget,gh,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ln._dragging===this&&this.finishDrag(!0),Ne(this._dragStartTarget,gh,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!xa(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Ln._dragging===this&&this.finishDrag();return}if(!(Ln._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Ln._dragging=this,this._preventOutline&&Ra(this._element),Ta(),Sr(),!this._moving)){this.fire("down");var s=n.touches?n.touches[0]:n,c=ah(this._element);this._startPoint=new k(s.clientX,s.clientY),this._startPos=ii(this._element),this._parentScale=Oa(c);var d=n.type==="mousedown";fe(document,d?"mousemove":"touchmove",this._onMove,this),fe(document,d?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var s=n.touches&&n.touches.length===1?n.touches[0]:n,c=new k(s.clientX,s.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,at(n),this._moved||(this.fire("dragstart"),this._moved=!0,pe(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),pe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),qe(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){We(document.body,"leaflet-dragging"),this._lastTarget&&(We(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ne(document,"mousemove touchmove",this._onMove,this),Ne(document,"mouseup touchend touchcancel",this._onUp,this),Pa(),Dr();var s=this._moved&&this._moving;this._moving=!1,Ln._dragging=!1,s&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function mh(n,s,c){var d,p=[1,4,2,8],_,C,M,P,N,W,se,me;for(_=0,W=n.length;_<W;_++)n[_]._code=si(n[_],s);for(M=0;M<4;M++){for(se=p[M],d=[],_=0,W=n.length,C=W-1;_<W;C=_++)P=n[_],N=n[C],P._code&se?N._code&se||(me=Io(N,P,se,s,c),me._code=si(me,s),d.push(me)):(N._code&se&&(me=Io(N,P,se,s,c),me._code=si(me,s),d.push(me)),d.push(P));n=d}return n}function _h(n,s){var c,d,p,_,C,M,P,N,W;if(!n||n.length===0)throw new Error("latlngs not passed");It(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var se=te([0,0]),me=J(n),pt=me.getNorthWest().distanceTo(me.getSouthWest())*me.getNorthEast().distanceTo(me.getNorthWest());pt<1700&&(se=za(n));var ot=n.length,Lt=[];for(c=0;c<ot;c++){var vt=te(n[c]);Lt.push(s.project(te([vt.lat-se.lat,vt.lng-se.lng])))}for(M=P=N=0,c=0,d=ot-1;c<ot;d=c++)p=Lt[c],_=Lt[d],C=p.y*_.x-_.y*p.x,P+=(p.x+_.x)*C,N+=(p.y+_.y)*C,M+=C*3;M===0?W=Lt[0]:W=[P/M,N/M];var Li=s.unproject(B(W));return te([Li.lat+se.lat,Li.lng+se.lng])}function za(n){for(var s=0,c=0,d=0,p=0;p<n.length;p++){var _=te(n[p]);s+=_.lat,c+=_.lng,d++}return te([s/d,c/d])}var Ag={__proto__:null,clipPolygon:mh,polygonCenter:_h,centroid:za};function vh(n,s){if(!s||!n.length)return n.slice();var c=s*s;return n=Ig(n,c),n=Og(n,c),n}function yh(n,s,c){return Math.sqrt(Tr(n,s,c,!0))}function Rg(n,s,c){return Tr(n,s,c)}function Og(n,s){var c=n.length,d=typeof Uint8Array<"u"?Uint8Array:Array,p=new d(c);p[0]=p[c-1]=1,Ua(n,p,s,0,c-1);var _,C=[];for(_=0;_<c;_++)p[_]&&C.push(n[_]);return C}function Ua(n,s,c,d,p){var _=0,C,M,P;for(M=d+1;M<=p-1;M++)P=Tr(n[M],n[d],n[p],!0),P>_&&(C=M,_=P);_>c&&(s[C]=1,Ua(n,s,c,d,C),Ua(n,s,c,C,p))}function Ig(n,s){for(var c=[n[0]],d=1,p=0,_=n.length;d<_;d++)Lg(n[d],n[p])>s&&(c.push(n[d]),p=d);return p<_-1&&c.push(n[_-1]),c}var wh;function bh(n,s,c,d,p){var _=d?wh:si(n,c),C=si(s,c),M,P,N;for(wh=C;;){if(!(_|C))return[n,s];if(_&C)return!1;M=_||C,P=Io(n,s,M,c,p),N=si(P,c),M===_?(n=P,_=N):(s=P,C=N)}}function Io(n,s,c,d,p){var _=s.x-n.x,C=s.y-n.y,M=d.min,P=d.max,N,W;return c&8?(N=n.x+_*(P.y-n.y)/C,W=P.y):c&4?(N=n.x+_*(M.y-n.y)/C,W=M.y):c&2?(N=P.x,W=n.y+C*(P.x-n.x)/_):c&1&&(N=M.x,W=n.y+C*(M.x-n.x)/_),new k(N,W,p)}function si(n,s){var c=0;return n.x<s.min.x?c|=1:n.x>s.max.x&&(c|=2),n.y<s.min.y?c|=4:n.y>s.max.y&&(c|=8),c}function Lg(n,s){var c=s.x-n.x,d=s.y-n.y;return c*c+d*d}function Tr(n,s,c,d){var p=s.x,_=s.y,C=c.x-p,M=c.y-_,P=C*C+M*M,N;return P>0&&(N=((n.x-p)*C+(n.y-_)*M)/P,N>1?(p=c.x,_=c.y):N>0&&(p+=C*N,_+=M*N)),C=n.x-p,M=n.y-_,d?C*C+M*M:new k(p,_)}function It(n){return!x(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Ch(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),It(n)}function Sh(n,s){var c,d,p,_,C,M,P,N;if(!n||n.length===0)throw new Error("latlngs not passed");It(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var W=te([0,0]),se=J(n),me=se.getNorthWest().distanceTo(se.getSouthWest())*se.getNorthEast().distanceTo(se.getNorthWest());me<1700&&(W=za(n));var pt=n.length,ot=[];for(c=0;c<pt;c++){var Lt=te(n[c]);ot.push(s.project(te([Lt.lat-W.lat,Lt.lng-W.lng])))}for(c=0,d=0;c<pt-1;c++)d+=ot[c].distanceTo(ot[c+1])/2;if(d===0)N=ot[0];else for(c=0,_=0;c<pt-1;c++)if(C=ot[c],M=ot[c+1],p=C.distanceTo(M),_+=p,_>d){P=(_-d)/p,N=[M.x-P*(M.x-C.x),M.y-P*(M.y-C.y)];break}var vt=s.unproject(B(N));return te([vt.lat+W.lat,vt.lng+W.lng])}var kg={__proto__:null,simplify:vh,pointToSegmentDistance:yh,closestPointOnSegment:Rg,clipSegment:bh,_getEdgeIntersection:Io,_getBitCode:si,_sqClosestPointOnSegment:Tr,isFlat:It,_flat:Ch,polylineCenter:Sh},Ga={project:function(n){return new k(n.lng,n.lat)},unproject:function(n){return new X(n.y,n.x)},bounds:new ne([-180,-90],[180,90])},ja={R:6378137,R_MINOR:6356752314245179e-9,bounds:new ne([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var s=Math.PI/180,c=this.R,d=n.lat*s,p=this.R_MINOR/c,_=Math.sqrt(1-p*p),C=_*Math.sin(d),M=Math.tan(Math.PI/4-d/2)/Math.pow((1-C)/(1+C),_/2);return d=-c*Math.log(Math.max(M,1e-10)),new k(n.lng*s*c,d)},unproject:function(n){for(var s=180/Math.PI,c=this.R,d=this.R_MINOR/c,p=Math.sqrt(1-d*d),_=Math.exp(-n.y/c),C=Math.PI/2-2*Math.atan(_),M=0,P=.1,N;M<15&&Math.abs(P)>1e-7;M++)N=p*Math.sin(C),N=Math.pow((1-N)/(1+N),p/2),P=Math.PI/2-2*Math.atan(_*N)-C,C+=P;return new X(C*s,n.x*s/c)}},Fg={__proto__:null,LonLat:Ga,Mercator:ja,SphericalMercator:ze},Ng=t({},rt,{code:"EPSG:3395",projection:ja,transformation:(function(){var n=.5/(Math.PI*ja.R);return Ge(n,.5,-n,.5)})()}),Dh=t({},rt,{code:"EPSG:4326",projection:Ga,transformation:Ge(1/180,1,-1/180,.5)}),Bg=t({},Ze,{projection:Ga,transformation:Ge(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,s){var c=s.lng-n.lng,d=s.lat-n.lat;return Math.sqrt(c*c+d*d)},infinite:!0});Ze.Earth=rt,Ze.EPSG3395=Ng,Ze.EPSG3857=ce,Ze.EPSG900913=ue,Ze.EPSG4326=Dh,Ze.Simple=Bg;var Ht=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[l(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[l(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var s=n.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var c=this.getEvents();s.on(c,this),this.once("remove",function(){s.off(c,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});xe.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var s=l(n);return this._layers[s]?this:(this._layers[s]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var s=l(n);return this._layers[s]?(this._loaded&&n.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return l(n)in this._layers},eachLayer:function(n,s){for(var c in this._layers)n.call(s,this._layers[c]);return this},_addLayers:function(n){n=n?x(n)?n:[n]:[];for(var s=0,c=n.length;s<c;s++)this.addLayer(n[s])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[l(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var s=l(n);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,s=-1/0,c=this._getZoomSpan();for(var d in this._zoomBoundLayers){var p=this._zoomBoundLayers[d].options;n=p.minZoom===void 0?n:Math.min(n,p.minZoom),s=p.maxZoom===void 0?s:Math.max(s,p.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=n===1/0?void 0:n,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Pi=Ht.extend({initialize:function(n,s){y(this,s),this._layers={};var c,d;if(n)for(c=0,d=n.length;c<d;c++)this.addLayer(n[c])},addLayer:function(n){var s=this.getLayerId(n);return this._layers[s]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var s=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(n){var s=typeof n=="number"?n:this.getLayerId(n);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var s=Array.prototype.slice.call(arguments,1),c,d;for(c in this._layers)d=this._layers[c],d[n]&&d[n].apply(d,s);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,s){for(var c in this._layers)n.call(s,this._layers[c]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return l(n)}}),Vg=function(n,s){return new Pi(n,s)},wn=Pi.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Pi.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Pi.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new q;for(var s in this._layers){var c=this._layers[s];n.extend(c.getBounds?c.getBounds():c.getLatLng())}return n}}),zg=function(n,s){return new wn(n,s)},Ai=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){y(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,s){var c=this._getIconUrl(n);if(!c){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(d,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),d},_setIconStyles:function(n,s){var c=this.options,d=c[s+"Size"];typeof d=="number"&&(d=[d,d]);var p=B(d),_=B(s==="shadow"&&c.shadowAnchor||c.iconAnchor||p&&p.divideBy(2,!0));n.className="leaflet-marker-"+s+" "+(c.className||""),_&&(n.style.marginLeft=-_.x+"px",n.style.marginTop=-_.y+"px"),p&&(n.style.width=p.x+"px",n.style.height=p.y+"px")},_createImg:function(n,s){return s=s||document.createElement("img"),s.src=n,s},_getIconUrl:function(n){return ee.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ug(n){return new Ai(n)}var Pr=Ai.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Pr.imagePath!="string"&&(Pr.imagePath=this._detectIconPath()),(this.options.imagePath||Pr.imagePath)+Ai.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var s=function(c,d,p){var _=d.exec(c);return _&&_[p]};return n=s(n,/^url\((['"])?(.+)\1\)$/,2),n&&s(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=Me("div","leaflet-default-icon-path",document.body),s=Cr(n,"background-image")||Cr(n,"backgroundImage");if(document.body.removeChild(n),s=this._stripUrl(s),s)return s;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),xh=an.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Ln(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),pe(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&We(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var s=this._marker,c=s._map,d=this._marker.options.autoPanSpeed,p=this._marker.options.autoPanPadding,_=ii(s._icon),C=c.getPixelBounds(),M=c.getPixelOrigin(),P=be(C.min._subtract(M).add(p),C.max._subtract(M).subtract(p));if(!P.contains(_)){var N=B((Math.max(P.max.x,_.x)-P.max.x)/(C.max.x-P.max.x)-(Math.min(P.min.x,_.x)-P.min.x)/(C.min.x-P.min.x),(Math.max(P.max.y,_.y)-P.max.y)/(C.max.y-P.max.y)-(Math.min(P.min.y,_.y)-P.min.y)/(C.min.y-P.min.y)).multiplyBy(d);c.panBy(N,{animate:!1}),this._draggable._newPos._add(N),this._draggable._startPos._add(N),qe(s._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=Z(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=Z(this._adjustPan.bind(this,n)))},_onDrag:function(n){var s=this._marker,c=s._shadow,d=ii(s._icon),p=s._map.layerPointToLatLng(d);c&&qe(c,d),s._latlng=p,n.latlng=p,n.oldLatLng=this._oldLatLng,s.fire("move",n).fire("drag",n)},_onDragEnd:function(n){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Lo=Ht.extend({options:{icon:new Pr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,s){y(this,s),this._latlng=te(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var s=this._latlng;return this._latlng=te(n),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=n.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,n.title&&(c.title=n.title),c.tagName==="IMG"&&(c.alt=n.alt||"")),pe(c,s),n.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&fe(c,"focus",this._panOnFocus,this);var p=n.icon.createShadow(this._shadow),_=!1;p!==this._shadow&&(this._removeShadow(),_=!0),p&&(pe(p,s),p.alt=""),this._shadow=p,n.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),p&&_&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ne(this._icon,"focus",this._panOnFocus,this),je(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&je(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&qe(this._icon,n),this._shadow&&qe(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(pe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),xh)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new xh(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Ot(this._icon,n),this._shadow&&Ot(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var s=this.options.icon.options,c=s.iconSize?B(s.iconSize):B(0,0),d=s.iconAnchor?B(s.iconAnchor):B(0,0);n.panInside(this._latlng,{paddingTopLeft:d,paddingBottomRight:c.subtract(d)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Gg(n,s){return new Lo(n,s)}var kn=Ht.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return y(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ko=kn.extend({options:{fill:!0,radius:10},initialize:function(n,s){y(this,s),this._latlng=te(n),this._radius=this.options.radius},setLatLng:function(n){var s=this._latlng;return this._latlng=te(n),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var s=n&&n.radius||this._radius;return kn.prototype.setStyle.call(this,n),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,s=this._radiusY||n,c=this._clickTolerance(),d=[n+c,s+c];this._pxBounds=new ne(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jg(n,s){return new ko(n,s)}var Ha=ko.extend({initialize:function(n,s,c){if(typeof s=="number"&&(s=t({},c,{radius:s})),y(this,s),this._latlng=te(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new q(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:kn.prototype.setStyle,_project:function(){var n=this._latlng.lng,s=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===rt.distance){var p=Math.PI/180,_=this._mRadius/rt.R/p,C=c.project([s+_,n]),M=c.project([s-_,n]),P=C.add(M).divideBy(2),N=c.unproject(P).lat,W=Math.acos((Math.cos(_*p)-Math.sin(s*p)*Math.sin(N*p))/(Math.cos(s*p)*Math.cos(N*p)))/p;(isNaN(W)||W===0)&&(W=_/Math.cos(Math.PI/180*s)),this._point=P.subtract(c.getPixelOrigin()),this._radius=isNaN(W)?0:P.x-c.project([N,n-W]).x,this._radiusY=P.y-C.y}else{var se=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(se).x}this._updateBounds()}});function Hg(n,s,c){return new Ha(n,s,c)}var bn=kn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,s){y(this,s),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var s=1/0,c=null,d=Tr,p,_,C=0,M=this._parts.length;C<M;C++)for(var P=this._parts[C],N=1,W=P.length;N<W;N++){p=P[N-1],_=P[N];var se=d(n,p,_,!0);se<s&&(s=se,c=d(n,p,_))}return c&&(c.distance=Math.sqrt(s)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Sh(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,s){return s=s||this._defaultShape(),n=te(n),s.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new q,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return It(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var s=[],c=It(n),d=0,p=n.length;d<p;d++)c?(s[d]=te(n[d]),this._bounds.extend(s[d])):s[d]=this._convertLatLngs(n[d]);return s},_project:function(){var n=new ne;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),s=new k(n,n);this._rawPxBounds&&(this._pxBounds=new ne([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(n,s,c){var d=n[0]instanceof X,p=n.length,_,C;if(d){for(C=[],_=0;_<p;_++)C[_]=this._map.latLngToLayerPoint(n[_]),c.extend(C[_]);s.push(C)}else for(_=0;_<p;_++)this._projectLatlngs(n[_],s,c)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,c,d,p,_,C,M,P;for(c=0,p=0,_=this._rings.length;c<_;c++)for(P=this._rings[c],d=0,C=P.length;d<C-1;d++)M=bh(P[d],P[d+1],n,d,!0),M&&(s[p]=s[p]||[],s[p].push(M[0]),(M[1]!==P[d+1]||d===C-2)&&(s[p].push(M[1]),p++))}},_simplifyPoints:function(){for(var n=this._parts,s=this.options.smoothFactor,c=0,d=n.length;c<d;c++)n[c]=vh(n[c],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,s){var c,d,p,_,C,M,P=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(c=0,_=this._parts.length;c<_;c++)for(M=this._parts[c],d=0,C=M.length,p=C-1;d<C;p=d++)if(!(!s&&d===0)&&yh(n,M[p],M[d])<=P)return!0;return!1}});function $g(n,s){return new bn(n,s)}bn._flat=Ch;var Ri=bn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _h(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var s=bn.prototype._convertLatLngs.call(this,n),c=s.length;return c>=2&&s[0]instanceof X&&s[0].equals(s[c-1])&&s.pop(),s},_setLatLngs:function(n){bn.prototype._setLatLngs.call(this,n),It(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return It(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,s=this.options.weight,c=new k(s,s);if(n=new ne(n.min.subtract(c),n.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var d=0,p=this._rings.length,_;d<p;d++)_=mh(this._rings[d],n,!0),_.length&&this._parts.push(_)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var s=!1,c,d,p,_,C,M,P,N;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(_=0,P=this._parts.length;_<P;_++)for(c=this._parts[_],C=0,N=c.length,M=N-1;C<N;M=C++)d=c[C],p=c[M],d.y>n.y!=p.y>n.y&&n.x<(p.x-d.x)*(n.y-d.y)/(p.y-d.y)+d.x&&(s=!s);return s||bn.prototype._containsPoint.call(this,n,!0)}});function Wg(n,s){return new Ri(n,s)}var Cn=wn.extend({initialize:function(n,s){y(this,s),this._layers={},n&&this.addData(n)},addData:function(n){var s=x(n)?n:n.features,c,d,p;if(s){for(c=0,d=s.length;c<d;c++)p=s[c],(p.geometries||p.geometry||p.features||p.coordinates)&&this.addData(p);return this}var _=this.options;if(_.filter&&!_.filter(n))return this;var C=Fo(n,_);return C?(C.feature=Vo(n),C.defaultOptions=C.options,this.resetStyle(C),_.onEachFeature&&_.onEachFeature(n,C),this.addLayer(C)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=t({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(s){this._setLayerStyle(s,n)},this)},_setLayerStyle:function(n,s){n.setStyle&&(typeof s=="function"&&(s=s(n.feature)),n.setStyle(s))}});function Fo(n,s){var c=n.type==="Feature"?n.geometry:n,d=c?c.coordinates:null,p=[],_=s&&s.pointToLayer,C=s&&s.coordsToLatLng||$a,M,P,N,W;if(!d&&!c)return null;switch(c.type){case"Point":return M=C(d),Eh(_,n,M,s);case"MultiPoint":for(N=0,W=d.length;N<W;N++)M=C(d[N]),p.push(Eh(_,n,M,s));return new wn(p);case"LineString":case"MultiLineString":return P=No(d,c.type==="LineString"?0:1,C),new bn(P,s);case"Polygon":case"MultiPolygon":return P=No(d,c.type==="Polygon"?1:2,C),new Ri(P,s);case"GeometryCollection":for(N=0,W=c.geometries.length;N<W;N++){var se=Fo({geometry:c.geometries[N],type:"Feature",properties:n.properties},s);se&&p.push(se)}return new wn(p);case"FeatureCollection":for(N=0,W=c.features.length;N<W;N++){var me=Fo(c.features[N],s);me&&p.push(me)}return new wn(p);default:throw new Error("Invalid GeoJSON object.")}}function Eh(n,s,c,d){return n?n(s,c):new Lo(c,d&&d.markersInheritOptions&&d)}function $a(n){return new X(n[1],n[0],n[2])}function No(n,s,c){for(var d=[],p=0,_=n.length,C;p<_;p++)C=s?No(n[p],s-1,c):(c||$a)(n[p]),d.push(C);return d}function Wa(n,s){return n=te(n),n.alt!==void 0?[g(n.lng,s),g(n.lat,s),g(n.alt,s)]:[g(n.lng,s),g(n.lat,s)]}function Bo(n,s,c,d){for(var p=[],_=0,C=n.length;_<C;_++)p.push(s?Bo(n[_],It(n[_])?0:s-1,c,d):Wa(n[_],d));return!s&&c&&p.length>0&&p.push(p[0].slice()),p}function Oi(n,s){return n.feature?t({},n.feature,{geometry:s}):Vo(s)}function Vo(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var Za={toGeoJSON:function(n){return Oi(this,{type:"Point",coordinates:Wa(this.getLatLng(),n)})}};Lo.include(Za),Ha.include(Za),ko.include(Za),bn.include({toGeoJSON:function(n){var s=!It(this._latlngs),c=Bo(this._latlngs,s?1:0,!1,n);return Oi(this,{type:(s?"Multi":"")+"LineString",coordinates:c})}}),Ri.include({toGeoJSON:function(n){var s=!It(this._latlngs),c=s&&!It(this._latlngs[0]),d=Bo(this._latlngs,c?2:s?1:0,!0,n);return s||(d=[d]),Oi(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}}),Pi.include({toMultiPoint:function(n){var s=[];return this.eachLayer(function(c){s.push(c.toGeoJSON(n).geometry.coordinates)}),Oi(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(n){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(n);var c=s==="GeometryCollection",d=[];return this.eachLayer(function(p){if(p.toGeoJSON){var _=p.toGeoJSON(n);if(c)d.push(_.geometry);else{var C=Vo(_);C.type==="FeatureCollection"?d.push.apply(d,C.features):d.push(C)}}}),c?Oi(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});function Mh(n,s){return new Cn(n,s)}var Zg=Mh,zo=Ht.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,s,c){this._url=n,this._bounds=J(s),y(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(pe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){je(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Mi(this._image),this},bringToBack:function(){return this._map&&Ti(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=J(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",s=this._image=n?this._url:Me("img");if(pe(s,"leaflet-image-layer"),this._zoomAnimated&&pe(s,"leaflet-zoom-animated"),this.options.className&&pe(s,this.options.className),s.onselectstart=f,s.onmousemove=f,s.onload=o(this.fire,this,"load"),s.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(n){var s=this._map.getZoomScale(n.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;ni(this._image,c,s)},_reset:function(){var n=this._image,s=new ne(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=s.getSize();qe(n,s.min),n.style.width=c.x+"px",n.style.height=c.y+"px"},_updateOpacity:function(){Ot(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),qg=function(n,s,c){return new zo(n,s,c)},Th=zo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",s=this._image=n?this._url:Me("video");if(pe(s,"leaflet-image-layer"),this._zoomAnimated&&pe(s,"leaflet-zoom-animated"),this.options.className&&pe(s,this.options.className),s.onselectstart=f,s.onmousemove=f,s.onloadeddata=o(this.fire,this,"load"),n){for(var c=s.getElementsByTagName("source"),d=[],p=0;p<c.length;p++)d.push(c[p].src);this._url=c.length>0?d:[s.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var _=0;_<this._url.length;_++){var C=Me("source");C.src=this._url[_],s.appendChild(C)}}});function Yg(n,s,c){return new Th(n,s,c)}var Ph=zo.extend({_initImage:function(){var n=this._image=this._url;pe(n,"leaflet-image-layer"),this._zoomAnimated&&pe(n,"leaflet-zoom-animated"),this.options.className&&pe(n,this.options.className),n.onselectstart=f,n.onmousemove=f}});function Xg(n,s,c){return new Ph(n,s,c)}var ln=Ht.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,s){n&&(n instanceof X||x(n))?(this._latlng=te(n),y(this,s)):(y(this,n),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Ot(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Ot(this._container,1),this.bringToFront(),this.options.interactive&&(pe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Ot(this._container,0),this._removeTimeout=setTimeout(o(je,void 0,this._container),200)):je(this._container),this.options.interactive&&(We(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=te(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Mi(this._container),this},bringToBack:function(){return this._map&&Ti(this._container),this},_prepareOpen:function(n){var s=this._source;if(!s._map)return!1;if(s instanceof wn){s=null;var c=this._source._layers;for(var d in c)if(c[d]._map){s=c[d];break}if(!s)return!1;this._source=s}if(!n)if(s.getCenter)n=s.getCenter();else if(s.getLatLng)n=s.getLatLng();else if(s.getBounds)n=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")n.innerHTML=s;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),s=B(this.options.offset),c=this._getAnchor();this._zoomAnimated?qe(this._container,n.add(c)):s=s.add(n).add(c);var d=this._containerBottom=-s.y,p=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=d+"px",this._container.style.left=p+"px"}},_getAnchor:function(){return[0,0]}});xe.include({_initOverlay:function(n,s,c,d){var p=s;return p instanceof n||(p=new n(d).setContent(s)),c&&p.setLatLng(c),p}}),Ht.include({_initOverlay:function(n,s,c,d){var p=c;return p instanceof n?(y(p,d),p._source=this):(p=s&&!d?s:new n(d,this),p.setContent(c)),p}});var Uo=ln.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,ln.prototype.openOn.call(this,n)},onAdd:function(n){ln.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof kn||this._source.on("preclick",ri))},onRemove:function(n){ln.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof kn||this._source.off("preclick",ri))},getEvents:function(){var n=ln.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",s=this._container=Me("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=Me("div",n+"-content-wrapper",s);if(this._contentNode=Me("div",n+"-content",c),Er(s),Fa(this._contentNode),fe(s,"contextmenu",ri),this._tipContainer=Me("div",n+"-tip-container",s),this._tip=Me("div",n+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=Me("a",n+"-close-button",s);d.setAttribute("role","button"),d.setAttribute("aria-label","Close popup"),d.href="#close",d.innerHTML='<span aria-hidden="true">&#215;</span>',fe(d,"click",function(p){at(p),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,s=n.style;s.width="",s.whiteSpace="nowrap";var c=n.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),s.width=c+1+"px",s.whiteSpace="",s.height="";var d=n.offsetHeight,p=this.options.maxHeight,_="leaflet-popup-scrolled";p&&d>p?(s.height=p+"px",pe(n,_)):We(n,_),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),c=this._getAnchor();qe(this._container,s.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,s=parseInt(Cr(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+s,d=this._containerWidth,p=new k(this._containerLeft,-c-this._containerBottom);p._add(ii(this._container));var _=n.layerPointToContainerPoint(p),C=B(this.options.autoPanPadding),M=B(this.options.autoPanPaddingTopLeft||C),P=B(this.options.autoPanPaddingBottomRight||C),N=n.getSize(),W=0,se=0;_.x+d+P.x>N.x&&(W=_.x+d-N.x+P.x),_.x-W-M.x<0&&(W=_.x-M.x),_.y+c+P.y>N.y&&(se=_.y+c-N.y+P.y),_.y-se-M.y<0&&(se=_.y-M.y),(W||se)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([W,se]))}},_getAnchor:function(){return B(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Kg=function(n,s){return new Uo(n,s)};xe.mergeOptions({closePopupOnClick:!0}),xe.include({openPopup:function(n,s,c){return this._initOverlay(Uo,n,s,c).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Ht.include({bindPopup:function(n,s){return this._popup=this._initOverlay(Uo,this._popup,n,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof wn||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){oi(n);var s=n.layer||n.target;if(this._popup._source===s&&!(s instanceof kn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=s,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var Go=ln.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){ln.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){ln.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=ln.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",s=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Me("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var s,c,d=this._map,p=this._container,_=d.latLngToContainerPoint(d.getCenter()),C=d.layerPointToContainerPoint(n),M=this.options.direction,P=p.offsetWidth,N=p.offsetHeight,W=B(this.options.offset),se=this._getAnchor();M==="top"?(s=P/2,c=N):M==="bottom"?(s=P/2,c=0):M==="center"?(s=P/2,c=N/2):M==="right"?(s=0,c=N/2):M==="left"?(s=P,c=N/2):C.x<_.x?(M="right",s=0,c=N/2):(M="left",s=P+(W.x+se.x)*2,c=N/2),n=n.subtract(B(s,c,!0)).add(W).add(se),We(p,"leaflet-tooltip-right"),We(p,"leaflet-tooltip-left"),We(p,"leaflet-tooltip-top"),We(p,"leaflet-tooltip-bottom"),pe(p,"leaflet-tooltip-"+M),qe(p,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Ot(this._container,n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(s)},_getAnchor:function(){return B(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Jg=function(n,s){return new Go(n,s)};xe.include({openTooltip:function(n,s,c){return this._initOverlay(Go,n,s,c).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Ht.include({bindTooltip:function(n,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Go,this._tooltip,n,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var s=n?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[s](c),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof wn||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&(fe(s,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),fe(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var s=n.latlng,c,d;this._tooltip.options.sticky&&n.originalEvent&&(c=this._map.mouseEventToContainerPoint(n.originalEvent),d=this._map.containerPointToLayerPoint(c),s=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(s)}});var Ah=Ai.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var s=n&&n.tagName==="DIV"?n:document.createElement("div"),c=this.options;if(c.html instanceof Element?(To(s),s.appendChild(c.html)):s.innerHTML=c.html!==!1?c.html:"",c.bgPos){var d=B(c.bgPos);s.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function Qg(n){return new Ah(n)}Ai.Default=Pr;var Ar=Ht.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ee.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){y(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),je(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Mi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ti(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=h(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof k?n:new k(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var s=this.getPane().children,c=-n(-1/0,1/0),d=0,p=s.length,_;d<p;d++)_=s[d].style.zIndex,s[d]!==this._container&&_&&(c=n(c,+_));isFinite(c)&&(this.options.zIndex=c+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ee.ielt9){Ot(this._container,this.options.opacity);var n=+new Date,s=!1,c=!1;for(var d in this._tiles){var p=this._tiles[d];if(!(!p.current||!p.loaded)){var _=Math.min(1,(n-p.loaded)/200);Ot(p.el,_),_<1?s=!0:(p.active?c=!0:this._onOpaqueTile(p),p.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),s&&(K(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Me("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,s=this.options.maxZoom;if(n!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===n?(this._levels[c].el.style.zIndex=s-Math.abs(n-c),this._onUpdateLevel(c)):(je(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var d=this._levels[n],p=this._map;return d||(d=this._levels[n]={},d.el=Me("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=s,d.origin=p.project(p.unproject(p.getPixelOrigin()),n).round(),d.zoom=n,this._setZoomTransform(d,p.getCenter(),p.getZoom()),f(d.el.offsetWidth),this._onCreateLevel(d)),this._level=d,d}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var n,s,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)s=this._tiles[n],s.retain=s.current;for(n in this._tiles)if(s=this._tiles[n],s.current&&!s.active){var d=s.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var s in this._tiles)this._tiles[s].coords.z===n&&this._removeTile(s)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)je(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,s,c,d){var p=Math.floor(n/2),_=Math.floor(s/2),C=c-1,M=new k(+p,+_);M.z=+C;var P=this._tileCoordsToKey(M),N=this._tiles[P];return N&&N.active?(N.retain=!0,!0):(N&&N.loaded&&(N.retain=!0),C>d?this._retainParent(p,_,C,d):!1)},_retainChildren:function(n,s,c,d){for(var p=2*n;p<2*n+2;p++)for(var _=2*s;_<2*s+2;_++){var C=new k(p,_);C.z=c+1;var M=this._tileCoordsToKey(C),P=this._tiles[M];if(P&&P.active){P.retain=!0;continue}else P&&P.loaded&&(P.retain=!0);c+1<d&&this._retainChildren(p,_,c+1,d)}},_resetView:function(n){var s=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var s=this.options;return s.minNativeZoom!==void 0&&n<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<n?s.maxNativeZoom:n},_setView:function(n,s,c,d){var p=Math.round(s);this.options.maxZoom!==void 0&&p>this.options.maxZoom||this.options.minZoom!==void 0&&p<this.options.minZoom?p=void 0:p=this._clampZoom(p);var _=this.options.updateWhenZooming&&p!==this._tileZoom;(!d||_)&&(this._tileZoom=p,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),p!==void 0&&this._update(n),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(n,s)},_setZoomTransforms:function(n,s){for(var c in this._levels)this._setZoomTransform(this._levels[c],n,s)},_setZoomTransform:function(n,s,c){var d=this._map.getZoomScale(c,n.zoom),p=n.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(s,c)).round();ee.any3d?ni(n.el,p,d):qe(n.el,p)},_resetGrid:function(){var n=this._map,s=n.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,p=this._map.getPixelWorldBounds(this._tileZoom);p&&(this._globalTileRange=this._pxBoundsToTileRange(p)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,s.wrapLng[0]],d).x/c.x),Math.ceil(n.project([0,s.wrapLng[1]],d).x/c.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([s.wrapLat[0],0],d).y/c.x),Math.ceil(n.project([s.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var s=this._map,c=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),d=s.getZoomScale(c,this._tileZoom),p=s.project(n,this._tileZoom).floor(),_=s.getSize().divideBy(d*2);return new ne(p.subtract(_),p.add(_))},_update:function(n){var s=this._map;if(s){var c=this._clampZoom(s.getZoom());if(n===void 0&&(n=s.getCenter()),this._tileZoom!==void 0){var d=this._getTiledPixelBounds(n),p=this._pxBoundsToTileRange(d),_=p.getCenter(),C=[],M=this.options.keepBuffer,P=new ne(p.getBottomLeft().subtract([M,-M]),p.getTopRight().add([M,-M]));if(!(isFinite(p.min.x)&&isFinite(p.min.y)&&isFinite(p.max.x)&&isFinite(p.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var N in this._tiles){var W=this._tiles[N].coords;(W.z!==this._tileZoom||!P.contains(new k(W.x,W.y)))&&(this._tiles[N].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(n,c);return}for(var se=p.min.y;se<=p.max.y;se++)for(var me=p.min.x;me<=p.max.x;me++){var pt=new k(me,se);if(pt.z=this._tileZoom,!!this._isValidTile(pt)){var ot=this._tiles[this._tileCoordsToKey(pt)];ot?ot.current=!0:C.push(pt)}}if(C.sort(function(vt,Li){return vt.distanceTo(_)-Li.distanceTo(_)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Lt=document.createDocumentFragment();for(me=0;me<C.length;me++)this._addTile(C[me],Lt);this._level.el.appendChild(Lt)}}}},_isValidTile:function(n){var s=this._map.options.crs;if(!s.infinite){var c=this._globalTileRange;if(!s.wrapLng&&(n.x<c.min.x||n.x>c.max.x)||!s.wrapLat&&(n.y<c.min.y||n.y>c.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(n);return J(this.options.bounds).overlaps(d)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var s=this._map,c=this.getTileSize(),d=n.scaleBy(c),p=d.add(c),_=s.unproject(d,n.z),C=s.unproject(p,n.z);return[_,C]},_tileCoordsToBounds:function(n){var s=this._tileCoordsToNwSe(n),c=new q(s[0],s[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var s=n.split(":"),c=new k(+s[0],+s[1]);return c.z=+s[2],c},_removeTile:function(n){var s=this._tiles[n];s&&(je(s.el),delete this._tiles[n],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){pe(n,"leaflet-tile");var s=this.getTileSize();n.style.width=s.x+"px",n.style.height=s.y+"px",n.onselectstart=f,n.onmousemove=f,ee.ielt9&&this.options.opacity<1&&Ot(n,this.options.opacity)},_addTile:function(n,s){var c=this._getTilePos(n),d=this._tileCoordsToKey(n),p=this.createTile(this._wrapCoords(n),o(this._tileReady,this,n));this._initTile(p),this.createTile.length<2&&Z(o(this._tileReady,this,n,null,p)),qe(p,c),this._tiles[d]={el:p,coords:n,current:!0},s.appendChild(p),this.fire("tileloadstart",{tile:p,coords:n})},_tileReady:function(n,s,c){s&&this.fire("tileerror",{error:s,tile:c,coords:n});var d=this._tileCoordsToKey(n);c=this._tiles[d],c&&(c.loaded=+new Date,this._map._fadeAnimated?(Ot(c.el,0),K(this._fadeFrame),this._fadeFrame=Z(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),s||(pe(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ee.ielt9||!this._map._fadeAnimated?Z(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var s=new k(this._wrapX?u(n.x,this._wrapX):n.x,this._wrapY?u(n.y,this._wrapY):n.y);return s.z=n.z,s},_pxBoundsToTileRange:function(n){var s=this.getTileSize();return new ne(n.min.unscaleBy(s).floor(),n.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function em(n){return new Ar(n)}var Ii=Ar.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,s){this._url=n,s=y(this,s),s.detectRetina&&ee.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,s){return this._url===n&&s===void 0&&(s=!0),this._url=n,s||this.redraw(),this},createTile:function(n,s){var c=document.createElement("img");return fe(c,"load",o(this._tileOnLoad,this,s,c)),fe(c,"error",o(this._tileOnError,this,s,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(n),c},getTileUrl:function(n){var s={r:ee.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-n.y;this.options.tms&&(s.y=c),s["-y"]=c}return D(this._url,t(s,this.options))},_tileOnLoad:function(n,s){ee.ielt9?setTimeout(o(n,this,null,s),0):n(null,s)},_tileOnError:function(n,s,c){var d=this.options.errorTileUrl;d&&s.getAttribute("src")!==d&&(s.src=d),n(c,s)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,s=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset;return c&&(n=s-n),n+d},_getSubdomain:function(n){var s=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var n,s;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(s=this._tiles[n].el,s.onload=f,s.onerror=f,!s.complete)){s.src=T;var c=this._tiles[n].coords;je(s),delete this._tiles[n],this.fire("tileabort",{tile:s,coords:c})}},_removeTile:function(n){var s=this._tiles[n];if(s)return s.el.setAttribute("src",T),Ar.prototype._removeTile.call(this,n)},_tileReady:function(n,s,c){if(!(!this._map||c&&c.getAttribute("src")===T))return Ar.prototype._tileReady.call(this,n,s,c)}});function Rh(n,s){return new Ii(n,s)}var Oh=Ii.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,s){this._url=n;var c=t({},this.defaultWmsParams);for(var d in s)d in this.options||(c[d]=s[d]);s=y(this,s);var p=s.detectRetina&&ee.retina?2:1,_=this.getTileSize();c.width=_.x*p,c.height=_.y*p,this.wmsParams=c},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,Ii.prototype.onAdd.call(this,n)},getTileUrl:function(n){var s=this._tileCoordsToNwSe(n),c=this._crs,d=be(c.project(s[0]),c.project(s[1])),p=d.min,_=d.max,C=(this._wmsVersion>=1.3&&this._crs===Dh?[p.y,p.x,_.y,_.x]:[p.x,p.y,_.x,_.y]).join(","),M=Ii.prototype.getTileUrl.call(this,n);return M+b(this.wmsParams,M,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(n,s){return t(this.wmsParams,n),s||this.redraw(),this}});function tm(n,s){return new Oh(n,s)}Ii.WMS=Oh,Rh.wms=tm;var Sn=Ht.extend({options:{padding:.1},initialize:function(n){y(this,n),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),pe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,s){var c=this._map.getZoomScale(s,this._zoom),d=this._map.getSize().multiplyBy(.5+this.options.padding),p=this._map.project(this._center,s),_=d.multiplyBy(-c).add(p).subtract(this._map._getNewPixelOrigin(n,s));ee.any3d?ni(this._container,_,c):qe(this._container,_)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,s=this._map.getSize(),c=this._map.containerPointToLayerPoint(s.multiplyBy(-n)).round();this._bounds=new ne(c,c.add(s.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ih=Sn.extend({options:{tolerance:0},getEvents:function(){var n=Sn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Sn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");fe(n,"mousemove",this._onMouseMove,this),fe(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),fe(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,je(this._container),Ne(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var s in this._layers)n=this._layers[s],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sn.prototype._update.call(this);var n=this._bounds,s=this._container,c=n.getSize(),d=ee.retina?2:1;qe(s,n.min),s.width=d*c.x,s.height=d*c.y,s.style.width=c.x+"px",s.style.height=c.y+"px",ee.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){Sn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[l(n)]=n;var s=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var s=n._order,c=s.next,d=s.prev;c?c.prev=d:this._drawLast=d,d?d.next=c:this._drawFirst=c,delete n._order,delete this._layers[l(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var s=n.options.dashArray.split(/[, ]+/),c=[],d,p;for(p=0;p<s.length;p++){if(d=Number(s[p]),isNaN(d))return;c.push(d)}n.options._dashArray=c}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||Z(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var s=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new ne,this._redrawBounds.extend(n._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(n._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var s=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,s=this._redrawBounds;if(this._ctx.save(),s){var c=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)n=d.layer,(!s||n._pxBounds&&n._pxBounds.intersects(s))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,s){if(this._drawing){var c,d,p,_,C=n._parts,M=C.length,P=this._ctx;if(M){for(P.beginPath(),c=0;c<M;c++){for(d=0,p=C[c].length;d<p;d++)_=C[c][d],P[d?"lineTo":"moveTo"](_.x,_.y);s&&P.closePath()}this._fillStroke(P,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var s=n._point,c=this._ctx,d=Math.max(Math.round(n._radius),1),p=(Math.max(Math.round(n._radiusY),1)||d)/d;p!==1&&(c.save(),c.scale(1,p)),c.beginPath(),c.arc(s.x,s.y/p,d,0,Math.PI*2,!1),p!==1&&c.restore(),this._fillStroke(c,n)}},_fillStroke:function(n,s){var c=s.options;c.fill&&(n.globalAlpha=c.fillOpacity,n.fillStyle=c.fillColor||c.color,n.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(n.setLineDash&&n.setLineDash(s.options&&s.options._dashArray||[]),n.globalAlpha=c.opacity,n.lineWidth=c.weight,n.strokeStyle=c.color,n.lineCap=c.lineCap,n.lineJoin=c.lineJoin,n.stroke())},_onClick:function(n){for(var s=this._map.mouseEventToLayerPoint(n),c,d,p=this._drawFirst;p;p=p.next)c=p.layer,c.options.interactive&&c._containsPoint(s)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(c))&&(d=c);this._fireEvent(d?[d]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,s)}},_handleMouseOut:function(n){var s=this._hoveredLayer;s&&(We(this._container,"leaflet-interactive"),this._fireEvent([s],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,s){if(!this._mouseHoverThrottled){for(var c,d,p=this._drawFirst;p;p=p.next)c=p.layer,c.options.interactive&&c._containsPoint(s)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(n),d&&(pe(this._container,"leaflet-interactive"),this._fireEvent([d],n,"mouseover"),this._hoveredLayer=d)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,s,c){this._map._fireDOMEvent(s,c||s.type,n)},_bringToFront:function(n){var s=n._order;if(s){var c=s.next,d=s.prev;if(c)c.prev=d;else return;d?d.next=c:c&&(this._drawFirst=c),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(n)}},_bringToBack:function(n){var s=n._order;if(s){var c=s.next,d=s.prev;if(d)d.next=c;else return;c?c.prev=d:d&&(this._drawLast=d),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(n)}}});function Lh(n){return ee.canvas?new Ih(n):null}var Rr=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),nm={_initContainer:function(){this._container=Me("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Sn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var s=n._container=Rr("shape");pe(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",n._path=Rr("path"),s.appendChild(n._path),this._updateStyle(n),this._layers[l(n)]=n},_addPath:function(n){var s=n._container;this._container.appendChild(s),n.options.interactive&&n.addInteractiveTarget(s)},_removePath:function(n){var s=n._container;je(s),n.removeInteractiveTarget(s),delete this._layers[l(n)]},_updateStyle:function(n){var s=n._stroke,c=n._fill,d=n.options,p=n._container;p.stroked=!!d.stroke,p.filled=!!d.fill,d.stroke?(s||(s=n._stroke=Rr("stroke")),p.appendChild(s),s.weight=d.weight+"px",s.color=d.color,s.opacity=d.opacity,d.dashArray?s.dashStyle=x(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=d.lineCap.replace("butt","flat"),s.joinstyle=d.lineJoin):s&&(p.removeChild(s),n._stroke=null),d.fill?(c||(c=n._fill=Rr("fill")),p.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(p.removeChild(c),n._fill=null)},_updateCircle:function(n){var s=n._point.round(),c=Math.round(n._radius),d=Math.round(n._radiusY||c);this._setPath(n,n._empty()?"M0 0":"AL "+s.x+","+s.y+" "+c+","+d+" 0,"+65535*360)},_setPath:function(n,s){n._path.v=s},_bringToFront:function(n){Mi(n._container)},_bringToBack:function(n){Ti(n._container)}},jo=ee.vml?Rr:Le,Or=Sn.extend({_initContainer:function(){this._container=jo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=jo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){je(this._container),Ne(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Sn.prototype._update.call(this);var n=this._bounds,s=n.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,c.setAttribute("width",s.x),c.setAttribute("height",s.y)),qe(c,n.min),c.setAttribute("viewBox",[n.min.x,n.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(n){var s=n._path=jo("path");n.options.className&&pe(s,n.options.className),n.options.interactive&&pe(s,"leaflet-interactive"),this._updateStyle(n),this._layers[l(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){je(n._path),n.removeInteractiveTarget(n._path),delete this._layers[l(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var s=n._path,c=n.options;s&&(c.stroke?(s.setAttribute("stroke",c.color),s.setAttribute("stroke-opacity",c.opacity),s.setAttribute("stroke-width",c.weight),s.setAttribute("stroke-linecap",c.lineCap),s.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?s.setAttribute("stroke-dasharray",c.dashArray):s.removeAttribute("stroke-dasharray"),c.dashOffset?s.setAttribute("stroke-dashoffset",c.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),c.fill?(s.setAttribute("fill",c.fillColor||c.color),s.setAttribute("fill-opacity",c.fillOpacity),s.setAttribute("fill-rule",c.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(n,s){this._setPath(n,Ke(n._parts,s))},_updateCircle:function(n){var s=n._point,c=Math.max(Math.round(n._radius),1),d=Math.max(Math.round(n._radiusY),1)||c,p="a"+c+","+d+" 0 1,0 ",_=n._empty()?"M0 0":"M"+(s.x-c)+","+s.y+p+c*2+",0 "+p+-c*2+",0 ";this._setPath(n,_)},_setPath:function(n,s){n._path.setAttribute("d",s)},_bringToFront:function(n){Mi(n._path)},_bringToBack:function(n){Ti(n._path)}});ee.vml&&Or.include(nm);function kh(n){return ee.svg||ee.vml?new Or(n):null}xe.include({getRenderer:function(n){var s=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var s=this._paneRenderers[n];return s===void 0&&(s=this._createRenderer({pane:n}),this._paneRenderers[n]=s),s},_createRenderer:function(n){return this.options.preferCanvas&&Lh(n)||kh(n)}});var Fh=Ri.extend({initialize:function(n,s){Ri.prototype.initialize.call(this,this._boundsToLatLngs(n),s)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=J(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function im(n,s){return new Fh(n,s)}Or.create=jo,Or.pointsToPath=Ke,Cn.geometryToLayer=Fo,Cn.coordsToLatLng=$a,Cn.coordsToLatLngs=No,Cn.latLngToCoords=Wa,Cn.latLngsToCoords=Bo,Cn.getFeature=Oi,Cn.asFeature=Vo,xe.mergeOptions({boxZoom:!0});var Nh=an.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){fe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ne(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){je(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Sr(),Ta(),this._startPoint=this._map.mouseEventToContainerPoint(n),fe(document,{contextmenu:oi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=Me("div","leaflet-zoom-box",this._container),pe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var s=new ne(this._point,this._startPoint),c=s.getSize();qe(this._box,s.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(je(this._box),We(this._container,"leaflet-crosshair")),Dr(),Pa(),Ne(document,{contextmenu:oi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var s=new q(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});xe.addInitHook("addHandler","boxZoom",Nh),xe.mergeOptions({doubleClickZoom:!0});var Bh=an.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var s=this._map,c=s.getZoom(),d=s.options.zoomDelta,p=n.originalEvent.shiftKey?c-d:c+d;s.options.doubleClickZoom==="center"?s.setZoom(p):s.setZoomAround(n.containerPoint,p)}});xe.addInitHook("addHandler","doubleClickZoom",Bh),xe.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Vh=an.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Ln(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}pe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){We(this._map._container,"leaflet-grab"),We(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=J(this._map.options.maxBounds);this._offsetLimit=be(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var s=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(s),this._prunePositions(s)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,s){return n-(n-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;n.x<s.min.x&&(n.x=this._viscousLimit(n.x,s.min.x)),n.y<s.min.y&&(n.y=this._viscousLimit(n.y,s.min.y)),n.x>s.max.x&&(n.x=this._viscousLimit(n.x,s.max.x)),n.y>s.max.y&&(n.y=this._viscousLimit(n.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,s=Math.round(n/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,p=(d-s+c)%n+s-c,_=(d+s+c)%n-s-c,C=Math.abs(p+c)<Math.abs(_+c)?p:_;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(n){var s=this._map,c=s.options,d=!c.inertia||n.noInertia||this._times.length<2;if(s.fire("dragend",n),d)s.fire("moveend");else{this._prunePositions(+new Date);var p=this._lastPos.subtract(this._positions[0]),_=(this._lastTime-this._times[0])/1e3,C=c.easeLinearity,M=p.multiplyBy(C/_),P=M.distanceTo([0,0]),N=Math.min(c.inertiaMaxSpeed,P),W=M.multiplyBy(N/P),se=N/(c.inertiaDeceleration*C),me=W.multiplyBy(-se/2).round();!me.x&&!me.y?s.fire("moveend"):(me=s._limitOffset(me,s.options.maxBounds),Z(function(){s.panBy(me,{duration:se,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});xe.addInitHook("addHandler","dragging",Vh),xe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var zh=an.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),fe(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ne(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,s=document.documentElement,c=n.scrollTop||s.scrollTop,d=n.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(d,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var s=this._panKeys={},c=this.keyCodes,d,p;for(d=0,p=c.left.length;d<p;d++)s[c.left[d]]=[-1*n,0];for(d=0,p=c.right.length;d<p;d++)s[c.right[d]]=[n,0];for(d=0,p=c.down.length;d<p;d++)s[c.down[d]]=[0,n];for(d=0,p=c.up.length;d<p;d++)s[c.up[d]]=[0,-1*n]},_setZoomDelta:function(n){var s=this._zoomKeys={},c=this.keyCodes,d,p;for(d=0,p=c.zoomIn.length;d<p;d++)s[c.zoomIn[d]]=n;for(d=0,p=c.zoomOut.length;d<p;d++)s[c.zoomOut[d]]=-n},_addHooks:function(){fe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ne(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var s=n.keyCode,c=this._map,d;if(s in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(d=this._panKeys[s],n.shiftKey&&(d=B(d).multiplyBy(3)),c.options.maxBounds&&(d=c._limitOffset(B(d),c.options.maxBounds)),c.options.worldCopyJump){var p=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(d)));c.panTo(p)}else c.panBy(d)}else if(s in this._zoomKeys)c.setZoom(c.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;oi(n)}}});xe.addInitHook("addHandler","keyboard",zh),xe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Uh=an.extend({addHooks:function(){fe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ne(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var s=uh(n),c=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),d),oi(n)},_performZoom:function(){var n=this._map,s=n.getZoom(),c=this._map.options.zoomSnap||0;n._stop();var d=this._delta/(this._map.options.wheelPxPerZoomLevel*4),p=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,_=c?Math.ceil(p/c)*c:p,C=n._limitZoom(s+(this._delta>0?_:-_))-s;this._delta=0,this._startTime=null,C&&(n.options.scrollWheelZoom==="center"?n.setZoom(s+C):n.setZoomAround(this._lastMousePos,s+C))}});xe.addInitHook("addHandler","scrollWheelZoom",Uh);var rm=600;xe.mergeOptions({tapHold:ee.touchNative&&ee.safari&&ee.mobile,tapTolerance:15});var Gh=an.extend({addHooks:function(){fe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ne(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var s=n.touches[0];this._startPos=this._newPos=new k(s.clientX,s.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(fe(document,"touchend",at),fe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),rm),fe(document,"touchend touchcancel contextmenu",this._cancel,this),fe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Ne(document,"touchend",at),Ne(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Ne(document,"touchend touchcancel contextmenu",this._cancel,this),Ne(document,"touchmove",this._onMove,this)},_onMove:function(n){var s=n.touches[0];this._newPos=new k(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,s){var c=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});c._simulated=!0,s.target.dispatchEvent(c)}});xe.addInitHook("addHandler","tapHold",Gh),xe.mergeOptions({touchZoom:ee.touch,bounceAtZoomLimits:!0});var jh=an.extend({addHooks:function(){pe(this._map._container,"leaflet-touch-zoom"),fe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){We(this._map._container,"leaflet-touch-zoom"),Ne(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var s=this._map;if(!(!n.touches||n.touches.length!==2||s._animatingZoom||this._zooming)){var c=s.mouseEventToContainerPoint(n.touches[0]),d=s.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(c.add(d)._divideBy(2))),this._startDist=c.distanceTo(d),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),fe(document,"touchmove",this._onTouchMove,this),fe(document,"touchend touchcancel",this._onTouchEnd,this),at(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var s=this._map,c=s.mouseEventToContainerPoint(n.touches[0]),d=s.mouseEventToContainerPoint(n.touches[1]),p=c.distanceTo(d)/this._startDist;if(this._zoom=s.getScaleZoom(p,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&p<1||this._zoom>s.getMaxZoom()&&p>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,p===1)return}else{var _=c._add(d)._divideBy(2)._subtract(this._centerPoint);if(p===1&&_.x===0&&_.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(_),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var C=o(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Z(C,this,!0),at(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),Ne(document,"touchmove",this._onTouchMove,this),Ne(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});xe.addInitHook("addHandler","touchZoom",jh),xe.BoxZoom=Nh,xe.DoubleClickZoom=Bh,xe.Drag=Vh,xe.Keyboard=zh,xe.ScrollWheelZoom=Uh,xe.TapHold=Gh,xe.TouchZoom=jh,r.Bounds=ne,r.Browser=ee,r.CRS=Ze,r.Canvas=Ih,r.Circle=Ha,r.CircleMarker=ko,r.Class=Y,r.Control=jt,r.DivIcon=Ah,r.DivOverlay=ln,r.DomEvent=Cg,r.DomUtil=wg,r.Draggable=Ln,r.Evented=Q,r.FeatureGroup=wn,r.GeoJSON=Cn,r.GridLayer=Ar,r.Handler=an,r.Icon=Ai,r.ImageOverlay=zo,r.LatLng=X,r.LatLngBounds=q,r.Layer=Ht,r.LayerGroup=Pi,r.LineUtil=kg,r.Map=xe,r.Marker=Lo,r.Mixin=Pg,r.Path=kn,r.Point=k,r.PolyUtil=Ag,r.Polygon=Ri,r.Polyline=bn,r.Popup=Uo,r.PosAnimation=dh,r.Projection=Fg,r.Rectangle=Fh,r.Renderer=Sn,r.SVG=Or,r.SVGOverlay=Ph,r.TileLayer=Ii,r.Tooltip=Go,r.Transformation=Pe,r.Util=ge,r.VideoOverlay=Th,r.bind=o,r.bounds=be,r.canvas=Lh,r.circle=Hg,r.circleMarker=jg,r.control=Mr,r.divIcon=Qg,r.extend=t,r.featureGroup=zg,r.geoJSON=Mh,r.geoJson=Zg,r.gridLayer=em,r.icon=Ug,r.imageOverlay=qg,r.latLng=te,r.latLngBounds=J,r.layerGroup=Vg,r.map=Sg,r.marker=Gg,r.point=B,r.polygon=Wg,r.polyline=$g,r.popup=Kg,r.rectangle=im,r.setOptions=y,r.stamp=l,r.svg=kh,r.svgOverlay=Xg,r.tileLayer=Rh,r.tooltip=Jg,r.transformation=Ge,r.version=e,r.videoOverlay=Yg;var om=window.L;r.noConflict=function(){return window.L=om,this},window.L=r})});var Su=null;function Vt(){return Su}function ll(r){Su??=r}var zr=class{},Gi=(()=>{class r{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(Du),providedIn:"platform"})}return r})();var Du=(()=>{class r extends Gi{_location;_history;_doc=U(et);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Vt().getBaseHref(this._doc)}onPopState(t){let i=Vt().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){let i=Vt().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,o){this._history.pushState(t,i,o)}replaceState(t,i,o){this._history.replaceState(t,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>new r,providedIn:"platform"})}return r})();function Mu(r,e){return r?e?r.endsWith("/")?e.startsWith("/")?r+e.slice(1):r+e:e.startsWith("/")?r+e:`${r}/${e}`:r:e}function xu(r){let e=r.search(/#|\?|$/);return r[e-1]==="/"?r.slice(0,e-1)+r.slice(e):r}function jn(r){return r&&r[0]!=="?"?`?${r}`:r}var is=(()=>{class r{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(_m),providedIn:"root"})}return r})(),mm=new ye(""),_m=(()=>{class r extends is{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??U(et).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Mu(this._baseHref,t)}path(t=!1){let i=this._platformLocation.pathname+jn(this._platformLocation.search),o=this._platformLocation.hash;return o&&t?`${i}${o}`:i}pushState(t,i,o,a){let l=this.prepareExternalUrl(o+jn(a));this._platformLocation.pushState(t,i,l)}replaceState(t,i,o,a){let l=this.prepareExternalUrl(o+jn(a));this._platformLocation.replaceState(t,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||r)(ve(Gi),ve(mm,8))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),ji=(()=>{class r{_subject=new cn;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let i=this._locationStrategy.getBaseHref();this._basePath=wm(xu(Eu(i))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+jn(i))}normalize(t){return r.stripTrailingSlash(ym(this._basePath,Eu(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",o=null){this._locationStrategy.pushState(o,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+jn(i)),o)}replaceState(t,i="",o=null){this._locationStrategy.replaceState(o,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+jn(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(o=>o(t,i))}subscribe(t,i,o){return this._subject.subscribe({next:t,error:i??void 0,complete:o??void 0})}static normalizeQueryParams=jn;static joinWithSlash=Mu;static stripTrailingSlash=xu;static \u0275fac=function(i){return new(i||r)(ve(is))};static \u0275prov=ie({token:r,factory:()=>vm(),providedIn:"root"})}return r})();function vm(){return new ji(ve(is))}function ym(r,e){if(!r||!e.startsWith(r))return e;let t=e.substring(r.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Eu(r){return r.replace(/\/index.html$/,"")}function wm(r){if(new RegExp("^(https?:)?//").test(r)){let[,t]=r.split(/\/\/[^\/]+/);return t}return r}var st=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=En({type:r});static \u0275inj=xn({})}return r})();function Ur(r,e){e=encodeURIComponent(e);for(let t of r.split(";")){let i=t.indexOf("="),[o,a]=i==-1?[t,""]:[t.slice(0,i),t.slice(i+1)];if(o.trim()===e)return decodeURIComponent(a)}return null}var di=class{};var cl="browser";function hl(r){return r===cl}var Gr=class{_doc;constructor(e){this._doc=e}manager},rs=(()=>{class r extends Gr{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,o,a){return t.addEventListener(i,o,a),()=>this.removeEventListener(t,i,o,a)}removeEventListener(t,i,o,a){return t.removeEventListener(i,o,a)}static \u0275fac=function(i){return new(i||r)(ve(et))};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),as=new ye(""),pl=(()=>{class r{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(l=>{l.manager=this});let o=t.filter(l=>!(l instanceof rs));this._plugins=o.slice().reverse();let a=t.find(l=>l instanceof rs);a&&this._plugins.push(a)}addEventListener(t,i,o,a){return this._findPluginFor(i).addEventListener(t,i,o,a)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(a=>a.supports(t)),!i)throw new Te(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||r)(ve(as),ve(ai))};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),ul="ng-app-id";function Tu(r){for(let e of r)e.remove()}function Pu(r,e){let t=e.createElement("style");return t.textContent=r,t}function Cm(r,e,t,i){let o=r.head?.querySelectorAll(`style[${ul}="${e}"],link[${ul}="${e}"]`);if(o)for(let a of o)a.removeAttribute(ul),a instanceof HTMLLinkElement?i.set(a.href.slice(a.href.lastIndexOf("/")+1),{usage:0,elements:[a]}):a.textContent&&t.set(a.textContent,{usage:0,elements:[a]})}function fl(r,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",r),t}var gl=(()=>{class r{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,i,o,a={}){this.doc=t,this.appId=i,this.nonce=o,Cm(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(let o of t)this.addUsage(o,this.inline,Pu);i?.forEach(o=>this.addUsage(o,this.external,fl))}removeStyles(t,i){for(let o of t)this.removeUsage(o,this.inline);i?.forEach(o=>this.removeUsage(o,this.external))}addUsage(t,i,o){let a=i.get(t);a?a.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(l=>this.addElement(l,o(t,this.doc)))})}removeUsage(t,i){let o=i.get(t);o&&(o.usage--,o.usage<=0&&(Tu(o.elements),i.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Tu(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[i,{elements:o}]of this.inline)o.push(this.addElement(t,Pu(i,this.doc)));for(let[i,{elements:o}]of this.external)o.push(this.addElement(t,fl(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),t.appendChild(i)}static \u0275fac=function(i){return new(i||r)(ve(et),ve(tl),ve(nl,8),ve(zi))};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),dl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},ml=/%COMP%/g;var Ru="%COMP%",Sm=`_nghost-${Ru}`,Dm=`_ngcontent-${Ru}`,xm=!0,Em=new ye("",{factory:()=>xm});function Mm(r){return Dm.replace(ml,r)}function Tm(r){return Sm.replace(ml,r)}function Ou(r,e){return e.map(t=>t.replace(ml,r))}var $r=(()=>{class r{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,i,o,a,l,h,u=null,f=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=a,this.doc=l,this.ngZone=h,this.nonce=u,this.tracingService=f,this.defaultRenderer=new jr(t,l,h,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;let o=this.getOrCreateRenderer(t,i);return o instanceof ss?o.applyToHost(t):o instanceof Hr&&o.applyStyles(),o}getOrCreateRenderer(t,i){let o=this.rendererByCompId,a=o.get(i.id);if(!a){let l=this.doc,h=this.ngZone,u=this.eventManager,f=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,m=this.tracingService;switch(i.encapsulation){case Ko.Emulated:a=new ss(u,f,i,this.appId,g,l,h,m);break;case Ko.ShadowDom:return new os(u,t,i,l,h,this.nonce,m,f);case Ko.ExperimentalIsolatedShadowDom:return new os(u,t,i,l,h,this.nonce,m);default:a=new Hr(u,f,i,g,l,h,m);break}o.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||r)(ve(pl),ve(gl),ve(tl),ve(Em),ve(et),ve(ai),ve(nl),ve(Jo,8))};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),jr=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,o){this.eventManager=e,this.doc=t,this.ngZone=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(dl[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Au(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Au(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Te(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,o){if(o){t=o+":"+t;let a=dl[o];a?e.setAttributeNS(a,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let o=dl[i];o?e.removeAttributeNS(o,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,o){o&(Nr.DashCase|Nr.Important)?e.style.setProperty(t,i,o&Nr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Nr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,o){if(typeof e=="string"&&(e=Vt().getGlobalEventTarget(this.doc,e),!e))throw new Te(5102,!1);let a=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(a=this.tracingService.wrapEventListener(e,t,a)),this.eventManager.addEventListener(e,t,a,o)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Au(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var os=class extends jr{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,i,o,a,l,h,u){super(e,o,a,h),this.hostEl=t,this.sharedStylesHost=u,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let f=i.styles;f=Ou(i.id,f);for(let m of f){let v=document.createElement("style");l&&v.setAttribute("nonce",l),v.textContent=m,this.shadowRoot.appendChild(v)}let g=i.getExternalStyles?.();if(g)for(let m of g){let v=fl(m,o);l&&v.setAttribute("nonce",l),this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},Hr=class extends jr{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,o,a,l,h,u){super(e,a,l,h),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=o;let f=i.styles;this.styles=u?Ou(u,f):f,this.styleUrls=i.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&hu.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ss=class extends Hr{contentAttr;hostAttr;constructor(e,t,i,o,a,l,h,u){let f=o+"-"+i.id;super(e,t,i,a,l,h,u,f),this.contentAttr=Mm(f),this.hostAttr=Tm(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}};var ls=class r extends zr{supportsDOMEvents=!0;static makeCurrent(){ll(new r)}onAndCancel(e,t,i,o){return e.addEventListener(t,i,o),()=>{e.removeEventListener(t,i,o)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=Pm();return t==null?null:Am(t)}resetBaseElement(){Wr=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ur(document.cookie,e)}},Wr=null;function Pm(){return Wr=Wr||document.head.querySelector("base"),Wr?Wr.getAttribute("href"):null}function Am(r){return new URL(r,document.baseURI).pathname}var Rm=(()=>{class r{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),Iu=["alt","control","meta","shift"],Om={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Im={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},Lu=(()=>{class r extends Gr{constructor(t){super(t)}supports(t){return r.parseEventName(t)!=null}addEventListener(t,i,o,a){let l=r.parseEventName(i),h=r.eventCallback(l.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vt().onAndCancel(t,l.domEventName,h,a))}static parseEventName(t){let i=t.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let a=r._normalizeKey(i.pop()),l="",h=i.indexOf("code");if(h>-1&&(i.splice(h,1),l="code."),Iu.forEach(f=>{let g=i.indexOf(f);g>-1&&(i.splice(g,1),l+=f+".")}),l+=a,i.length!=0||a.length===0)return null;let u={};return u.domEventName=o,u.fullKey=l,u}static matchEventFullKeyCode(t,i){let o=Om[t.key]||t.key,a="";return i.indexOf("code.")>-1&&(o=t.code,a="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),Iu.forEach(l=>{if(l!==o){let h=Im[l];h(t)&&(a+=l+".")}}),a+=o,a===i)}static eventCallback(t,i,o){return a=>{r.matchEventFullKeyCode(a,t)&&o.runGuarded(()=>i(a))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(i){return new(i||r)(ve(et))};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})();async function _l(r,e,t){let i=j({rootComponent:r},Lm(e,t));return Cu(i)}function Lm(r,e){return{platformRef:e?.platformRef,appProviders:[...Vm,...r?.providers??[]],platformProviders:Bm}}function km(){ls.makeCurrent()}function Fm(){return new Qa}function Nm(){return au(document),document}var Bm=[{provide:zi,useValue:cl},{provide:lu,useValue:km,multi:!0},{provide:et,useFactory:Nm}];var Vm=[{provide:iu,useValue:"root"},{provide:Qa,useFactory:Fm},{provide:as,useClass:rs,multi:!0},{provide:as,useClass:Lu,multi:!0},$r,gl,pl,{provide:Qo,useExisting:$r},{provide:di,useClass:Rm},[]];var Hn=class r{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let o=t.slice(0,i),a=t.slice(i+1).trim();this.addHeaderEntry(o,a)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new r;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let o=(e.op==="a"?this.headers.get(t):void 0)||[];o.push(...i),this.headers.set(t,o);break;case"d":let a=e.value;if(!a)this.headers.delete(t),this.normalizedNames.delete(t);else{let l=this.headers.get(t);if(!l)return;l=l.filter(h=>a.indexOf(h)===-1),l.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,l)}break}}addHeaderEntry(e,t){let i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(a=>a.toString()),o=e.toLowerCase();this.headers.set(o,i),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var hs=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}},us=class{encodeKey(e){return ku(e)}encodeValue(e){return ku(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function zm(r,e){let t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(o=>{let a=o.indexOf("="),[l,h]=a==-1?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,a)),e.decodeValue(o.slice(a+1))],u=t.get(l)||[];u.push(h),t.set(l,u)}),t}var Um=/%(\d[a-f0-9])/gi,Gm={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ku(r){return encodeURIComponent(r).replace(Um,(e,t)=>Gm[t]??e)}function cs(r){return`${r}`}var Tn=class r{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new us,e.fromString){if(e.fromObject)throw new Te(2805,!1);this.map=zm(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],o=Array.isArray(i)?i.map(cs):[cs(i)];this.map.set(t,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let o=e[i];Array.isArray(o)?o.forEach(a=>{t.push({param:i,value:a,op:"a"})}):t.push({param:i,value:o,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new r({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(cs(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],o=i.indexOf(cs(e.value));o!==-1&&i.splice(o,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};function jm(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Fu(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function Nu(r){return typeof Blob<"u"&&r instanceof Blob}function Bu(r){return typeof FormData<"u"&&r instanceof FormData}function Hm(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Vu="Content-Type",zu="Accept",Uu="text/plain",Gu="application/json",$m=`${Gu}, ${Uu}, */*`,Hi=class r{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;referrerPolicy;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,i,o){this.url=t,this.method=e.toUpperCase();let a;if(jm(this.method)||o?(this.body=i!==void 0?i:null,a=o):a=i,a){if(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,this.keepalive=!!a.keepalive,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params),a.priority&&(this.priority=a.priority),a.cache&&(this.cache=a.cache),a.credentials&&(this.credentials=a.credentials),typeof a.timeout=="number"){if(a.timeout<1||!Number.isInteger(a.timeout))throw new Te(2822,"");this.timeout=a.timeout}a.mode&&(this.mode=a.mode),a.redirect&&(this.redirect=a.redirect),a.integrity&&(this.integrity=a.integrity),a.referrer&&(this.referrer=a.referrer),a.referrerPolicy&&(this.referrerPolicy=a.referrerPolicy),this.transferCache=a.transferCache}if(this.headers??=new Hn,this.context??=new hs,!this.params)this.params=new Tn,this.urlWithParams=t;else{let l=this.params.toString();if(l.length===0)this.urlWithParams=t;else{let h=t.indexOf("?"),u=h===-1?"?":h<t.length-1?"&":"";this.urlWithParams=t+u+l}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Fu(this.body)||Nu(this.body)||Bu(this.body)||Hm(this.body)?this.body:this.body instanceof Tn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Bu(this.body)?null:Nu(this.body)?this.body.type||null:Fu(this.body)?null:typeof this.body=="string"?Uu:this.body instanceof Tn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Gu:null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,o=e.responseType||this.responseType,a=e.keepalive??this.keepalive,l=e.priority||this.priority,h=e.cache||this.cache,u=e.mode||this.mode,f=e.redirect||this.redirect,g=e.credentials||this.credentials,m=e.referrer||this.referrer,v=e.integrity||this.integrity,y=e.referrerPolicy||this.referrerPolicy,b=e.transferCache??this.transferCache,E=e.timeout??this.timeout,D=e.body!==void 0?e.body:this.body,x=e.withCredentials??this.withCredentials,A=e.reportProgress??this.reportProgress,T=e.headers||this.headers,R=e.params||this.params,z=e.context??this.context;return e.setHeaders!==void 0&&(T=Object.keys(e.setHeaders).reduce((G,$)=>G.set($,e.setHeaders[$]),T)),e.setParams&&(R=Object.keys(e.setParams).reduce((G,$)=>G.set($,e.setParams[$]),R)),new r(t,i,D,{params:R,headers:T,context:z,reportProgress:A,responseType:o,withCredentials:x,transferCache:b,keepalive:a,cache:h,priority:l,timeout:E,mode:u,redirect:f,credentials:g,referrer:m,integrity:v,referrerPolicy:y})}},fi=(function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r})(fi||{}),Wi=class{headers;status;statusText;url;ok;type;redirected;responseType;constructor(e,t=200,i="OK"){this.headers=e.headers||new Hn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.redirected=e.redirected,this.responseType=e.responseType,this.ok=this.status>=200&&this.status<300}},ds=class r extends Wi{constructor(e={}){super(e)}type=fi.ResponseHeader;clone(e={}){return new r({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Zr=class r extends Wi{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=fi.Response;clone(e={}){return new r({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0,redirected:e.redirected??this.redirected,responseType:e.responseType??this.responseType})}},$i=class extends Wi{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Wm=200,Zm=204;var qm=new ye("");var Ym=/^\)\]\}',?\n/;var yl=(()=>{class r{xhrFactory;tracingService=U(Jo,{optional:!0});constructor(t){this.xhrFactory=t}maybePropagateTrace(t){return this.tracingService?.propagate?this.tracingService.propagate(t):t}handle(t){if(t.method==="JSONP")throw new Te(-2800,!1);let i=this.xhrFactory;return _e(null).pipe(Bt(()=>new $o(a=>{let l=i.build();if(l.open(t.method,t.urlWithParams),t.withCredentials&&(l.withCredentials=!0),t.headers.forEach((D,x)=>l.setRequestHeader(D,x.join(","))),t.headers.has(zu)||l.setRequestHeader(zu,$m),!t.headers.has(Vu)){let D=t.detectContentTypeHeader();D!==null&&l.setRequestHeader(Vu,D)}if(t.timeout&&(l.timeout=t.timeout),t.responseType){let D=t.responseType.toLowerCase();l.responseType=D!=="json"?D:"text"}let h=t.serializeBody(),u=null,f=()=>{if(u!==null)return u;let D=l.statusText||"OK",x=new Hn(l.getAllResponseHeaders()),A=l.responseURL||t.url;return u=new ds({headers:x,status:l.status,statusText:D,url:A}),u},g=this.maybePropagateTrace(()=>{let{headers:D,status:x,statusText:A,url:T}=f(),R=null;x!==Zm&&(R=typeof l.response>"u"?l.responseText:l.response),x===0&&(x=R?Wm:0);let z=x>=200&&x<300;if(t.responseType==="json"&&typeof R=="string"){let G=R;R=R.replace(Ym,"");try{R=R!==""?JSON.parse(R):null}catch($){R=G,z&&(z=!1,R={error:$,text:R})}}z?(a.next(new Zr({body:R,headers:D,status:x,statusText:A,url:T||void 0})),a.complete()):a.error(new $i({error:R,headers:D,status:x,statusText:A,url:T||void 0}))}),m=this.maybePropagateTrace(D=>{let{url:x}=f(),A=new $i({error:D,status:l.status||0,statusText:l.statusText||"Unknown Error",url:x||void 0});a.error(A)}),v=m;t.timeout&&(v=this.maybePropagateTrace(D=>{let{url:x}=f(),A=new $i({error:new DOMException("Request timed out","TimeoutError"),status:l.status||0,statusText:l.statusText||"Request timeout",url:x||void 0});a.error(A)}));let y=!1,b=this.maybePropagateTrace(D=>{y||(a.next(f()),y=!0);let x={type:fi.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(x.total=D.total),t.responseType==="text"&&l.responseText&&(x.partialText=l.responseText),a.next(x)}),E=this.maybePropagateTrace(D=>{let x={type:fi.UploadProgress,loaded:D.loaded};D.lengthComputable&&(x.total=D.total),a.next(x)});return l.addEventListener("load",g),l.addEventListener("error",m),l.addEventListener("timeout",v),l.addEventListener("abort",m),t.reportProgress&&(l.addEventListener("progress",b),h!==null&&l.upload&&l.upload.addEventListener("progress",E)),l.send(h),a.next({type:fi.Sent}),()=>{l.removeEventListener("error",m),l.removeEventListener("abort",m),l.removeEventListener("load",g),l.removeEventListener("timeout",v),t.reportProgress&&(l.removeEventListener("progress",b),h!==null&&l.upload&&l.upload.removeEventListener("progress",E)),l.readyState!==l.DONE&&l.abort()}})))}static \u0275fac=function(i){return new(i||r)(ve(di))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Xm(r,e){return e(r)}function Km(r,e,t){return(i,o)=>yt(t,()=>e(i,a=>r(a,o)))}var ju=new ye("",{factory:()=>[]}),Hu=new ye(""),$u=new ye("",{factory:()=>!0});var wl=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=ve(yl),o},providedIn:"root"})}return r})();var fs=(()=>{class r{backend;injector;chain=null;pendingTasks=U(su);contributeToStability=U($u);constructor(t,i){this.backend=t,this.injector=i}handle(t){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(ju),...this.injector.get(Hu,[])]));this.chain=i.reduceRight((o,a)=>Km(o,a,this.injector),Xm)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(t,o=>this.backend.handle(o)).pipe(qo(i))}else return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||r)(ve(wl),ve(un))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),bl=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=ve(fs),o},providedIn:"root"})}return r})();function vl(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,credentials:r.credentials,transferCache:r.transferCache,timeout:r.timeout,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,integrity:r.integrity,referrer:r.referrer,referrerPolicy:r.referrerPolicy}}var $n=(()=>{class r{handler;constructor(t){this.handler=t}request(t,i,o={}){let a;if(t instanceof Hi)a=t;else{let u;o.headers instanceof Hn?u=o.headers:u=new Hn(o.headers);let f;o.params&&(o.params instanceof Tn?f=o.params:f=new Tn({fromObject:o.params})),a=new Hi(t,i,o.body!==void 0?o.body:null,{headers:u,context:o.context,params:f,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache,keepalive:o.keepalive,priority:o.priority,cache:o.cache,mode:o.mode,redirect:o.redirect,credentials:o.credentials,referrer:o.referrer,referrerPolicy:o.referrerPolicy,integrity:o.integrity,timeout:o.timeout})}let l=_e(a).pipe(Lr(u=>this.handler.handle(u)));if(t instanceof Hi||o.observe==="events")return l;let h=l.pipe(hn(u=>u instanceof Zr));switch(o.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return h.pipe(Be(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new Te(2806,!1);return u.body}));case"blob":return h.pipe(Be(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new Te(2807,!1);return u.body}));case"text":return h.pipe(Be(u=>{if(u.body!==null&&typeof u.body!="string")throw new Te(2808,!1);return u.body}));default:return h.pipe(Be(u=>u.body))}case"response":return h;default:throw new Te(2809,!1)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Tn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,o={}){return this.request("PATCH",t,vl(o,i))}post(t,i,o={}){return this.request("POST",t,vl(o,i))}put(t,i,o={}){return this.request("PUT",t,vl(o,i))}static \u0275fac=function(i){return new(i||r)(ve(bl))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Jm=new ye("",{factory:()=>!0}),Qm="XSRF-TOKEN",e0=new ye("",{factory:()=>Qm}),t0="X-XSRF-TOKEN",n0=new ye("",{factory:()=>t0}),i0=(()=>{class r{cookieName=U(e0);doc=U(et);lastCookieString="";lastToken=null;parseCount=0;getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ur(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Wu=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:function(i){let o=null;return i?o=new(i||r):o=ve(i0),o},providedIn:"root"})}return r})();function r0(r,e){if(!U(Jm)||r.method==="GET"||r.method==="HEAD")return e(r);try{let o=U(Gi).href,{origin:a}=new URL(o),{origin:l}=new URL(r.url,a);if(a!==l)return e(r)}catch{return e(r)}let t=U(Wu).getToken(),i=U(n0);return t!=null&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,t)})),e(r)}function Cl(...r){let e=[$n,fs,{provide:bl,useExisting:fs},{provide:wl,useFactory:()=>U(qm,{optional:!0})??U(yl)},{provide:ju,useValue:r0,multi:!0}];for(let t of r)e.push(...t.\u0275providers);return Fi(e)}var Zu=(()=>{class r{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||r)(ve(et))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var de="primary",ro=Symbol("RouteTitle"),Ml=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ki(r){return new Ml(r)}function Sl(r,e,t){for(let i=0;i<r.length;i++){let o=r[i],a=e[i];if(o[0]===":")t[o.substring(1)]=a;else if(o!==a.path)return!1}return!0}function s0(r,e,t){let i=t.path.split("/"),o=i.indexOf("**");if(o===-1){if(i.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<r.length))return null;let u={},f=r.slice(0,i.length);return Sl(i,f,u)?{consumed:f,posParams:u}:null}if(o!==i.lastIndexOf("**"))return null;let a=i.slice(0,o),l=i.slice(o+1);if(a.length+l.length>r.length||t.pathMatch==="full"&&e.hasChildren()&&t.path!=="**")return null;let h={};return!Sl(a,r.slice(0,a.length),h)||!Sl(l,r.slice(r.length-l.length),h)?null:{consumed:r,posParams:h}}function ys(r){return new Promise((e,t)=>{r.pipe(Nn()).subscribe({next:i=>e(i),error:i=>t(i)})})}function a0(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!pn(r[t],e[t]))return!1;return!0}function pn(r,e){let t=r?Tl(r):void 0,i=e?Tl(e):void 0;if(!t||!i||t.length!=i.length)return!1;let o;for(let a=0;a<t.length;a++)if(o=t[a],!rd(r[o],e[o]))return!1;return!0}function Tl(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function rd(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),i=[...e].sort();return t.every((o,a)=>i[a]===o)}else return r===e}function l0(r){return r.length>0?r[r.length-1]:null}function vi(r){return Xa(r)?r:ts(r)?Nt(Promise.resolve(r)):_e(r)}function od(r){return Xa(r)?ys(r):Promise.resolve(r)}var c0={exact:ad,subset:ld},sd={exact:h0,subset:u0,ignored:()=>!0};function qu(r,e,t){return c0[t.paths](r.root,e.root,t.matrixParams)&&sd[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function h0(r,e){return pn(r,e)}function ad(r,e,t){if(!gi(r.segments,e.segments)||!ms(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!r.children[i]||!ad(r.children[i],e.children[i],t))return!1;return!0}function u0(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>rd(r[t],e[t]))}function ld(r,e,t){return cd(r,e,e.segments,t)}function cd(r,e,t,i){if(r.segments.length>t.length){let o=r.segments.slice(0,t.length);return!(!gi(o,t)||e.hasChildren()||!ms(o,t,i))}else if(r.segments.length===t.length){if(!gi(r.segments,t)||!ms(r.segments,t,i))return!1;for(let o in e.children)if(!r.children[o]||!ld(r.children[o],e.children[o],i))return!1;return!0}else{let o=t.slice(0,r.segments.length),a=t.slice(r.segments.length);return!gi(r.segments,o)||!ms(r.segments,o,i)||!r.children[de]?!1:cd(r.children[de],e,a,i)}}function ms(r,e,t){return e.every((i,o)=>sd[t](r[o].parameters,i.parameters))}var gn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Ae([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Ki(this.queryParams),this._queryParamMap}toString(){return p0.serialize(this)}},Ae=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _s(this)}},pi=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ki(this.parameters),this._parameterMap}toString(){return ud(this)}};function d0(r,e){return gi(r,e)&&r.every((t,i)=>pn(t.parameters,e[i].parameters))}function gi(r,e){return r.length!==e.length?!1:r.every((t,i)=>t.path===e[i].path)}function f0(r,e){let t=[];return Object.entries(r.children).forEach(([i,o])=>{i===de&&(t=t.concat(e(o,i)))}),Object.entries(r.children).forEach(([i,o])=>{i!==de&&(t=t.concat(e(o,i)))}),t}var Ps=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>new mi,providedIn:"root"})}return r})(),mi=class{parse(e){let t=new Al(e);return new gn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${qr(e.root,!0)}`,i=_0(e.queryParams),o=typeof e.fragment=="string"?`#${g0(e.fragment)}`:"";return`${t}${i}${o}`}},p0=new mi;function _s(r){return r.segments.map(e=>ud(e)).join("/")}function qr(r,e){if(!r.hasChildren())return _s(r);if(e){let t=r.children[de]?qr(r.children[de],!1):"",i=[];return Object.entries(r.children).forEach(([o,a])=>{o!==de&&i.push(`${o}:${qr(a,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=f0(r,(i,o)=>o===de?[qr(r.children[de],!1)]:[`${o}:${qr(i,!1)}`]);return Object.keys(r.children).length===1&&r.children[de]!=null?`${_s(r)}/${t[0]}`:`${_s(r)}/(${t.join("//")})`}}function hd(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ps(r){return hd(r).replace(/%3B/gi,";")}function g0(r){return encodeURI(r)}function Pl(r){return hd(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vs(r){return decodeURIComponent(r)}function Yu(r){return vs(r.replace(/\+/g,"%20"))}function ud(r){return`${Pl(r.path)}${m0(r.parameters)}`}function m0(r){return Object.entries(r).map(([e,t])=>`;${Pl(e)}=${Pl(t)}`).join("")}function _0(r){let e=Object.entries(r).map(([t,i])=>Array.isArray(i)?i.map(o=>`${ps(t)}=${ps(o)}`).join("&"):`${ps(t)}=${ps(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var v0=/^[^\/()?;#]+/;function Dl(r){let e=r.match(v0);return e?e[0]:""}var y0=/^[^\/()?;=#]+/;function w0(r){let e=r.match(y0);return e?e[0]:""}var b0=/^[^=?&#]+/;function C0(r){let e=r.match(b0);return e?e[0]:""}var S0=/^[^&#]+/;function D0(r){let e=r.match(S0);return e?e[0]:""}var Al=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ae([],{}):new Ae([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[de]=new Ae(e,t)),i}parseSegment(){let e=Dl(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Te(4009,!1);return this.capture(e),new pi(vs(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=w0(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=Dl(this.remaining);o&&(i=o,this.capture(i))}e[vs(t)]=vs(i)}parseQueryParam(e){let t=C0(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let l=D0(this.remaining);l&&(i=l,this.capture(i))}let o=Yu(t),a=Yu(i);if(e.hasOwnProperty(o)){let l=e[o];Array.isArray(l)||(l=[l],e[o]=l),l.push(a)}else e[o]=a}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=Dl(this.remaining),o=this.remaining[i.length];if(o!=="/"&&o!==")"&&o!==";")throw new Te(4010,!1);let a;i.indexOf(":")>-1?(a=i.slice(0,i.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=de);let l=this.parseChildren();t[a??de]=Object.keys(l).length===1&&l[de]?l[de]:new Ae([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Te(4011,!1)}};function dd(r){return r.segments.length>0?new Ae([],{[de]:r}):r}function fd(r){let e={};for(let[i,o]of Object.entries(r.children)){let a=fd(o);if(i===de&&a.segments.length===0&&a.hasChildren())for(let[l,h]of Object.entries(a.children))e[l]=h;else(a.segments.length>0||a.hasChildren())&&(e[i]=a)}let t=new Ae(r.segments,e);return x0(t)}function x0(r){if(r.numberOfChildren===1&&r.children[de]){let e=r.children[de];return new Ae(r.segments.concat(e.segments),e.children)}return r}function Ji(r){return r instanceof gn}function E0(r,e,t=null,i=null,o=new mi){let a=pd(r);return gd(a,e,t,i,o)}function pd(r){let e;function t(a){let l={};for(let u of a.children){let f=t(u);l[u.outlet]=f}let h=new Ae(a.url,l);return a===r&&(e=h),h}let i=t(r.root),o=dd(i);return e??o}function gd(r,e,t,i,o){let a=r;for(;a.parent;)a=a.parent;if(e.length===0)return xl(a,a,a,t,i,o);let l=M0(e);if(l.toRoot())return xl(a,a,new Ae([],{}),t,i,o);let h=T0(l,a,r),u=h.processChildren?Xr(h.segmentGroup,h.index,l.commands):_d(h.segmentGroup,h.index,l.commands);return xl(a,h.segmentGroup,u,t,i,o)}function ws(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function Qr(r){return typeof r=="object"&&r!=null&&r.outlets}function Xu(r,e,t){r||="\u0275";let i=new gn;return i.queryParams={[r]:e},t.parse(t.serialize(i)).queryParams[r]}function xl(r,e,t,i,o,a){let l={};for(let[f,g]of Object.entries(i??{}))l[f]=Array.isArray(g)?g.map(m=>Xu(f,m,a)):Xu(f,g,a);let h;r===e?h=t:h=md(r,e,t);let u=dd(fd(h));return new gn(u,l,o)}function md(r,e,t){let i={};return Object.entries(r.children).forEach(([o,a])=>{a===e?i[o]=t:i[o]=md(a,e,t)}),new Ae(r.segments,i)}var bs=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&ws(i[0]))throw new Te(4003,!1);let o=i.find(Qr);if(o&&o!==l0(i))throw new Te(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function M0(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new bs(!0,0,r);let e=0,t=!1,i=r.reduce((o,a,l)=>{if(typeof a=="object"&&a!=null){if(a.outlets){let h={};return Object.entries(a.outlets).forEach(([u,f])=>{h[u]=typeof f=="string"?f.split("/"):f}),[...o,{outlets:h}]}if(a.segmentPath)return[...o,a.segmentPath]}return typeof a!="string"?[...o,a]:l===0?(a.split("/").forEach((h,u)=>{u==0&&h==="."||(u==0&&h===""?t=!0:h===".."?e++:h!=""&&o.push(h))}),o):[...o,a]},[]);return new bs(t,e,i)}var qi=class{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function T0(r,e,t){if(r.isAbsolute)return new qi(e,!0,0);if(!t)return new qi(e,!1,NaN);if(t.parent===null)return new qi(t,!0,0);let i=ws(r.commands[0])?0:1,o=t.segments.length-1+i;return P0(t,o,r.numberOfDoubleDots)}function P0(r,e,t){let i=r,o=e,a=t;for(;a>o;){if(a-=o,i=i.parent,!i)throw new Te(4005,!1);o=i.segments.length}return new qi(i,!1,o-a)}function A0(r){return Qr(r[0])?r[0].outlets:{[de]:r}}function _d(r,e,t){if(r??=new Ae([],{}),r.segments.length===0&&r.hasChildren())return Xr(r,e,t);let i=R0(r,e,t),o=t.slice(i.commandIndex);if(i.match&&i.pathIndex<r.segments.length){let a=new Ae(r.segments.slice(0,i.pathIndex),{});return a.children[de]=new Ae(r.segments.slice(i.pathIndex),r.children),Xr(a,0,o)}else return i.match&&o.length===0?new Ae(r.segments,{}):i.match&&!r.hasChildren()?Rl(r,e,t):i.match?Xr(r,0,o):Rl(r,e,t)}function Xr(r,e,t){if(t.length===0)return new Ae(r.segments,{});{let i=A0(t),o={};if(Object.keys(i).some(a=>a!==de)&&r.children[de]&&r.numberOfChildren===1&&r.children[de].segments.length===0){let a=Xr(r.children[de],e,t);return new Ae(r.segments,a.children)}return Object.entries(i).forEach(([a,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(o[a]=_d(r.children[a],e,l))}),Object.entries(r.children).forEach(([a,l])=>{i[a]===void 0&&(o[a]=l)}),new Ae(r.segments,o)}}function R0(r,e,t){let i=0,o=e,a={match:!1,pathIndex:0,commandIndex:0};for(;o<r.segments.length;){if(i>=t.length)return a;let l=r.segments[o],h=t[i];if(Qr(h))break;let u=`${h}`,f=i<t.length-1?t[i+1]:null;if(o>0&&u===void 0)break;if(u&&f&&typeof f=="object"&&f.outlets===void 0){if(!Ju(u,f,l))return a;i+=2}else{if(!Ju(u,{},l))return a;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}function Rl(r,e,t){let i=r.segments.slice(0,e),o=0;for(;o<t.length;){let a=t[o];if(Qr(a)){let u=O0(a.outlets);return new Ae(i,u)}if(o===0&&ws(t[0])){let u=r.segments[e];i.push(new pi(u.path,Ku(t[0]))),o++;continue}let l=Qr(a)?a.outlets[de]:`${a}`,h=o<t.length-1?t[o+1]:null;l&&h&&ws(h)?(i.push(new pi(l,Ku(h))),o+=2):(i.push(new pi(l,{})),o++)}return new Ae(i,{})}function O0(r){let e={};return Object.entries(r).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=Rl(new Ae([],{}),0,i))}),e}function Ku(r){let e={};return Object.entries(r).forEach(([t,i])=>e[t]=`${i}`),e}function Ju(r,e,t){return r==t.path&&pn(e,t.parameters)}var Kr="imperative",ct=(function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r})(ct||{}),zt=class{id;url;constructor(e,t){this.id=e,this.url=t}},Qi=class extends zt{type=ct.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",o=null){super(e,t),this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Wn=class extends zt{urlAfterRedirects;type=ct.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},mt=(function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r[r.Aborted=4]="Aborted",r})(mt||{}),Cs=(function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r})(Cs||{}),Jt=class extends zt{reason;code;type=ct.NavigationCancel;constructor(e,t,i,o){super(e,t),this.reason=i,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}};function vd(r){return r instanceof Jt&&(r.code===mt.Redirect||r.code===mt.SupersededByNewNavigation)}var Zn=class extends zt{reason;code;type=ct.NavigationSkipped;constructor(e,t,i,o){super(e,t),this.reason=i,this.code=o}},er=class extends zt{error;target;type=ct.NavigationError;constructor(e,t,i,o){super(e,t),this.error=i,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},eo=class extends zt{urlAfterRedirects;state;type=ct.RoutesRecognized;constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ol=class extends zt{urlAfterRedirects;state;type=ct.GuardsCheckStart;constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Il=class extends zt{urlAfterRedirects;state;shouldActivate;type=ct.GuardsCheckEnd;constructor(e,t,i,o,a){super(e,t),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ll=class extends zt{urlAfterRedirects;state;type=ct.ResolveStart;constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kl=class extends zt{urlAfterRedirects;state;type=ct.ResolveEnd;constructor(e,t,i,o){super(e,t),this.urlAfterRedirects=i,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fl=class{route;type=ct.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Nl=class{route;type=ct.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Bl=class{snapshot;type=ct.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Vl=class{snapshot;type=ct.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zl=class{snapshot;type=ct.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ul=class{snapshot;type=ct.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var tr=class{},nr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function I0(r){return!(r instanceof tr)&&!(r instanceof nr)}var Gl=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return this.route?.snapshot._environmentInjector??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new oo(this.rootInjector)}},oo=(()=>{class r{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){let o=this.getOrCreateContext(t);o.outlet=i,this.contexts.set(t,o)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Gl(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||r)(ve(un))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ss=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=jl(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=jl(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Hl(e,this._root);return t.length<2?[]:t[t.length-2].children.map(o=>o.value).filter(o=>o!==e)}pathFromRoot(e){return Hl(e,this._root).map(t=>t.value)}};function jl(r,e){if(r===e.value)return e;for(let t of e.children){let i=jl(r,t);if(i)return i}return null}function Hl(r,e){if(r===e.value)return[e];for(let t of e.children){let i=Hl(r,t);if(i.length)return i.unshift(e),i}return[]}var Mt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Zi(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var Ds=class extends Ss{snapshot;constructor(e,t){super(e),this.snapshot=t,Ql(this,e)}toString(){return this.snapshot.toString()}};function yd(r,e){let t=L0(r,e),i=new kt([new pi("",{})]),o=new kt({}),a=new kt({}),l=new kt({}),h=new kt(""),u=new _i(i,o,l,h,a,de,r,t.root);return u.snapshot=t.root,new Ds(new Mt(u,[]),t)}function L0(r,e){let t={},i={},o={},l=new Yi([],t,o,"",i,de,r,null,{},e);return new Es("",new Mt(l,[]))}var _i=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,o,a,l,h,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=o,this.dataSubject=a,this.outlet=l,this.component=h,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(Be(f=>f[ro]))??_e(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=o,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Be(e=>Ki(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Be(e=>Ki(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function xs(r,e,t="emptyOnly"){let i,{routeConfig:o}=r;return e!==null&&(t==="always"||o?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:j(j({},e.params),r.params),data:j(j({},e.data),r.data),resolve:j(j(j(j({},r.data),e.data),o?.data),r._resolvedData)}:i={params:j({},r.params),data:j({},r.data),resolve:j(j({},r.data),r._resolvedData??{})},o&&bd(o)&&(i.resolve[ro]=o.title),i}var Yi=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;_environmentInjector;get title(){return this.data?.[ro]}constructor(e,t,i,o,a,l,h,u,f,g){this.url=e,this.params=t,this.queryParams=i,this.fragment=o,this.data=a,this.outlet=l,this.component=h,this.routeConfig=u,this._resolve=f,this._environmentInjector=g}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ki(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ki(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Es=class extends Ss{url;constructor(e,t){super(t),this.url=e,Ql(this,t)}toString(){return wd(this._root)}};function Ql(r,e){e.value._routerState=r,e.children.forEach(t=>Ql(r,t))}function wd(r){let e=r.children.length>0?` { ${r.children.map(wd).join(", ")} } `:"";return`${r.value}${e}`}function El(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,pn(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),pn(e.params,t.params)||r.paramsSubject.next(t.params),a0(e.url,t.url)||r.urlSubject.next(t.url),pn(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function $l(r,e){let t=pn(r.params,e.params)&&d0(r.url,e.url),i=!r.parent!=!e.parent;return t&&!i&&(!r.parent||$l(r.parent,e.parent))}function bd(r){return typeof r.title=="string"||r.title===null}var k0=new ye(""),Cd=(()=>{class r{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=de;activateEvents=new $t;deactivateEvents=new $t;attachEvents=new $t;detachEvents=new $t;routerOutletData=Ue();parentContexts=U(oo);location=U(rl);changeDetector=U(Vr);inputBinder=U(As,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:o}=t.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Te(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Te(4013,!1);this._activatedRoute=t;let o=this.location,l=t.snapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,u=new Wl(t,h,o.injector,this.routerOutletData);this.activated=o.createComponent(l,{index:o.length,injector:u,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||r)};static \u0275dir=Wt({type:r,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Bi]})}return r})(),Wl=class{route;childContexts;parent;outletData;constructor(e,t,i,o){this.route=e,this.childContexts=t,this.parent=i,this.outletData=o}get(e,t){return e===_i?this.route:e===oo?this.childContexts:e===k0?this.outletData:this.parent.get(e,t)}},As=new ye("");var Sd=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275cmp=Xe({type:r,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,o){i&1&&nt(0,"router-outlet")},dependencies:[Cd],encapsulation:2})}return r})();function ec(r){let e=r.children&&r.children.map(ec),t=e?Oe(j({},r),{children:e}):j({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==de&&(t.component=Sd),t}function F0(r,e,t){let i=to(r,e._root,t?t._root:void 0);return new Ds(i,e)}function to(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let o=N0(r,e,t);return new Mt(i,o)}else{if(r.shouldAttach(e.value)){let a=r.retrieve(e.value);if(a!==null){let l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>to(r,h)),l}}let i=B0(e.value),o=e.children.map(a=>to(r,a));return new Mt(i,o)}}function N0(r,e,t){return e.children.map(i=>{for(let o of t.children)if(r.shouldReuseRoute(i.value,o.value.snapshot))return to(r,i,o);return to(r,i)})}function B0(r){return new _i(new kt(r.url),new kt(r.params),new kt(r.queryParams),new kt(r.fragment),new kt(r.data),r.outlet,r.component,r)}var no=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Dd="ngNavigationCancelingError";function Ms(r,e){let{redirectTo:t,navigationBehaviorOptions:i}=Ji(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,o=xd(!1,mt.Redirect);return o.url=t,o.navigationBehaviorOptions=i,o}function xd(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[Dd]=!0,t.cancellationCode=e,t}function V0(r){return Ed(r)&&Ji(r.url)}function Ed(r){return!!r&&r[Dd]}var Zl=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,o,a){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=o,this.inputBindingEnabled=a}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),El(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let o=Zi(t);e.children.forEach(a=>{let l=a.value.outlet;this.deactivateRoutes(a,o[l],i),delete o[l]}),Object.values(o).forEach(a=>{this.deactivateRouteAndItsChildren(a,i)})}deactivateRoutes(e,t,i){let o=e.value,a=t?t.value:null;if(o===a)if(o.component){let l=i.getContext(o.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,i);else a&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),o=i&&e.value.component?i.children:t,a=Zi(e);for(let l of Object.values(a))this.deactivateRouteAndItsChildren(l,o);if(i&&i.outlet){let l=i.outlet.detach(),h=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),o=i&&e.value.component?i.children:t,a=Zi(e);for(let l of Object.values(a))this.deactivateRouteAndItsChildren(l,o);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let o=Zi(t);e.children.forEach(a=>{this.activateRoutes(a,o[a.value.outlet],i),this.forwardEvent(new Ul(a.value.snapshot))}),e.children.length&&this.forwardEvent(new Vl(e.value.snapshot))}activateRoutes(e,t,i){let o=e.value,a=t?t.value:null;if(El(o),o===a)if(o.component){let l=i.getOrCreateContext(o.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,i);else if(o.component){let l=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let h=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),El(h.route.value),this.activateChildRoutes(e,null,l.children)}else l.attachRef=null,l.route=o,l.outlet&&l.outlet.activateWith(o,l.injector),this.activateChildRoutes(e,null,l.children)}else this.activateChildRoutes(e,null,i)}},Ts=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Xi=class{component;route;constructor(e,t){this.component=e,this.route=t}};function z0(r,e,t){let i=r._root,o=e?e._root:null;return Yr(i,o,t,[i.value])}function U0(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function rr(r,e){let t=Symbol(),i=e.get(r,t);return i===t?typeof r=="function"&&!nu(r)?r:e.get(r):i}function Yr(r,e,t,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let a=Zi(e);return r.children.forEach(l=>{G0(l,a[l.value.outlet],t,i.concat([l.value]),o),delete a[l.value.outlet]}),Object.entries(a).forEach(([l,h])=>Jr(h,t.getContext(l),o)),o}function G0(r,e,t,i,o={canDeactivateChecks:[],canActivateChecks:[]}){let a=r.value,l=e?e.value:null,h=t?t.getContext(r.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){let u=j0(l,a,a.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new Ts(i)):(a.data=l.data,a._resolvedData=l._resolvedData),a.component?Yr(r,e,h?h.children:null,i,o):Yr(r,e,t,i,o),u&&h&&h.outlet&&h.outlet.isActivated&&o.canDeactivateChecks.push(new Xi(h.outlet.component,l))}else l&&Jr(e,h,o),o.canActivateChecks.push(new Ts(i)),a.component?Yr(r,null,h?h.children:null,i,o):Yr(r,null,t,i,o);return o}function j0(r,e,t){if(typeof t=="function")return yt(e._environmentInjector,()=>t(r,e));switch(t){case"pathParamsChange":return!gi(r.url,e.url);case"pathParamsOrQueryParamsChange":return!gi(r.url,e.url)||!pn(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$l(r,e)||!pn(r.queryParams,e.queryParams);default:return!$l(r,e)}}function Jr(r,e,t){let i=Zi(r),o=r.value;Object.entries(i).forEach(([a,l])=>{o.component?e?Jr(l,e.children.getContext(a),t):Jr(l,null,t):Jr(l,e,t)}),o.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Xi(e.outlet.component,o)):t.canDeactivateChecks.push(new Xi(null,o)):t.canDeactivateChecks.push(new Xi(null,o))}function so(r){return typeof r=="function"}function H0(r){return typeof r=="boolean"}function $0(r){return r&&so(r.canLoad)}function W0(r){return r&&so(r.canActivate)}function Z0(r){return r&&so(r.canActivateChild)}function q0(r){return r&&so(r.canDeactivate)}function Y0(r){return r&&so(r.canMatch)}function Md(r){return r instanceof Xh||r?.name==="EmptyError"}var gs=Symbol("INITIAL_VALUE");function ir(){return Bt(r=>Kh(r.map(e=>e.pipe(ki(1),tu(gs)))).pipe(Be(e=>{for(let t of e)if(t!==!0){if(t===gs)return gs;if(t===!1||X0(t))return t}return!0}),hn(e=>e!==gs),ki(1)))}function X0(r){return Ji(r)||r instanceof no}function Td(r){return r.aborted?_e(void 0).pipe(ki(1)):new $o(e=>{let t=()=>{e.next(),e.complete()};return r.addEventListener("abort",t),()=>r.removeEventListener("abort",t)})}function Pd(r){return Yo(Td(r))}function K0(r){return Fn(e=>{let{targetSnapshot:t,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=e;return a.length===0&&o.length===0?_e(Oe(j({},e),{guardsResult:!0})):J0(a,t,i).pipe(Fn(l=>l&&H0(l)?Q0(t,o,r):_e(l)),Be(l=>Oe(j({},e),{guardsResult:l})))})}function J0(r,e,t){return Nt(r).pipe(Fn(i=>r_(i.component,i.route,t,e)),Nn(i=>i!==!0,!0))}function Q0(r,e,t){return Nt(e).pipe(Lr(i=>Jh(t_(i.route.parent,t),e_(i.route,t),i_(r,i.path),n_(r,i.route))),Nn(i=>i!==!0,!0))}function e_(r,e){return r!==null&&e&&e(new zl(r)),_e(!0)}function t_(r,e){return r!==null&&e&&e(new Bl(r)),_e(!0)}function n_(r,e){let t=e.routeConfig?e.routeConfig.canActivate:null;if(!t||t.length===0)return _e(!0);let i=t.map(o=>Wo(()=>{let a=e._environmentInjector,l=rr(o,a),h=W0(l)?l.canActivate(e,r):yt(a,()=>l(e,r));return vi(h).pipe(Nn())}));return _e(i).pipe(ir())}function i_(r,e){let t=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(a=>U0(a)).filter(a=>a!==null).map(a=>Wo(()=>{let l=a.guards.map(h=>{let u=a.node._environmentInjector,f=rr(h,u),g=Z0(f)?f.canActivateChild(t,r):yt(u,()=>f(t,r));return vi(g).pipe(Nn())});return _e(l).pipe(ir())}));return _e(o).pipe(ir())}function r_(r,e,t,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return _e(!0);let a=o.map(l=>{let h=e._environmentInjector,u=rr(l,h),f=q0(u)?u.canDeactivate(r,e,t,i):yt(h,()=>u(r,e,t,i));return vi(f).pipe(Nn())});return _e(a).pipe(ir())}function o_(r,e,t,i,o){let a=e.canLoad;if(a===void 0||a.length===0)return _e(!0);let l=a.map(h=>{let u=rr(h,r),f=$0(u)?u.canLoad(e,t):yt(r,()=>u(e,t)),g=vi(f);return o?g.pipe(Pd(o)):g});return _e(l).pipe(ir(),Ad(i))}function Ad(r){return qh(Dn(e=>{if(typeof e!="boolean")throw Ms(r,e)}),Be(e=>e===!0))}function s_(r,e,t,i,o){let a=e.canMatch;if(!a||a.length===0)return _e(!0);let l=a.map(h=>{let u=rr(h,r),f=Y0(u)?u.canMatch(e,t):yt(r,()=>u(e,t));return vi(f).pipe(Pd(o))});return _e(l).pipe(ir(),Ad(i))}var Pn=class r extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,r.prototype)}},io=class r extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,r.prototype)}};function a_(r){throw new Te(4e3,!1)}function l_(r){throw xd(!1,mt.GuardRejected)}var ql=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let i=[],o=t.root;for(;;){if(i=i.concat(o.segments),o.numberOfChildren===0)return i;if(o.numberOfChildren>1||!o.children[de])throw a_(`${e.redirectTo}`);o=o.children[de]}}async applyRedirectCommands(e,t,i,o,a){let l=await c_(t,o,a);if(l instanceof gn)throw new io(l);let h=this.applyRedirectCreateUrlTree(l,this.urlSerializer.parse(l),e,i);if(l[0]==="/")throw new io(h);return h}applyRedirectCreateUrlTree(e,t,i,o){let a=this.createSegmentGroup(e,t.root,i,o);return new gn(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([o,a])=>{if(typeof a=="string"&&a[0]===":"){let h=a.substring(1);i[o]=t[h]}else i[o]=a}),i}createSegmentGroup(e,t,i,o){let a=this.createSegments(e,t.segments,i,o),l={};return Object.entries(t.children).forEach(([h,u])=>{l[h]=this.createSegmentGroup(e,u,i,o)}),new Ae(a,l)}createSegments(e,t,i,o){return t.map(a=>a.path[0]===":"?this.findPosParam(e,a,o):this.findOrReturn(a,i))}findPosParam(e,t,i){let o=i[t.path.substring(1)];if(!o)throw new Te(4001,!1);return o}findOrReturn(e,t){let i=0;for(let o of t){if(o.path===e.path)return t.splice(i),o;i++}return e}};function c_(r,e,t){if(typeof r=="string")return Promise.resolve(r);let i=r,{queryParams:o,fragment:a,routeConfig:l,url:h,outlet:u,params:f,data:g,title:m,paramMap:v,queryParamMap:y}=e;return ys(vi(yt(t,()=>i({params:f,data:g,queryParams:o,fragment:a,routeConfig:l,url:h,outlet:u,title:m,paramMap:v,queryParamMap:y}))))}function h_(r,e){return r.providers&&!r._injector&&(r._injector=ol(r.providers,e,`Route: ${r.path}`)),r._injector??e}function Kt(r){return r.outlet||de}function u_(r,e){let t=r.filter(i=>Kt(i)===e);return t.push(...r.filter(i=>Kt(i)!==e)),t}var Yl={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function d_(r,e,t,i,o,a){let l=Rd(r,e,t);return l.matched?(i=h_(e,i),s_(i,e,t,o,a).pipe(Be(h=>h===!0?l:j({},Yl)))):_e(l)}function Rd(r,e,t){if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?j({},Yl):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let o=(e.matcher||s0)(t,r,e);if(!o)return j({},Yl);let a={};Object.entries(o.posParams??{}).forEach(([h,u])=>{a[h]=u.path});let l=o.consumed.length>0?j(j({},a),o.consumed[o.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:l,positionalParamSegments:o.posParams??{}}}function Qu(r,e,t,i){return t.length>0&&g_(r,t,i)?{segmentGroup:new Ae(e,p_(i,new Ae(t,r.children))),slicedSegments:[]}:t.length===0&&m_(r,t,i)?{segmentGroup:new Ae(r.segments,f_(r,t,i,r.children)),slicedSegments:t}:{segmentGroup:new Ae(r.segments,r.children),slicedSegments:t}}function f_(r,e,t,i){let o={};for(let a of t)if(Rs(r,e,a)&&!i[Kt(a)]){let l=new Ae([],{});o[Kt(a)]=l}return j(j({},i),o)}function p_(r,e){let t={};t[de]=e;for(let i of r)if(i.path===""&&Kt(i)!==de){let o=new Ae([],{});t[Kt(i)]=o}return t}function g_(r,e,t){return t.some(i=>Rs(r,e,i)&&Kt(i)!==de)}function m_(r,e,t){return t.some(i=>Rs(r,e,i))}function Rs(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function __(r,e,t){return e.length===0&&!r.children[t]}var Xl=class{};async function v_(r,e,t,i,o,a,l="emptyOnly",h){return new Kl(r,e,t,i,o,l,a,h).recognize()}var y_=31,Kl=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,o,a,l,h,u){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=o,this.urlTree=a,this.paramsInheritanceStrategy=l,this.urlSerializer=h,this.abortSignal=u,this.applyRedirects=new ql(this.urlSerializer,this.urlTree)}noMatchError(e){return new Te(4002,`'${e.segmentGroup}'`)}async recognize(){let e=Qu(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:i}=await this.match(e),o=new Mt(i,t),a=new Es("",o),l=E0(i,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(l),{state:a,tree:l}}async match(e){let t=new Yi([],Object.freeze({}),Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),de,this.rootComponentType,null,{},this.injector);try{return{children:await this.processSegmentGroup(this.injector,this.config,e,de,t),rootSnapshot:t}}catch(i){if(i instanceof io)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Pn?this.noMatchError(i):i}}async processSegmentGroup(e,t,i,o,a){if(i.segments.length===0&&i.hasChildren())return this.processChildren(e,t,i,a);let l=await this.processSegment(e,t,i,i.segments,o,!0,a);return l instanceof Mt?[l]:[]}async processChildren(e,t,i,o){let a=[];for(let u of Object.keys(i.children))u==="primary"?a.unshift(u):a.push(u);let l=[];for(let u of a){let f=i.children[u],g=u_(t,u),m=await this.processSegmentGroup(e,g,f,u,o);l.push(...m)}let h=Od(l);return w_(h),h}async processSegment(e,t,i,o,a,l,h){for(let u of t)try{return await this.processSegmentAgainstRoute(u._injector??e,t,u,i,o,a,l,h)}catch(f){if(f instanceof Pn||Md(f))continue;throw f}if(__(i,o,a))return new Xl;throw new Pn(i)}async processSegmentAgainstRoute(e,t,i,o,a,l,h,u){if(Kt(i)!==l&&(l===de||!Rs(o,a,i)))throw new Pn(o);if(i.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,o,i,a,l,u);if(this.allowRedirects&&h)return this.expandSegmentAgainstRouteUsingRedirect(e,o,t,i,a,l,u);throw new Pn(o)}async expandSegmentAgainstRouteUsingRedirect(e,t,i,o,a,l,h){let{matched:u,parameters:f,consumedSegments:g,positionalParamSegments:m,remainingSegments:v}=Rd(t,o,a);if(!u)throw new Pn(t);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>y_&&(this.allowRedirects=!1));let y=new Yi(a,f,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,ed(o),Kt(o),o.component??o._loadedComponent??null,o,td(o),e),b=xs(y,h,this.paramsInheritanceStrategy);if(y.params=Object.freeze(b.params),y.data=Object.freeze(b.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let E=await this.applyRedirects.applyRedirectCommands(g,o.redirectTo,m,y,e),D=await this.applyRedirects.lineralizeSegments(o,E);return this.processSegment(e,i,t,D.concat(v),l,!1,h)}async matchSegmentAgainstRoute(e,t,i,o,a,l){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let h=await ys(d_(t,i,o,e,this.urlSerializer,this.abortSignal));if(i.path==="**"&&(t.children={}),!h?.matched)throw new Pn(t);e=i._injector??e;let{routes:u}=await this.getChildConfig(e,i,o),f=i._loadedInjector??e,{parameters:g,consumedSegments:m,remainingSegments:v}=h,y=new Yi(m,g,Object.freeze(j({},this.urlTree.queryParams)),this.urlTree.fragment,ed(i),Kt(i),i.component??i._loadedComponent??null,i,td(i),e),b=xs(y,l,this.paramsInheritanceStrategy);y.params=Object.freeze(b.params),y.data=Object.freeze(b.data);let{segmentGroup:E,slicedSegments:D}=Qu(t,m,v,u);if(D.length===0&&E.hasChildren()){let T=await this.processChildren(f,u,E,y);return new Mt(y,T)}if(u.length===0&&D.length===0)return new Mt(y,[]);let x=Kt(i)===a,A=await this.processSegment(f,u,E,D,x?de:a,!0,y);return new Mt(y,A instanceof Mt?[A]:[])}async getChildConfig(e,t,i){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0){let a=t._loadedNgModuleFactory;return a&&!t._loadedInjector&&(t._loadedInjector=a.create(e).injector),{routes:t._loadedRoutes,injector:t._loadedInjector}}if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await ys(o_(e,t,i,this.urlSerializer,this.abortSignal))){let a=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=a.routes,t._loadedInjector=a.injector,t._loadedNgModuleFactory=a.factory,a}throw l_(t)}return{routes:[],injector:e}}};function w_(r){r.sort((e,t)=>e.value.outlet===de?-1:t.value.outlet===de?1:e.value.outlet.localeCompare(t.value.outlet))}function b_(r){let e=r.value.routeConfig;return e&&e.path===""}function Od(r){let e=[],t=new Set;for(let i of r){if(!b_(i)){e.push(i);continue}let o=e.find(a=>i.value.routeConfig===a.value.routeConfig);o!==void 0?(o.children.push(...i.children),t.add(o)):e.push(i)}for(let i of t){let o=Od(i.children);e.push(new Mt(i.value,o))}return e.filter(i=>!t.has(i))}function ed(r){return r.data||{}}function td(r){return r.resolve||{}}function C_(r,e,t,i,o,a,l){return Fn(async h=>{let{state:u,tree:f}=await v_(r,e,t,i,h.extractedUrl,o,a,l);return Oe(j({},h),{targetSnapshot:u,urlAfterRedirects:f})})}function S_(r){return Fn(e=>{let{targetSnapshot:t,guards:{canActivateChecks:i}}=e;if(!i.length)return _e(e);let o=new Set(i.map(h=>h.route)),a=new Set;for(let h of o)if(!a.has(h))for(let u of Id(h))a.add(u);let l=0;return Nt(a).pipe(Lr(h=>o.has(h)?D_(h,t,r):(h.data=xs(h,h.parent,r).resolve,_e(void 0))),Dn(()=>l++),Ka(1),Fn(h=>l===a.size?_e(e):Ft))})}function Id(r){let e=r.children.map(t=>Id(t)).flat();return[r,...e]}function D_(r,e,t){let i=r.routeConfig,o=r._resolve;return i?.title!==void 0&&!bd(i)&&(o[ro]=i.title),Wo(()=>(r.data=xs(r,r.parent,t).resolve,x_(o,r,e).pipe(Be(a=>(r._resolvedData=a,r.data=j(j({},r.data),a),null)))))}function x_(r,e,t){let i=Tl(r);if(i.length===0)return _e({});let o={};return Nt(i).pipe(Fn(a=>E_(r[a],e,t).pipe(Nn(),Dn(l=>{if(l instanceof no)throw Ms(new mi,l);o[a]=l}))),Ka(1),Be(()=>o),Ir(a=>Md(a)?Ft:Yh(a)))}function E_(r,e,t){let i=e._environmentInjector,o=rr(r,i),a=o.resolve?o.resolve(e,t):yt(i,()=>o(e,t));return vi(a)}function nd(r){return Bt(e=>{let t=r(e);return t?Nt(t).pipe(Be(()=>e)):_e(e)})}var Ld=(()=>{class r{buildTitle(t){let i,o=t.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(a=>a.outlet===de);return i}getResolvedTitleForRoute(t){return t.data[ro]}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(M_),providedIn:"root"})}return r})(),M_=(()=>{class r extends Ld{title;constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||r)(ve(Zu))};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Os=new ye("",{factory:()=>({})}),Is=new ye(""),kd=(()=>{class r{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=U(wu);async loadComponent(t,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return Promise.resolve(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let o=(async()=>{try{let a=await od(yt(t,()=>i.loadComponent())),l=await Nd(Fd(a));return this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=l,l}finally{this.componentLoaders.delete(i)}})();return this.componentLoaders.set(i,o),o}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Promise.resolve({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=(async()=>{try{let a=await T_(i,this.compiler,t,this.onLoadEndListener);return i._loadedRoutes=a.routes,i._loadedInjector=a.injector,i._loadedNgModuleFactory=a.factory,a}finally{this.childrenLoaders.delete(i)}})();return this.childrenLoaders.set(i,o),o}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();async function T_(r,e,t,i){let o=await od(yt(t,()=>r.loadChildren())),a=await Nd(Fd(o)),l;a instanceof du||Array.isArray(a)?l=a:l=await e.compileModuleAsync(a),i&&i(r);let h,u,f=!1,g;return Array.isArray(l)?(u=l,f=!0):(h=l.create(t).injector,g=l,u=h.get(Is,[],{optional:!0,self:!0}).flat()),{routes:u.map(ec),injector:h,factory:g}}function P_(r){return r&&typeof r=="object"&&"default"in r}function Fd(r){return P_(r)?r.default:r}async function Nd(r){return r}var tc=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(A_),providedIn:"root"})}return r})(),A_=(()=>{class r{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Bd=new ye("");var R_=()=>{},Vd=new ye(""),zd=(()=>{class r{currentNavigation=De(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=De(null);events=new cn;transitionAbortWithErrorSubject=new cn;configLoader=U(kd);environmentInjector=U(un);destroyRef=U(Fr);urlSerializer=U(Ps);rootContexts=U(oo);location=U(ji);inputBindingEnabled=U(As,{optional:!0})!==null;titleStrategy=U(Ld);options=U(Os,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=U(tc);createViewTransition=U(Bd,{optional:!0});navigationErrorHandler=U(Vd,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>_e(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=o=>this.events.next(new Fl(o)),i=o=>this.events.next(new Nl(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;lt(()=>{this.transitions?.next(Oe(j({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))})}setupNavigations(t){return this.transitions=new kt(null),this.transitions.pipe(hn(i=>i!==null),Bt(i=>{let o=!1,a=new AbortController,l=()=>!o&&this.currentTransition?.id===i.id;return _e(i).pipe(Bt(h=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",mt.SupersededByNewNavigation),Ft;this.currentTransition=i;let u=this.lastSuccessfulNavigation();this.currentNavigation.set({id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,targetBrowserUrl:typeof h.extras.browserUrl=="string"?this.urlSerializer.parse(h.extras.browserUrl):h.extras.browserUrl,trigger:h.source,extras:h.extras,previousNavigation:u?Oe(j({},u),{previousNavigation:null}):null,abort:()=>a.abort()});let f=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),g=h.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!f&&g!=="reload")return this.events.next(new Zn(h.id,this.urlSerializer.serialize(h.rawUrl),"",Cs.IgnoredSameUrlNavigation)),h.resolve(!1),Ft;if(this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return _e(h).pipe(Bt(m=>(this.events.next(new Qi(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),m.id!==this.navigationId?Ft:Promise.resolve(m))),C_(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,a.signal),Dn(m=>{i.targetSnapshot=m.targetSnapshot,i.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation.update(y=>(y.finalUrl=m.urlAfterRedirects,y));let v=new eo(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}));if(f&&this.urlHandlingStrategy.shouldProcessUrl(h.currentRawUrl)){let{id:m,extractedUrl:v,source:y,restoredState:b,extras:E}=h,D=new Qi(m,this.urlSerializer.serialize(v),y,b);this.events.next(D);let x=yd(this.rootComponentType,this.environmentInjector).snapshot;return this.currentTransition=i=Oe(j({},h),{targetSnapshot:x,urlAfterRedirects:v,extras:Oe(j({},E),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(A=>(A.finalUrl=v,A)),_e(i)}else return this.events.next(new Zn(h.id,this.urlSerializer.serialize(h.extractedUrl),"",Cs.IgnoredByUrlHandlingStrategy)),h.resolve(!1),Ft}),Be(h=>{let u=new Ol(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);return this.events.next(u),this.currentTransition=i=Oe(j({},h),{guards:z0(h.targetSnapshot,h.currentSnapshot,this.rootContexts)}),i}),K0(h=>this.events.next(h)),Bt(h=>{if(i.guardsResult=h.guardsResult,h.guardsResult&&typeof h.guardsResult!="boolean")throw Ms(this.urlSerializer,h.guardsResult);let u=new Il(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);if(this.events.next(u),!l())return Ft;if(!h.guardsResult)return this.cancelNavigationTransition(h,"",mt.GuardRejected),Ft;if(h.guards.canActivateChecks.length===0)return _e(h);let f=new Ll(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);if(this.events.next(f),!l())return Ft;let g=!1;return _e(h).pipe(S_(this.paramsInheritanceStrategy),Dn({next:()=>{g=!0;let m=new kl(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(m)},complete:()=>{g||this.cancelNavigationTransition(h,"",mt.NoDataFromResolver)}}))}),nd(h=>{let u=g=>{let m=[];if(g.routeConfig?._loadedComponent)g.component=g.routeConfig?._loadedComponent;else if(g.routeConfig?.loadComponent){let v=g._environmentInjector;m.push(this.configLoader.loadComponent(v,g.routeConfig).then(y=>{g.component=y}))}for(let v of g.children)m.push(...u(v));return m},f=u(h.targetSnapshot.root);return f.length===0?_e(h):Nt(Promise.all(f).then(()=>h))}),nd(()=>this.afterPreactivation()),Bt(()=>{let{currentSnapshot:h,targetSnapshot:u}=i,f=this.createViewTransition?.(this.environmentInjector,h.root,u.root);return f?Nt(f).pipe(Be(()=>i)):_e(i)}),ki(1),Be(h=>{let u=F0(t.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);this.currentTransition=i=h=Oe(j({},h),{targetRouterState:u}),this.currentNavigation.update(f=>(f.targetRouterState=u,f)),this.events.next(new tr),l()&&(new Zl(t.routeReuseStrategy,i.targetRouterState,i.currentRouterState,f=>this.events.next(f),this.inputBindingEnabled).activate(this.rootContexts),l()&&(o=!0,this.currentNavigation.update(f=>(f.abort=R_,f)),this.lastSuccessfulNavigation.set(lt(this.currentNavigation)),this.events.next(new Wn(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects))),this.titleStrategy?.updateTitle(h.targetRouterState.snapshot),h.resolve(!0)))}),Yo(Td(a.signal).pipe(hn(()=>!o&&!i.targetRouterState),Dn(()=>{this.cancelNavigationTransition(i,a.signal.reason+"",mt.Aborted)}))),Dn({complete:()=>{o=!0}}),Yo(this.transitionAbortWithErrorSubject.pipe(Dn(h=>{throw h}))),qo(()=>{a.abort(),o||this.cancelNavigationTransition(i,"",mt.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Ir(h=>{if(o=!0,this.destroyed)return i.resolve(!1),Ft;if(Ed(h))this.events.next(new Jt(i.id,this.urlSerializer.serialize(i.extractedUrl),h.message,h.cancellationCode)),V0(h)?this.events.next(new nr(h.url,h.navigationBehaviorOptions)):i.resolve(!1);else{let u=new er(i.id,this.urlSerializer.serialize(i.extractedUrl),h,i.targetSnapshot??void 0);try{let f=yt(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(f instanceof no){let{message:g,cancellationCode:m}=Ms(this.urlSerializer,f);this.events.next(new Jt(i.id,this.urlSerializer.serialize(i.extractedUrl),g,m)),this.events.next(new nr(f.redirectTo,f.navigationBehaviorOptions))}else throw this.events.next(u),h}catch(f){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(f)}}return Ft}))}))}cancelNavigationTransition(t,i,o){let a=new Jt(t.id,this.urlSerializer.serialize(t.extractedUrl),i,o);this.events.next(a),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=lt(this.currentNavigation),o=i?.targetBrowserUrl??i?.extractedUrl;return t.toString()!==o?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function O_(r){return r!==Kr}var Ud=new ye("");var I_=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(L_),providedIn:"root"})}return r})(),Jl=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}shouldDestroyInjector(e){return!0}},L_=(()=>{class r extends Jl{static \u0275fac=(()=>{let t;return function(o){return(t||(t=Vi(r)))(o||r)}})();static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),nc=(()=>{class r{urlSerializer=U(Ps);options=U(Os,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=U(ji);urlHandlingStrategy=U(tc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new gn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:i,targetBrowserUrl:o}){let a=t!==void 0?this.urlHandlingStrategy.merge(t,i):i,l=o??a;return l instanceof gn?this.urlSerializer.serialize(l):l}commitTransition({targetRouterState:t,finalUrl:i,initialUrl:o}){i&&t?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,o),this.routerState=t):this.rawUrlTree=o}routerState=yd(null,U(un));getRouterState(){return this.routerState}_stateMemento=this.createStateMemento();get stateMemento(){return this._stateMemento}updateStateMemento(){this._stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}restoredState(){return this.location.getState()}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:()=>U(k_),providedIn:"root"})}return r})(),k_=(()=>{class r extends nc{currentPageId=0;lastSuccessfulId=-1;get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{t(i.url,i.state,"popstate")})})}handleRouterEvent(t,i){t instanceof Qi?this.updateStateMemento():t instanceof Zn?this.commitTransition(i):t instanceof eo?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof tr?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):t instanceof Jt&&!vd(t)?this.restoreHistory(i):t instanceof er?this.restoreHistory(i,!0):t instanceof Wn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:i,id:o}){let{replaceUrl:a,state:l}=i;if(this.location.isCurrentPathEqualTo(t)||a){let h=this.browserPageId,u=j(j({},l),this.generateNgRouterState(o,h));this.location.replaceState(t,"",u)}else{let h=j(j({},l),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(t,"",h)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,a=this.currentPageId-o;a!==0?this.location.historyGo(a):this.getCurrentUrlTree()===t.finalUrl&&a===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(o){return(t||(t=Vi(r)))(o||r)}})();static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Gd(r,e){r.events.pipe(hn(t=>t instanceof Wn||t instanceof Jt||t instanceof er||t instanceof Zn),Be(t=>t instanceof Wn||t instanceof Zn?0:(t instanceof Jt?t.code===mt.Redirect||t.code===mt.SupersededByNewNavigation:!1)?2:1),hn(t=>t!==2),ki(1)).subscribe(()=>{e()})}var jd={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Hd={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ic=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=U(fu);stateManager=U(nc);options=U(Os,{optional:!0})||{};pendingTasks=U(ru);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=U(zd);urlSerializer=U(Ps);location=U(ji);urlHandlingStrategy=U(tc);injector=U(un);_events=new cn;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=U(I_);injectorCleanup=U(Ud,{optional:!0});onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=U(Is,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!U(As,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{}}),this.subscribeToNavigationEvents()}eventsSubscription=new Zh;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,a=lt(this.navigationTransitions.currentNavigation);if(o!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Jt&&i.code!==mt.Redirect&&i.code!==mt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Wn)this.navigated=!0,this.injectorCleanup?.(this.routeReuseStrategy,this.routerState,this.config);else if(i instanceof nr){let l=i.navigationBehaviorOptions,h=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),u=j({scroll:o.extras.scroll,browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||O_(o.source)},l);this.scheduleNavigation(h,Kr,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}I0(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortWithErrorSubject.next(o)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Kr,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i,o)=>{this.navigateToSyncWithBrowser(t,o,i)})}navigateToSyncWithBrowser(t,i,o){let a={replaceUrl:!0},l=o?.navigationId?o:null;if(o){let u=j({},o);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(a.state=u)}let h=this.parseUrl(t);this.scheduleNavigation(h,i,l,a).catch(u=>{this.disposed||this.injector.get(el)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return lt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ec),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription?.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0,this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:o,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:u}=i,f=u?this.currentUrlTree.fragment:l,g=null;switch(h??this.options.defaultQueryParamsHandling){case"merge":g=j(j({},this.currentUrlTree.queryParams),a);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=a||null}g!==null&&(g=this.removeEmptyProps(g));let m;try{let v=o?o.snapshot:this.routerState.snapshot.root;m=pd(v)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return gd(m,t,g,f??null,this.urlSerializer)}navigateByUrl(t,i={skipLocationChange:!1}){let o=Ji(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(a,Kr,null,i)}navigate(t,i={skipLocationChange:!1}){return F_(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Ja(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,i){let o;if(i===!0?o=j({},jd):i===!1?o=j({},Hd):o=i,Ji(t))return qu(this.currentUrlTree,t,o);let a=this.parseUrl(t);return qu(this.currentUrlTree,a,o)}removeEmptyProps(t){return Object.entries(t).reduce((i,[o,a])=>(a!=null&&(i[o]=a),i),{})}scheduleNavigation(t,i,o,a,l){if(this.disposed)return Promise.resolve(!1);let h,u,f;l?(h=l.resolve,u=l.reject,f=l.promise):f=new Promise((m,v)=>{h=m,u=v});let g=this.pendingTasks.add();return Gd(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:h,reject:u,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}static \u0275fac=function(i){return new(i||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function F_(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new Te(4008,!1)}var N_=new ye("");function rc(r,...e){return Fi([{provide:Is,multi:!0,useValue:r},[],{provide:_i,useFactory:B_},{provide:pu,multi:!0,useFactory:V_},e.map(t=>t.\u0275providers)])}function B_(){return U(ic).routerState.root}function V_(){let r=U(Ni);return e=>{let t=r.get(sl);if(e!==t.components[0])return;let i=r.get(ic),o=r.get(z_);r.get(U_)===1&&i.initialNavigation(),r.get(G_,null,{optional:!0})?.setUpPreloading(),r.get(N_,null,{optional:!0})?.init(),i.resetRootComponentType(t.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var z_=new ye("",{factory:()=>new cn}),U_=new ye("",{factory:()=>1});var G_=new ye("");var H_="@",$_=(()=>{class r{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=U(Ni);loadingSchedulerFn=U(W_,{optional:!0});_engine;constructor(t,i,o,a,l){this.doc=t,this.delegate=i,this.zone=o,this.animationType=a,this.moduleImpl=l}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-SGXPLHFC.js").then(o=>o),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(t):i=t(),i.catch(o=>{throw new Te(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:a})=>{this._engine=o(this.animationType,this.doc);let l=new a(this.delegate,this._engine,this.zone);return this.delegate=l,l})}createRenderer(t,i){let o=this.delegate.createRenderer(t,i);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let a=new oc(o);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(l=>{let h=l.createRenderer(t,i);a.use(h),this.scheduler??=this.injector.get(ou,null,{optional:!0}),this.scheduler?.notify(10)}).catch(l=>{a.use(o)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(t){this._engine?.flush(),this.delegate.componentReplaced?.(t)}static \u0275fac=function(i){uu()};static \u0275prov=ie({token:r,factory:r.\u0275fac})}return r})(),oc=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,i,o){this.delegate.insertBefore(e,t,i,o)}removeChild(e,t,i,o){this.delegate.removeChild(e,t,i,o)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,o){this.delegate.setAttribute(e,t,i,o)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,o){this.delegate.setStyle(e,t,i,o)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){this.shouldReplay(t)&&this.replay.push(o=>o.setProperty(e,t,i)),this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i,o){return this.shouldReplay(t)&&this.replay.push(a=>a.listen(e,t,i,o)),this.delegate.listen(e,t,i,o)}shouldReplay(e){return this.replay!==null&&e.startsWith(H_)}},W_=new ye("");function $d(r="animations"){return il("NgAsyncAnimations"),Fi([{provide:Qo,useFactory:()=>new $_(U(et),U($r),U(ai),r)},{provide:cu,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Wd=[];var Zd={providers:[bu(),rc(Wd),Cl(),$d()]};var or=class r{http=U($n);baseUrl="https://nominatim.openstreetmap.org/search";search(e){let t={q:e,format:"json",addressdetails:"1",limit:"5"};return this.http.get(this.baseUrl,{params:t})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})};var qn=class r{http=U($n);themesPath="assets/themes/";availableThemes=["autumn","blueprint","contrast_zones","copper_patina","feature_based","forest","gradient_roads","japanese_ink","midnight_blue","monochrome_blue","neon_cyberpunk","noir","ocean","pastel_dream","sunset","terracotta","warm_beige"];getAvailableThemes(){return this.availableThemes}loadTheme(e){return this.http.get(`${this.themesPath}${e}.json`)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ls=class r{http=U($n);baseUrl="https://overpass.kumi.systems/api/interpreter";getBbox(e,t,i,o){let l=o/6378137*(180/Math.PI),h=i/6378137*(180/Math.PI)/Math.cos(e*Math.PI/180),u=e-l,f=e+l,g=t-h,m=t+h;return`${u},${g},${f},${m}`}getTimeout(e){return e<=5e3?60:e<=1e4?120:e<=15e3?180:240}getHighwayFilter(e){return e?"motorway|trunk|primary|secondary|tertiary|residential|living_street|unclassified":"motorway|trunk|primary|secondary|tertiary|residential|living_street|unclassified|footway|path|cycleway|steps|pedestrian|track|service"}fetchAllMapData(e,t=!1,i=1e4){let o=this.getTimeout(i),a=this.getHighwayFilter(t),l=`
      [out:json][timeout:${o}][bbox:${e}];
      (
        // Roads - regex filter with _link suffix support
        way["highway"~"^(${a})(_link)?$"];

        // Water bodies and waterways
        way["natural"="water"];
        relation["natural"="water"];
        way["waterway"];

        // Parks and green spaces
        way["leisure"="park"];
        relation["leisure"="park"];
        way["landuse"~"^(grass|forest|meadow)$"];
        relation["landuse"~"^(grass|forest|meadow)$"];
      );
      // "out body" = include tags, "geom(bbox)" = inline coords cropped at bbox
      out body geom(${e}) qt;
    `;return this.http.post(this.baseUrl,`data=${encodeURIComponent(l)}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).pipe(Be(h=>this.categorizeElements(h.elements)))}categorizeElements(e){let t=[],i=[],o=[],a=[];for(let l of e){let h=l.tags;if(h){if(l.type==="way"&&h.highway){t.push(l);continue}if(h.natural==="water"){i.push(l);continue}if(l.type==="way"&&h.waterway){o.push(l);continue}if(h.leisure==="park"||["grass","forest","meadow"].includes(h.landuse||"")){a.push(l);continue}}}return{roads:t,waterAreas:i,waterways:o,parks:a}}fetchMapDataSmart(e,t,i){return i>15e3?(console.log("[Overpass] Large area detected, using parallel queries"),this.fetchMapDataParallel(e,t,i)):(console.log("[Overpass] Normal area, using unified query"),this.fetchAllMapData(e,t,i))}fetchMapDataParallel(e,t,i){let o=this.getTimeout(i),a=this.getHighwayFilter(t),l=`
      [out:json][timeout:${o}][bbox:${e}];
      way["highway"~"^(${a})(_link)?$"];
      out body geom(${e}) qt;
    `,h=`
      [out:json][timeout:${o}][bbox:${e}];
      (
        way["natural"="water"];
        relation["natural"="water"];
        way["waterway"];
      );
      out body geom(${e}) qt;
    `,u=`
      [out:json][timeout:${o}][bbox:${e}];
      (
        way["leisure"="park"];
        relation["leisure"="park"];
        way["landuse"~"^(grass|forest|meadow)$"];
        relation["landuse"~"^(grass|forest|meadow)$"];
      );
      out body geom(${e}) qt;
    `,f={"Content-Type":"application/x-www-form-urlencoded"};return Zo({roads:this.http.post(this.baseUrl,`data=${encodeURIComponent(l)}`,{headers:f}),water:this.http.post(this.baseUrl,`data=${encodeURIComponent(h)}`,{headers:f}),parks:this.http.post(this.baseUrl,`data=${encodeURIComponent(u)}`,{headers:f})}).pipe(Be(g=>{let m=[],v=[],y=[],b=[];for(let E of g.roads.elements)E.type==="way"&&E.tags?.highway&&m.push(E);for(let E of g.water.elements)E.tags&&(E.tags.natural==="water"?v.push(E):E.type==="way"&&E.tags.waterway&&y.push(E));for(let E of g.parks.elements)E.tags&&b.push(E);return{roads:m,waterAreas:v,waterways:y,parks:b}}))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})};var sr=gm(Yd());var Z_=["map"],Fs=class r{lat=Ue(48.8566);lon=Ue(2.3522);distance=Ue(1e4);mapContainer;map;rectangle;platformId=U(zi);constructor(){Vn(()=>{let e=this.lat(),t=this.lon(),i=this.distance();hl(this.platformId)&&this.map&&this.updateMap(e,t,i)})}ngAfterViewInit(){hl(this.platformId)&&this.initMap()}ngOnDestroy(){this.map&&this.map.remove()}initMap(){this.map=sr.map(this.mapContainer.nativeElement).setView([this.lat(),this.lon()],12),sr.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.updateMap(this.lat(),this.lon(),this.distance())}updateMap(e,t,i){if(!this.map)return;this.map.setView([e,t]),this.rectangle&&this.map.removeLayer(this.rectangle);let o=this.getBounds(e,t,i);this.rectangle=sr.rectangle(o,{color:"#ff7800",weight:1}).addTo(this.map),this.map.fitBounds(o)}getBounds(e,t,i){let o=i*1.3333333333333333,a=6378137,l=i/a*(180/Math.PI)/Math.cos(e*Math.PI/180),h=o/a*(180/Math.PI);return[[e-h,t-l],[e+h,t+l]]}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-map-preview"]],viewQuery:function(t,i){if(t&1&&Ui(Z_,5),t&2){let o;ci(o=hi())&&(i.mapContainer=o.first)}},inputs:{lat:[1,"lat"],lon:[1,"lon"],distance:[1,"distance"]},decls:2,vars:0,consts:[["map",""],[1,"map-container"]],template:function(t,i){t&1&&Yt(0,"div",1,0)},styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.map-container[_ngcontent-%COMP%]{width:100%;height:100%}"],changeDetection:0})};var q_=Math.PI/180;function Y_(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}var Xn=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},V={_global:Xn,version:"10.2.0",isBrowser:Y_(),isUnminified:/param/.test(function(r){}.toString()),dblClickWindow:400,getAngle(r){return V.angleDeg?r*q_:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return V.DD.isDragging},isTransforming(){var r,e;return(e=(r=V.Transformer)===null||r===void 0?void 0:r.isTransforming())!==null&&e!==void 0?e:!1},isDragReady(){return!!V.DD.node},releaseCanvasOnDestroy:!0,document:Xn.document,_injectGlobal(r){typeof Xn.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Xn.Konva=r}},le=r=>{V[r.prototype.getClassName()]=r};V._injectGlobal(V);var X_=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Xd=()=>{if(typeof document>"u")throw new Error(X_)},ht=class r{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){let t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){let t=Math.cos(e),i=Math.sin(e),o=this.m[0]*t+this.m[2]*i,a=this.m[1]*t+this.m[3]*i,l=this.m[0]*-i+this.m[2]*t,h=this.m[1]*-i+this.m[3]*t;return this.m[0]=o,this.m[1]=a,this.m[2]=l,this.m[3]=h,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){let i=this.m[0]+this.m[2]*t,o=this.m[1]+this.m[3]*t,a=this.m[2]+this.m[0]*e,l=this.m[3]+this.m[1]*e;return this.m[0]=i,this.m[1]=o,this.m[2]=a,this.m[3]=l,this}multiply(e){let t=this.m[0]*e.m[0]+this.m[2]*e.m[1],i=this.m[1]*e.m[0]+this.m[3]*e.m[1],o=this.m[0]*e.m[2]+this.m[2]*e.m[3],a=this.m[1]*e.m[2]+this.m[3]*e.m[3],l=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],h=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=i,this.m[2]=o,this.m[3]=a,this.m[4]=l,this.m[5]=h,this}invert(){let e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,i=-this.m[1]*e,o=-this.m[2]*e,a=this.m[0]*e,l=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),h=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=i,this.m[2]=o,this.m[3]=a,this.m[4]=l,this.m[5]=h,this}getMatrix(){return this.m}decompose(){let e=this.m[0],t=this.m[1],i=this.m[2],o=this.m[3],a=this.m[4],l=this.m[5],h=e*o-t*i,u={x:a,y:l,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||t!=0){let f=Math.sqrt(e*e+t*t);u.rotation=t>0?Math.acos(e/f):-Math.acos(e/f),u.scaleX=f,u.scaleY=h/f,u.skewX=(e*i+t*o)/h,u.skewY=0}else if(i!=0||o!=0){let f=Math.sqrt(i*i+o*o);u.rotation=Math.PI/2-(o>0?Math.acos(-i/f):-Math.acos(i/f)),u.scaleX=h/f,u.scaleY=f,u.skewX=0,u.skewY=(e*i+t*o)/h}return u.rotation=S._getRotation(u.rotation),u}},K_="[object Array]",J_="[object Number]",Q_="[object String]",ev="[object Boolean]",tv=Math.PI/180,nv=180/Math.PI,ao="#",iv="",rv="0",ov="Konva warning: ",Kd="Konva error: ",sv="rgb(",sc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},av=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Ns=[],lo=null,lv=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(r){setTimeout(r,16)},S={_isElement(r){return!!(r&&r.nodeType==1)},_isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)},_isPlainObject(r){return!!r&&r.constructor===Object},_isArray(r){return Object.prototype.toString.call(r)===K_},_isNumber(r){return Object.prototype.toString.call(r)===J_&&!isNaN(r)&&isFinite(r)},_isString(r){return Object.prototype.toString.call(r)===Q_},_isBoolean(r){return Object.prototype.toString.call(r)===ev},isObject(r){return r instanceof Object},isValidSelector(r){if(typeof r!="string")return!1;let e=r[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(r){return r===0||r>0?1:-1},requestAnimFrame(r){Ns.push(r),Ns.length===1&&lv(function(){let e=Ns;Ns=[],e.forEach(function(t){t()})})},createCanvasElement(){Xd();let r=document.createElement("canvas");try{r.style=r.style||{}}catch{}return r},createImageElement(){return Xd(),document.createElement("img")},_isInDocument(r){for(;r=r.parentNode;)if(r==document)return!0;return!1},_urlToImage(r,e){let t=S.createImageElement();t.onload=function(){e(t)},t.src=r},_rgbToHex(r,e,t){return((1<<24)+(r<<16)+(e<<8)+t).toString(16).slice(1)},_hexToRgb(r){r=r.replace(ao,iv);let e=parseInt(r,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){let r=(Math.random()*16777215<<0).toString(16);for(;r.length<6;)r=rv+r;return ao+r},isCanvasFarblingActive(){if(lo!==null)return lo;if(typeof document>"u")return lo=!1,!1;let r=this.createCanvasElement();r.width=10,r.height=10;let e=r.getContext("2d",{willReadFrequently:!0});e.clearRect(0,0,10,10),e.fillStyle="#282828",e.fillRect(0,0,10,10);let t=e.getImageData(0,0,10,10).data,i=!1;for(let o=0;o<100;o++)if(t[o*4]!==40||t[o*4+1]!==40||t[o*4+2]!==40||t[o*4+3]!==255){i=!0;break}return lo=i,this.releaseCanvas(r),lo},getHitColor(){let r=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(r):r},getHitColorKey(r,e,t){return this.isCanvasFarblingActive()&&(r=Math.round(r/5)*5,e=Math.round(e/5)*5,t=Math.round(t/5)*5),ao+this._rgbToHex(r,e,t)},getSnappedHexColor(r){let e=this._hexToRgb(r);return ao+this._rgbToHex(Math.round(e.r/5)*5,Math.round(e.g/5)*5,Math.round(e.b/5)*5)},getRGB(r){let e;return r in sc?(e=sc[r],{r:e[0],g:e[1],b:e[2]}):r[0]===ao?this._hexToRgb(r.substring(1)):r.substr(0,4)===sv?(e=av.exec(r.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(r){return r=r||"black",S._namedColorToRBA(r)||S._hex3ColorToRGBA(r)||S._hex4ColorToRGBA(r)||S._hex6ColorToRGBA(r)||S._hex8ColorToRGBA(r)||S._rgbColorToRGBA(r)||S._rgbaColorToRGBA(r)||S._hslColorToRGBA(r)},_namedColorToRBA(r){let e=sc[r.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(r){if(r.indexOf("rgb(")===0){r=r.match(/rgb\(([^)]+)\)/)[1];let e=r.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(r){if(r.indexOf("rgba(")===0){r=r.match(/rgba\(([^)]+)\)/)[1];let e=r.split(/ *, */).map((t,i)=>t.slice(-1)==="%"?i===3?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(r){if(r[0]==="#"&&r.length===9)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:parseInt(r.slice(7,9),16)/255}},_hex6ColorToRGBA(r){if(r[0]==="#"&&r.length===7)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:1}},_hex4ColorToRGBA(r){if(r[0]==="#"&&r.length===5)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:parseInt(r[4]+r[4],16)/255}},_hex3ColorToRGBA(r){if(r[0]==="#"&&r.length===4)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:1}},_hslColorToRGBA(r){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(r)){let[e,...t]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(r),i=Number(t[0])/360,o=Number(t[1])/100,a=Number(t[2])/100,l,h,u;if(o===0)return u=a*255,{r:Math.round(u),g:Math.round(u),b:Math.round(u),a:1};a<.5?l=a*(1+o):l=a+o-a*o;let f=2*a-l,g=[0,0,0];for(let m=0;m<3;m++)h=i+1/3*-(m-1),h<0&&h++,h>1&&h--,6*h<1?u=f+(l-f)*6*h:2*h<1?u=l:3*h<2?u=f+(l-f)*(2/3-h)*6:u=f,g[m]=u*255;return{r:Math.round(g[0]),g:Math.round(g[1]),b:Math.round(g[2]),a:1}}},haveIntersection(r,e){return!(e.x>r.x+r.width||e.x+e.width<r.x||e.y>r.y+r.height||e.y+e.height<r.y)},cloneObject(r){let e={};for(let t in r)this._isPlainObject(r[t])?e[t]=this.cloneObject(r[t]):this._isArray(r[t])?e[t]=this.cloneArray(r[t]):e[t]=r[t];return e},cloneArray(r){return r.slice(0)},degToRad(r){return r*tv},radToDeg(r){return r*nv},_degToRad(r){return S.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),S.degToRad(r)},_radToDeg(r){return S.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),S.radToDeg(r)},_getRotation(r){return V.angleDeg?S.radToDeg(r):r},_capitalize(r){return r.charAt(0).toUpperCase()+r.slice(1)},throw(r){throw new Error(Kd+r)},error(r){console.error(Kd+r)},warn(r){V.showWarnings&&console.warn(ov+r)},each(r,e){for(let t in r)e(t,r[t])},_inRange(r,e,t){return e<=r&&r<t},_getProjectionToSegment(r,e,t,i,o,a){let l,h,u,f=(r-t)*(r-t)+(e-i)*(e-i);if(f==0)l=r,h=e,u=(o-t)*(o-t)+(a-i)*(a-i);else{let g=((o-r)*(t-r)+(a-e)*(i-e))/f;g<0?(l=r,h=e,u=(r-o)*(r-o)+(e-a)*(e-a)):g>1?(l=t,h=i,u=(t-o)*(t-o)+(i-a)*(i-a)):(l=r+g*(t-r),h=e+g*(i-e),u=(l-o)*(l-o)+(h-a)*(h-a))}return[l,h,u]},_getProjectionToLine(r,e,t){let i=S.cloneObject(r),o=Number.MAX_VALUE;return e.forEach(function(a,l){if(!t&&l===e.length-1)return;let h=e[(l+1)%e.length],u=S._getProjectionToSegment(a.x,a.y,h.x,h.y,r.x,r.y),f=u[0],g=u[1],m=u[2];m<o&&(i.x=f,i.y=g,o=m)}),i},_prepareArrayForTween(r,e,t){let i=[],o=[];if(r.length>e.length){let l=e;e=r,r=l}for(let l=0;l<r.length;l+=2)i.push({x:r[l],y:r[l+1]});for(let l=0;l<e.length;l+=2)o.push({x:e[l],y:e[l+1]});let a=[];return o.forEach(function(l){let h=S._getProjectionToLine(l,i,t);a.push(h.x),a.push(h.y)}),a},_prepareToStringify(r){let e;r.visitedByCircularReferenceRemoval=!0;for(let t in r)if(r.hasOwnProperty(t)&&r[t]&&typeof r[t]=="object"){if(e=Object.getOwnPropertyDescriptor(r,t),r[t].visitedByCircularReferenceRemoval||S._isElement(r[t]))if(e.configurable)delete r[t];else return null;else if(S._prepareToStringify(r[t])===null)if(e.configurable)delete r[t];else return null}return delete r.visitedByCircularReferenceRemoval,r},_assign(r,e){for(let t in e)r[t]=e[t];return r},_getFirstPointerId(r){return r.touches?r.changedTouches[0].identifier:r.pointerId||999},releaseCanvas(...r){V.releaseCanvasOnDestroy&&r.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(r,e,t,i){let o=e<0?e:0,a=t<0?t:0;e=Math.abs(e),t=Math.abs(t);let l=0,h=0,u=0,f=0;typeof i=="number"?l=h=u=f=Math.min(i,e/2,t/2):(l=Math.min(i[0]||0,e/2,t/2),h=Math.min(i[1]||0,e/2,t/2),f=Math.min(i[2]||0,e/2,t/2),u=Math.min(i[3]||0,e/2,t/2)),r.moveTo(o+l,a),r.lineTo(o+e-h,a),r.arc(o+e-h,a+h,h,Math.PI*3/2,0,!1),r.lineTo(o+e,a+t-f),r.arc(o+e-f,a+t-f,f,0,Math.PI/2,!1),r.lineTo(o+u,a+t),r.arc(o+u,a+t-u,u,Math.PI/2,Math.PI,!1),r.lineTo(o,a+l),r.arc(o+l,a+l,l,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(r,e,t,i,o){i=Math.abs(i);for(let a=0;a<t;a++){let l=e[(a-1+t)%t],h=e[a],u=e[(a+1)%t],f={x:h.x-l.x,y:h.y-l.y},g={x:u.x-h.x,y:u.y-h.y},m=Math.hypot(f.x,f.y),v=Math.hypot(g.x,g.y),y;typeof o=="number"?y=o:y=a<o.length?o[a]:0,y=i*Math.cos(Math.PI/t)*Math.min(1,y/i*2);let E={x:f.x/m,y:f.y/m},D={x:g.x/v,y:g.y/v},x={x:h.x-E.x*y,y:h.y-E.y*y},A={x:h.x+D.x*y,y:h.y+D.y*y};a===0?r.moveTo(x.x,x.y):r.lineTo(x.x,x.y),r.arcTo(h.x,h.y,A.x,A.y,y)}}};function cv(r){let e=[],t=r.length,i=S;for(let o=0;o<t;o++){let a=r[o];i._isNumber(a)?a=Math.round(a*1e3)/1e3:i._isString(a)||(a=a+""),e.push(a)}return e}var Jd=",",hv="(",uv=")",dv="([",fv="])",pv=";",gv="()",mv="=",Qd=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],_v=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],vv=100,Bs=null;function ac(){if(Bs!==null)return Bs;try{let e=S.createCanvasElement().getContext("2d");return e?!!e&&"filter"in e:(Bs=!1,!1)}catch{return Bs=!1,!1}}var yi=class{constructor(e){this.canvas=e,V.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let i=this.traceArr,o=i.length,a="",l,h,u,f;for(l=0;l<o;l++)h=i[l],u=h.method,u?(f=h.args,a+=u,e?a+=gv:S._isArray(f[0])?a+=dv+f.join(Jd)+fv:(t&&(f=f.map(g=>typeof g=="number"?Math.floor(g):g)),a+=hv+f.join(Jd)+uv)):(a+=h.property,e||(a+=mv+h.val)),a+=pv;return a}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,i;t.push(e),i=t.length,i>=vv&&t.shift()}reset(){let e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){let t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){let t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){let t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){let t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}_applyMiterLimit(e){let t=e.attrs.miterLimit;t!=null&&this.setAttr("miterLimit",t)}setAttr(e,t){this._context[e]=t}arc(e,t,i,o,a,l){this._context.arc(e,t,i,o,a,l)}arcTo(e,t,i,o,a){this._context.arcTo(e,t,i,o,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,i,o,a,l){this._context.bezierCurveTo(e,t,i,o,a,l)}clearRect(e,t,i,o){this._context.clearRect(e,t,i,o)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){let i=arguments;if(i.length===2)return this._context.createImageData(e,t);if(i.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,i,o){return this._context.createLinearGradient(e,t,i,o)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,i,o,a,l){return this._context.createRadialGradient(e,t,i,o,a,l)}drawImage(e,t,i,o,a,l,h,u,f){let g=arguments,m=this._context;g.length===3?m.drawImage(e,t,i):g.length===5?m.drawImage(e,t,i,o,a):g.length===9&&m.drawImage(e,t,i,o,a,l,h,u,f)}ellipse(e,t,i,o,a,l,h,u){this._context.ellipse(e,t,i,o,a,l,h,u)}isPointInPath(e,t,i,o){return i?this._context.isPointInPath(i,e,t,o):this._context.isPointInPath(e,t,o)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,i,o){this._context.fillRect(e,t,i,o)}strokeRect(e,t,i,o){this._context.strokeRect(e,t,i,o)}fillText(e,t,i,o){o?this._context.fillText(e,t,i,o):this._context.fillText(e,t,i)}measureText(e){return this._context.measureText(e)}getImageData(e,t,i,o){return this._context.getImageData(e,t,i,o)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,i,o){this._context.rect(e,t,i,o)}roundRect(e,t,i,o,a){this._context.roundRect(e,t,i,o,a)}putImageData(e,t,i){this._context.putImageData(e,t,i)}quadraticCurveTo(e,t,i,o){this._context.quadraticCurveTo(e,t,i,o)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,i,o,a,l){this._context.setTransform(e,t,i,o,a,l)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,i,o){this._context.strokeText(e,t,i,o)}transform(e,t,i,o,a,l){this._context.transform(e,t,i,o,a,l)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=Qd.length,i=this.setAttr,o,a,l=function(h){let u=e[h],f;e[h]=function(){return a=cv(Array.prototype.slice.call(arguments,0)),f=u.apply(e,arguments),e._trace({method:h,args:a}),f}};for(o=0;o<t;o++)l(Qd[o]);e.setAttr=function(){i.apply(e,arguments);let h=arguments[0],u=arguments[1];(h==="shadowOffsetX"||h==="shadowOffsetY"||h==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),e._trace({property:h,val:u})}}_applyGlobalCompositeOperation(e){let t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}};_v.forEach(function(r){Object.defineProperty(yi.prototype,r,{get(){return this._context[r]},set(e){this._context[r]=e}})});var Vs=class extends yi{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){let t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){let t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){let t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){let t=e.fill(),i=e.getFillPriority();if(t&&i==="color"){this._fillColor(e);return}let o=e.getFillPatternImage();if(o&&i==="pattern"){this._fillPattern(e);return}let a=e.getFillLinearGradientColorStops();if(a&&i==="linear-gradient"){this._fillLinearGradient(e);return}let l=e.getFillRadialGradientColorStops();if(l&&i==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):o?this._fillPattern(e):a?this._fillLinearGradient(e):l&&this._fillRadialGradient(e)}_strokeLinearGradient(e){let t=e.getStrokeLinearGradientStartPoint(),i=e.getStrokeLinearGradientEndPoint(),o=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(t.x,t.y,i.x,i.y);if(o){for(let l=0;l<o.length;l+=2)a.addColorStop(o[l],o[l+1]);this.setAttr("strokeStyle",a)}}_stroke(e){let t=e.dash(),i=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!i){this.save();let a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),i||this.restore()}}_applyShadow(e){var t,i,o;let a=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",l=(i=e.getShadowBlur())!==null&&i!==void 0?i:5,h=(o=e.getShadowOffset())!==null&&o!==void 0?o:{x:0,y:0},u=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),g=u.x*f,m=u.y*f;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",l*Math.min(Math.abs(g),Math.abs(m))),this.setAttr("shadowOffsetX",h.x*g),this.setAttr("shadowOffsetY",h.y*m)}},zs=class extends yi{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){let t=e.getStrokeScaleEnabled();if(!t){this.save();let a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);let i=e.hitStrokeWidth(),o=i==="auto"?e.strokeWidth():i;this.setAttr("lineWidth",o),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}};var Us;function yv(){if(Us)return Us;let r=S.createCanvasElement(),e=r.getContext("2d");return Us=(function(){let t=V._global.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i})(),S.releaseCanvas(r),Us}var ar=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let i=(e||{}).pixelRatio||V.pixelRatio||yv();this.pixelRatio=i,this._canvas=S.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){let t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";let t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";let t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(o){return S.error("Unable to get data URL. "+o.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}},Tt=class extends ar{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new Vs(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}},Kn=class extends ar{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new zs(this),this.setSize(e.width,e.height)}};var Ee={get isDragging(){let r=!1;return Ee._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return Ee._dragElements.forEach(e=>{r=e.node}),r},_dragElements:new Map,_drag(r){let e=[];Ee._dragElements.forEach((t,i)=>{let{node:o}=t,a=o.getStage();a.setPointersPositions(r),t.pointerId===void 0&&(t.pointerId=S._getFirstPointerId(r));let l=a._changedPointerPositions.find(h=>h.id===t.pointerId);if(l){if(t.dragStatus!=="dragging"){let h=o.dragDistance();if(Math.max(Math.abs(l.x-t.startPointerPos.x),Math.abs(l.y-t.startPointerPos.y))<h||(o.startDrag({evt:r}),!o.isDragging()))return}o._setDragPosition(r,t),e.push(o)}}),e.forEach(t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:r},!0)})},_endDragBefore(r){let e=[];Ee._dragElements.forEach(t=>{let{node:i}=t,o=i.getStage();if(r&&o.setPointersPositions(r),!o._changedPointerPositions.find(h=>h.id===t.pointerId))return;(t.dragStatus==="dragging"||t.dragStatus==="stopped")&&(Ee.justDragged=!0,V._mouseListenClick=!1,V._touchListenClick=!1,V._pointerListenClick=!1,t.dragStatus="stopped");let l=t.node.getLayer()||t.node instanceof V.Stage&&t.node;l&&e.indexOf(l)===-1&&e.push(l)}),e.forEach(t=>{t.draw()})},_endDragAfter(r){Ee._dragElements.forEach((e,t)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:r},!0),e.dragStatus!=="dragging"&&Ee._dragElements.delete(t)})}};V.isBrowser&&(window.addEventListener("mouseup",Ee._endDragBefore,!0),window.addEventListener("touchend",Ee._endDragBefore,!0),window.addEventListener("touchcancel",Ee._endDragBefore,!0),window.addEventListener("mousemove",Ee._drag),window.addEventListener("touchmove",Ee._drag),window.addEventListener("mouseup",Ee._endDragAfter,!1),window.addEventListener("touchend",Ee._endDragAfter,!1),window.addEventListener("touchcancel",Ee._endDragAfter,!1));function Jn(r){return S._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||S._isBoolean(r)?r:Object.prototype.toString.call(r)}function Gs(r){return r>255?255:r<0?0:Math.round(r)}function O(){if(V.isUnminified)return function(r,e){return S._isNumber(r)||S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),r}}function Qn(r){if(V.isUnminified)return function(e,t){let i=S._isNumber(e),o=S._isArray(e)&&e.length==r;return!i&&!o&&S.warn(Jn(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+r+")"),e}}function co(){if(V.isUnminified)return function(r,e){return S._isNumber(r)||r==="auto"||S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),r}}function mn(){if(V.isUnminified)return function(r,e){return S._isString(r)||S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),r}}function lc(){if(V.isUnminified)return function(r,e){let t=S._isString(r),i=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return t||i||S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),r}}function ef(){if(V.isUnminified)return function(r,e){let t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&r instanceof t||(S._isArray(r)?r.forEach(function(i){S._isNumber(i)||S.warn('"'+e+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),r}}function ut(){if(V.isUnminified)return function(r,e){return r===!0||r===!1||S.warn(Jn(r)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),r}}function tf(r){if(V.isUnminified)return function(e,t){return e==null||S.isObject(e)||S.warn(Jn(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+r),e}}var ho="get",uo="set",w={addGetterSetter(r,e,t,i,o){w.addGetter(r,e,t),w.addSetter(r,e,i,o),w.addOverloadedGetterSetter(r,e)},addGetter(r,e,t){let i=ho+S._capitalize(e);r.prototype[i]=r.prototype[i]||function(){let o=this.attrs[e];return o===void 0?t:o}},addSetter(r,e,t,i){let o=uo+S._capitalize(e);r.prototype[o]||w.overWriteSetter(r,e,t,i)},overWriteSetter(r,e,t,i){let o=uo+S._capitalize(e);r.prototype[o]=function(a){return t&&a!==void 0&&a!==null&&(a=t.call(this,a,e)),this._setAttr(e,a),i&&i.call(this),this}},addComponentsGetterSetter(r,e,t,i,o){let a=t.length,l=S._capitalize,h=ho+l(e),u=uo+l(e);r.prototype[h]=function(){let g={};for(let m=0;m<a;m++){let v=t[m];g[v]=this.getAttr(e+l(v))}return g};let f=tf(t);r.prototype[u]=function(g){let m=this.attrs[e];i&&(g=i.call(this,g,e)),f&&f.call(this,g,e);for(let v in g)g.hasOwnProperty(v)&&this._setAttr(e+l(v),g[v]);return g||t.forEach(v=>{this._setAttr(e+l(v),void 0)}),this._fireChangeEvent(e,m,g),o&&o.call(this),this},w.addOverloadedGetterSetter(r,e)},addOverloadedGetterSetter(r,e){let t=S._capitalize(e),i=uo+t,o=ho+t;r.prototype[e]=function(){return arguments.length?(this[i](arguments[0]),this):this[o]()}},addDeprecatedGetterSetter(r,e,t,i){S.error("Adding deprecated "+e);let o=ho+S._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[o]=function(){S.error(a);let l=this.attrs[e];return l===void 0?t:l},w.addSetter(r,e,i,function(){S.error(a)}),w.addOverloadedGetterSetter(r,e)},backCompat(r,e){S.each(e,function(t,i){let o=r.prototype[i],a=ho+S._capitalize(t),l=uo+S._capitalize(t);function h(){o.apply(this,arguments),S.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}r.prototype[t]=h,r.prototype[a]=h,r.prototype[l]=h})},afterSetFilter(){this._filterUpToDate=!1}};function wv(r){let e=/(\w+)\(([^)]+)\)/g,t;for(;(t=e.exec(r))!==null;){let[,i,o]=t;switch(i){case"blur":{let a=parseFloat(o.replace("px",""));return function(l){this.blurRadius(a*.5);let h=V.Filters;h&&h.Blur&&h.Blur.call(this,l)}}case"brightness":{let a=o.includes("%")?parseFloat(o)/100:parseFloat(o);return function(l){this.brightness(a);let h=V.Filters;h&&h.Brightness&&h.Brightness.call(this,l)}}case"contrast":{let a=parseFloat(o);return function(l){let h=100*(Math.sqrt(a)-1);this.contrast(h);let u=V.Filters;u&&u.Contrast&&u.Contrast.call(this,l)}}case"grayscale":return function(a){let l=V.Filters;l&&l.Grayscale&&l.Grayscale.call(this,a)};case"sepia":return function(a){let l=V.Filters;l&&l.Sepia&&l.Sepia.call(this,a)};case"invert":return function(a){let l=V.Filters;l&&l.Invert&&l.Invert.call(this,a)};default:S.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}var js="absoluteOpacity",nf="allEventListeners",An="absoluteTransform",rf="absoluteScale",wi="canvas",bv="Change",Cv="children",Sv="konva",cc="listening",Dv="mouseenter",xv="mouseleave",Ev="pointerenter",Mv="pointerleave",Tv="touchenter",Pv="touchleave";var of="set",sf="Shape",Hs=" ",af="stage",ei="transform",Av="Stage",hc="visible",Rv=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Hs),Ov=1,F=class r{constructor(e){this._id=Ov++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===ei||e===An)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let i=this._cache.get(e);return(i===void 0||(e===ei||e===An)&&i.dirty===!0)&&(i=t.call(this),this._cache.set(e,i)),i}_calculate(e,t,i){if(!this._attachedDepsListeners.get(e)){let o=t.map(a=>a+"Change.konva").join(Hs);this.on(o,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,i)}_getCanvasCache(){return this._cache.get(wi)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===An&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(wi)){let{scene:e,filter:t,hit:i}=this._cache.get(wi);S.releaseCanvas(e._canvas,t._canvas,i._canvas),this._cache.delete(wi)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){let t=e||{},i={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let o=Math.ceil(t.width||i.width),a=Math.ceil(t.height||i.height),l=t.pixelRatio,h=t.x===void 0?Math.floor(i.x):t.x,u=t.y===void 0?Math.floor(i.y):t.y,f=t.offset||0,g=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!o||!a){S.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}let v=Math.abs(Math.round(i.x)-h)>.5?1:0,y=Math.abs(Math.round(i.y)-u)>.5?1:0;o+=f*2+v,a+=f*2+y,h-=f,u-=f;let b=new Tt({pixelRatio:l,width:o,height:a}),E=new Tt({pixelRatio:l,width:0,height:0,willReadFrequently:!0}),D=new Kn({pixelRatio:m,width:o,height:a}),x=b.getContext(),A=D.getContext(),T=new Tt({width:b.width/b.pixelRatio+Math.abs(h),height:b.height/b.pixelRatio+Math.abs(u),pixelRatio:b.pixelRatio}),R=T.getContext();return D.isCache=!0,b.isCache=!0,this._cache.delete(wi),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(b.getContext()._context.imageSmoothingEnabled=!1,E.getContext()._context.imageSmoothingEnabled=!1),x.save(),A.save(),R.save(),x.translate(-h,-u),A.translate(-h,-u),R.translate(-h,-u),T.x=h,T.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(js),this._clearSelfAndDescendantCache(rf),this.drawScene(b,this,T),this.drawHit(D,this),this._isUnderCache=!1,x.restore(),A.restore(),g&&(x.save(),x.beginPath(),x.rect(0,0,o,a),x.closePath(),x.setAttr("strokeStyle","red"),x.setAttr("lineWidth",5),x.stroke(),x.restore()),S.releaseCanvas(T._canvas),this._cache.set(wi,{scene:b,filter:E,hit:D,x:h,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(wi)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){let i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],o=1/0,a=1/0,l=-1/0,h=-1/0,u=this.getAbsoluteTransform(t);return i.forEach(function(f){let g=u.point(f);o===void 0&&(o=l=g.x,a=h=g.y),o=Math.min(o,g.x),a=Math.min(a,g.y),l=Math.max(l,g.x),h=Math.max(h,g.y)}),{x:o,y:a,width:l-o,height:h-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);let t=this._getCanvasCache();e.translate(t.x,t.y);let i=this._getCachedSceneCanvas(),o=i.pixelRatio;e.drawImage(i._canvas,0,0,i.width/o,i.height/o),e.restore()}_drawCachedHitCanvas(e){let t=this._getCanvasCache(),i=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),i=t.scene,o=t.filter,a=o.getContext(),l,h,u,f;if(!e||e.length===0)return i;if(this._filterUpToDate)return o;let g=!0;for(let v=0;v<e.length;v++){let y=typeof e[v]=="string"&&!ac();if(typeof e[v]!="string"||!ac()){g=!1;break}}let m=i.pixelRatio;if(o.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),g){let v=e.join(" ");return a.save(),a.setAttr("filter",v),a.drawImage(i._canvas,0,0,i.getWidth()/m,i.getHeight()/m),a.restore(),this._filterUpToDate=!0,o}try{for(l=e.length,a.clear(),a.drawImage(i._canvas,0,0,i.getWidth()/m,i.getHeight()/m),h=a.getImageData(0,0,o.getWidth(),o.getHeight()),u=0;u<l;u++)f=e[u],typeof f=="string"&&(f=wv(f)),f.call(this,h),a.putImageData(h,0,0)}catch(v){S.error("Unable to apply filter. "+v.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,o}on(e,t){if(this._cache&&this._cache.delete(nf),arguments.length===3)return this._delegate.apply(this,arguments);let i=e.split(Hs);for(let o=0;o<i.length;o++){let l=i[o].split("."),h=l[0],u=l[1]||"";this.eventListeners[h]||(this.eventListeners[h]=[]),this.eventListeners[h].push({name:u,handler:t})}return this}off(e,t){let i=(e||"").split(Hs),o=i.length,a,l,h,u,f,g;if(this._cache&&this._cache.delete(nf),!e)for(l in this.eventListeners)this._off(l);for(a=0;a<o;a++)if(h=i[a],u=h.split("."),f=u[0],g=u[1],f)this.eventListeners[f]&&this._off(f,g,t);else for(l in this.eventListeners)this._off(l,g,t);return this}dispatchEvent(e){let t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(i){t.call(this,i.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,i){let o=this;this.on(e,function(a){let l=a.target.findAncestors(t,!0,o);for(let h=0;h<l.length;h++)a=S.cloneObject(a),a.currentTarget=l[h],i.call(l[h],a)})}remove(){return this.isDragging()&&this.stopDrag(),Ee._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(An),this._clearSelfAndDescendantCache(js),this._clearSelfAndDescendantCache(rf),this._clearSelfAndDescendantCache(af),this._clearSelfAndDescendantCache(hc),this._clearSelfAndDescendantCache(cc)}_remove(){this._clearCaches();let e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){let t="get"+S._capitalize(e);return S._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,i;if(!e)return this;for(t in e)t!==Cv&&(i=of+S._capitalize(t),S._isFunction(this[i])?this[i](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(cc,this._isListening)}_isListening(e){if(!this.listening())return!1;let i=this.getParent();return i&&i!==e&&this!==e?i._isListening(e):!0}isVisible(){return this._getCache(hc,this._isVisible)}_isVisible(e){if(!this.visible())return!1;let i=this.getParent();return i&&i!==e&&this!==e?i._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);let i=this.getLayer(),o=!1;Ee._dragElements.forEach(l=>{l.dragStatus==="dragging"&&(l.node.nodeType==="Stage"||l.node.getLayer()===i)&&(o=!0)});let a=!t&&!V.hitOnDragEnabled&&(o||V.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,i=0,o,a,l,h;function u(g){for(o=[],a=g.length,l=0;l<a;l++)h=g[l],i++,h.nodeType!==sf&&(o=o.concat(h.getChildren().slice())),h._id===t._id&&(l=a);o.length>0&&o[0].getDepth()<=e&&u(o)}let f=this.getStage();return t.nodeType!==Av&&f&&u(f.getChildren()),i}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ei),this._clearSelfAndDescendantCache(An)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let e=this.getStage();if(!e)return null;let t=e.getPointerPosition();if(!t)return null;let i=this.getAbsoluteTransform().copy();return i.invert(),i.point(t)}getAbsolutePosition(e){let t=!1,i=this.parent;for(;i;){if(i.isCached()){t=!0;break}i=i.parent}t&&!e&&(e=!0);let o=this.getAbsoluteTransform(e).getMatrix(),a=new ht,l=this.offset();return a.m=o.slice(),a.translate(l.x,l.y),a.getTranslation()}setAbsolutePosition(e){let l=this._clearTransform(),{x:t,y:i}=l,o=Ya(l,["x","y"]);this.attrs.x=t,this.attrs.y=i,this._clearCache(ei);let a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(o),this.setPosition({x:e.x,y:e.y}),this._clearCache(ei),this._clearSelfAndDescendantCache(An),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){let e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,i=e.y,o=this.x(),a=this.y();return t!==void 0&&(o+=t),i!==void 0&&(a+=i),this.setPosition({x:o,y:a}),this}_eachAncestorReverse(e,t){let i=[],o=this.getParent(),a,l;if(!(t&&t._id===this._id)){for(i.unshift(this);o&&(!t||o._id!==t._id);)i.unshift(o),o=o.parent;for(a=i.length,l=0;l<a;l++)e(i[l])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return S.warn("Node has no parent. moveToTop function is ignored."),!1;let e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return S.warn("Node has no parent. moveUp function is ignored."),!1;let e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return S.warn("Node has no parent. moveDown function is ignored."),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return S.warn("Node has no parent. moveToBottom function is ignored."),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return S.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&S.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");let t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(js,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,i,o,a,l,h={attrs:{},className:this.getClassName()};for(t in e)i=e[t],l=S.isObject(i)&&!S._isPlainObject(i)&&!S._isArray(i),!l&&(o=typeof this[t]=="function"&&this[t],delete e[t],a=o?o.call(this):null,e[t]=i,a!==i&&(h.attrs[t]=i));return S._prepareToStringify(h)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,i){let o=[];t&&this._isMatch(e)&&o.push(this);let a=this.parent;for(;a;){if(a===i)return o;a._isMatch(e)&&o.push(a),a=a.parent}return o}isAncestorOf(e){return!1}findAncestor(e,t,i){return this.findAncestors(e,t,i)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),i=t.length,o,a;for(o=0;o<i;o++)if(a=t[o],S.isValidSelector(a)||(S.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),S.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),S.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){let e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(af,this._getStage)}_getStage(){let e=this.getParent();return e?e.getStage():null}fire(e,t={},i){return t.target=t.target||this,i?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(An,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new ht,this._eachAncestorReverse(function(i){let o=i.transformsEnabled();o==="all"?t.multiply(i.getTransform()):o==="position"&&t.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},e),t;{t=this._cache.get(An)||new ht,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();let i=this.transformsEnabled();if(i==="all")t.multiply(this.getTransform());else if(i==="position"){let o=this.attrs.x||0,a=this.attrs.y||0,l=this.attrs.offsetX||0,h=this.attrs.offsetY||0;t.translate(o-l,a-h)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();let o=this.getAbsoluteTransform(e).decompose();return{x:o.scaleX,y:o.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ei,this._getTransform)}_getTransform(){var e,t;let i=this._cache.get(ei)||new ht;i.reset();let o=this.x(),a=this.y(),l=V.getAngle(this.rotation()),h=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,u=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,f=this.attrs.skewX||0,g=this.attrs.skewY||0,m=this.attrs.offsetX||0,v=this.attrs.offsetY||0;return(o!==0||a!==0)&&i.translate(o,a),l!==0&&i.rotate(l),(f!==0||g!==0)&&i.skew(f,g),(h!==1||u!==1)&&i.scale(h,u),(m!==0||v!==0)&&i.translate(-1*m,-1*v),i.dirty=!1,i}clone(e){let t=S.cloneObject(this.attrs),i,o,a,l,h;for(i in e)t[i]=e[i];let u=new this.constructor(t);for(i in this.eventListeners)for(o=this.eventListeners[i],a=o.length,l=0;l<a;l++)h=o[l],h.name.indexOf(Sv)<0&&(u.eventListeners[i]||(u.eventListeners[i]=[]),u.eventListeners[i].push(h));return u}_toKonvaCanvas(e){e=e||{};let t=this.getClientRect(),i=this.getStage(),o=e.x!==void 0?e.x:Math.floor(t.x),a=e.y!==void 0?e.y:Math.floor(t.y),l=e.pixelRatio||1,h=new Tt({width:e.width||Math.ceil(t.width)||(i?i.width():0),height:e.height||Math.ceil(t.height)||(i?i.height():0),pixelRatio:l}),u=h.getContext(),f=new Tt({width:h.width/h.pixelRatio+Math.abs(o),height:h.height/h.pixelRatio+Math.abs(a),pixelRatio:h.pixelRatio});return e.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(o||a)&&u.translate(-1*o,-1*a),this.drawScene(h,void 0,f),u.restore(),h}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};let t=e.mimeType||null,i=e.quality||null,o=this._toKonvaCanvas(e).toDataURL(t,i);return e.callback&&e.callback(o),o}toImage(e){return new Promise((t,i)=>{try{let o=e?.callback;o&&delete e.callback,S._urlToImage(this.toDataURL(e),function(a){t(a),o?.(a)})}catch(o){i(o)}})}toBlob(e){return new Promise((t,i)=>{try{let o=e?.callback;o&&delete e.callback,this.toCanvas(e).toBlob(a=>{t(a),o?.(a)},e?.mimeType,e?.quality)}catch(o){i(o)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():V.dragDistance}_off(e,t,i){let o=this.eventListeners[e],a,l,h;for(a=0;a<o.length;a++)if(l=o[a].name,h=o[a].handler,(l!=="konva"||t==="konva")&&(!t||l===t)&&(!i||i===h)){if(o.splice(a,1),o.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,t,i){this._fire(e+bv,{oldVal:t,newVal:i})}addName(e){if(!this.hasName(e)){let t=this.name(),i=t?t+" "+e:e;this.name(i)}return this}hasName(e){if(!e)return!1;let t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){let t=(this.name()||"").split(/\s/g),i=t.indexOf(e);return i!==-1&&(t.splice(i,1),this.name(t.join(" "))),this}setAttr(e,t){let i=this[of+S._capitalize(e)];return S._isFunction(i)?i.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(V.autoDrawEnabled){let e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,t){let i=this.attrs[e];i===t&&!S.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,i,t),this._requestDraw())}_setComponentAttr(e,t,i){let o;i!==void 0&&(o=this.attrs[e],o||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=i,this._fireChangeEvent(e,o,i))}_fireAndBubble(e,t,i){t&&this.nodeType===sf&&(t.target=this);let o=[Dv,xv,Ev,Mv,Tv,Pv];if(!(o.indexOf(e)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(e,t);let l=o.indexOf(e)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!l&&(i&&i.parent?this._fireAndBubble.call(this.parent,e,t,i):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,i;let{nodeType:o}=this,a=r.protoListenerMap.get(o)||{},l=a?.[e];if(l===void 0){l=[];let h=Object.getPrototypeOf(this);for(;h;){let u=(i=(t=h.eventListeners)===null||t===void 0?void 0:t[e])!==null&&i!==void 0?i:[];l.push(...u),h=Object.getPrototypeOf(h)}a[e]=l,r.protoListenerMap.set(o,a)}return l}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;let i=this._getProtoListeners(e);if(i)for(let a=0;a<i.length;a++)i[a].handler.call(this,t);let o=this.eventListeners[e];if(o)for(let a=0;a<o.length;a++)o[a].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){let t=e?e.pointerId:void 0,i=this.getStage(),o=this.getAbsolutePosition();if(!i)return;let a=i._getPointerById(t)||i._changedPointerPositions[0]||o;Ee._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-o.x,y:a.y-o.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){Ee._dragElements.has(this._id)||this._createDragElement(e);let i=Ee._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){let i=this.getStage()._getPointerById(t.pointerId);if(!i)return;let o={x:i.x-t.offset.x,y:i.y-t.offset.y},a=this.dragBoundFunc();if(a!==void 0){let l=a.call(this,o,e);l?o=l:S.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==o.x||this._lastPos.y!==o.y)&&(this.setAbsolutePosition(o),this._requestDraw()),this._lastPos=o}stopDrag(e){let t=Ee._dragElements.get(this._id);t&&(t.dragStatus="stopped"),Ee._endDragBefore(e),Ee._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){let e=Ee._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||V.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let o=!1;Ee._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(o=!0)}),o||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;let t=Ee._dragElements.get(this._id),i=t&&t.dragStatus==="dragging",o=t&&t.dragStatus==="ready";i?this.stopDrag():o&&Ee._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){let t=this.getStage();if(!t)return!1;let i={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return S.haveIntersection(i,this.getClientRect())}static create(e,t){return S._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let i=r.prototype.getClassName.call(e),o=e.children,a,l,h;t&&(e.attrs.container=t),V[i]||(S.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");let u=V[i];if(a=new u(e.attrs),o)for(l=o.length,h=0;h<l;h++)a.add(r._createNode(o[h]));return a}};F.protoListenerMap=new Map;F.prototype.nodeType="Node";F.prototype._attrsAffectingSize=[];F.prototype.eventListeners={};F.prototype.on.call(F.prototype,Rv,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ei),this._clearSelfAndDescendantCache(An)});F.prototype.on.call(F.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(hc)});F.prototype.on.call(F.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(cc)});F.prototype.on.call(F.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(js)});var Fe=w.addGetterSetter;Fe(F,"zIndex");Fe(F,"absolutePosition");Fe(F,"position");Fe(F,"x",0,O());Fe(F,"y",0,O());Fe(F,"globalCompositeOperation","source-over",mn());Fe(F,"opacity",1,O());Fe(F,"name","",mn());Fe(F,"id","",mn());Fe(F,"rotation",0,O());w.addComponentsGetterSetter(F,"scale",["x","y"]);Fe(F,"scaleX",1,O());Fe(F,"scaleY",1,O());w.addComponentsGetterSetter(F,"skew",["x","y"]);Fe(F,"skewX",0,O());Fe(F,"skewY",0,O());w.addComponentsGetterSetter(F,"offset",["x","y"]);Fe(F,"offsetX",0,O());Fe(F,"offsetY",0,O());Fe(F,"dragDistance",void 0,O());Fe(F,"width",0,O());Fe(F,"height",0,O());Fe(F,"listening",!0,ut());Fe(F,"preventDefault",!0,ut());Fe(F,"filters",void 0,function(r){return this._filterUpToDate=!1,r});Fe(F,"visible",!0,ut());Fe(F,"transformsEnabled","all",mn());Fe(F,"size");Fe(F,"dragBoundFunc");Fe(F,"draggable",!1,ut());w.backCompat(F,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var it=class extends F{constructor(){super(...arguments),this.children=[]}getChildren(e){let t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let i=0;i<e.length;i++)this.add(e[i]);return this}let t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){let t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){let i=[];return this._descendants(o=>{let a=o._isMatch(e);return a&&i.push(o),!!(a&&t)}),i}_descendants(e){let t=!1,i=this.getChildren();for(let o of i){if(t=e(o),t)return!0;if(o.hasChildren()&&(t=o._descendants(e),t))return!0}return!1}toObject(){let e=F.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){let t=F.prototype.clone.call(this,e);return this.getChildren().forEach(function(i){t.add(i.clone())}),t}getAllIntersections(e){let t=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(e)&&t.push(i)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(i){i._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,i){t.index=i}),this._requestDraw()}drawScene(e,t,i){let o=this.getLayer(),a=e||o&&o.getCanvas(),l=a&&a.getContext(),h=this._getCanvasCache(),u=h&&h.scene,f=a&&a.isCache;if(!this.isVisible()&&!f)return this;if(u){l.save();let g=this.getAbsoluteTransform(t).getMatrix();l.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedSceneCanvas(l),l.restore()}else this._drawChildren("drawScene",a,t,i);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;let i=this.getLayer(),o=e||i&&i.hitCanvas,a=o&&o.getContext(),l=this._getCanvasCache();if(l&&l.hit){a.save();let u=this.getAbsoluteTransform(t).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",o,t);return this}_drawChildren(e,t,i,o){var a;let l=t&&t.getContext(),h=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),g=typeof h=="number"&&typeof u=="number"||f,m=i===this;if(g){l.save();let y=this.getAbsoluteTransform(i),b=y.getMatrix();l.transform(b[0],b[1],b[2],b[3],b[4],b[5]),l.beginPath();let E;if(f)E=f.call(this,l,this);else{let D=this.clipX(),x=this.clipY();l.rect(D||0,x||0,h,u)}l.clip.apply(l,E),b=y.copy().invert().getMatrix(),l.transform(b[0],b[1],b[2],b[3],b[4],b[5])}let v=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";v&&(l.save(),l._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(y){y[e](t,i,o)}),v&&l.restore(),g&&l.restore()}getClientRect(e={}){var t;let i=e.skipTransform,o=e.relativeTo,a,l,h,u,f={x:1/0,y:1/0,width:0,height:0},g=this;(t=this.children)===null||t===void 0||t.forEach(function(y){if(!y.visible())return;let b=y.getClientRect({relativeTo:g,skipShadow:e.skipShadow,skipStroke:e.skipStroke});b.width===0&&b.height===0||(a===void 0?(a=b.x,l=b.y,h=b.x+b.width,u=b.y+b.height):(a=Math.min(a,b.x),l=Math.min(l,b.y),h=Math.max(h,b.x+b.width),u=Math.max(u,b.y+b.height)))});let m=this.find("Shape"),v=!1;for(let y=0;y<m.length;y++)if(m[y]._isVisible(this)){v=!0;break}return v&&a!==void 0?f={x:a,y:l,width:h-a,height:u-l}:f={x:0,y:0,width:0,height:0},i?f:this._transformedRect(f,o)}};w.addComponentsGetterSetter(it,"clip",["x","y","width","height"]);w.addGetterSetter(it,"clipX",void 0,O());w.addGetterSetter(it,"clipY",void 0,O());w.addGetterSetter(it,"clipWidth",void 0,O());w.addGetterSetter(it,"clipHeight",void 0,O());w.addGetterSetter(it,"clipFunc");var fo=new Map,lf=V._global.PointerEvent!==void 0;function $s(r){return fo.get(r)}function Ws(r){return{evt:r,pointerId:r.pointerId}}function Zs(r,e){return fo.get(r)===e}function qs(r,e){bi(r),e.getStage()&&(fo.set(r,e),lf&&e._fire("gotpointercapture",Ws(new PointerEvent("gotpointercapture"))))}function bi(r,e){let t=fo.get(r);if(!t)return;let i=t.getStage();i&&i.content,fo.delete(r),lf&&t._fire("lostpointercapture",Ws(new PointerEvent("lostpointercapture")))}var Iv="Stage",Lv="string",hf="px",kv="mouseout",df="mouseleave",ff="mouseover",pf="mouseenter",gf="mousemove",mf="mousedown",_f="mouseup",po="pointermove",go="pointerdown",cr="pointerup",mo="pointercancel",Fv="lostpointercapture",Ys="pointerout",_o="pointerleave",Xs="pointerover",Ks="pointerenter",dc="contextmenu",vf="touchstart",yf="touchend",wf="touchmove",bf="touchcancel",fc="wheel",Nv=5,Bv=[[pf,"_pointerenter"],[mf,"_pointerdown"],[gf,"_pointermove"],[_f,"_pointerup"],[df,"_pointerleave"],[vf,"_pointerdown"],[wf,"_pointermove"],[yf,"_pointerup"],[bf,"_pointercancel"],[ff,"_pointerover"],[fc,"_wheel"],[dc,"_contextmenu"],[go,"_pointerdown"],[po,"_pointermove"],[cr,"_pointerup"],[mo,"_pointercancel"],[_o,"_pointerleave"],[Fv,"_lostpointercapture"]],uc={mouse:{[Ys]:kv,[_o]:df,[Xs]:ff,[Ks]:pf,[po]:gf,[go]:mf,[cr]:_f,[mo]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Ys]:"touchout",[_o]:"touchleave",[Xs]:"touchover",[Ks]:"touchenter",[po]:wf,[go]:vf,[cr]:yf,[mo]:bf,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Ys]:Ys,[_o]:_o,[Xs]:Xs,[Ks]:Ks,[po]:po,[go]:go,[cr]:cr,[mo]:mo,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},vo=r=>r.indexOf("pointer")>=0?"pointer":r.indexOf("touch")>=0?"touch":"mouse",lr=r=>{let e=vo(r);if(e==="pointer")return V.pointerEventsEnabled&&uc.pointer;if(e==="touch")return uc.touch;if(e==="mouse")return uc.mouse};function uf(r={}){return(r.clipFunc||r.clipWidth||r.clipHeight)&&S.warn("Stage does not support clipping. Please use clip for Layers or Groups."),r}var Vv="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",hr=[],Ci=class extends it{constructor(e){super(uf(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),hr.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{uf(this.attrs)}),this._checkVisibility()}_validateAdd(e){let t=e.getType()==="Layer",i=e.getType()==="FastLayer";t||i||S.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;let e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===Lv){let t;if(e.charAt(0)==="."){let i=e.slice(1);e=document.getElementsByClassName(i)[0]}else e.charAt(0)!=="#"?t=e:t=e.slice(1),e=document.getElementById(t);if(!e)throw"Can not find container in document with id "+t}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let e=this.children,t=e.length;for(let i=0;i<t;i++)e[i].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),it.prototype.clone.call(this,e)}destroy(){super.destroy();let e=this.content;e&&S._isInDocument(e)&&this.container().removeChild(e);let t=hr.indexOf(this);return t>-1&&hr.splice(t,1),S.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(S.warn(Vv),null)}_getPointerById(e){return this._pointerPositions.find(t=>t.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e=j({},e),e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();let t=new Tt({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),i=t.getContext()._context,o=this.children;return(e.x||e.y)&&i.translate(-1*e.x,-1*e.y),o.forEach(function(a){if(!a.isVisible())return;let l=a._toKonvaCanvas(e);i.drawImage(l._canvas,e.x,e.y,l.getWidth()/l.getPixelRatio(),l.getHeight()/l.getPixelRatio())}),t}getIntersection(e){if(!e)return null;let t=this.children,i=t.length,o=i-1;for(let a=o;a>=0;a--){let l=t[a].getIntersection(e);if(l)return l}return null}_resizeDOM(){let e=this.width(),t=this.height();this.content&&(this.content.style.width=e+hf,this.content.style.height=t+hf),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach(i=>{i.setSize({width:e,height:t}),i.draw()})}add(e,...t){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.add(arguments[o]);return this}super.add(e);let i=this.children.length;return i>Nv&&S.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),V.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return Zs(e,this)}setPointerCapture(e){qs(e,this)}releaseCapture(e){bi(e,this)}getLayers(){return this.children}_bindContentEvents(){V.isBrowser&&Bv.forEach(([e,t])=>{this.content.addEventListener(e,i=>{this[t](i)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);let t=lr(e.type);t&&this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);let t=lr(e.type);t&&this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){let t=lr(e.type),i=vo(e.type);if(!t)return;this.setPointersPositions(e);let o=this._getTargetShape(i),a=!(V.isDragging()||V.isTransforming())||V.hitOnDragEnabled;o&&a?(o._fireAndBubble(t.pointerout,{evt:e}),o._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[i+"targetShape"]=null):a&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){let t=lr(e.type),i=vo(e.type);if(!t)return;this.setPointersPositions(e);let o=!1;this._changedPointerPositions.forEach(a=>{let l=this.getIntersection(a);if(Ee.justDragged=!1,V["_"+i+"ListenClick"]=!0,!l||!l.isListening()){this[i+"ClickStartShape"]=void 0;return}V.capturePointerEventsEnabled&&l.setPointerCapture(a.id),this[i+"ClickStartShape"]=l,l._fireAndBubble(t.pointerdown,{evt:e,pointerId:a.id}),o=!0;let h=e.type.indexOf("touch")>=0;l.preventDefault()&&e.cancelable&&h&&e.preventDefault()}),o||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){let t=lr(e.type),i=vo(e.type);if(!t)return;let o=e.type.indexOf("touch")>=0||e.pointerType==="touch";if(V.isDragging()&&Ee.node.preventDefault()&&e.cancelable&&o&&e.preventDefault(),this.setPointersPositions(e),!(!(V.isDragging()||V.isTransforming())||V.hitOnDragEnabled))return;let l={},h=!1,u=this._getTargetShape(i);this._changedPointerPositions.forEach(f=>{let g=$s(f.id)||this.getIntersection(f),m=f.id,v={evt:e,pointerId:m},y=u!==g;if(y&&u&&(u._fireAndBubble(t.pointerout,j({},v),g),u._fireAndBubble(t.pointerleave,j({},v),g)),g){if(l[g._id])return;l[g._id]=!0}g&&g.isListening()?(h=!0,y&&(g._fireAndBubble(t.pointerover,j({},v),u),g._fireAndBubble(t.pointerenter,j({},v),u),this[i+"targetShape"]=g),g._fireAndBubble(t.pointermove,j({},v))):u&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:m}),this[i+"targetShape"]=null)}),h||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){let t=lr(e.type),i=vo(e.type);if(!t)return;this.setPointersPositions(e);let o=this[i+"ClickStartShape"],a=this[i+"ClickEndShape"],l={},h=!1;this._changedPointerPositions.forEach(u=>{let f=$s(u.id)||this.getIntersection(u);if(f){if(f.releaseCapture(u.id),l[f._id])return;l[f._id]=!0}let g=u.id,m={evt:e,pointerId:g},v=!1;V["_"+i+"InDblClickWindow"]?(v=!0,clearTimeout(this[i+"DblTimeout"])):Ee.justDragged||(V["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){V["_"+i+"InDblClickWindow"]=!1},V.dblClickWindow),f&&f.isListening()?(h=!0,this[i+"ClickEndShape"]=f,f._fireAndBubble(t.pointerup,j({},m)),V["_"+i+"ListenClick"]&&o&&o===f&&(f._fireAndBubble(t.pointerclick,j({},m)),v&&a&&a===f&&f._fireAndBubble(t.pointerdblclick,j({},m)))):(this[i+"ClickEndShape"]=null,h||(this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),h=!0),V["_"+i+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:g}),v&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:g}))}),h||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),V["_"+i+"ListenClick"]=!1,e.cancelable&&i!=="touch"&&i!=="pointer"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);let t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(dc,{evt:e}):this._fire(dc,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);let t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(fc,{evt:e}):this._fire(fc,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);let t=$s(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(cr,Ws(e)),bi(e.pointerId)}_lostpointercapture(e){bi(e.pointerId)}setPointersPositions(e){let t=this._getContentPosition(),i=null,o=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,a=>{this._pointerPositions.push({id:a.identifier,x:(a.clientX-t.left)/t.scaleX,y:(a.clientY-t.top)/t.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,a=>{this._changedPointerPositions.push({id:a.identifier,x:(a.clientX-t.left)/t.scaleX,y:(a.clientY-t.top)/t.scaleY})})):(i=(e.clientX-t.left)/t.scaleX,o=(e.clientY-t.top)/t.scaleY,this.pointerPos={x:i,y:o},this._pointerPositions=[{x:i,y:o,id:S._getFirstPointerId(e)}],this._changedPointerPositions=[{x:i,y:o,id:S._getFirstPointerId(e)}])}_setPointerPosition(e){S.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Tt({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Kn({pixelRatio:1,width:this.width(),height:this.height()}),!V.isBrowser)return;let e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return S.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}};Ci.prototype.nodeType=Iv;le(Ci);w.addGetterSetter(Ci,"container");V.isBrowser&&document.addEventListener("visibilitychange",()=>{hr.forEach(r=>{r.batchDraw()})});var Cf="hasShadow",Sf="shadowRGBA",Df="patternImage",xf="linearGradient",Ef="radialGradient",Js;function pc(){return Js||(Js=S.createCanvasElement().getContext("2d"),Js)}var Si={};function zv(r){let e=this.attrs.fillRule;e?r.fill(e):r.fill()}function Uv(r){r.stroke()}function Gv(r){let e=this.attrs.fillRule;e?r.fill(e):r.fill()}function jv(r){r.stroke()}function Hv(){this._clearCache(Cf)}function $v(){this._clearCache(Sf)}function Wv(){this._clearCache(Df)}function Zv(){this._clearCache(xf)}function qv(){this._clearCache(Ef)}var I=class extends F{constructor(e){super(e);let t,i=0;for(;t=S.getHitColor(),!(t&&!(t in Si));)if(i++,i>=1e4){S.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),t=S.getRandomColor();break}this.colorKey=t,Si[t]=this}getContext(){return S.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return S.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Cf,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Df,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let t=pc().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){let i=new ht;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(V.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let o=i.getMatrix(),a=typeof DOMMatrix>"u"?{a:o[0],b:o[1],c:o[2],d:o[3],e:o[4],f:o[5]}:new DOMMatrix(o);t.setTransform(a)}return t}}_getLinearGradient(){return this._getCache(xf,this.__getLinearGradient)}__getLinearGradient(){let e=this.fillLinearGradientColorStops();if(e){let t=pc(),i=this.fillLinearGradientStartPoint(),o=this.fillLinearGradientEndPoint(),a=t.createLinearGradient(i.x,i.y,o.x,o.y);for(let l=0;l<e.length;l+=2)a.addColorStop(e[l],e[l+1]);return a}}_getRadialGradient(){return this._getCache(Ef,this.__getRadialGradient)}__getRadialGradient(){let e=this.fillRadialGradientColorStops();if(e){let t=pc(),i=this.fillRadialGradientStartPoint(),o=this.fillRadialGradientEndPoint(),a=t.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),o.x,o.y,this.fillRadialGradientEndRadius());for(let l=0;l<e.length;l+=2)a.addColorStop(e[l],e[l+1]);return a}}getShadowRGBA(){return this._getCache(Sf,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let e=S.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){let t=this.getStage();if(!t)return!1;let i=t.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return F.prototype.destroy.call(this),delete Si[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!((t=this.attrs.perfectDrawEnabled)!==null&&t!==void 0?t:!0))return!1;let o=e||this.hasFill(),a=this.hasStroke(),l=this.getAbsoluteOpacity()!==1;if(o&&a&&l)return!0;let h=this.hasShadow(),u=this.shadowForStrokeEnabled();return!!(o&&a&&h&&u)}setStrokeHitEnabled(e){S.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let t=!1,i=this.getParent();for(;i;){if(i.isCached()){t=!0;break}i=i.getParent()}let o=e.skipTransform,a=e.relativeTo||t&&this.getStage()||void 0,l=this.getSelfRect(),u=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,f=l.width+u,g=l.height+u,m=!e.skipShadow&&this.hasShadow(),v=m?this.shadowOffsetX():0,y=m?this.shadowOffsetY():0,b=f+Math.abs(v),E=g+Math.abs(y),D=m&&this.shadowBlur()||0,x=b+D*2,A=E+D*2,T={width:x,height:A,x:-(u/2+D)+Math.min(v,0)+l.x,y:-(u/2+D)+Math.min(y,0)+l.y};return o?T:this._transformedRect(T,a)}drawScene(e,t,i){let o=this.getLayer(),a=e||o.getCanvas(),l=a.getContext(),h=this._getCanvasCache(),u=this.getSceneFunc(),f=this.hasShadow(),g,m=!1,v=t===this;if(!this.isVisible()&&!v)return this;if(h){l.save();let y=this.getAbsoluteTransform(t).getMatrix();return l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(l),l.restore(),this}if(!u)return this;if(l.save(),this._useBufferCanvas()&&!m){g=this.getStage();let y=i||g.bufferCanvas,b=y.getContext();i?(b.save(),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,y.width,y.height),b.restore()):b.clear(),b.save(),b._applyLineJoin(this),b._applyMiterLimit(this);let E=this.getAbsoluteTransform(t).getMatrix();b.transform(E[0],E[1],E[2],E[3],E[4],E[5]),u.call(this,b,this),b.restore();let D=y.pixelRatio;f&&l._applyShadow(this),v||(l._applyOpacity(this),l._applyGlobalCompositeOperation(this)),l.drawImage(y._canvas,y.x||0,y.y||0,y.width/D,y.height/D)}else{if(l._applyLineJoin(this),l._applyMiterLimit(this),!v){let y=this.getAbsoluteTransform(t).getMatrix();l.transform(y[0],y[1],y[2],y[3],y[4],y[5]),l._applyOpacity(this),l._applyGlobalCompositeOperation(this)}f&&l._applyShadow(this),u.call(this,l,this)}return l.restore(),this}drawHit(e,t,i=!1){if(!this.shouldDrawHit(t,i))return this;let o=this.getLayer(),a=e||o.hitCanvas,l=a&&a.getContext(),h=this.hitFunc()||this.sceneFunc(),u=this._getCanvasCache(),f=u&&u.hit;if(this.colorKey||S.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),f){l.save();let m=this.getAbsoluteTransform(t).getMatrix();return l.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(l),l.restore(),this}if(!h)return this;if(l.save(),l._applyLineJoin(this),l._applyMiterLimit(this),!(this===t)){let m=this.getAbsoluteTransform(t).getMatrix();l.transform(m[0],m[1],m[2],m[3],m[4],m[5])}return h.call(this,l,this),l.restore(),this}drawHitFromCache(e=0){let t=this._getCanvasCache(),i=this._getCachedSceneCanvas(),o=t.hit,a=o.getContext(),l=o.getWidth(),h=o.getHeight();a.clear(),a.drawImage(i._canvas,0,0,l,h);try{let u=a.getImageData(0,0,l,h),f=u.data,g=f.length,m=S._hexToRgb(this.colorKey);for(let v=0;v<g;v+=4)f[v+3]>e?(f[v]=m.r,f[v+1]=m.g,f[v+2]=m.b,f[v+3]=255):f[v+3]=0;a.putImageData(u,0,0)}catch(u){S.error("Unable to draw hit graph from cached scene canvas. "+u.message)}return this}hasPointerCapture(e){return Zs(e,this)}setPointerCapture(e){qs(e,this)}releaseCapture(e){bi(e,this)}};I.prototype._fillFunc=zv;I.prototype._strokeFunc=Uv;I.prototype._fillFuncHit=Gv;I.prototype._strokeFuncHit=jv;I.prototype._centroid=!1;I.prototype.nodeType="Shape";le(I);I.prototype.eventListeners={};I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Hv);I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",$v);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",Wv);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",Zv);I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",qv);w.addGetterSetter(I,"stroke",void 0,lc());w.addGetterSetter(I,"strokeWidth",2,O());w.addGetterSetter(I,"fillAfterStrokeEnabled",!1);w.addGetterSetter(I,"hitStrokeWidth","auto",co());w.addGetterSetter(I,"strokeHitEnabled",!0,ut());w.addGetterSetter(I,"perfectDrawEnabled",!0,ut());w.addGetterSetter(I,"shadowForStrokeEnabled",!0,ut());w.addGetterSetter(I,"lineJoin");w.addGetterSetter(I,"lineCap");w.addGetterSetter(I,"miterLimit");w.addGetterSetter(I,"sceneFunc");w.addGetterSetter(I,"hitFunc");w.addGetterSetter(I,"dash");w.addGetterSetter(I,"dashOffset",0,O());w.addGetterSetter(I,"shadowColor",void 0,mn());w.addGetterSetter(I,"shadowBlur",0,O());w.addGetterSetter(I,"shadowOpacity",1,O());w.addComponentsGetterSetter(I,"shadowOffset",["x","y"]);w.addGetterSetter(I,"shadowOffsetX",0,O());w.addGetterSetter(I,"shadowOffsetY",0,O());w.addGetterSetter(I,"fillPatternImage");w.addGetterSetter(I,"fill",void 0,lc());w.addGetterSetter(I,"fillPatternX",0,O());w.addGetterSetter(I,"fillPatternY",0,O());w.addGetterSetter(I,"fillLinearGradientColorStops");w.addGetterSetter(I,"strokeLinearGradientColorStops");w.addGetterSetter(I,"fillRadialGradientStartRadius",0);w.addGetterSetter(I,"fillRadialGradientEndRadius",0);w.addGetterSetter(I,"fillRadialGradientColorStops");w.addGetterSetter(I,"fillPatternRepeat","repeat");w.addGetterSetter(I,"fillEnabled",!0);w.addGetterSetter(I,"strokeEnabled",!0);w.addGetterSetter(I,"shadowEnabled",!0);w.addGetterSetter(I,"dashEnabled",!0);w.addGetterSetter(I,"strokeScaleEnabled",!0);w.addGetterSetter(I,"fillPriority","color");w.addComponentsGetterSetter(I,"fillPatternOffset",["x","y"]);w.addGetterSetter(I,"fillPatternOffsetX",0,O());w.addGetterSetter(I,"fillPatternOffsetY",0,O());w.addComponentsGetterSetter(I,"fillPatternScale",["x","y"]);w.addGetterSetter(I,"fillPatternScaleX",1,O());w.addGetterSetter(I,"fillPatternScaleY",1,O());w.addComponentsGetterSetter(I,"fillLinearGradientStartPoint",["x","y"]);w.addComponentsGetterSetter(I,"strokeLinearGradientStartPoint",["x","y"]);w.addGetterSetter(I,"fillLinearGradientStartPointX",0);w.addGetterSetter(I,"strokeLinearGradientStartPointX",0);w.addGetterSetter(I,"fillLinearGradientStartPointY",0);w.addGetterSetter(I,"strokeLinearGradientStartPointY",0);w.addComponentsGetterSetter(I,"fillLinearGradientEndPoint",["x","y"]);w.addComponentsGetterSetter(I,"strokeLinearGradientEndPoint",["x","y"]);w.addGetterSetter(I,"fillLinearGradientEndPointX",0);w.addGetterSetter(I,"strokeLinearGradientEndPointX",0);w.addGetterSetter(I,"fillLinearGradientEndPointY",0);w.addGetterSetter(I,"strokeLinearGradientEndPointY",0);w.addComponentsGetterSetter(I,"fillRadialGradientStartPoint",["x","y"]);w.addGetterSetter(I,"fillRadialGradientStartPointX",0);w.addGetterSetter(I,"fillRadialGradientStartPointY",0);w.addComponentsGetterSetter(I,"fillRadialGradientEndPoint",["x","y"]);w.addGetterSetter(I,"fillRadialGradientEndPointX",0);w.addGetterSetter(I,"fillRadialGradientEndPointY",0);w.addGetterSetter(I,"fillPatternRotation",0);w.addGetterSetter(I,"fillRule",void 0,mn());w.backCompat(I,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var Yv="beforeDraw",Xv="draw",Mf=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Kv=Mf.length,Qt=class extends it{constructor(e){super(e),this.canvas=new Tt,this.hitCanvas=new Kn({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){F.prototype.moveToTop.call(this);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!F.prototype.moveUp.call(this))return!1;let t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(F.prototype.moveDown.call(this)){let e=this.getStage();if(e){let t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(F.prototype.moveToBottom.call(this)){let e=this.getStage();if(e){let t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let e=this.getNativeCanvasElement();return F.prototype.remove.call(this),e&&e.parentNode&&S._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){let t=e.getType();t!=="Group"&&t!=="Shape"&&S.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=j({},e),e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),F.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){S.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){S.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,S.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,i=!1;for(;;){for(let o=0;o<Kv;o++){let a=Mf[o],l=this._getIntersection({x:e.x+a.x*t,y:e.y+a.y*t}),h=l.shape;if(h)return h;if(i=!!l.antialiased,!l.antialiased)break}if(i)t+=1;else return null}}_getIntersection(e){let t=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,o=i[3];if(o===255){let a=S.getHitColorKey(i[0],i[1],i[2]),l=Si[a];return l?{shape:l}:{antialiased:!0}}else if(o>0)return{antialiased:!0};return{}}drawScene(e,t,i){let o=this.getLayer(),a=e||o&&o.getCanvas();return this._fire(Yv,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),it.prototype.drawScene.call(this,a,t,i),this._fire(Xv,{node:this}),this}drawHit(e,t){let i=this.getLayer(),o=e||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),it.prototype.drawHit.call(this,o,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){S.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return S.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return S.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Qt.prototype.nodeType="Layer";le(Qt);w.addGetterSetter(Qt,"imageSmoothingEnabled",!0);w.addGetterSetter(Qt,"clearBeforeDraw",!0);w.addGetterSetter(Qt,"hitGraphEnabled",!0,ut());var ur=class extends Qt{constructor(e){super(e),this.listening(!1),S.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};ur.prototype.nodeType="FastLayer";le(ur);var en=class extends it{_validateAdd(e){let t=e.getType();t!=="Group"&&t!=="Shape"&&S.throw("You may only add groups and shapes to groups.")}};en.prototype.nodeType="Group";le(en);var gc=(function(){return Xn.performance&&Xn.performance.now?function(){return Xn.performance.now()}:function(){return new Date().getTime()}})(),dr=(()=>{class r{constructor(t,i){this.id=r.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:gc(),frameRate:0},this.func=t,this.setLayers(i)}setLayers(t){let i=[];return t&&(i=Array.isArray(t)?t:[t]),this.layers=i,this}getLayers(){return this.layers}addLayer(t){let i=this.layers,o=i.length;for(let a=0;a<o;a++)if(i[a]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){let i=r.animations,o=i.length;for(let a=0;a<o;a++)if(i[a].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=gc(),r._addAnimation(this),this}stop(){return r._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){let i=t.id,o=this.animations,a=o.length;for(let l=0;l<a;l++)if(o[l].id===i){this.animations.splice(l,1);break}}static _runFrames(){let t={},i=this.animations;for(let o=0;o<i.length;o++){let a=i[o],l=a.layers,h=a.func;a._updateFrameObject(gc());let u=l.length,f;if(h?f=h.call(a,a.frame)!==!1:f=!0,!!f)for(let g=0;g<u;g++){let m=l[g];m._id!==void 0&&(t[m._id]=m)}}for(let o in t)t.hasOwnProperty(o)&&t[o].batchDraw()}static _animationLoop(){let t=r;t.animations.length?(t._runFrames(),S.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,S.requestAnimFrame(this._animationLoop))}}return r.animations=[],r.animIdCounter=0,r.animRunning=!1,r})();var Jv={node:1,duration:1,easing:1,onFinish:1,yoyo:1},Qv=1,Tf=2,Pf=3,Af=["fill","stroke","shadowColor"],e1=0,mc=class{constructor(e,t,i,o,a,l,h){this.prop=e,this.propFunc=t,this.begin=o,this._pos=o,this.duration=l,this._change=0,this.prevPos=0,this.yoyo=h,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=a-this.begin,this.pause()}fire(e){let t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=Tf,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Pf,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){let e=this.getTimer()-this._startTime;this.state===Tf?this.setTime(e):this.state===Pf&&this.setTime(this.duration-e)}pause(){this.state=Qv,this.fire("onPause")}getTimer(){return new Date().getTime()}},_c=(()=>{class r{constructor(t){let i=this,o=t.node,a=o._id,l=t.easing||fr.Linear,h=!!t.yoyo,u,f;typeof t.duration>"u"?u=.3:t.duration===0?u=.001:u=t.duration,this.node=o,this._id=e1++;let g=o.getLayer()||(o instanceof V.Stage?o.getLayers():null);g||S.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new dr(function(){i.tween.onEnterFrame()},g),this.tween=new mc(f,function(m){i._tweenFunc(m)},l,0,1,u*1e3,h),this._addListeners(),r.attrs[a]||(r.attrs[a]={}),r.attrs[a][this._id]||(r.attrs[a][this._id]={}),r.tweens[a]||(r.tweens[a]={});for(f in t)Jv[f]===void 0&&this._addAttr(f,t[f]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,i){let o=this.node,a=o._id,l,h,u,f,g,m=r.tweens[a][t];m&&delete r.attrs[a][m][t];let v=o.getAttr(t);if(S._isArray(i))if(l=[],h=Math.max(i.length,v.length),t==="points"&&i.length!==v.length&&(i.length>v.length?(f=v,v=S._prepareArrayForTween(v,i,o.closed())):(u=i,i=S._prepareArrayForTween(i,v,o.closed()))),t.indexOf("fill")===0)for(let y=0;y<h;y++)if(y%2===0)l.push(i[y]-v[y]);else{let b=S.colorToRGBA(v[y]);g=S.colorToRGBA(i[y]),v[y]=b,l.push({r:g.r-b.r,g:g.g-b.g,b:g.b-b.b,a:g.a-b.a})}else for(let y=0;y<h;y++)l.push(i[y]-v[y]);else Af.indexOf(t)!==-1?(v=S.colorToRGBA(v),g=S.colorToRGBA(i),l={r:g.r-v.r,g:g.g-v.g,b:g.b-v.b,a:g.a-v.a}):l=i-v;r.attrs[a][this._id][t]={start:v,diff:l,end:i,trueEnd:u,trueStart:f},r.tweens[a][t]=this._id}_tweenFunc(t){let i=this.node,o=r.attrs[i._id][this._id],a,l,h,u,f,g,m,v;for(a in o){if(l=o[a],h=l.start,u=l.diff,v=l.end,S._isArray(h))if(f=[],m=Math.max(h.length,v.length),a.indexOf("fill")===0)for(g=0;g<m;g++)g%2===0?f.push((h[g]||0)+u[g]*t):f.push("rgba("+Math.round(h[g].r+u[g].r*t)+","+Math.round(h[g].g+u[g].g*t)+","+Math.round(h[g].b+u[g].b*t)+","+(h[g].a+u[g].a*t)+")");else for(g=0;g<m;g++)f.push((h[g]||0)+u[g]*t);else Af.indexOf(a)!==-1?f="rgba("+Math.round(h.r+u.r*t)+","+Math.round(h.g+u.g*t)+","+Math.round(h.b+u.b*t)+","+(h.a+u.a*t)+")":f=h+u*t;i.setAttr(a,f)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let t=this.node,i=r.attrs[t._id][this._id];i.points&&i.points.trueEnd&&t.setAttr("points",i.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let t=this.node,i=r.attrs[t._id][this._id];i.points&&i.points.trueStart&&t.points(i.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let t=this.node._id,i=this._id,o=r.tweens[t];this.pause(),this.anim&&this.anim.stop();for(let a in o)delete r.tweens[t][a];delete r.attrs[t][i],r.tweens[t]&&(Object.keys(r.tweens[t]).length===0&&delete r.tweens[t],Object.keys(r.attrs[t]).length===0&&delete r.attrs[t])}}return r.attrs={},r.tweens={},r})();F.prototype.to=function(r){let e=r.onFinish;r.node=this,r.onFinish=function(){this.destroy(),e&&e()},new _c(r).play()};var fr={BackEaseIn(r,e,t,i){return t*(r/=i)*r*((1.70158+1)*r-1.70158)+e},BackEaseOut(r,e,t,i){return t*((r=r/i-1)*r*((1.70158+1)*r+1.70158)+1)+e},BackEaseInOut(r,e,t,i){let o=1.70158;return(r/=i/2)<1?t/2*(r*r*(((o*=1.525)+1)*r-o))+e:t/2*((r-=2)*r*(((o*=1.525)+1)*r+o)+2)+e},ElasticEaseIn(r,e,t,i,o,a){let l=0;return r===0?e:(r/=i)===1?e+t:(a||(a=i*.3),!o||o<Math.abs(t)?(o=t,l=a/4):l=a/(2*Math.PI)*Math.asin(t/o),-(o*Math.pow(2,10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a))+e)},ElasticEaseOut(r,e,t,i,o,a){let l=0;return r===0?e:(r/=i)===1?e+t:(a||(a=i*.3),!o||o<Math.abs(t)?(o=t,l=a/4):l=a/(2*Math.PI)*Math.asin(t/o),o*Math.pow(2,-10*r)*Math.sin((r*i-l)*(2*Math.PI)/a)+t+e)},ElasticEaseInOut(r,e,t,i,o,a){let l=0;return r===0?e:(r/=i/2)===2?e+t:(a||(a=i*(.3*1.5)),!o||o<Math.abs(t)?(o=t,l=a/4):l=a/(2*Math.PI)*Math.asin(t/o),r<1?-.5*(o*Math.pow(2,10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a))+e:o*Math.pow(2,-10*(r-=1))*Math.sin((r*i-l)*(2*Math.PI)/a)*.5+t+e)},BounceEaseOut(r,e,t,i){return(r/=i)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e},BounceEaseIn(r,e,t,i){return t-fr.BounceEaseOut(i-r,0,t,i)+e},BounceEaseInOut(r,e,t,i){return r<i/2?fr.BounceEaseIn(r*2,0,t,i)*.5+e:fr.BounceEaseOut(r*2-i,0,t,i)*.5+t*.5+e},EaseIn(r,e,t,i){return t*(r/=i)*r+e},EaseOut(r,e,t,i){return-t*(r/=i)*(r-2)+e},EaseInOut(r,e,t,i){return(r/=i/2)<1?t/2*r*r+e:-t/2*(--r*(r-2)-1)+e},StrongEaseIn(r,e,t,i){return t*(r/=i)*r*r*r*r+e},StrongEaseOut(r,e,t,i){return t*((r=r/i-1)*r*r*r*r+1)+e},StrongEaseInOut(r,e,t,i){return(r/=i/2)<1?t/2*r*r*r*r*r+e:t/2*((r-=2)*r*r*r*r+2)+e},Linear(r,e,t,i){return t*r/i+e}};var vc=S._assign(V,{Util:S,Transform:ht,Node:F,Container:it,Stage:Ci,stages:hr,Layer:Qt,FastLayer:ur,Group:en,DD:Ee,Shape:I,shapes:Si,Animation:dr,Tween:_c,Easings:fr,Context:yi,Canvas:ar});var Ut=class extends I{_sceneFunc(e){let t=V.getAngle(this.angle()),i=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,i),e.arc(0,0,this.innerRadius(),t,0,!i),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){let e=this.innerRadius(),t=this.outerRadius(),i=this.clockwise(),o=V.getAngle(i?360-this.angle():this.angle()),a=Math.cos(Math.min(o,Math.PI)),l=1,h=Math.sin(Math.min(Math.max(Math.PI,o),3*Math.PI/2)),u=Math.sin(Math.min(o,Math.PI/2)),f=a*(a>0?e:t),g=l*(l>0?t:e),m=h*(h>0?e:t),v=u*(u>0?t:e);return{x:f,y:i?-1*v:m,width:g-f,height:v-m}}};Ut.prototype._centroid=!0;Ut.prototype.className="Arc";Ut.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];le(Ut);w.addGetterSetter(Ut,"innerRadius",0,O());w.addGetterSetter(Ut,"outerRadius",0,O());w.addGetterSetter(Ut,"angle",0,O());w.addGetterSetter(Ut,"clockwise",!1,ut());function yc(r,e,t,i,o,a,l){let h=Math.sqrt(Math.pow(t-r,2)+Math.pow(i-e,2)),u=Math.sqrt(Math.pow(o-t,2)+Math.pow(a-i,2)),f=l*h/(h+u),g=l*u/(h+u),m=t-f*(o-r),v=i-f*(a-e),y=t+g*(o-r),b=i+g*(a-e);return[m,v,y,b]}function Rf(r,e){let t=r.length,i=[];for(let o=2;o<t-2;o+=2){let a=yc(r[o-2],r[o-1],r[o],r[o+1],r[o+2],r[o+3],e);isNaN(a[0])||(i.push(a[0]),i.push(a[1]),i.push(r[o]),i.push(r[o+1]),i.push(a[2]),i.push(a[3]))}return i}function t1(r){let e=[[r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]]],t=[];for(let i of e){let o=-3*i[0]+9*i[1]-9*i[2]+3*i[3];if(o!==0){let a=6*i[0]-12*i[1]+6*i[2],l=-3*i[0]+3*i[1],h=a*a-4*o*l;if(h>=0){let u=Math.sqrt(h);t.push((-a+u)/(2*o)),t.push((-a-u)/(2*o))}}}return t.filter(i=>i>0&&i<1).flatMap(i=>e.map(o=>{let a=1-i;return a*a*a*o[0]+3*a*a*i*o[1]+3*a*i*i*o[2]+i*i*i*o[3]}))}var Pt=class extends I{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let t=this.points(),i=t.length,o=this.tension(),a=this.closed(),l=this.bezier();if(!i)return;let h=0;if(e.beginPath(),e.moveTo(t[0],t[1]),o!==0&&i>4){let u=this.getTensionPoints(),f=u.length;for(h=a?0:4,a||e.quadraticCurveTo(u[0],u[1],u[2],u[3]);h<f-2;)e.bezierCurveTo(u[h++],u[h++],u[h++],u[h++],u[h++],u[h++]);a||e.quadraticCurveTo(u[f-2],u[f-1],t[i-2],t[i-1])}else if(l)for(h=2;h<i;)e.bezierCurveTo(t[h++],t[h++],t[h++],t[h++],t[h++],t[h++]);else for(h=2;h<i;h+=2)e.lineTo(t[h],t[h+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Rf(this.points(),this.tension())}_getTensionPointsClosed(){let e=this.points(),t=e.length,i=this.tension(),o=yc(e[t-2],e[t-1],e[0],e[1],e[2],e[3],i),a=yc(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],i),l=Rf(e,i);return[o[2],o[3]].concat(l).concat([a[0],a[1],e[t-2],e[t-1],a[2],a[3],o[0],o[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.bezier()?e=[e[0],e[1],...t1(this.points()),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],i=e[0],o=e[1],a=e[1],l,h;for(let u=0;u<e.length/2;u++)l=e[u*2],h=e[u*2+1],t=Math.min(t,l),i=Math.max(i,l),o=Math.min(o,h),a=Math.max(a,h);return{x:t,y:o,width:i-t,height:a-o}}};Pt.prototype.className="Line";Pt.prototype._attrsAffectingSize=["points","bezier","tension"];le(Pt);w.addGetterSetter(Pt,"closed",!1);w.addGetterSetter(Pt,"bezier",!1);w.addGetterSetter(Pt,"tension",0,O());w.addGetterSetter(Pt,"points",[],ef());var n1=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],i1=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r1=[[1],[1,1],[1,2,1],[1,3,3,1]],bc=(r,e,t)=>{let i,o,l=t/2;i=0;for(let h=0;h<20;h++)o=l*n1[20][h]+l,i+=i1[20][h]*o1(r,e,o);return l*i},Cc=(r,e,t)=>{t===void 0&&(t=1);let i=r[0]-2*r[1]+r[2],o=e[0]-2*e[1]+e[2],a=2*r[1]-2*r[0],l=2*e[1]-2*e[0],h=4*(i*i+o*o),u=4*(i*a+o*l),f=a*a+l*l;if(h===0)return t*Math.sqrt(Math.pow(r[2]-r[0],2)+Math.pow(e[2]-e[0],2));let g=u/(2*h),m=f/h,v=t+g,y=m-g*g,b=v*v+y>0?Math.sqrt(v*v+y):0,E=g*g+y>0?Math.sqrt(g*g+y):0,D=g+Math.sqrt(g*g+y)!==0?y*Math.log(Math.abs((v+b)/(g+E))):0;return Math.sqrt(h)/2*(v*b-g*E+D)};function o1(r,e,t){let i=wc(1,t,r),o=wc(1,t,e),a=i*i+o*o;return Math.sqrt(a)}var wc=(r,e,t)=>{let i=t.length-1,o,a;if(i===0)return 0;if(r===0){a=0;for(let l=0;l<=i;l++)a+=r1[i][l]*Math.pow(1-e,i-l)*Math.pow(e,l)*t[l];return a}else{o=new Array(i);for(let l=0;l<i;l++)o[l]=i*(t[l+1]-t[l]);return wc(r-1,e,o)}},Sc=(r,e,t)=>{let i=1,o=r/e,a=(r-t(o))/e,l=0;for(;i>.001;){let h=t(o+a),u=Math.abs(r-h)/e;if(u<i)i=u,o+=a;else{let f=t(o-a),g=Math.abs(r-f)/e;g<i?(i=g,o-=a):a/=2}if(l++,l>500)break}return o};var dt=class r extends I{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=r.parsePathData(this.data()),this.pathLength=r.getPathLength(this.dataArray)}_sceneFunc(e){let t=this.dataArray;e.beginPath();let i=!1;for(let o=0;o<t.length;o++){let a=t[o].command,l=t[o].points;switch(a){case"L":e.lineTo(l[0],l[1]);break;case"M":e.moveTo(l[0],l[1]);break;case"C":e.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"Q":e.quadraticCurveTo(l[0],l[1],l[2],l[3]);break;case"A":let h=l[0],u=l[1],f=l[2],g=l[3],m=l[4],v=l[5],y=l[6],b=l[7],E=f>g?f:g,D=f>g?1:f/g,x=f>g?g/f:1;e.translate(h,u),e.rotate(y),e.scale(D,x),e.arc(0,0,E,m,m+v,1-b),e.scale(1/D,1/x),e.rotate(-y),e.translate(-h,-u);break;case"z":i=!0,e.closePath();break}}!i&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(u){if(u.command==="A"){let f=u.points[4],g=u.points[5],m=u.points[4]+g,v=Math.PI/180;if(Math.abs(f-m)<v&&(v=Math.abs(f-m)),g<0)for(let y=f-v;y>m;y-=v){let b=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);e.push(b.x,b.y)}else for(let y=f+v;y<m;y+=v){let b=r.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],y,0);e.push(b.x,b.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){let g=r.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(g.x,g.y)}else e=e.concat(u.points)});let t=e[0],i=e[0],o=e[1],a=e[1],l,h;for(let u=0;u<e.length/2;u++)l=e[u*2],h=e[u*2+1],isNaN(l)||(t=Math.min(t,l),i=Math.max(i,l)),isNaN(h)||(o=Math.min(o,h),a=Math.max(a,h));return{x:t,y:o,width:i-t,height:a-o}}getLength(){return this.pathLength}getPointAtLength(e){return r.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,i,o){return Math.sqrt((i-e)*(i-e)+(o-t)*(o-t))}static getPathLength(e){let t=0;for(let i=0;i<e.length;++i)t+=e[i].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let i,o=0,a=t.length;if(!a)return null;for(;o<a&&e>t[o].pathLength;)e-=t[o].pathLength,++o;if(o===a)return i=t[o-1].points.slice(-2),{x:i[0],y:i[1]};if(e<.01)return t[o].command==="M"?(i=t[o].points.slice(0,2),{x:i[0],y:i[1]}):{x:t[o].start.x,y:t[o].start.y};let l=t[o],h=l.points;switch(l.command){case"L":return r.getPointOnLine(e,l.start.x,l.start.y,h[0],h[1]);case"C":return r.getPointOnCubicBezier(Sc(e,r.getPathLength(t),E=>bc([l.start.x,h[0],h[2],h[4]],[l.start.y,h[1],h[3],h[5]],E)),l.start.x,l.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return r.getPointOnQuadraticBezier(Sc(e,r.getPathLength(t),E=>Cc([l.start.x,h[0],h[2]],[l.start.y,h[1],h[3]],E)),l.start.x,l.start.y,h[0],h[1],h[2],h[3]);case"A":let u=h[0],f=h[1],g=h[2],m=h[3],v=h[5],y=h[6],b=h[4];return b+=v*e/l.pathLength,r.getPointOnEllipticalArc(u,f,g,m,b,y)}return null}static getPointOnLine(e,t,i,o,a,l,h){l=l??t,h=h??i;let u=this.getLineLength(t,i,o,a);if(u<1e-10)return{x:t,y:i};if(o===t)return{x:l,y:h+(a>i?e:-e)};let f=(a-i)/(o-t),g=Math.sqrt(e*e/(1+f*f))*(o<t?-1:1),m=f*g;if(Math.abs(h-i-f*(l-t))<1e-10)return{x:l+g,y:h+m};let v=((l-t)*(o-t)+(h-i)*(a-i))/(u*u),y=t+v*(o-t),b=i+v*(a-i),E=this.getLineLength(l,h,y,b),D=Math.sqrt(e*e-E*E),x=Math.sqrt(D*D/(1+f*f))*(o<t?-1:1),A=f*x;return{x:y+x,y:b+A}}static getPointOnCubicBezier(e,t,i,o,a,l,h,u,f){function g(D){return D*D*D}function m(D){return 3*D*D*(1-D)}function v(D){return 3*D*(1-D)*(1-D)}function y(D){return(1-D)*(1-D)*(1-D)}let b=u*g(e)+l*m(e)+o*v(e)+t*y(e),E=f*g(e)+h*m(e)+a*v(e)+i*y(e);return{x:b,y:E}}static getPointOnQuadraticBezier(e,t,i,o,a,l,h){function u(y){return y*y}function f(y){return 2*y*(1-y)}function g(y){return(1-y)*(1-y)}let m=l*u(e)+o*f(e)+t*g(e),v=h*u(e)+a*f(e)+i*g(e);return{x:m,y:v}}static getPointOnEllipticalArc(e,t,i,o,a,l){let h=Math.cos(l),u=Math.sin(l),f={x:i*Math.cos(a),y:o*Math.sin(a)};return{x:e+(f.x*h-f.y*u),y:t+(f.x*u+f.y*h)}}static parsePathData(e){if(!e)return[];let t=e,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let m=0;m<i.length;m++)t=t.replace(new RegExp(i[m],"g"),"|"+i[m]);let o=t.split("|"),a=[],l=[],h=0,u=0,f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,g;for(let m=1;m<o.length;m++){let v=o[m],y=v.charAt(0);for(v=v.slice(1),l.length=0;g=f.exec(v);)l.push(g[0]);let b=[],E=y==="A"||y==="a"?0:-1;for(let D=0,x=l.length;D<x;D++){let A=l[D];if(A==="00"){b.push(0,0),E>=0&&(E+=2,E>=7&&(E-=7));continue}if(E>=0){if(E===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(A)){b.push(parseInt(A[0],10)),b.push(parseInt(A[1],10)),b.push(parseFloat(A.slice(2))),E+=3,E>=7&&(E-=7);continue}if(A==="11"||A==="10"||A==="01"){b.push(parseInt(A[0],10)),b.push(parseInt(A[1],10)),E+=2,E>=7&&(E-=7);continue}if(A==="0"||A==="1"){b.push(parseInt(A,10)),E+=1,E>=7&&(E-=7);continue}}else if(E===4){if(/^[01]\d+(?:\.\d+)?$/.test(A)){b.push(parseInt(A[0],10)),b.push(parseFloat(A.slice(1))),E+=2,E>=7&&(E-=7);continue}if(A==="0"||A==="1"){b.push(parseInt(A,10)),E+=1,E>=7&&(E-=7);continue}}let T=parseFloat(A);isNaN(T)?b.push(0):b.push(T),E+=1,E>=7&&(E-=7)}else{let T=parseFloat(A);isNaN(T)?b.push(0):b.push(T)}}for(;b.length>0&&!isNaN(b[0]);){let D="",x=[],A=h,T=u,R,z,G,$,H,Z,K,ge,Y,we;switch(y){case"l":h+=b.shift(),u+=b.shift(),D="L",x.push(h,u);break;case"L":h=b.shift(),u=b.shift(),x.push(h,u);break;case"m":let re=b.shift(),Q=b.shift();if(h+=re,u+=Q,D="M",a.length>2&&a[a.length-1].command==="z"){for(let k=a.length-2;k>=0;k--)if(a[k].command==="M"){h=a[k].points[0]+re,u=a[k].points[1]+Q;break}}x.push(h,u),y="l";break;case"M":h=b.shift(),u=b.shift(),D="M",x.push(h,u),y="L";break;case"h":h+=b.shift(),D="L",x.push(h,u);break;case"H":h=b.shift(),D="L",x.push(h,u);break;case"v":u+=b.shift(),D="L",x.push(h,u);break;case"V":u=b.shift(),D="L",x.push(h,u);break;case"C":x.push(b.shift(),b.shift(),b.shift(),b.shift()),h=b.shift(),u=b.shift(),x.push(h,u);break;case"c":x.push(h+b.shift(),u+b.shift(),h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="C",x.push(h,u);break;case"S":z=h,G=u,R=a[a.length-1],R.command==="C"&&(z=h+(h-R.points[2]),G=u+(u-R.points[3])),x.push(z,G,b.shift(),b.shift()),h=b.shift(),u=b.shift(),D="C",x.push(h,u);break;case"s":z=h,G=u,R=a[a.length-1],R.command==="C"&&(z=h+(h-R.points[2]),G=u+(u-R.points[3])),x.push(z,G,h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="C",x.push(h,u);break;case"Q":x.push(b.shift(),b.shift()),h=b.shift(),u=b.shift(),x.push(h,u);break;case"q":x.push(h+b.shift(),u+b.shift()),h+=b.shift(),u+=b.shift(),D="Q",x.push(h,u);break;case"T":z=h,G=u,R=a[a.length-1],R.command==="Q"&&(z=h+(h-R.points[0]),G=u+(u-R.points[1])),h=b.shift(),u=b.shift(),D="Q",x.push(z,G,h,u);break;case"t":z=h,G=u,R=a[a.length-1],R.command==="Q"&&(z=h+(h-R.points[0]),G=u+(u-R.points[1])),h+=b.shift(),u+=b.shift(),D="Q",x.push(z,G,h,u);break;case"A":$=b.shift(),H=b.shift(),Z=b.shift(),K=b.shift(),ge=b.shift(),Y=h,we=u,h=b.shift(),u=b.shift(),D="A",x=this.convertEndpointToCenterParameterization(Y,we,h,u,K,ge,$,H,Z);break;case"a":$=b.shift(),H=b.shift(),Z=b.shift(),K=b.shift(),ge=b.shift(),Y=h,we=u,h+=b.shift(),u+=b.shift(),D="A",x=this.convertEndpointToCenterParameterization(Y,we,h,u,K,ge,$,H,Z);break}a.push({command:D||y,points:x,start:{x:A,y:T},pathLength:this.calcLength(A,T,D||y,x)})}(y==="z"||y==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,t,i,o){let a,l,h,u,f=r;switch(i){case"L":return f.getLineLength(e,t,o[0],o[1]);case"C":return bc([e,o[0],o[2],o[4]],[t,o[1],o[3],o[5]],1);case"Q":return Cc([e,o[0],o[2]],[t,o[1],o[3]],1);case"A":a=0;let g=o[4],m=o[5],v=o[4]+m,y=Math.PI/180;if(Math.abs(g-v)<y&&(y=Math.abs(g-v)),l=f.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],g,0),m<0)for(u=g-y;u>v;u-=y)h=f.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],u,0),a+=f.getLineLength(l.x,l.y,h.x,h.y),l=h;else for(u=g+y;u<v;u+=y)h=f.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],u,0),a+=f.getLineLength(l.x,l.y,h.x,h.y),l=h;return h=f.getPointOnEllipticalArc(o[0],o[1],o[2],o[3],v,0),a+=f.getLineLength(l.x,l.y,h.x,h.y),a}return 0}static convertEndpointToCenterParameterization(e,t,i,o,a,l,h,u,f){let g=f*(Math.PI/180),m=Math.cos(g)*(e-i)/2+Math.sin(g)*(t-o)/2,v=-1*Math.sin(g)*(e-i)/2+Math.cos(g)*(t-o)/2,y=m*m/(h*h)+v*v/(u*u);y>1&&(h*=Math.sqrt(y),u*=Math.sqrt(y));let b=Math.sqrt((h*h*(u*u)-h*h*(v*v)-u*u*(m*m))/(h*h*(v*v)+u*u*(m*m)));a===l&&(b*=-1),isNaN(b)&&(b=0);let E=b*h*v/u,D=b*-u*m/h,x=(e+i)/2+Math.cos(g)*E-Math.sin(g)*D,A=(t+o)/2+Math.sin(g)*E+Math.cos(g)*D,T=function(K){return Math.sqrt(K[0]*K[0]+K[1]*K[1])},R=function(K,ge){return(K[0]*ge[0]+K[1]*ge[1])/(T(K)*T(ge))},z=function(K,ge){return(K[0]*ge[1]<K[1]*ge[0]?-1:1)*Math.acos(R(K,ge))},G=z([1,0],[(m-E)/h,(v-D)/u]),$=[(m-E)/h,(v-D)/u],H=[(-1*m-E)/h,(-1*v-D)/u],Z=z($,H);return R($,H)<=-1&&(Z=Math.PI),R($,H)>=1&&(Z=0),l===0&&Z>0&&(Z=Z-2*Math.PI),l===1&&Z<0&&(Z=Z+2*Math.PI),[x,A,h,u,G,Z,g,l]}};dt.prototype.className="Path";dt.prototype._attrsAffectingSize=["data"];le(dt);w.addGetterSetter(dt,"data");var _n=class extends Pt{_sceneFunc(e){super._sceneFunc(e);let t=Math.PI*2,i=this.points(),o=i,a=this.tension()!==0&&i.length>4;a&&(o=this.getTensionPoints());let l=this.pointerLength(),h=i.length,u,f;if(a){let v=[o[o.length-4],o[o.length-3],o[o.length-2],o[o.length-1],i[h-2],i[h-1]],y=dt.calcLength(o[o.length-4],o[o.length-3],"C",v),b=dt.getPointOnQuadraticBezier(Math.min(1,1-l/y),v[0],v[1],v[2],v[3],v[4],v[5]);u=i[h-2]-b.x,f=i[h-1]-b.y}else u=i[h-2]-i[h-4],f=i[h-1]-i[h-3];let g=(Math.atan2(f,u)+t)%t,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(i[h-2],i[h-1]),e.rotate(g),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(i[0],i[1]),a?(u=(o[0]+o[2])/2-i[0],f=(o[1]+o[3])/2-i[1]):(u=i[2]-i[0],f=i[3]-i[1]),e.rotate((Math.atan2(-f,-u)+t)%t),e.moveTo(0,0),e.lineTo(-l,m/2),e.lineTo(-l,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){let t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){let e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}};_n.prototype.className="Arrow";le(_n);w.addGetterSetter(_n,"pointerLength",10,O());w.addGetterSetter(_n,"pointerWidth",10,O());w.addGetterSetter(_n,"pointerAtBeginning",!1);w.addGetterSetter(_n,"pointerAtEnding",!0);var Rn=class extends I{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};Rn.prototype._centroid=!0;Rn.prototype.className="Circle";Rn.prototype._attrsAffectingSize=["radius"];le(Rn);w.addGetterSetter(Rn,"radius",0,O());var tn=class extends I{_sceneFunc(e){let t=this.radiusX(),i=this.radiusY();e.beginPath(),e.save(),t!==i&&e.scale(1,i/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};tn.prototype.className="Ellipse";tn.prototype._centroid=!0;tn.prototype._attrsAffectingSize=["radiusX","radiusY"];le(tn);w.addComponentsGetterSetter(tn,"radius",["x","y"]);w.addGetterSetter(tn,"radiusX",0,O());w.addGetterSetter(tn,"radiusY",0,O());var Ct=class r extends I{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){let t=this.getWidth(),i=this.getHeight(),o=this.cornerRadius(),a=this.attrs.image,l;if(a){let h=this.attrs.cropWidth,u=this.attrs.cropHeight;h&&u?l=[a,this.cropX(),this.cropY(),h,u,0,0,t,i]:l=[a,0,0,t,i]}(this.hasFill()||this.hasStroke()||o)&&(e.beginPath(),o?S.drawRoundedRectPath(e,t,i,o):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)),a&&(o&&e.clip(),e.drawImage.apply(e,l))}_hitFunc(e){let t=this.width(),i=this.height(),o=this.cornerRadius();e.beginPath(),o?S.drawRoundedRectPath(e,t,i,o):e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t,i;return(i=(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width)!==null&&i!==void 0?i:0}getHeight(){var e,t,i;return(i=(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height)!==null&&i!==void 0?i:0}static fromURL(e,t,i=null){let o=S.createImageElement();o.onload=function(){let a=new r({image:o});t(a)},o.onerror=i,o.crossOrigin="Anonymous",o.src=e}};Ct.prototype.className="Image";Ct.prototype._attrsAffectingSize=["image"];le(Ct);w.addGetterSetter(Ct,"cornerRadius",0,Qn(4));w.addGetterSetter(Ct,"image");w.addComponentsGetterSetter(Ct,"crop",["x","y","width","height"]);w.addGetterSetter(Ct,"cropX",0,O());w.addGetterSetter(Ct,"cropY",0,O());w.addGetterSetter(Ct,"cropWidth",0,O());w.addGetterSetter(Ct,"cropHeight",0,O());var Of=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],s1="Change.konva",a1="none",Dc="up",xc="right",Ec="down",Mc="left",l1=Of.length,pr=class extends en{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,i,o=function(){t._sync()};for(i=0;i<l1;i++)e.on(Of[i]+s1,o)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),i,o,a,l,h,u,f;if(e&&t){switch(i=e.width(),o=e.height(),a=t.pointerDirection(),l=t.pointerWidth(),f=t.pointerHeight(),h=0,u=0,a){case Dc:h=i/2,u=-1*f;break;case xc:h=i+l,u=o/2;break;case Ec:h=i/2,u=o+f;break;case Mc:h=-1*l,u=o/2;break}t.setAttrs({x:-1*h,y:-1*u,width:i,height:o}),e.setAttrs({x:-1*h,y:-1*u})}}};pr.prototype.className="Label";le(pr);var vn=class extends I{_sceneFunc(e){let t=this.width(),i=this.height(),o=this.pointerDirection(),a=this.pointerWidth(),l=this.pointerHeight(),h=this.cornerRadius(),u=0,f=0,g=0,m=0;typeof h=="number"?u=f=g=m=Math.min(h,t/2,i/2):(u=Math.min(h[0]||0,t/2,i/2),f=Math.min(h[1]||0,t/2,i/2),m=Math.min(h[2]||0,t/2,i/2),g=Math.min(h[3]||0,t/2,i/2)),e.beginPath(),e.moveTo(u,0),o===Dc&&(e.lineTo((t-a)/2,0),e.lineTo(t/2,-1*l),e.lineTo((t+a)/2,0)),e.lineTo(t-f,0),e.arc(t-f,f,f,Math.PI*3/2,0,!1),o===xc&&(e.lineTo(t,(i-l)/2),e.lineTo(t+a,i/2),e.lineTo(t,(i+l)/2)),e.lineTo(t,i-m),e.arc(t-m,i-m,m,0,Math.PI/2,!1),o===Ec&&(e.lineTo((t+a)/2,i),e.lineTo(t/2,i+l),e.lineTo((t-a)/2,i)),e.lineTo(g,i),e.arc(g,i-g,g,Math.PI/2,Math.PI,!1),o===Mc&&(e.lineTo(0,(i+l)/2),e.lineTo(-1*a,i/2),e.lineTo(0,(i-l)/2)),e.lineTo(0,u),e.arc(u,u,u,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,i=this.pointerWidth(),o=this.pointerHeight(),a=this.pointerDirection(),l=this.width(),h=this.height();return a===Dc?(t-=o,h+=o):a===Ec?h+=o:a===Mc?(e-=i*1.5,l+=i):a===xc&&(l+=i*1.5),{x:e,y:t,width:l,height:h}}};vn.prototype.className="Tag";le(vn);w.addGetterSetter(vn,"pointerDirection",a1);w.addGetterSetter(vn,"pointerWidth",0,O());w.addGetterSetter(vn,"pointerHeight",0,O());w.addGetterSetter(vn,"cornerRadius",0,Qn(4));var On=class extends I{_sceneFunc(e){let t=this.cornerRadius(),i=this.width(),o=this.height();e.beginPath(),t?S.drawRoundedRectPath(e,i,o,t):e.rect(0,0,i,o),e.closePath(),e.fillStrokeShape(this)}};On.prototype.className="Rect";le(On);w.addGetterSetter(On,"cornerRadius",0,Qn(4));var nn=class extends I{_sceneFunc(e){let t=this._getPoints(),i=this.radius(),o=this.sides(),a=this.cornerRadius();if(e.beginPath(),a)S.drawRoundedPolygonPath(e,t,o,i,a);else{e.moveTo(t[0].x,t[0].y);for(let l=1;l<t.length;l++)e.lineTo(t[l].x,t[l].y)}e.closePath(),e.fillStrokeShape(this)}_getPoints(){let e=this.attrs.sides,t=this.attrs.radius||0,i=[];for(let o=0;o<e;o++)i.push({x:t*Math.sin(o*2*Math.PI/e),y:-1*t*Math.cos(o*2*Math.PI/e)});return i}getSelfRect(){let e=this._getPoints(),t=e[0].x,i=e[0].x,o=e[0].y,a=e[0].y;return e.forEach(l=>{t=Math.min(t,l.x),i=Math.max(i,l.x),o=Math.min(o,l.y),a=Math.max(a,l.y)}),{x:t,y:o,width:i-t,height:a-o}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};nn.prototype.className="RegularPolygon";nn.prototype._centroid=!0;nn.prototype._attrsAffectingSize=["radius"];le(nn);w.addGetterSetter(nn,"radius",0,O());w.addGetterSetter(nn,"sides",0,O());w.addGetterSetter(nn,"cornerRadius",0,Qn(4));var If=Math.PI*2,yn=class extends I{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,If,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),If,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};yn.prototype.className="Ring";yn.prototype._centroid=!0;yn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];le(yn);w.addGetterSetter(yn,"innerRadius",0,O());w.addGetterSetter(yn,"outerRadius",0,O());var At=class extends I{constructor(e){super(e),this._updated=!0,this.anim=new dr(()=>{let t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){let t=this.animation(),i=this.frameIndex(),o=i*4,a=this.animations()[t],l=this.frameOffsets(),h=a[o+0],u=a[o+1],f=a[o+2],g=a[o+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,g),e.closePath(),e.fillStrokeShape(this)),m)if(l){let v=l[t],y=i*2;e.drawImage(m,h,u,f,g,v[y+0],v[y+1],f,g)}else e.drawImage(m,h,u,f,g,0,0,f,g)}_hitFunc(e){let t=this.animation(),i=this.frameIndex(),o=i*4,a=this.animations()[t],l=this.frameOffsets(),h=a[o+2],u=a[o+3];if(e.beginPath(),l){let f=l[t],g=i*2;e.rect(f[g+0],f[g+1],h,u)}else e.rect(0,0,h,u);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let e=this.frameIndex(),t=this.animation(),i=this.animations(),o=i[t],a=o.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}};At.prototype.className="Sprite";le(At);w.addGetterSetter(At,"animation");w.addGetterSetter(At,"animations");w.addGetterSetter(At,"frameOffsets");w.addGetterSetter(At,"image");w.addGetterSetter(At,"frameIndex",0,O());w.addGetterSetter(At,"frameRate",17,O());w.backCompat(At,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var rn=class extends I{_sceneFunc(e){let t=this.innerRadius(),i=this.outerRadius(),o=this.numPoints();e.beginPath(),e.moveTo(0,0-i);for(let a=1;a<o*2;a++){let l=a%2===0?i:t,h=l*Math.sin(a*Math.PI/o),u=-1*l*Math.cos(a*Math.PI/o);e.lineTo(h,u)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};rn.prototype.className="Star";rn.prototype._centroid=!0;rn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];le(rn);w.addGetterSetter(rn,"numPoints",5,O());w.addGetterSetter(rn,"innerRadius",0,O());w.addGetterSetter(rn,"outerRadius",0,O());function In(r){return[...r].reduce((e,t,i,o)=>{if(new RegExp("\\p{Emoji}","u").test(t)){let a=o[i+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(e.push(t+a),o[i+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(o[i+1]||""))?e.push(t+o[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}var gr="auto",c1="center",Bf="inherit",yo="justify",h1="Change.konva",u1="2d",Lf="-",Vf="left",d1="text",f1="Text",p1="top",g1="bottom",kf="middle",zf="normal",m1="px ",Qs=" ",_1="right",Ff="rtl",v1="word",y1="char",Nf="none",Tc="\u2026",Uf=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],w1=Uf.length;function b1(r){return r.split(",").map(e=>{e=e.trim();let t=e.indexOf(" ")>=0,i=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!i&&(e=`"${e}"`),e}).join(", ")}var ea;function Pc(){return ea||(ea=S.createCanvasElement().getContext(u1),ea)}function C1(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function S1(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function D1(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}var Re=class extends I{constructor(e){super(D1(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<w1;t++)this.on(Uf[t]+h1,this._setTextData);this._setTextData()}_sceneFunc(e){var t,i;let o=this.textArr,a=o.length;if(!this.text())return;let l=this.padding(),h=this.fontSize(),u=this.lineHeight()*h,f=this.verticalAlign(),g=this.direction(),m=0,v=this.align(),y=this.getWidth(),b=this.letterSpacing(),E=this.charRenderFunc(),D=this.fill(),x=this.textDecoration(),A=this.underlineOffset(),T=x.indexOf("underline")!==-1,R=x.indexOf("line-through")!==-1,z;g=g===Bf?e.direction:g;let G=u/2,$=kf;if(!V.legacyTextRendering){let H=this.measureSize("M");$="alphabetic";let Z=(t=H.fontBoundingBoxAscent)!==null&&t!==void 0?t:H.actualBoundingBoxAscent,K=(i=H.fontBoundingBoxDescent)!==null&&i!==void 0?i:H.actualBoundingBoxDescent;G=(Z-K)/2+u/2}for(g===Ff&&e.setAttr("direction",g),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",$),e.setAttr("textAlign",Vf),f===kf?m=(this.getHeight()-a*u-l*2)/2:f===g1&&(m=this.getHeight()-a*u-l*2),e.translate(l,m+l),z=0;z<a;z++){let H=0,Z=0,K=o[z],ge=K.text,Y=K.width,we=K.lastInParagraph;if(e.save(),v===_1?H+=y-Y-l*2:v===c1&&(H+=(y-Y-l*2)/2),T){e.save(),e.beginPath();let Q=A??(V.legacyTextRendering?Math.round(h/2):Math.round(h/4)),k=H,Se=G+Z+Q;e.moveTo(k,Se);let B=v===yo&&!we?y-l*2:Y;e.lineTo(k+Math.round(B),Se),e.lineWidth=h/15;let ne=this._getLinearGradient();e.strokeStyle=ne||D,e.stroke(),e.restore()}let re=H;if(g!==Ff&&(b!==0||v===yo||E)){let Q=ge.split(" ").length-1,k=In(ge);for(let Se=0;Se<k.length;Se++){let B=k[Se];if(B===" "&&!we&&v===yo&&(H+=(y-l*2-Y)/Q),this._partialTextX=H,this._partialTextY=G+Z,this._partialText=B,E){e.save();let be=o.slice(0,z).reduce((J,X)=>J+In(X.text).length,0),q=Se+be;E({char:B,index:q,x:H,y:G+Z,lineIndex:z,column:Se,isLastInLine:we,width:this.measureSize(B).width,context:e})}e.fillStrokeShape(this),E&&e.restore(),H+=this.measureSize(B).width+b}}else b!==0&&e.setAttr("letterSpacing",`${b}px`),this._partialTextX=H,this._partialTextY=G+Z,this._partialText=ge,e.fillStrokeShape(this);if(R){e.save(),e.beginPath();let Q=V.legacyTextRendering?0:-Math.round(h/4),k=re;e.moveTo(k,G+Z+Q);let Se=v===yo&&!we?y-l*2:Y;e.lineTo(k+Math.round(Se),G+Z+Q),e.lineWidth=h/15;let B=this._getLinearGradient();e.strokeStyle=B||D,e.stroke(),e.restore()}e.restore(),a>1&&(G+=u)}}_hitFunc(e){let t=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,t,i),e.closePath(),e.fillStrokeShape(this)}setText(e){let t=S._isString(e)?e:e==null?"":e+"";return this._setAttr(d1,t),this}getWidth(){return this.attrs.width===gr||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===gr||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return S.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,i,o,a,l,h,u,f,g,m,v;let y=Pc(),b=this.fontSize(),E;y.save(),y.font=this._getContextFont(),E=y.measureText(e),y.restore();let D=b/100;return{actualBoundingBoxAscent:(t=E.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*D,actualBoundingBoxDescent:(i=E.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(o=E.actualBoundingBoxLeft)!==null&&o!==void 0?o:-7.421875*D,actualBoundingBoxRight:(a=E.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*D,alphabeticBaseline:(l=E.alphabeticBaseline)!==null&&l!==void 0?l:0,emHeightAscent:(h=E.emHeightAscent)!==null&&h!==void 0?h:100*D,emHeightDescent:(u=E.emHeightDescent)!==null&&u!==void 0?u:-20*D,fontBoundingBoxAscent:(f=E.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*D,fontBoundingBoxDescent:(g=E.fontBoundingBoxDescent)!==null&&g!==void 0?g:21*D,hangingBaseline:(m=E.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*D,ideographicBaseline:(v=E.ideographicBaseline)!==null&&v!==void 0?v:-21*D,width:E.width,height:b}}_getContextFont(){return this.fontStyle()+Qs+this.fontVariant()+Qs+(this.fontSize()+m1)+b1(this.fontFamily())}_addTextLine(e){this.align()===yo&&(e=e.trim());let i=this._getTextWidth(e);return this.textArr.push({text:e,width:i,lastInParagraph:!1})}_getTextWidth(e){let t=this.letterSpacing(),i=e.length;return Pc().measureText(e).width+t*i}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),i=0,o=this.lineHeight()*t,a=this.attrs.width,l=this.attrs.height,h=a!==gr&&a!==void 0,u=l!==gr&&l!==void 0,f=this.padding(),g=a-f*2,m=l-f*2,v=0,y=this.wrap(),b=y!==Nf,E=y!==y1&&b,D=this.ellipsis();this.textArr=[],Pc().font=this._getContextFont();let x=D?this._getTextWidth(Tc):0;for(let A=0,T=e.length;A<T;++A){let R=e[A],z=this._getTextWidth(R);if(h&&z>g)for(;R.length>0;){let G=0,$=In(R).length,H="",Z=0;for(;G<$;){let K=G+$>>>1,ge=In(R),Y=ge.slice(0,K+1).join(""),we=this._getTextWidth(Y);(D&&u&&v+o>m?we+x:we)<=g?(G=K+1,H=Y,Z=we):$=K}if(H){if(E){let Y=In(R),we=In(H),re=Y[we.length],Q=re===Qs||re===Lf,k;if(Q&&Z<=g)k=we.length;else{let Se=we.lastIndexOf(Qs),B=we.lastIndexOf(Lf);k=Math.max(Se,B)+1}k>0&&(G=k,H=Y.slice(0,G).join(""),Z=this._getTextWidth(H))}if(H=H.trimRight(),this._addTextLine(H),i=Math.max(i,Z),v+=o,this._shouldHandleEllipsis(v)){this._tryToAddEllipsisToLastLine();break}if(R=In(R).slice(G).join("").trimLeft(),R.length>0&&(z=this._getTextWidth(R),z<=g)){this._addTextLine(R),v+=o,i=Math.max(i,z);break}}else break}else this._addTextLine(R),v+=o,i=Math.max(i,z),this._shouldHandleEllipsis(v)&&A<T-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&v+o>m)break}this.textHeight=t,this.textWidth=i}_shouldHandleEllipsis(e){let t=+this.fontSize(),i=this.lineHeight()*t,o=this.attrs.height,a=o!==gr&&o!==void 0,l=this.padding(),h=o-l*2;return!(this.wrap()!==Nf)||a&&e+i>h}_tryToAddEllipsisToLastLine(){let e=this.attrs.width,t=e!==gr&&e!==void 0,i=this.padding(),o=e-i*2,a=this.ellipsis(),l=this.textArr[this.textArr.length-1];!l||!a||(t&&(this._getTextWidth(l.text+Tc)<o||(l.text=l.text.slice(0,l.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(l.text+Tc))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};Re.prototype._fillFunc=C1;Re.prototype._strokeFunc=S1;Re.prototype.className=f1;Re.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];le(Re);w.overWriteSetter(Re,"width",co());w.overWriteSetter(Re,"height",co());w.addGetterSetter(Re,"direction",Bf);w.addGetterSetter(Re,"fontFamily","Arial");w.addGetterSetter(Re,"fontSize",12,O());w.addGetterSetter(Re,"fontStyle",zf);w.addGetterSetter(Re,"fontVariant",zf);w.addGetterSetter(Re,"padding",0,O());w.addGetterSetter(Re,"align",Vf);w.addGetterSetter(Re,"verticalAlign",p1);w.addGetterSetter(Re,"lineHeight",1,O());w.addGetterSetter(Re,"wrap",v1);w.addGetterSetter(Re,"ellipsis",!1,ut());w.addGetterSetter(Re,"letterSpacing",0,O());w.addGetterSetter(Re,"text","",mn());w.addGetterSetter(Re,"textDecoration","");w.addGetterSetter(Re,"underlineOffset",void 0,O());w.addGetterSetter(Re,"charRenderFunc",void 0);var x1="",Gf="normal";function jf(r){r.fillText(this.partialText,0,0)}function Hf(r){r.strokeText(this.partialText,0,0)}var $e=class extends I{constructor(e){super(e),this.dummyCanvas=S.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return dt.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;let t=this.pathLength;return e>t?null:dt.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=dt.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();let t=this.textDecoration(),i=this.fill(),o=this.fontSize(),a=this.glyphInfo,l=t.indexOf("underline")!==-1,h=t.indexOf("line-through")!==-1;l&&e.beginPath();for(let u=0;u<a.length;u++){e.save();let f=a[u].p0;e.translate(f.x,f.y),e.rotate(a[u].rotation),this.partialText=a[u].text,e.fillStrokeShape(this),l&&(u===0&&e.moveTo(0,o/2+1),e.lineTo(a[u].width,o/2+1)),e.restore()}if(l&&(e.strokeStyle=i,e.lineWidth=o/20,e.stroke()),h){e.beginPath();for(let u=0;u<a.length;u++){e.save();let f=a[u].p0;e.translate(f.x,f.y),e.rotate(a[u].rotation),u===0&&e.moveTo(0,0),e.lineTo(a[u].width,0),e.restore()}e.strokeStyle=i,e.lineWidth=o/20,e.stroke()}e.restore()}_hitFunc(e){e.beginPath();let t=this.glyphInfo;if(t.length>=1){let i=t[0].p0;e.moveTo(i.x,i.y)}for(let i=0;i<t.length;i++){let o=t[i].p1;e.lineTo(o.x,o.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return S.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Re.prototype.setText.call(this,e)}_getContextFont(){return Re.prototype._getContextFont.call(this)}_getTextSize(e){let i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();let o=i.measureText(e);return i.restore(),{width:o.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let e=In(this.text()),t=[],i=0;for(let m=0;m<e.length;m++)t.push({char:e[m],width:this._getTextSize(e[m]).width}),i+=t[m].width;let{height:o}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=o,this.glyphInfo=[],!this.attrs.data)return null;let a=this.letterSpacing(),l=this.align(),h=this.kerningFunc(),u=Math.max(this.textWidth+((this.attrs.text||"").length-1)*a,0),f=0;l==="center"&&(f=Math.max(0,this.pathLength/2-u/2)),l==="right"&&(f=Math.max(0,this.pathLength-u));let g=f;for(let m=0;m<t.length;m++){let v=this._getPointAtLength(g);if(!v)return;let y=t[m].char,b=t[m].width+a;if(y===" "&&l==="justify"){let R=this.text().split(" ").length-1;b+=(this.pathLength-u)/R}let E=this._getPointAtLength(g+b);if(!E)return;let D=dt.getLineLength(v.x,v.y,E.x,E.y),x=0;if(h)try{x=h(t[m-1].char,y)*this.fontSize()}catch{x=0}v.x+=x,E.x+=x,this.textWidth+=x;let A=dt.getPointOnLine(x+D/2,v.x,v.y,E.x,E.y),T=Math.atan2(E.y-v.y,E.x-v.x);this.glyphInfo.push({transposeX:A.x,transposeY:A.y,text:e[m],rotation:T,p0:v,p1:E,width:D}),g+=b}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let t=e[0]||0,i=e[0]||0,o=e[1]||0,a=e[1]||0,l,h;for(let f=0;f<e.length/2;f++)l=e[f*2],h=e[f*2+1],t=Math.min(t,l),i=Math.max(i,l),o=Math.min(o,h),a=Math.max(a,h);let u=this.fontSize();return{x:t-u/2,y:o-u/2,width:i-t+u,height:a-o+u}}destroy(){return S.releaseCanvas(this.dummyCanvas),super.destroy()}};$e.prototype._fillFunc=jf;$e.prototype._strokeFunc=Hf;$e.prototype._fillFuncHit=jf;$e.prototype._strokeFuncHit=Hf;$e.prototype.className="TextPath";$e.prototype._attrsAffectingSize=["text","fontSize","data"];le($e);w.addGetterSetter($e,"data");w.addGetterSetter($e,"fontFamily","Arial");w.addGetterSetter($e,"fontSize",12,O());w.addGetterSetter($e,"fontStyle",Gf);w.addGetterSetter($e,"align","left");w.addGetterSetter($e,"letterSpacing",0,O());w.addGetterSetter($e,"textBaseline","middle");w.addGetterSetter($e,"fontVariant",Gf);w.addGetterSetter($e,"text",x1);w.addGetterSetter($e,"textDecoration","");w.addGetterSetter($e,"kerningFunc",void 0);var Zf="tr-konva",E1=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Zf}`).join(" "),$f="nodesRect",M1=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],T1={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},P1="ontouchstart"in V._global;function A1(r,e,t){if(r==="rotater")return t;e+=S.degToRad(T1[r]||0);let i=(S.radToDeg(e)%360+360)%360;return S._inRange(i,315+22.5,360)||S._inRange(i,0,22.5)?"ns-resize":S._inRange(i,45-22.5,45+22.5)?"nesw-resize":S._inRange(i,90-22.5,90+22.5)?"ew-resize":S._inRange(i,135-22.5,135+22.5)?"nwse-resize":S._inRange(i,180-22.5,180+22.5)?"ns-resize":S._inRange(i,225-22.5,225+22.5)?"nesw-resize":S._inRange(i,270-22.5,270+22.5)?"ew-resize":S._inRange(i,315-22.5,315+22.5)?"nwse-resize":(S.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var ta=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Wf=1e8;function R1(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function qf(r,e,t){let i=t.x+(r.x-t.x)*Math.cos(e)-(r.y-t.y)*Math.sin(e),o=t.y+(r.x-t.x)*Math.sin(e)+(r.y-t.y)*Math.cos(e);return Oe(j({},r),{rotation:r.rotation+e,x:i,y:o})}function O1(r,e){let t=R1(r);return qf(r,e,t)}function I1(r,e,t){let i=e;for(let o=0;o<r.length;o++){let a=V.getAngle(r[o]),l=Math.abs(a-e)%(Math.PI*2);Math.min(l,Math.PI*2-l)<t&&(i=a)}return i}var Ac=0,Ce=(()=>{class r extends en{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(E1,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return S.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Zf+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();let i=t.filter(a=>a.isAncestorOf(this)?(S.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=i,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(a=>{let l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(a._attrsAffectingSize.length){let h=a._attrsAffectingSize.map(u=>u+"Change."+this._getEventNamespace()).join(" ");a.on(h,l)}a.on(M1.map(h=>h+`.${this._getEventNamespace()}`).join(" "),l),a.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(a)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let i;t.on(`dragstart.${this._getEventNamespace()}`,o=>{i=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(o,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,o=>{if(!i)return;let a=t.getAbsolutePosition(),l=a.x-i.x,h=a.y-i.y;this.nodes().forEach(u=>{if(u===t||u.isDragging())return;let f=u.getAbsolutePosition();u.setAbsolutePosition({x:f.x+l,y:f.y+h}),u.startDrag(o)}),i=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache($f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache($f,this.__getNodeRect)}__getNodeShape(t,i=this.rotation(),o){let a=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(o),h=t.getAbsolutePosition(o),u=a.x*l.x-t.offsetX()*l.x,f=a.y*l.y-t.offsetY()*l.y,g=(V.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),m={x:h.x+u*Math.cos(g)+f*Math.sin(-g),y:h.y+f*Math.cos(g)+u*Math.sin(g),width:a.width*l.x,height:a.height*l.y,rotation:g};return qf(m,-V.getAngle(i),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-Wf,y:-Wf,width:0,height:0,rotation:0};let i=[];this.nodes().map(g=>{let m=g.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),v=[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}],y=g.getAbsoluteTransform();v.forEach(function(b){let E=y.point(b);i.push(E)})});let o=new ht;o.rotate(-V.getAngle(this.rotation()));let a=1/0,l=1/0,h=-1/0,u=-1/0;i.forEach(function(g){let m=o.point(g);a===void 0&&(a=h=m.x,l=u=m.y),a=Math.min(a,m.x),l=Math.min(l,m.y),h=Math.max(h,m.x),u=Math.max(u,m.y)}),o.invert();let f=o.point({x:a,y:l});return{x:f.x,y:f.y,width:h-a,height:u-l,rotation:V.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),ta.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){let i=new On({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:P1?10:"auto"}),o=this;i.on("mousedown touchstart",function(a){o._handleMouseDown(a)}),i.on("dragstart",a=>{i.stopDrag(),a.cancelBubble=!0}),i.on("dragend",a=>{a.cancelBubble=!0}),i.on("mouseenter",()=>{let a=V.getAngle(this.rotation()),l=this.rotateAnchorCursor(),h=A1(t,a,l);i.getStage().content&&(i.getStage().content.style.cursor=h),this._cursorChange=!0}),i.on("mouseout",()=>{i.getStage().content&&(i.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(i)}_createBack(){let t=new I({name:"back",width:0,height:0,sceneFunc(i,o){let a=o.getParent(),l=a.padding(),h=o.width(),u=o.height();if(i.beginPath(),i.rect(-l,-l,h+l*2,u+l*2),a.rotateEnabled()&&a.rotateLineVisible()){let f=a.rotateAnchorAngle(),g=a.rotateAnchorOffset(),m=S.degToRad(f),v=Math.sin(m),y=-Math.cos(m),b=h/2,E=u/2,D=1/0;y<0?D=Math.min(D,-E/y):y>0&&(D=Math.min(D,(u-E)/y)),v<0?D=Math.min(D,-b/v):v>0&&(D=Math.min(D,(h-b)/v));let x=b+v*D,A=E+y*D,T=S._sign(u),R=x+v*g*T,z=A+y*g*T;i.moveTo(x,A),i.lineTo(R,z)}i.fillStrokeShape(o)},hitFunc:(i,o)=>{if(!this.shouldOverdrawWholeArea())return;let a=this.padding();i.beginPath(),i.rect(-a,-a,o.width()+a*2,o.height()+a*2),i.fillStrokeShape(o)}});this.add(t),this._proxyDrag(t),t.on("dragstart",i=>{i.cancelBubble=!0}),t.on("dragmove",i=>{i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),this.on("dragmove",i=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];let i=this._getNodeRect(),o=i.width,a=i.height,l=Math.sqrt(Math.pow(o,2)+Math.pow(a,2));this.sin=Math.abs(a/l),this.cos=Math.abs(o/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;let h=t.target.getAbsolutePosition(),u=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:u.x-h.x,y:u.y-h.y},Ac++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(f=>{f._fire("transformstart",{evt:t.evt,target:f})})}_handleMouseMove(t){let i,o,a,l=this.findOne("."+this._movingAnchorName),h=l.getStage();h.setPointersPositions(t);let u=h.getPointerPosition(),f={x:u.x-this._anchorDragOffset.x,y:u.y-this._anchorDragOffset.y},g=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(f=this.anchorDragBoundFunc()(g,f,t)),l.setAbsolutePosition(f);let m=l.getAbsolutePosition();if(g.x===m.x&&g.y===m.y)return;if(this._movingAnchorName==="rotater"){let T=this._getNodeRect();i=l.x()-T.width/2,o=-l.y()+T.height/2;let R=V.getAngle(this.rotateAnchorAngle()),z=Math.atan2(-o,i)+Math.PI/2-R;T.height<0&&(z-=Math.PI);let $=V.getAngle(this.rotation())+z,H=V.getAngle(this.rotationSnapTolerance()),K=I1(this.rotationSnaps(),$,H)-T.rotation,ge=O1(T,K);this._fitNodesInto(ge,t);return}let v=this.shiftBehavior(),y;v==="inverted"?y=this.keepRatio()&&!t.shiftKey:v==="none"?y=this.keepRatio():y=this.keepRatio()||t.shiftKey;let b=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};a=Math.sqrt(Math.pow(T.x-l.x(),2)+Math.pow(T.y-l.y(),2));let R=this.findOne(".top-left").x()>T.x?-1:1,z=this.findOne(".top-left").y()>T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".top-left").x(T.x-i),this.findOne(".top-left").y(T.y-o)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};a=Math.sqrt(Math.pow(l.x()-T.x,2)+Math.pow(T.y-l.y(),2));let R=this.findOne(".top-right").x()<T.x?-1:1,z=this.findOne(".top-right").y()>T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".top-right").x(T.x+i),this.findOne(".top-right").y(T.y-o)}var E=l.position();this.findOne(".top-left").y(E.y),this.findOne(".bottom-right").x(E.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};a=Math.sqrt(Math.pow(T.x-l.x(),2)+Math.pow(l.y()-T.y,2));let R=T.x<l.x()?-1:1,z=l.y()<T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,l.x(T.x-i),l.y(T.y+o)}E=l.position(),this.findOne(".top-left").x(E.x),this.findOne(".bottom-right").y(E.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(y){let T=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};a=Math.sqrt(Math.pow(l.x()-T.x,2)+Math.pow(l.y()-T.y,2));let R=this.findOne(".bottom-right").x()<T.x?-1:1,z=this.findOne(".bottom-right").y()<T.y?-1:1;i=a*this.cos*R,o=a*this.sin*z,this.findOne(".bottom-right").x(T.x+i),this.findOne(".bottom-right").y(T.y+o)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(b=this.centeredScaling()||t.altKey,b){let T=this.findOne(".top-left"),R=this.findOne(".bottom-right"),z=T.x(),G=T.y(),$=this.getWidth()-R.x(),H=this.getHeight()-R.y();R.move({x:-z,y:-G}),T.move({x:$,y:H})}let D=this.findOne(".top-left").getAbsolutePosition();i=D.x,o=D.y;let x=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),A=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:i,y:o,width:x,height:A,rotation:V.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var i;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));let o=this.getNode();Ac--,this._fire("transformend",{evt:t,target:o}),(i=this.getLayer())===null||i===void 0||i.batchDraw(),o&&this._nodes.forEach(a=>{var l;a._fire("transformend",{evt:t,target:a}),(l=a.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,i){let o=this._getNodeRect(),a=1;if(S._inRange(t.width,-this.padding()*2-a,a)){this.update();return}if(S._inRange(t.height,-this.padding()*2-a,a)){this.update();return}let l=new ht;if(l.rotate(V.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){let y=l.point({x:-this.padding()*2,y:0});t.x+=y.x,t.y+=y.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){let y=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){let y=l.point({x:0,y:-this.padding()*2});t.x+=y.x,t.y+=y.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){let y=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){let y=this.boundBoxFunc()(o,t);y?t=y:S.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}let h=1e7,u=new ht;u.translate(o.x,o.y),u.rotate(o.rotation),u.scale(o.width/h,o.height/h);let f=new ht,g=t.width/h,m=t.height/h;this.flipEnabled()===!1?(f.translate(t.x,t.y),f.rotate(t.rotation),f.translate(t.width<0?t.width:0,t.height<0?t.height:0),f.scale(Math.abs(g),Math.abs(m))):(f.translate(t.x,t.y),f.rotate(t.rotation),f.scale(g,m));let v=f.multiply(u.invert());this._nodes.forEach(y=>{var b;if(!y.getStage())return;let E=y.getParent().getAbsoluteTransform(),D=y.getTransform().copy();D.translate(y.offsetX(),y.offsetY());let x=new ht;x.multiply(E.copy().invert()).multiply(v).multiply(E).multiply(D);let A=x.decompose();y.setAttrs(A),(b=y.getLayer())===null||b===void 0||b.batchDraw()}),this.rotation(S._getRotation(t.rotation)),this._nodes.forEach(y=>{this._fire("transform",{evt:i,target:y}),y._fire("transform",{evt:i,target:y})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,i){this.findOne(t).setAttrs(i)}update(){var t;let i=this._getNodeRect();this.rotation(S._getRotation(i.rotation));let o=i.width,a=i.height,l=this.enabledAnchors(),h=this.resizeEnabled(),u=this.padding(),f=this.anchorSize(),g=this.find("._anchor");g.forEach($=>{$.setAttrs({width:f,height:f,offsetX:f/2,offsetY:f/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:f/2+u,offsetY:f/2+u,visible:h&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:o/2,y:0,offsetY:f/2+u,visible:h&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:o,y:0,offsetX:f/2-u,offsetY:f/2+u,visible:h&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:a/2,offsetX:f/2+u,visible:h&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:o,y:a/2,offsetX:f/2-u,visible:h&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:a,offsetX:f/2+u,offsetY:f/2-u,visible:h&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:o/2,y:a,offsetY:f/2-u,visible:h&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:o,y:a,offsetX:f/2-u,offsetY:f/2-u,visible:h&&l.indexOf("bottom-right")>=0});let m=this.rotateAnchorAngle(),v=this.rotateAnchorOffset(),y=S.degToRad(m),b=Math.sin(y),E=-Math.cos(y),D=o/2,x=a/2,A=1/0;E<0?A=Math.min(A,-x/E):E>0&&(A=Math.min(A,(a-x)/E)),b<0?A=Math.min(A,-D/b):b>0&&(A=Math.min(A,(o-D)/b));let T=D+b*A,R=x+E*A,z=S._sign(a);this._batchChangeChild(".rotater",{x:T+b*v*z,y:R+E*v*z-u*E,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:o,height:a,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some($=>$.draggable()),x:0,y:0});let G=this.anchorStyleFunc();G&&g.forEach($=>{G($)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),en.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return F.prototype.toObject.call(this)}clone(t){return F.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}return r.isTransforming=()=>Ac>0,r})();function L1(r){return r instanceof Array||S.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(e){ta.indexOf(e)===-1&&S.warn("Unknown anchor name: "+e+". Available names are: "+ta.join(", "))}),r||[]}Ce.prototype.className="Transformer";le(Ce);w.addGetterSetter(Ce,"enabledAnchors",ta,L1);w.addGetterSetter(Ce,"flipEnabled",!0,ut());w.addGetterSetter(Ce,"resizeEnabled",!0);w.addGetterSetter(Ce,"anchorSize",10,O());w.addGetterSetter(Ce,"rotateEnabled",!0);w.addGetterSetter(Ce,"rotateLineVisible",!0);w.addGetterSetter(Ce,"rotationSnaps",[]);w.addGetterSetter(Ce,"rotateAnchorOffset",50,O());w.addGetterSetter(Ce,"rotateAnchorAngle",0,O());w.addGetterSetter(Ce,"rotateAnchorCursor","crosshair");w.addGetterSetter(Ce,"rotationSnapTolerance",5,O());w.addGetterSetter(Ce,"borderEnabled",!0);w.addGetterSetter(Ce,"anchorStroke","rgb(0, 161, 255)");w.addGetterSetter(Ce,"anchorStrokeWidth",1,O());w.addGetterSetter(Ce,"anchorFill","white");w.addGetterSetter(Ce,"anchorCornerRadius",0,O());w.addGetterSetter(Ce,"borderStroke","rgb(0, 161, 255)");w.addGetterSetter(Ce,"borderStrokeWidth",1,O());w.addGetterSetter(Ce,"borderDash");w.addGetterSetter(Ce,"keepRatio",!0);w.addGetterSetter(Ce,"shiftBehavior","default");w.addGetterSetter(Ce,"centeredScaling",!1);w.addGetterSetter(Ce,"ignoreStroke",!1);w.addGetterSetter(Ce,"padding",0,O());w.addGetterSetter(Ce,"nodes");w.addGetterSetter(Ce,"node");w.addGetterSetter(Ce,"boundBoxFunc");w.addGetterSetter(Ce,"anchorDragBoundFunc");w.addGetterSetter(Ce,"anchorStyleFunc");w.addGetterSetter(Ce,"shouldOverdrawWholeArea",!1);w.addGetterSetter(Ce,"useSingleNodeRotation",!0);w.backCompat(Ce,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Gt=class extends I{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,V.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Gt.prototype.className="Wedge";Gt.prototype._centroid=!0;Gt.prototype._attrsAffectingSize=["radius"];le(Gt);w.addGetterSetter(Gt,"radius",0,O());w.addGetterSetter(Gt,"angle",0,O());w.addGetterSetter(Gt,"clockwise",!1);w.backCompat(Gt,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Yf(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var k1=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],F1=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function N1(r,e){let t=r.data,i=r.width,o=r.height,a,l,h,u,f,g,m,v,y,b,E,D,x,A,T,R,z,G,$,H,Z=e+e+1,K=i-1,ge=o-1,Y=e+1,we=Y*(Y+1)/2,re=new Yf,Q=k1[e],k=F1[e],Se=null,B=re,ne=null,be=null;for(let q=1;q<Z;q++)B=B.next=new Yf,q===Y&&(Se=B);B.next=re,h=l=0;for(let q=0;q<o;q++){D=x=A=T=u=f=g=m=0,v=Y*(R=t[l]),y=Y*(z=t[l+1]),b=Y*(G=t[l+2]),E=Y*($=t[l+3]),u+=we*R,f+=we*z,g+=we*G,m+=we*$,B=re;for(let J=0;J<Y;J++)B.r=R,B.g=z,B.b=G,B.a=$,B=B.next;for(let J=1;J<Y;J++)a=l+((K<J?K:J)<<2),u+=(B.r=R=t[a])*(H=Y-J),f+=(B.g=z=t[a+1])*H,g+=(B.b=G=t[a+2])*H,m+=(B.a=$=t[a+3])*H,D+=R,x+=z,A+=G,T+=$,B=B.next;ne=re,be=Se;for(let J=0;J<i;J++)t[l+3]=$=m*Q>>k,$!==0?($=255/$,t[l]=(u*Q>>k)*$,t[l+1]=(f*Q>>k)*$,t[l+2]=(g*Q>>k)*$):t[l]=t[l+1]=t[l+2]=0,u-=v,f-=y,g-=b,m-=E,v-=ne.r,y-=ne.g,b-=ne.b,E-=ne.a,a=h+((a=J+e+1)<K?a:K)<<2,D+=ne.r=t[a],x+=ne.g=t[a+1],A+=ne.b=t[a+2],T+=ne.a=t[a+3],u+=D,f+=x,g+=A,m+=T,ne=ne.next,v+=R=be.r,y+=z=be.g,b+=G=be.b,E+=$=be.a,D-=R,x-=z,A-=G,T-=$,be=be.next,l+=4;h+=i}for(let q=0;q<i;q++){x=A=T=D=f=g=m=u=0,l=q<<2,v=Y*(R=t[l]),y=Y*(z=t[l+1]),b=Y*(G=t[l+2]),E=Y*($=t[l+3]),u+=we*R,f+=we*z,g+=we*G,m+=we*$,B=re;for(let X=0;X<Y;X++)B.r=R,B.g=z,B.b=G,B.a=$,B=B.next;let J=i;for(let X=1;X<=e;X++)l=J+q<<2,u+=(B.r=R=t[l])*(H=Y-X),f+=(B.g=z=t[l+1])*H,g+=(B.b=G=t[l+2])*H,m+=(B.a=$=t[l+3])*H,D+=R,x+=z,A+=G,T+=$,B=B.next,X<ge&&(J+=i);l=q,ne=re,be=Se;for(let X=0;X<o;X++)a=l<<2,t[a+3]=$=m*Q>>k,$>0?($=255/$,t[a]=(u*Q>>k)*$,t[a+1]=(f*Q>>k)*$,t[a+2]=(g*Q>>k)*$):t[a]=t[a+1]=t[a+2]=0,u-=v,f-=y,g-=b,m-=E,v-=ne.r,y-=ne.g,b-=ne.b,E-=ne.a,a=q+((a=X+Y)<ge?a:ge)*i<<2,u+=D+=ne.r=t[a],f+=x+=ne.g=t[a+1],g+=A+=ne.b=t[a+2],m+=T+=ne.a=t[a+3],ne=ne.next,v+=R=be.r,y+=z=be.g,b+=G=be.b,E+=$=be.a,D-=R,x-=z,A-=G,T-=$,be=be.next,l+=i}}var Xf=function(e){let t=Math.round(this.blurRadius());t>0&&N1(e,t)};w.addGetterSetter(F,"blurRadius",0,O(),w.afterSetFilter);var Kf=function(r){let e=this.brightness()*255,t=r.data,i=t.length;for(let o=0;o<i;o+=4)t[o]+=e,t[o+1]+=e,t[o+2]+=e};w.addGetterSetter(F,"brightness",0,O(),w.afterSetFilter);var Jf=function(r){let e=this.brightness(),t=r.data,i=t.length;for(let o=0;o<i;o+=4)t[o]=Math.min(255,t[o]*e),t[o+1]=Math.min(255,t[o+1]*e),t[o+2]=Math.min(255,t[o+2]*e)};var Qf=function(r){let e=Math.pow((this.contrast()+100)/100,2),t=r.data,i=t.length,o=150,a=150,l=150;for(let h=0;h<i;h+=4)o=t[h],a=t[h+1],l=t[h+2],o/=255,o-=.5,o*=e,o+=.5,o*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,l/=255,l-=.5,l*=e,l+=.5,l*=255,o=o<0?0:o>255?255:o,a=a<0?0:a>255?255:a,l=l<0?0:l>255?255:l,t[h]=o,t[h+1]=a,t[h+2]=l};w.addGetterSetter(F,"contrast",0,O(),w.afterSetFilter);var ep=function(r){var e,t,i,o,a,l,h,u,f;let g=r.data,m=r.width,v=r.height,y=Math.min(1,Math.max(0,(t=(e=this.embossStrength)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:.5)),b=Math.min(1,Math.max(0,(o=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&o!==void 0?o:.5)),D=(h={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(l=(a=this.embossDirection)===null||a===void 0?void 0:a.call(this))!==null&&l!==void 0?l:"top-left"])!==null&&h!==void 0?h:315,x=!!((f=(u=this.embossBlend)===null||u===void 0?void 0:u.call(this))!==null&&f!==void 0&&f),A=y*10,T=b*255,R=D*Math.PI/180,z=Math.cos(R),G=Math.sin(R),$=128/1020*A,H=new Uint8ClampedArray(g),Z=new Float32Array(m*v);for(let re=0,Q=0;Q<g.length;Q+=4,re++)Z[re]=.2126*H[Q]+.7152*H[Q+1]+.0722*H[Q+2];let K=[-1,0,1,-2,0,2,-1,0,1],ge=[-1,-2,-1,0,0,0,1,2,1],Y=[-m-1,-m,-m+1,-1,0,1,m-1,m,m+1],we=re=>re<0?0:re>255?255:re;for(let re=1;re<v-1;re++)for(let Q=1;Q<m-1;Q++){let k=re*m+Q,Se=0,B=0;Se+=Z[k+Y[0]]*K[0],B+=Z[k+Y[0]]*ge[0],Se+=Z[k+Y[1]]*K[1],B+=Z[k+Y[1]]*ge[1],Se+=Z[k+Y[2]]*K[2],B+=Z[k+Y[2]]*ge[2],Se+=Z[k+Y[3]]*K[3],B+=Z[k+Y[3]]*ge[3],Se+=Z[k+Y[5]]*K[5],B+=Z[k+Y[5]]*ge[5],Se+=Z[k+Y[6]]*K[6],B+=Z[k+Y[6]]*ge[6],Se+=Z[k+Y[7]]*K[7],B+=Z[k+Y[7]]*ge[7],Se+=Z[k+Y[8]]*K[8],B+=Z[k+Y[8]]*ge[8];let ne=z*Se+G*B,be=we(T+ne*$),q=k*4;if(x){let J=be-T;g[q]=we(H[q]+J),g[q+1]=we(H[q+1]+J),g[q+2]=we(H[q+2]+J),g[q+3]=H[q+3]}else g[q]=g[q+1]=g[q+2]=be,g[q+3]=H[q+3]}for(let re=0;re<m;re++){let Q=re*4,k=((v-1)*m+re)*4;g[Q]=H[Q],g[Q+1]=H[Q+1],g[Q+2]=H[Q+2],g[Q+3]=H[Q+3],g[k]=H[k],g[k+1]=H[k+1],g[k+2]=H[k+2],g[k+3]=H[k+3]}for(let re=1;re<v-1;re++){let Q=re*m*4,k=(re*m+(m-1))*4;g[Q]=H[Q],g[Q+1]=H[Q+1],g[Q+2]=H[Q+2],g[Q+3]=H[Q+3],g[k]=H[k],g[k+1]=H[k+1],g[k+2]=H[k+2],g[k+3]=H[k+3]}return r};w.addGetterSetter(F,"embossStrength",.5,O(),w.afterSetFilter);w.addGetterSetter(F,"embossWhiteLevel",.5,O(),w.afterSetFilter);w.addGetterSetter(F,"embossDirection","top-left",void 0,w.afterSetFilter);w.addGetterSetter(F,"embossBlend",!1,void 0,w.afterSetFilter);function Rc(r,e,t,i,o){let a=t-e,l=o-i;if(a===0)return i+l/2;if(l===0)return i;let h=(r-e)/a;return h=l*h+i,h}var tp=function(r){let e=r.data,t=e.length,i=e[0],o=i,a,l=e[1],h=l,u,f=e[2],g=f,m,v=this.enhance();if(v===0)return;for(let T=0;T<t;T+=4)a=e[T+0],a<i?i=a:a>o&&(o=a),u=e[T+1],u<l?l=u:u>h&&(h=u),m=e[T+2],m<f?f=m:m>g&&(g=m);o===i&&(o=255,i=0),h===l&&(h=255,l=0),g===f&&(g=255,f=0);let y,b,E,D,x,A;if(v>0)y=o+v*(255-o),b=i-v*(i-0),E=h+v*(255-h),D=l-v*(l-0),x=g+v*(255-g),A=f-v*(f-0);else{let T=(o+i)*.5;y=o+v*(o-T),b=i+v*(i-T);let R=(h+l)*.5;E=h+v*(h-R),D=l+v*(l-R);let z=(g+f)*.5;x=g+v*(g-z),A=f+v*(f-z)}for(let T=0;T<t;T+=4)e[T+0]=Rc(e[T+0],i,o,b,y),e[T+1]=Rc(e[T+1],l,h,D,E),e[T+2]=Rc(e[T+2],f,g,A,x)};w.addGetterSetter(F,"enhance",0,O(),w.afterSetFilter);var np=function(r){let e=r.data,t=e.length;for(let i=0;i<t;i+=4){let o=.34*e[i]+.5*e[i+1]+.16*e[i+2];e[i]=o,e[i+1]=o,e[i+2]=o}};w.addGetterSetter(F,"hue",0,O(),w.afterSetFilter);w.addGetterSetter(F,"saturation",0,O(),w.afterSetFilter);w.addGetterSetter(F,"luminance",0,O(),w.afterSetFilter);var ip=function(r){let e=r.data,t=e.length,i=1,o=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,l=this.luminance()*127,h=i*o*Math.cos(a*Math.PI/180),u=i*o*Math.sin(a*Math.PI/180),f=.299*i+.701*h+.167*u,g=.587*i-.587*h+.33*u,m=.114*i-.114*h-.497*u,v=.299*i-.299*h-.328*u,y=.587*i+.413*h+.035*u,b=.114*i-.114*h+.293*u,E=.299*i-.3*h+1.25*u,D=.587*i-.586*h-1.05*u,x=.114*i+.886*h-.2*u,A,T,R,z;for(let G=0;G<t;G+=4)A=e[G+0],T=e[G+1],R=e[G+2],z=e[G+3],e[G+0]=f*A+g*T+m*R+l,e[G+1]=v*A+y*T+b*R+l,e[G+2]=E*A+D*T+x*R+l,e[G+3]=z};var rp=function(r){let e=r.data,t=e.length,i=Math.pow(2,this.value()),o=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,l=i*o*Math.cos(a*Math.PI/180),h=i*o*Math.sin(a*Math.PI/180),u=.299*i+.701*l+.167*h,f=.587*i-.587*l+.33*h,g=.114*i-.114*l-.497*h,m=.299*i-.299*l-.328*h,v=.587*i+.413*l+.035*h,y=.114*i-.114*l+.293*h,b=.299*i-.3*l+1.25*h,E=.587*i-.586*l-1.05*h,D=.114*i+.886*l-.2*h;for(let x=0;x<t;x+=4){let A=e[x+0],T=e[x+1],R=e[x+2],z=e[x+3];e[x+0]=u*A+f*T+g*R,e[x+1]=m*A+v*T+y*R,e[x+2]=b*A+E*T+D*R,e[x+3]=z}};w.addGetterSetter(F,"hue",0,O(),w.afterSetFilter);w.addGetterSetter(F,"saturation",0,O(),w.afterSetFilter);w.addGetterSetter(F,"value",0,O(),w.afterSetFilter);var op=function(r){let e=r.data,t=e.length;for(let i=0;i<t;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2]};var B1=function(r,e,t){let i=r.data,o=e.data,a=r.width,l=r.height,h=t.polarCenterX||a/2,u=t.polarCenterY||l/2,f=Math.sqrt(h*h+u*u),g=a-h,m=l-u,v=Math.sqrt(g*g+m*m);f=v>f?v:f;let y=l,b=a,E=360/b*Math.PI/180;for(let D=0;D<b;D+=1){let x=Math.sin(D*E),A=Math.cos(D*E);for(let T=0;T<y;T+=1){g=Math.floor(h+f*T/y*A),m=Math.floor(u+f*T/y*x);let R=(m*a+g)*4,z=i[R+0],G=i[R+1],$=i[R+2],H=i[R+3];R=(D+T*a)*4,o[R+0]=z,o[R+1]=G,o[R+2]=$,o[R+3]=H}}},V1=function(r,e,t){let i=r.data,o=e.data,a=r.width,l=r.height,h=t.polarCenterX||a/2,u=t.polarCenterY||l/2,f=Math.sqrt(h*h+u*u),g=a-h,m=l-u,v=Math.sqrt(g*g+m*m);f=v>f?v:f;let y=l,b=a,E=t.polarRotation||0,D,x;for(g=0;g<a;g+=1)for(m=0;m<l;m+=1){let A=g-h,T=m-u,R=Math.sqrt(A*A+T*T)*y/f,z=(Math.atan2(T,A)*180/Math.PI+360+E)%360;z=z*b/360,D=Math.floor(z),x=Math.floor(R);let G=(x*a+D)*4,$=i[G+0],H=i[G+1],Z=i[G+2],K=i[G+3];G=(m*a+g)*4,o[G+0]=$,o[G+1]=H,o[G+2]=Z,o[G+3]=K}},sp=function(r){let e=r.width,t=r.height,i,o,a,l,h,u,f,g,m,v,y=Math.round(this.kaleidoscopePower()),b=Math.round(this.kaleidoscopeAngle()),E=Math.floor(e*(b%360)/360);if(y<1)return;let D=S.createCanvasElement();D.width=e,D.height=t;let x=D.getContext("2d").getImageData(0,0,e,t);S.releaseCanvas(D),B1(r,x,{polarCenterX:e/2,polarCenterY:t/2});let A=e/Math.pow(2,y);for(;A<=8;)A=A*2,y-=1;A=Math.ceil(A);let T=A,R=0,z=T,G=1;for(E+A>e&&(R=T,z=0,G=-1),o=0;o<t;o+=1)for(i=R;i!==z;i+=G)a=Math.round(i+E)%e,m=(e*o+a)*4,h=x.data[m+0],u=x.data[m+1],f=x.data[m+2],g=x.data[m+3],v=(e*o+i)*4,x.data[v+0]=h,x.data[v+1]=u,x.data[v+2]=f,x.data[v+3]=g;for(o=0;o<t;o+=1)for(T=Math.floor(A),l=0;l<y;l+=1){for(i=0;i<T+1;i+=1)m=(e*o+i)*4,h=x.data[m+0],u=x.data[m+1],f=x.data[m+2],g=x.data[m+3],v=(e*o+T*2-i-1)*4,x.data[v+0]=h,x.data[v+1]=u,x.data[v+2]=f,x.data[v+3]=g;T*=2}V1(x,r,{polarRotation:0})};w.addGetterSetter(F,"kaleidoscopePower",2,O(),w.afterSetFilter);w.addGetterSetter(F,"kaleidoscopeAngle",0,O(),w.afterSetFilter);function na(r,e,t){let i=(t*r.width+e)*4,o=[];return o.push(r.data[i++],r.data[i++],r.data[i++],r.data[i++]),o}function wo(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2)+Math.pow(r[2]-e[2],2))}function z1(r){let e=[0,0,0];for(let t=0;t<r.length;t++)e[0]+=r[t][0],e[1]+=r[t][1],e[2]+=r[t][2];return e[0]/=r.length,e[1]/=r.length,e[2]/=r.length,e}function U1(r,e){let t=na(r,0,0),i=na(r,r.width-1,0),o=na(r,0,r.height-1),a=na(r,r.width-1,r.height-1),l=e||10;if(wo(t,i)<l&&wo(i,a)<l&&wo(a,o)<l&&wo(o,t)<l){let h=z1([i,t,a,o]),u=[];for(let f=0;f<r.width*r.height;f++){let g=wo(h,[r.data[f*4],r.data[f*4+1],r.data[f*4+2]]);u[f]=g<l?0:255}return u}}function G1(r,e){for(let t=0;t<r.width*r.height;t++)r.data[4*t+3]=e[t]}function j1(r,e,t){let i=[1,1,1,1,0,1,1,1,1],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<t;h++)for(let u=0;u<e;u++){let f=h*e+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<t&&b>=0&&b<e){let E=y*e+b,D=i[m*o+v];g+=r[E]*D}}l[f]=g===2040?255:0}return l}function H1(r,e,t){let i=[1,1,1,1,1,1,1,1,1],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<t;h++)for(let u=0;u<e;u++){let f=h*e+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<t&&b>=0&&b<e){let E=y*e+b,D=i[m*o+v];g+=r[E]*D}}l[f]=g>=1020?255:0}return l}function $1(r,e,t){let i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],o=Math.round(Math.sqrt(i.length)),a=Math.floor(o/2),l=[];for(let h=0;h<t;h++)for(let u=0;u<e;u++){let f=h*e+u,g=0;for(let m=0;m<o;m++)for(let v=0;v<o;v++){let y=h+m-a,b=u+v-a;if(y>=0&&y<t&&b>=0&&b<e){let E=y*e+b,D=i[m*o+v];g+=r[E]*D}}l[f]=g}return l}var ap=function(r){let e=this.threshold(),t=U1(r,e);return t&&(t=j1(t,r.width,r.height),t=H1(t,r.width,r.height),t=$1(t,r.width,r.height),G1(r,t)),r};w.addGetterSetter(F,"threshold",0,O(),w.afterSetFilter);var lp=function(r){let e=this.noise()*255,t=r.data,i=t.length,o=e/2;for(let a=0;a<i;a+=4)t[a+0]+=o-2*o*Math.random(),t[a+1]+=o-2*o*Math.random(),t[a+2]+=o-2*o*Math.random()};w.addGetterSetter(F,"noise",.2,O(),w.afterSetFilter);var cp=function(r){let e=Math.ceil(this.pixelSize()),t=r.width,i=r.height,o=Math.ceil(t/e),a=Math.ceil(i/e),l=r.data;if(e<=0){S.error("pixelSize value can not be <= 0");return}for(let h=0;h<o;h+=1)for(let u=0;u<a;u+=1){let f=0,g=0,m=0,v=0,y=h*e,b=y+e,E=u*e,D=E+e,x=0;for(let A=y;A<b;A+=1)if(!(A>=t))for(let T=E;T<D;T+=1){if(T>=i)continue;let R=(t*T+A)*4;f+=l[R+0],g+=l[R+1],m+=l[R+2],v+=l[R+3],x+=1}f=f/x,g=g/x,m=m/x,v=v/x;for(let A=y;A<b;A+=1)if(!(A>=t))for(let T=E;T<D;T+=1){if(T>=i)continue;let R=(t*T+A)*4;l[R+0]=f,l[R+1]=g,l[R+2]=m,l[R+3]=v}}};w.addGetterSetter(F,"pixelSize",8,O(),w.afterSetFilter);var hp=function(r){let e=Math.round(this.levels()*254)+1,t=r.data,i=t.length,o=255/e;for(let a=0;a<i;a+=1)t[a]=Math.floor(t[a]/o)*o};w.addGetterSetter(F,"levels",.5,O(),w.afterSetFilter);var up=function(r){let e=r.data,t=e.length,i=this.red(),o=this.green(),a=this.blue();for(let l=0;l<t;l+=4){let h=(.34*e[l]+.5*e[l+1]+.16*e[l+2])/255;e[l]=h*i,e[l+1]=h*o,e[l+2]=h*a,e[l+3]=e[l+3]}};w.addGetterSetter(F,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(F,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(F,"blue",0,Gs,w.afterSetFilter);var dp=function(r){let e=r.data,t=e.length,i=this.red(),o=this.green(),a=this.blue(),l=this.alpha();for(let h=0;h<t;h+=4){let u=1-l;e[h]=i*l+e[h]*u,e[h+1]=o*l+e[h+1]*u,e[h+2]=a*l+e[h+2]*u}};w.addGetterSetter(F,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(F,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});w.addGetterSetter(F,"blue",0,Gs,w.afterSetFilter);w.addGetterSetter(F,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var fp=function(r){let e=r.data,t=e.length;for(let i=0;i<t;i+=4){let o=e[i+0],a=e[i+1],l=e[i+2];e[i+0]=Math.min(255,o*.393+a*.769+l*.189),e[i+1]=Math.min(255,o*.349+a*.686+l*.168),e[i+2]=Math.min(255,o*.272+a*.534+l*.131)}};var pp=function(r){let t=r.data;for(let i=0;i<t.length;i+=4){let o=t[i],a=t[i+1],l=t[i+2];.2126*o+.7152*a+.0722*l>=128&&(t[i]=255-o,t[i+1]=255-a,t[i+2]=255-l)}return r};var gp=function(r){let e=this.threshold()*255,t=r.data,i=t.length;for(let o=0;o<i;o+=1)t[o]=t[o]<e?0:255};w.addGetterSetter(F,"threshold",.5,O(),w.afterSetFilter);var mp=vc.Util._assign(vc,{Arc:Ut,Arrow:_n,Circle:Rn,Ellipse:tn,Image:Ct,Label:pr,Tag:vn,Line:Pt,Path:dt,Rect:On,RegularPolygon:nn,Ring:yn,Sprite:At,Star:rn,Text:Re,TextPath:$e,Transformer:Ce,Wedge:Gt,Filters:{Blur:Xf,Brightness:Jf,Brighten:Kf,Contrast:Qf,Emboss:ep,Enhance:tp,Grayscale:np,HSL:ip,HSV:rp,Invert:op,Kaleidoscope:sp,Mask:ap,Noise:lp,Pixelate:cp,Posterize:hp,RGB:up,RGBA:dp,Sepia:fp,Solarize:pp,Threshold:gp}});var St=mp;var ia=class r{async generatePoster(e,t,i,o,a,l,h,u,f=1200,g=1600){await Promise.all([document.fonts.load("400 16px Roboto"),document.fonts.load("700 16px Roboto")]);let m=new St.Stage({container:e,width:f,height:g}),v=new St.Layer;m.add(v);let y=new St.Rect({x:0,y:0,width:f,height:g,fill:i.bg});v.add(y);let b=6378137,E=85.05112878,D=(q,J)=>{let X=Math.max(Math.min(q,E),-E),te=b*(J*Math.PI/180),Ze=b*Math.log(Math.tan(Math.PI/4+X*Math.PI/180/2));return{x:te,y:Ze}},x=D(l.lat,l.lon),A=1/Math.cos(l.lat*Math.PI/180),T=h*A,R=g/f,z=x.x-T,G=x.x+T,$=x.y-T*R,H=x.y+T*R,Z=G-z,K=H-$,ge={x:z,y:$},Y=f/Z,we=K*Y,re=(f-Z*Y)/2,Q=(g-we)/2,k=(q,J)=>{let X=D(q,J);return{x:(X.x-ge.x)*Y+re,y:g-((X.y-ge.y)*Y+Q)}},Se=q=>{let J=[];for(let X of q)if(X&&X.lat!=null&&X.lon!=null){let te=k(X.lat,X.lon);J.push(te.x,te.y)}return J},B=async(q,J,X,te,Ze)=>{let rt=[];for(let Pe=0;Pe<q.length;Pe++){if(Pe%500===0){let ce=X+Pe/q.length*(te-X);u&&u(`Processing ${Ze}...`,Math.round(ce)),await new Promise(ue=>setTimeout(ue,0))}let Ge=q[Pe];if(Ge.type==="way"){let ce=Ge;if(ce.geometry&&ce.geometry.length>=3){let ue=Se(ce.geometry);ue.length>=6&&rt.push(ue)}}else if(Ge.type==="relation"){let ce=Ge;for(let ue of ce.members)if(ue.geometry&&ue.geometry.length>=3){let Le=Se(ue.geometry);Le.length>=6&&rt.push(Le)}}}if(rt.length===0)return;let ze=new St.Shape({fill:J,strokeEnabled:!1,listening:!1,sceneFunc:function(Pe,Ge){Pe.beginPath();for(let ce of rt){Pe.moveTo(ce[0],ce[1]);for(let ue=2;ue<ce.length;ue+=2)Pe.lineTo(ce[ue],ce[ue+1]);Pe.closePath()}Pe.fillStrokeShape(Ge)}});v.add(ze)},ne=async(q,J,X)=>{let te=new Map,Ze=1e3;for(let ze=0;ze<q.length;ze++){if(ze%Ze===0){let ft=J+ze/q.length*(X-J);u&&u("Processing roads...",Math.round(ft)),await new Promise(ti=>setTimeout(ti,0))}let Pe=q[ze];if(!Pe.geometry||Pe.geometry.length<2)continue;let Ge=Se(Pe.geometry);if(Ge.length<4)continue;let ce=Pe.tags?.highway||"unclassified",ue=i.road_default,Le=1,Ke=0;["motorway","motorway_link"].includes(ce)?(ue=i.road_motorway,Le=3,Ke=4):["trunk","trunk_link","primary","primary_link"].includes(ce)?(ue=i.road_primary,Le=2.5,Ke=3):["secondary","secondary_link"].includes(ce)?(ue=i.road_secondary,Le=2,Ke=2):["tertiary","tertiary_link"].includes(ce)?(ue=i.road_tertiary,Le=1.5,Ke=1):["residential","living_street","unclassified"].includes(ce)&&(ue=i.road_residential,Le=1,Ke=0);let Dt=`${ue}|${Le}|${Ke}`;te.has(Dt)||te.set(Dt,[]),te.get(Dt).push(Ge)}if(te.size===0)return;let rt=Array.from(te.keys()).sort((ze,Pe)=>{let Ge=parseInt(ze.split("|")[2],10),ce=parseInt(Pe.split("|")[2],10);return Ge-ce}),Rt=2e3;for(let ze of rt){let[Pe,Ge]=ze.split("|"),ce=parseFloat(Ge),ue=te.get(ze);for(let Le=0;Le<ue.length;Le+=Rt){let Ke=ue.slice(Le,Le+Rt),Dt=new St.Shape({stroke:Pe,strokeWidth:ce,lineCap:"round",lineJoin:"round",listening:!1,sceneFunc:function(ft,ti){ft.beginPath();for(let _t of Ke){ft.moveTo(_t[0],_t[1]);for(let xt=2;xt<_t.length;xt+=2)ft.lineTo(_t[xt],_t[xt+1])}ft.fillStrokeShape(ti)}});v.add(Dt)}}},be=async(q,J,X,te)=>{let Ze=[];for(let ce=0;ce<q.length;ce++){if(ce%500===0){let Ke=X+ce/q.length*(te-X);u&&u("Processing waterways...",Math.round(Ke)),await new Promise(Dt=>setTimeout(Dt,0))}let ue=q[ce];if(!ue.geometry||ue.geometry.length<2)continue;let Le=Se(ue.geometry);Le.length>=4&&Ze.push(Le)}if(Ze.length===0)return;let Rt=ce=>{let ue=ce?.waterway||"";return ue==="river"?3:ue==="canal"?2.5:ue==="stream"?1.5:1},ze=new Map;for(let ce=0;ce<q.length;ce++){let ue=q[ce];if(!ue.geometry||ue.geometry.length<2)continue;let Le=Se(ue.geometry);if(Le.length<4)continue;let Ke=Rt(ue.tags);ze.has(Ke)||ze.set(Ke,[]),ze.get(Ke).push(Le)}let Pe=2e3,Ge=Array.from(ze.keys()).sort((ce,ue)=>ce-ue);for(let ce of Ge){let ue=ze.get(ce);for(let Le=0;Le<ue.length;Le+=Pe){let Ke=ue.slice(Le,Le+Pe),Dt=new St.Shape({stroke:J,strokeWidth:ce,lineCap:"round",lineJoin:"round",listening:!1,sceneFunc:function(ft,ti){ft.beginPath();for(let _t of Ke){ft.moveTo(_t[0],_t[1]);for(let xt=2;xt<_t.length;xt+=2)ft.lineTo(_t[xt],_t[xt+1])}ft.fillStrokeShape(ti)}});v.add(Dt)}}};return(async()=>{try{u&&u("Water areas",5),await B(t.waterAreas,i.water,0,15,"water areas"),u&&u("Parks",15),await B(t.parks,i.parks,15,30,"parks"),u&&u("Waterways",30),await be(t.waterways,i.water,30,45),u&&u("Roads",45),await ne(t.roads,45,90),u&&u("Finalizing",95),await new Promise(Ge=>setTimeout(Ge,0));let q=new St.Rect({x:0,y:0,width:f,height:g*.25,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:g*.25},fillLinearGradientColorStops:[0,i.gradient_color,1,"rgba(0,0,0,0)"]});v.add(q);let J=new St.Rect({x:0,y:g*.75,width:f,height:g*.25,fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:g*.25},fillLinearGradientColorStops:[0,"rgba(0,0,0,0)",1,i.gradient_color]});v.add(J);let X=new St.Text({x:f/2,y:g*.86-50,text:o.toUpperCase().split("").join("  "),fontSize:60,fontFamily:"Roboto",fontStyle:"bold",fill:i.text,align:"center"});X.offsetX(X.width()/2),v.add(X);let te=new St.Text({x:f/2,y:g*.9,text:a.toUpperCase(),fontSize:22,fontFamily:"Roboto",fontStyle:"normal",fill:i.text,align:"center"});te.offsetX(te.width()/2),v.add(te);let Ze=l.lat>=0?`${l.lat.toFixed(4)}\xB0 N`:`${Math.abs(l.lat).toFixed(4)}\xB0 S`,rt=l.lon>=0?`${l.lon.toFixed(4)}\xB0 E`:`${Math.abs(l.lon).toFixed(4)}\xB0 W`,Rt=new St.Text({x:f/2,y:g*.93,text:`${Ze} / ${rt}`,fontSize:14,fontFamily:"Roboto",fill:i.text,opacity:.7,align:"center"});Rt.offsetX(Rt.width()/2),v.add(Rt);let ze=new St.Line({points:[f*.4,g*.88,f*.6,g*.88],stroke:i.text,strokeWidth:1});v.add(ze);let Pe=new St.Text({x:f-10,y:g-20,text:"\xA9 OpenStreetMap contributors",fontSize:10,fontFamily:"Roboto",fill:i.text,opacity:.5,align:"right"});Pe.offsetX(Pe.width()),v.add(Pe),v.batchDraw(),u&&u("Done",100)}catch(q){console.error("Background rendering error",q),u&&u("Error",0)}})(),m}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})};var W1=["posterContainer"],Z1=["posterWrapper"];function q1(r,e){if(r&1&&(Et(0,"div",4),Yt(1,"div",7),qt()),r&2){let t,i=ke();ae(),mu("width",i.loadingProgress(),"%")("background-color",((t=i.theme())==null?null:t.text)||"#ffffff")}}var bo=class r{mapData=Ue(null);theme=Ue(null);city=Ue("");country=Ue("");coords=Ue(null);distance=Ue(1e4);isLoading=Ue(!1);posterContainer;posterWrapper;posterService=U(ia);stage=De(null);loadingProgress=De(0);loadingMessage=De("Generating...");viewReady=De(!1);isExporting=De(!1);resizeObserver;constructor(){Vn(async()=>{let e=this.mapData(),t=this.theme(),i=this.coords(),o=this.distance(),a=this.isLoading(),l=this.viewReady();if(e&&t&&i&&!a&&l&&this.posterContainer){let h=lt(()=>this.stage());h&&h.destroy(),this.loadingProgress.set(0),this.loadingMessage.set("Starting...");try{let u=await this.posterService.generatePoster(this.posterContainer.nativeElement.id,e,t,this.city(),this.country(),i,o,(f,g)=>{this.loadingProgress.set(g),lt(()=>this.loadingMessage())!==f&&(console.log(`[Poster Generation] ${f} (${g}%)`),this.loadingMessage.set(f))});this.stage.set(u),this.loadingProgress.set(100),this.loadingMessage.set("Done"),setTimeout(()=>this.updateScale(),0)}catch(u){console.error("Poster Generation Error:",u),this.loadingMessage.set("Error generating poster"),this.loadingProgress.set(0)}}})}ngAfterViewInit(){this.viewReady.set(!0),this.posterWrapper&&(this.resizeObserver=new ResizeObserver(()=>{this.updateScale()}),this.resizeObserver.observe(this.posterWrapper.nativeElement))}ngOnDestroy(){this.resizeObserver?.disconnect();let e=this.stage();e&&(e.getLayers().forEach(t=>{t.destroyChildren(),t.destroy()}),e.destroy(),this.stage.set(null))}updateScale(){let e=this.stage();if(!e||!this.posterContainer||!this.posterWrapper)return;let t=this.posterWrapper.nativeElement.getBoundingClientRect(),i=e.width(),o=e.height();if(t.width===0||t.height===0)return;let a=60,l=t.width-a,h=t.height-a,u=Math.min(l/i,h/o),f=this.posterContainer.nativeElement;f.style.width=`${i}px`,f.style.height=`${o}px`,f.style.transform=`scale(${u})`,f.style.transformOrigin="top left";let g=f.parentElement;g&&(g.style.width=`${i*u}px`,g.style.height=`${o*u}px`)}download(e=2){let t=this.stage();if(!t||this.isExporting())return;this.isExporting.set(!0);let i=e===1?"HD":e===2?"QHD":"4K",o=`${this.city()}_${this.theme()?.name||"style"}_${i}.png`;t.toCanvas({pixelRatio:e}).toBlob(l=>{if(l){let h=URL.createObjectURL(l),u=document.createElement("a");u.download=o,u.href=h,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(h)}this.isExporting.set(!1)},"image/png")}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-poster-view"]],viewQuery:function(t,i){if(t&1&&Ui(W1,5)(Z1,5),t&2){let o;ci(o=hi())&&(i.posterContainer=o.first),ci(o=hi())&&(i.posterWrapper=o.first)}},inputs:{mapData:[1,"mapData"],theme:[1,"theme"],city:[1,"city"],country:[1,"country"],coords:[1,"coords"],distance:[1,"distance"],isLoading:[1,"isLoading"]},decls:7,vars:1,consts:[["posterWrapper",""],["posterContainer",""],[1,"poster-wrapper"],[1,"w-full","h-full","flex","items-center","justify-center","overflow-hidden","bg-black","relative"],[1,"absolute","top-0","left-0","w-full","h-1","z-[99999]"],["id","poster-container-wrapper",1,"poster-container-wrapper"],["id","poster-container",1,"poster-container"],[1,"loading-bar","transition-all","duration-300","ease-out","shadow-[0_0_10px_rgba(255,255,255,0.5)]"]],template:function(t,i){t&1&&(Et(0,"div",2,0)(2,"div",3),wt(3,q1,2,4,"div",4),Et(4,"div",5),Yt(5,"div",6,1),qt()()()),t&2&&(ae(3),bt(i.isLoading()||i.loadingProgress()<100?3:-1))},dependencies:[st],styles:[".poster-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;overflow:hidden;padding:20px}.poster-container-wrapper[_ngcontent-%COMP%]{position:relative;display:block;box-shadow:0 4px 50px #00000080}.poster-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;transform-origin:top left;background:#fff}.loading-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#121212e6;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:200;color:#fff}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;font-family:Roboto,sans-serif;font-size:1.2rem;letter-spacing:1px;font-weight:300}.loading-bar[_ngcontent-%COMP%]{height:5px}"],changeDetection:0})};var Dp=(()=>{class r{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||r)(tt(es),tt(Xo))};static \u0275dir=Wt({type:r})}return r})(),xp=(()=>{class r extends Dp{static \u0275fac=(()=>{let t;return function(o){return(t||(t=Vi(r)))(o||r)}})();static \u0275dir=Wt({type:r,features:[li]})}return r})(),ca=new ye("");var Y1={provide:ca,useExisting:kr(()=>vr),multi:!0};function X1(){let r=Vt()?Vt().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}var K1=new ye(""),vr=(()=>{class r extends Dp{_compositionMode;_composing=!1;constructor(t,i,o){super(t,i),this._compositionMode=o,this._compositionMode==null&&(this._compositionMode=!X1())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||r)(tt(es),tt(Xo),tt(K1,8))};static \u0275dir=Wt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&Ve("input",function(l){return o._handleInput(l.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(l){return o._compositionEnd(l.target.value)})},standalone:!1,features:[Br([Y1]),li]})}return r})();var Ep=new ye(""),Mp=new ye("");function Tp(r){return r!=null}function Pp(r){return ts(r)?Nt(r):r}function Ap(r){let e={};return r.forEach(t=>{e=t!=null?j(j({},e),t):e}),Object.keys(e).length===0?null:e}function Rp(r,e){return e.map(t=>t(r))}function J1(r){return!r.validate}function Op(r){return r.map(e=>J1(e)?e:t=>e.validate(t))}function Q1(r){if(!r)return null;let e=r.filter(Tp);return e.length==0?null:function(t){return Ap(Rp(t,e))}}function Ip(r){return r!=null?Q1(Op(r)):null}function ey(r){if(!r)return null;let e=r.filter(Tp);return e.length==0?null:function(t){let i=Rp(t,e).map(Pp);return Zo(i).pipe(Be(Ap))}}function Lp(r){return r!=null?ey(Op(r)):null}function _p(r,e){return r===null?[e]:Array.isArray(r)?[...r,e]:[r,e]}function kp(r){return r._rawValidators}function Fp(r){return r._rawAsyncValidators}function Oc(r){return r?Array.isArray(r)?r:[r]:[]}function oa(r,e){return Array.isArray(r)?r.includes(e):r===e}function vp(r,e){let t=Oc(e);return Oc(r).forEach(o=>{oa(t,o)||t.push(o)}),t}function yp(r,e){return Oc(e).filter(t=>!oa(r,t))}var sa=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ip(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Lp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ic=class extends sa{name;get formDirective(){return null}get path(){return null}},Di=class extends sa{_parent=null;name=null;valueAccessor=null},Lc=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var ha=(()=>{class r extends Lc{constructor(t){super(t)}static \u0275fac=function(i){return new(i||r)(tt(Di,2))};static \u0275dir=Wt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&fn("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},standalone:!1,features:[li]})}return r})();var Co="VALID",ra="INVALID",mr="PENDING",So="DISABLED",xi=class{},aa=class extends xi{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Do=class extends xi{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},xo=class extends xi{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},_r=class extends xi{status;source;constructor(e,t){super(),this.status=e,this.source=t}};var kc=class extends xi{source;constructor(e){super(),this.source=e}};function ty(r){return(ua(r)?r.validators:r)||null}function ny(r){return Array.isArray(r)?Ip(r):r||null}function iy(r,e){return(ua(e)?e.asyncValidators:r)||null}function ry(r){return Array.isArray(r)?Lp(r):r||null}function ua(r){return r!=null&&!Array.isArray(r)&&typeof r=="object"}var Fc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return lt(this.statusReactive)}set status(e){lt(()=>this.statusReactive.set(e))}_status=ui(()=>this.statusReactive());statusReactive=De(void 0);get valid(){return this.status===Co}get invalid(){return this.status===ra}get pending(){return this.status==mr}get disabled(){return this.status===So}get enabled(){return this.status!==So}errors;get pristine(){return lt(this.pristineReactive)}set pristine(e){lt(()=>this.pristineReactive.set(e))}_pristine=ui(()=>this.pristineReactive());pristineReactive=De(!0);get dirty(){return!this.pristine}get touched(){return lt(this.touchedReactive)}set touched(e){lt(()=>this.touchedReactive.set(e))}_touched=ui(()=>this.touchedReactive());touchedReactive=De(!1);get untouched(){return!this.touched}_events=new cn;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(vp(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(vp(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(yp(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(yp(e,this._rawAsyncValidators))}hasValidator(e){return oa(this._rawValidators,e)}hasAsyncValidator(e){return oa(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(Oe(j({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new xo(!0,i))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:i})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,i),t&&e.emitEvent!==!1&&this._events.next(new xo(!1,i))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let i=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(Oe(j({},e),{sourceControl:i})),t&&e.emitEvent!==!1&&this._events.next(new Do(!1,i))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=e.sourceControl??this;this._forEachChild(o=>{o.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,i),t&&e.emitEvent!==!1&&this._events.next(new Do(!0,i))}markAsPending(e={}){this.status=mr;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _r(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(Oe(j({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=So,this.errors=null,this._forEachChild(o=>{o.disable(Oe(j({},e),{onlySelf:!0}))}),this._updateValue();let i=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new aa(this.value,i)),this._events.next(new _r(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Oe(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(o=>o(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Co,this._forEachChild(i=>{i.enable(Oe(j({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Oe(j({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Co||this.status===mr)&&this._runAsyncValidator(i,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new aa(this.value,t)),this._events.next(new _r(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(Oe(j({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?So:Co}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=mr,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let i=Pp(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(o=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(o,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,o)=>i&&i._find(o),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,i){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||i)&&this._events.next(new _r(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,i)}_initObservables(){this.valueChanges=new $t,this.statusChanges=new $t}_calculateStatus(){return this._allControlsDisabled()?So:this.errors?ra:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(mr)?mr:this._anyControlsHaveStatus(ra)?ra:Co}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let i=!this._anyControlsDirty(),o=this.pristine!==i;this.pristine=i,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),o&&this._events.next(new Do(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new xo(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ua(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=ny(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=ry(this._rawAsyncValidators)}};var da=new ye("",{factory:()=>fa}),fa="always";function oy(r,e){return[...e.path,r]}function Np(r,e,t=fa){ay(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(r.disabled),cy(r,e),uy(r,e),hy(r,e),sy(r,e)}function wp(r,e,t=!0){let i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),ly(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function la(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function sy(r,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}function ay(r,e){let t=kp(r);e.validator!==null?r.setValidators(_p(t,e.validator)):typeof t=="function"&&r.setValidators([t]);let i=Fp(r);e.asyncValidator!==null?r.setAsyncValidators(_p(i,e.asyncValidator)):typeof i=="function"&&r.setAsyncValidators([i]);let o=()=>r.updateValueAndValidity();la(e._rawValidators,o),la(e._rawAsyncValidators,o)}function ly(r,e){let t=!1;if(r!==null){if(e.validator!==null){let o=kp(r);if(Array.isArray(o)&&o.length>0){let a=o.filter(l=>l!==e.validator);a.length!==o.length&&(t=!0,r.setValidators(a))}}if(e.asyncValidator!==null){let o=Fp(r);if(Array.isArray(o)&&o.length>0){let a=o.filter(l=>l!==e.asyncValidator);a.length!==o.length&&(t=!0,r.setAsyncValidators(a))}}}let i=()=>{};return la(e._rawValidators,i),la(e._rawAsyncValidators,i),t}function cy(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,r.updateOn==="change"&&Bp(r,e)})}function hy(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,r.updateOn==="blur"&&r._pendingChange&&Bp(r,e),r.updateOn!=="submit"&&r.markAsTouched()})}function Bp(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function uy(r,e){let t=(i,o)=>{e.valueAccessor.writeValue(i),o&&e.viewToModelUpdate(i)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}function Vp(r,e){if(!r.hasOwnProperty("model"))return!1;let t=r.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function dy(r){return Object.getPrototypeOf(r.constructor)===xp}function zp(r,e){if(!e)return null;Array.isArray(e);let t,i,o;return e.forEach(a=>{a.constructor===vr?t=a:dy(a)?i=a:o=a}),o||i||t||null}function bp(r,e){let t=r.indexOf(e);t>-1&&r.splice(t,1)}function Cp(r){return typeof r=="object"&&r!==null&&Object.keys(r).length===2&&"value"in r&&"disabled"in r}var Nc=class extends Fc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,i){super(ty(t),iy(i,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ua(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Cp(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new kc(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){bp(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){bp(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Cp(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var fy={provide:Di,useExisting:kr(()=>Bc)},Sp=Promise.resolve(),Bc=(()=>{class r extends Di{_changeDetectorRef;callSetDisabledState;control=new Nc;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new $t;constructor(t,i,o,a,l,h){super(),this._changeDetectorRef=l,this.callSetDisabledState=h,this._parent=t,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=zp(this,a)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Vp(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Np(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Sp.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,o=i!==0&&al(i);Sp.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?oy(t,this._parent):[t]}static \u0275fac=function(i){return new(i||r)(tt(Ic,9),tt(Ep,10),tt(Mp,10),tt(ca,10),tt(Vr,8),tt(da,8))};static \u0275dir=Wt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Br([fy]),li,Bi]})}return r})();var py={provide:ca,useExisting:kr(()=>Vc),multi:!0},Vc=(()=>{class r extends xp{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let t;return function(o){return(t||(t=Vi(r)))(o||r)}})();static \u0275dir=Wt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(i,o){i&1&&Ve("change",function(l){return o.onChange(l.target.value)})("input",function(l){return o.onChange(l.target.value)})("blur",function(){return o.onTouched()})},standalone:!1,features:[Br([py]),li]})}return r})();var Up=new ye(""),gy={provide:Di,useExisting:kr(()=>zc)},zc=(()=>{class r extends Di{_ngModelWarningConfig;callSetDisabledState;viewModel;form;set isDisabled(t){}model;update=new $t;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,i,o,a,l){super(),this._ngModelWarningConfig=a,this.callSetDisabledState=l,this._setValidators(t),this._setAsyncValidators(i),this.valueAccessor=zp(this,o)}ngOnChanges(t){if(this._isControlChanged(t)){let i=t.form.previousValue;i&&wp(i,this,!1),Np(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}Vp(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&wp(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}static \u0275fac=function(i){return new(i||r)(tt(Ep,10),tt(Mp,10),tt(ca,10),tt(Up,8),tt(da,8))};static \u0275dir=Wt({type:r,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],standalone:!1,features:[Br([gy]),li,Bi]})}return r})();var Gp=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=En({type:r});static \u0275inj=xn({})}return r})();var jp=(()=>{class r{static withConfig(t){return{ngModule:r,providers:[{provide:da,useValue:t.callSetDisabledState??fa}]}}static \u0275fac=function(i){return new(i||r)};static \u0275mod=En({type:r});static \u0275inj=xn({imports:[Gp]})}return r})(),Hp=(()=>{class r{static withConfig(t){return{ngModule:r,providers:[{provide:Up,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:da,useValue:t.callSetDisabledState??fa}]}}static \u0275fac=function(i){return new(i||r)};static \u0275mod=En({type:r});static \u0275inj=xn({imports:[Gp]})}return r})();var my=(r,e)=>e.place_id;function _y(r,e){if(r&1){let t=Xt();oe(0,"button",8),Ve("click",function(){Je(t);let o=ke();return Qe(o.clearSearch())}),Ie(1,"\xD7"),he()}}function vy(r,e){if(r&1){let t=Xt();oe(0,"li",9),Ve("click",function(){let o=Je(t).$implicit,a=ke(2);return Qe(a.selectSuggestion(o))}),oe(1,"span",10),Ie(2),he(),oe(3,"span",11),Ie(4),he()()}if(r&2){let t=e.$implicit;ae(2),Mn(t.display_name.split(",")[0]),ae(2),Mn(t.display_name)}}function yy(r,e){if(r&1&&(oe(0,"ul",7),zn(1,vy,5,2,"li",null,my),he()),r&2){let t=ke();ae(),Un(t.suggestions())}}var pa=class r{geocoding=U(or);searchControl=new Nc("");suggestions=De([]);showSuggestions=De(!1);locationSelected=Gn();constructor(){this.searchControl.valueChanges.pipe(Qh(300),eu(),hn(e=>(e?.length??0)>2),Bt(e=>this.geocoding.search(e))).subscribe(e=>{this.suggestions.set(e),this.showSuggestions.set(!0)})}selectSuggestion(e){this.searchControl.setValue(e.display_name.split(",")[0],{emitEvent:!1}),this.showSuggestions.set(!1),this.locationSelected.emit(e)}clearSearch(){this.searchControl.setValue(""),this.suggestions.set([])}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-search-bar"]],outputs:{locationSelected:"locationSelected"},decls:8,vars:3,consts:[[1,"search-container"],[1,"input-wrapper"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["placeholder","Search for a city...","type","text",3,"focus","formControl"],[1,"clear-btn"],[1,"suggestions-list"],[1,"clear-btn",3,"click"],[3,"click"],[1,"main-text"],[1,"sub-text"]],template:function(t,i){t&1&&(oe(0,"div",0)(1,"div",1),dn(),oe(2,"svg",2),nt(3,"circle",3)(4,"line",4),he(),Bn(),oe(5,"input",5),Ve("focus",function(){return i.showSuggestions.set(!0)}),he(),wt(6,_y,2,0,"button",6),he(),wt(7,yy,3,0,"ul",7),he()),t&2&&(ae(5),gt("formControl",i.searchControl),ae(),bt(i.searchControl.value?6:-1),ae(),bt(i.showSuggestions()&&i.suggestions().length>0?7:-1))},dependencies:[st,Hp,vr,ha,zc],styles:[".search-container[_ngcontent-%COMP%]{position:absolute;top:20px;left:50%;transform:translate(-50%);width:90%;max-width:400px;z-index:2000;font-family:Inter,sans-serif}.input-wrapper[_ngcontent-%COMP%]{background:#1e1e1ee6;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:25px;padding:10px 20px;display:flex;align-items:center;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1)}.icon[_ngcontent-%COMP%]{color:#aaa;margin-right:10px;width:18px;height:18px}input[_ngcontent-%COMP%]{background:transparent;border:none;color:#fff;width:100%;font-size:16px;outline:none}.clear-btn[_ngcontent-%COMP%]{background:none;border:none;color:#aaa;font-size:20px;cursor:pointer;padding:0 5px}.suggestions-list[_ngcontent-%COMP%]{list-style:none;margin:10px 0 0;padding:0;background:#1e1e1ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1)}li[_ngcontent-%COMP%]{padding:12px 20px;cursor:pointer;border-bottom:1px solid rgba(255,255,255,.05);display:flex;flex-direction:column}li[_ngcontent-%COMP%]:last-child{border-bottom:none}li[_ngcontent-%COMP%]:hover{background:#ffffff1a}.main-text[_ngcontent-%COMP%]{color:#fff;font-weight:500;font-size:15px}.sub-text[_ngcontent-%COMP%]{color:#aaa;font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})};function wy(r,e){if(r&1&&(dn(),Et(0,"svg",0),Yt(1,"rect",2)(2,"path",3)(3,"path",4)(4,"path",5),Et(5,"g",6),Yt(6,"path",7)(7,"path",8)(8,"path",9)(9,"path",10),qt(),Et(10,"g",11),Yt(11,"path",12)(12,"path",13)(13,"path",14)(14,"path",15),qt(),Yt(15,"path",16),Et(16,"text",17),Ie(17,"MAP"),qt(),Et(18,"text",18),Ie(19,"PREVIEW"),qt()()),r&2){let t=e;ae(),Zt("fill",t.bg),ae(),Zt("fill",t.water),ae(),Zt("fill",t.water),ae(),Zt("fill",t.parks),ae(),Zt("stroke",t.road_primary),ae(5),Zt("stroke",t.road_secondary),ae(5),Zt("stroke",t.road_motorway),ae(),Zt("fill",t.text),ae(2),Zt("fill",t.text)}}function by(r,e){r&1&&Yt(0,"div",1)}var yr=class r{theme=Ue(null);static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-theme-preview-svg"]],inputs:{theme:[1,"theme"]},decls:2,vars:1,consts:[["viewBox","0 0 100 140","xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","xMidYMid slice",1,"preview-svg"],[1,"skeleton"],["width","100","height","140"],["d","M0,60 C30,50 40,80 60,75 S90,60 100,70 L100,140 L0,140 Z","opacity","0.3"],["d","M-10,120 C20,115 50,125 100,110 L100,140 L-10,140 Z"],["d","M10,20 Q25,10 40,25 T70,30 Q80,10 90,25 L95,60 Q80,70 60,65 T20,80 Z","opacity","0.8"],["stroke-width","2","fill","none","stroke-linecap","round"],["d","M30,-5 L30,145"],["d","M70,-5 L70,145"],["d","M-5,40 L105,50"],["d","M-5,90 L105,80"],["stroke-width","1","fill","none","stroke-opacity","0.8"],["d","M50,-5 L50,145"],["d","M-5,20 L105,25"],["d","M-5,60 L105,65"],["d","M-5,110 L105,105"],["d","M-5,100 C30,95 60,105 105,90","stroke-width","3","fill","none"],["x","50","y","125","font-family","Roboto, sans-serif","font-size","8","font-weight","bold","text-anchor","middle","letter-spacing","1"],["x","50","y","133","font-family","Roboto, sans-serif","font-size","4","font-weight","normal","text-anchor","middle","letter-spacing","0.5","opacity","0.7"]],template:function(t,i){if(t&1&&wt(0,wy,20,9,":svg:svg",0)(1,by,1,0,"div",1),t&2){let o;bt((o=i.theme())?0:1,o)}},dependencies:[st],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}.preview-svg[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:inherit}.skeleton[_ngcontent-%COMP%]{width:100%;height:100%;background:#444;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:.6}50%{opacity:1}to{opacity:.6}}"]})};function Cy(r,e){if(r&1){let t=Xt();oe(0,"div",6),Ve("click",function(){let o=Je(t).$implicit,a=ke();return Qe(a.selectTheme(o))}),oe(1,"div",7),nt(2,"app-theme-preview-svg",8),oe(3,"span",9),Ie(4),he()()()}if(r&2){let t=e.$implicit,i=ke();fn("active",i.currentTheme()===t),ae(2),gt("theme",i.themeData()[t]),ae(2),Mn(t)}}var ga=class r{themeService=U(qn);themes=Ue([]);currentTheme=Ue("");themeSelected=Gn();themeData=De({});constructor(){Vn(()=>{let e=this.themes();e.length>0&&this.loadThemes(e)})}loadThemes(e){e.forEach(t=>{this.themeData()[t]||this.themeService.loadTheme(t).subscribe(i=>{this.themeData.update(o=>Oe(j({},o),{[t]:i}))})})}selectTheme(e){this.themeSelected.emit(e)}onWheel(e,t){e.deltaY!==0&&(e.preventDefault(),t.scrollLeft+=e.deltaY+e.deltaX)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-style-selector"]],inputs:{themes:[1,"themes"],currentTheme:[1,"currentTheme"]},outputs:{themeSelected:"themeSelected"},decls:10,vars:0,consts:[["scrollContainer",""],[1,"selector-container"],[1,"header"],[1,"badge"],[1,"styles-scroll",3,"wheel"],[1,"style-card",3,"active"],[1,"style-card",3,"click"],[1,"preview"],[3,"theme"],[1,"theme-name"]],template:function(t,i){if(t&1){let o=Xt();oe(0,"div",1)(1,"div",2)(2,"h3"),Ie(3,"Styles"),he(),oe(4,"span",3),Ie(5,"Curated"),he()(),oe(6,"div",4,0),Ve("wheel",function(l){Je(o);let h=gu(7);return Qe(i.onWheel(l,h))}),zn(8,Cy,5,4,"div",5,ns),he()()}t&2&&(ae(8),Un(i.themes()))},dependencies:[st,yr],styles:[".selector-container[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;background:#141414f2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-top-left-radius:25px;border-top-right-radius:25px;padding:20px 0;z-index:1000;box-shadow:0 -5px 20px #00000080;font-family:Inter,sans-serif}.header[_ngcontent-%COMP%]{padding:0 25px 15px;display:flex;align-items:center;gap:10px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:18px;font-weight:600}.header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#ffffff1a;color:#aaa;font-size:11px;padding:2px 8px;border-radius:10px}.styles-scroll[_ngcontent-%COMP%]{display:flex;gap:15px;overflow-x:auto;padding:0 25px 10px;scroll-behavior:smooth}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.styles-scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff4d}.style-card[_ngcontent-%COMP%]{flex:0 0 100px;cursor:pointer;transition:transform .2s}.style-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.style-card.active[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{border:2px solid #fff;transform:scale(1.05)}.preview[_ngcontent-%COMP%]{height:140px;border-radius:18px;display:flex;align-items:flex-end;padding:10px;background:#333;position:relative;overflow:hidden;border:2px solid transparent;transition:all .2s}app-theme-preview-svg[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:0}.theme-name[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:500;text-shadow:0 1px 3px rgb(0,0,0);z-index:1;position:relative;text-transform:capitalize}"]})};var ma=class r{distance=Ue.required();distanceChange=Gn();displayValue=ui(()=>(this.distance()/1e3).toFixed(1));onValueChange(e){this.distanceChange.emit(e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-distance-control"]],inputs:{distance:[1,"distance"]},outputs:{distanceChange:"distanceChange"},decls:13,vars:2,consts:[[1,"distance-container"],[1,"label"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["d","M21 6H3"],["d","M21 18H3"],["d","M3 6v12"],["d","M21 6v12"],["d","M7 6v12"],["d","M17 6v12"],[1,"slider-wrapper"],["type","range","min","1000","max","25000","step","500",1,"custom-range",3,"ngModelChange","ngModel"]],template:function(t,i){t&1&&(oe(0,"div",0)(1,"div",1),dn(),oe(2,"svg",2),nt(3,"path",3)(4,"path",4)(5,"path",5)(6,"path",6)(7,"path",7)(8,"path",8),he(),Bn(),oe(9,"span"),Ie(10),he()(),oe(11,"div",9)(12,"input",10),Ve("ngModelChange",function(a){return i.onValueChange(a)}),he()()()),t&2&&(ae(10),vu("Distance: ",i.displayValue()," km"),ae(2),gt("ngModel",i.distance()))},dependencies:[st,jp,vr,Vc,ha,Bc],styles:[".distance-container[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;left:auto;transform:none;width:250px;z-index:1000;background:var(--surface-glass, rgba(30, 30, 30, .9));backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:20px;padding:15px 20px;box-shadow:var(--shadow-glass, 0 8px 32px 0 rgba(0, 0, 0, .37));border:1px solid var(--border-glass, rgba(255, 255, 255, .1));display:flex;flex-direction:column;gap:10px;transition:opacity .3s}.label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:var(--text-secondary, #aaa);font-size:13px;font-weight:500}.label[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:16px;height:16px}.slider-wrapper[_ngcontent-%COMP%]{width:100%;padding:5px 0}.custom-range[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:6px;background:#444;border-radius:3px;outline:none;cursor:pointer}.custom-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:18px;height:18px;background:var(--primary-color, #6200ee);border-radius:50%;border:2px solid white;box-shadow:0 2px 5px #0000004d;transition:transform .1s}.custom-range[_ngcontent-%COMP%]::-webkit-slider-thumb:hover{transform:scale(1.1)}.custom-range[_ngcontent-%COMP%]::-moz-range-thumb{width:18px;height:18px;background:var(--primary-color, #6200ee);border-radius:50%;border:2px solid white;cursor:pointer;box-shadow:0 2px 5px #0000004d}"]})};var Sy=(r,e)=>e.id;function Dy(r,e){if(r&1&&(Et(0,"div",2)(1,"span"),Ie(2),qt()()),r&2){let t=e.$implicit;_u(t.type),ae(2),Mn(t.message)}}var Eo=class r{toasts=De([]);show(e,t="info"){let i=Date.now();this.toasts.update(o=>[...o,{id:i,message:e,type:t}]),setTimeout(()=>this.remove(i),3e3)}remove(e){this.toasts.update(t=>t.filter(i=>i.id!==e))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=ie({token:r,factory:r.\u0275fac,providedIn:"root"})},_a=class r{toastService=U(Eo);toasts=this.toastService.toasts;static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-toast-container"]],decls:3,vars:0,consts:[[1,"toast-container"],[1,"toast",3,"class"],[1,"toast"]],template:function(t,i){t&1&&(Et(0,"div",0),zn(1,Dy,3,3,"div",1,Sy),qt()),t&2&&(ae(),Un(i.toasts()))},dependencies:[st],styles:[".toast-container[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);display:flex;flex-direction:column;gap:10px;z-index:9999;pointer-events:none}.toast[_ngcontent-%COMP%]{background:#1e1e1ef2;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);color:#fff;padding:12px 24px;border-radius:12px;box-shadow:0 4px 15px #0000004d;border:1px solid rgba(255,255,255,.1);font-size:14px;animation:_ngcontent-%COMP%_slideUp .3s ease-out;display:flex;align-items:center}.toast.error[_ngcontent-%COMP%]{border-left:4px solid #cf6679}.toast.success[_ngcontent-%COMP%]{border-left:4px solid #03dac6}.toast.info[_ngcontent-%COMP%]{border-left:4px solid #6200ee}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};function xy(r,e){if(r&1&&nt(0,"app-theme-preview-svg",5),r&2){let t=ke().$implicit,i=ke();gt("theme",i.themeData()[t])}}function Ey(r,e){if(r&1){let t=Xt();oe(0,"div",3),Ve("click",function(){let o=Je(t).$implicit,a=ke();return Qe(a.selectTheme(o))}),oe(1,"div",4),wt(2,xy,1,1,"app-theme-preview-svg",5),he(),oe(3,"div",6)(4,"span",7),Ie(5),he(),oe(6,"span",8),Ie(7,"Click to apply"),he()()()}if(r&2){let t=e.$implicit,i=ke();fn("active",i.currentTheme()===t),ae(2),bt(i.themeData()[t]?2:-1),ae(3),Mn(t.replace("_"," "))}}var va=class r{themeService=U(qn);themes=Ue([]);currentTheme=Ue("");themeSelected=Gn();themeData=De({});constructor(){Vn(()=>{let e=this.themes();e.length>0&&this.loadThemes(e)})}loadThemes(e){e.forEach(t=>{this.themeData()[t]||this.themeService.loadTheme(t).subscribe(i=>{this.themeData.update(o=>Oe(j({},o),{[t]:i}))})})}selectTheme(e){this.themeSelected.emit(e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-sidebar-style-selector"]],inputs:{themes:[1,"themes"],currentTheme:[1,"currentTheme"]},outputs:{themeSelected:"themeSelected"},decls:4,vars:0,consts:[[1,"sidebar-selector"],[1,"list-container"],[1,"theme-item",3,"active"],[1,"theme-item",3,"click"],[1,"preview-box"],[3,"theme"],[1,"theme-info"],[1,"name"],[1,"helper"]],template:function(t,i){t&1&&(oe(0,"div",0)(1,"div",1),zn(2,Ey,8,4,"div",2,ns),he()()),t&2&&(ae(2),Un(i.themes()))},dependencies:[st,yr],styles:[".sidebar-selector[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:auto;overflow-x:hidden;padding:0 5px 0 0}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.sidebar-selector[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding-bottom:20px}.theme-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px;background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:12px;cursor:pointer;transition:all .2s ease}.theme-item[_ngcontent-%COMP%]:hover{background:#ffffff1a;border-color:#ffffff4d}.theme-item.active[_ngcontent-%COMP%]{background:rgba(var(--primary-rgb, 100, 100, 255),.2);border-color:rgba(var(--primary-rgb, 100, 100, 255),.6);box-shadow:0 0 15px rgba(var(--primary-rgb, 100, 100, 255),.1)}.theme-item.active[_ngcontent-%COMP%]   .theme-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:#fff;font-weight:700}.preview-box[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:8px;overflow:hidden;position:relative;background:#222;flex-shrink:0;border:1px solid rgba(255,255,255,.1)}.preview-box[_ngcontent-%COMP%]   app-theme-preview-svg[_ngcontent-%COMP%]{width:100%;height:100%;display:block}.theme-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.theme-info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:1rem;color:#eee;text-transform:capitalize;font-weight:500;margin-bottom:2px}.theme-info[_ngcontent-%COMP%]   .helper[_ngcontent-%COMP%]{font-size:.75rem;color:#888}"],changeDetection:0})};var My=(r,e)=>({lat:r,lon:e});function Ty(r,e){if(r&1){let t=Xt();oe(0,"div",3)(1,"div",5),nt(2,"app-poster-view",6),oe(3,"button",7),Ve("click",function(){Je(t);let o=ke();return Qe(o.closePoster())}),dn(),oe(4,"svg",8),nt(5,"line",9)(6,"line",10),he()()(),Bn(),oe(7,"div",11)(8,"div",12)(9,"h2"),Ie(10,"Your Art"),he(),oe(11,"p"),Ie(12,"Ready for print"),he()(),oe(13,"div",13)(14,"button",14),Ve("click",function(){Je(t);let o=ke();return Qe(o.downloadPoster(o.resolution()))}),dn(),oe(15,"svg",8),nt(16,"path",15)(17,"polyline",16)(18,"line",17),he(),Ie(19," Download PNG "),he(),Bn(),oe(20,"div",18)(21,"span",19),Ie(22,"Resolution:"),he(),oe(23,"div",20)(24,"button",21),Ve("click",function(){Je(t);let o=ke();return Qe(o.resolution.set(1))}),Ie(25,"1080p"),he(),oe(26,"button",21),Ve("click",function(){Je(t);let o=ke();return Qe(o.resolution.set(2))}),Ie(27,"4K"),he(),oe(28,"button",21),Ve("click",function(){Je(t);let o=ke();return Qe(o.resolution.set(3))}),Ie(29,"8K"),he()()()(),oe(30,"div",22)(31,"h3"),Ie(32,"Try other styles"),he(),oe(33,"app-sidebar-style-selector",23),Ve("themeSelected",function(o){Je(t);let a=ke();return Qe(a.onThemeSelected(o))}),he()()()()}if(r&2){let t=ke();ae(2),gt("isLoading",t.isLoading())("city",t.city())("country",t.country())("coords",yu(15,My,t.lat(),t.lon()))("distance",t.distance())("theme",t.currentTheme())("mapData",t.mapData()),ae(22),fn("active",t.resolution()===1),ae(2),fn("active",t.resolution()===2),ae(2),fn("active",t.resolution()===3),ae(5),gt("themes",t.themes)("currentTheme",t.currentThemeName())}}function Py(r,e){r&1&&nt(0,"div",28)}function Ay(r,e){r&1&&(dn(),oe(0,"svg",8),nt(1,"path",29)(2,"path",30),he(),Bn(),oe(3,"span"),Ie(4,"Generate Art"),he())}function Ry(r,e){if(r&1){let t=Xt();oe(0,"app-search-bar",24),Ve("locationSelected",function(o){Je(t);let a=ke();return Qe(a.onLocationSelected(o))}),he(),oe(1,"app-distance-control",25),Ve("distanceChange",function(o){Je(t);let a=ke();return Qe(a.distance.set(o))}),he(),oe(2,"app-style-selector",23),Ve("themeSelected",function(o){Je(t);let a=ke();return Qe(a.onThemeSelected(o))}),he(),oe(3,"div",26)(4,"button",27),Ve("click",function(){Je(t);let o=ke();return Qe(o.generatePoster())}),wt(5,Py,1,0,"div",28)(6,Ay,5,0),he()()}if(r&2){let t=ke();ae(),gt("distance",t.distance()),ae(),gt("themes",t.themes)("currentTheme",t.currentThemeName()),ae(2),gt("disabled",t.isLoading()),ae(),bt(t.isLoading()?5:6)}}function Oy(r,e){r&1&&(oe(0,"div",4)(1,"div",31),nt(2,"div",32),oe(3,"p"),Ie(4,"Fetching Map Data..."),he()()())}var ya=class r{geocodingService=U(or);themeService=U(qn);overpassService=U(Ls);toastService=U(Eo);lat=De(45.1885);lon=De(5.7245);distance=De(1e4);city=De("Grenoble");country=De("France");themes=this.themeService.getAvailableThemes();currentThemeName=De("midnight_blue");currentTheme=De(null);mapData=De(null);isLoading=De(!1);showPoster=De(!1);constructor(){this.loadTheme(this.currentThemeName())}onLocationSelected(e){this.lat.set(parseFloat(e.lat)),this.lon.set(parseFloat(e.lon));let t=e.display_name.split(", ");this.city.set(t[0]),this.country.set(t[t.length-1]),this.showPoster.set(!1)}onThemeSelected(e){this.currentThemeName.set(e),this.loadTheme(e),this.toastService.show(`Theme '${e}' selected.`,"info")}loadTheme(e){this.themeService.loadTheme(e).subscribe(t=>{this.currentTheme.set(t)})}posterView;closePoster(){this.showPoster.set(!1),this.mapData.set(null)}generatePoster(){this.distance()>15e3&&this.toastService.show("\u26A0\uFE0F Large area selected. This may take a while and use significant memory.","info"),this.showPoster.set(!1),this.isLoading.set(!0);let e=this.distance()*(4/3),t=this.overpassService.getBbox(this.lat(),this.lon(),this.distance(),e),i=this.distance()>1e4;this.overpassService.fetchMapDataSmart(t,i,this.distance()).pipe(Ir(o=>{console.error("Error fetching data",o);let a="Error fetching map data. Try a smaller area or different location.";return o.status===504?a="Server timeout (504). Try a smaller area.":o.status===429?a="Too many requests (429). Please wait a bit.":o.status===400&&(a="Bad request (400). The area may be too large."),this.toastService.show(a,"error"),this.isLoading.set(!1),_e(null)})).subscribe(o=>{o&&(this.mapData.set(o),this.showPoster.set(!0)),this.isLoading.set(!1)})}resolution=De(2);downloadPoster(e){this.posterView?.download(e)}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=Xe({type:r,selectors:[["app-root"]],viewQuery:function(t,i){if(t&1&&Ui(bo,5),t&2){let o;ci(o=hi())&&(i.posterView=o.first)}},decls:7,vars:6,consts:[[1,"app-container"],[1,"map-layer"],[3,"lat","lon","distance"],[1,"poster-layer"],[1,"loading-overlay"],[1,"poster-preview-area"],[3,"isLoading","city","country","coords","distance","theme","mapData"],[1,"close-poster-btn","custom-btn","icon-only",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"icon"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"poster-sidebar"],[1,"sidebar-header"],[1,"download-section"],[1,"custom-btn","primary","full-width",3,"click"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","7 10 12 15 17 10"],["x1","12","y1","15","x2","12","y2","3"],[1,"resolution-options"],[1,"res-label"],[1,"res-buttons"],[1,"res-btn",3,"click"],[1,"theme-section"],[3,"themeSelected","themes","currentTheme"],[3,"locationSelected"],[3,"distanceChange","distance"],[1,"actions-container"],[1,"action-btn","generate-btn","custom-btn","primary",3,"click","disabled"],[1,"spinner"],["d","M12 2a10 10 0 0 1 10 10c0 5.52-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16z"],["d","M12 6v6l4 2"],[1,"loading-content"],[1,"big-spinner"]],template:function(t,i){t&1&&(oe(0,"div",0)(1,"div",1),nt(2,"app-map-preview",2),he(),wt(3,Ty,34,18,"div",3),wt(4,Ry,7,5),wt(5,Oy,5,0,"div",4),nt(6,"app-toast-container"),he()),t&2&&(ae(2),gt("lat",i.lat())("lon",i.lon())("distance",i.distance()),ae(),bt(i.showPoster()?3:-1),ae(),bt(i.showPoster()?-1:4),ae(),bt(i.isLoading()&&!i.showPoster()?5:-1))},dependencies:[st,Fs,bo,pa,ga,ma,_a,va],styles:["[_nghost-%COMP%]{display:block;height:100vh;width:100vw;overflow:hidden;font-family:Inter,sans-serif;box-sizing:border-box;--primary-color: #6200ee;--accent-color: #03dac6;--bg-dark: #121212;--surface-glass: rgba(30, 30, 30, .85);--border-glass: rgba(255, 255, 255, .1);--text-primary: #ffffff;--text-secondary: #aaaaaa;--shadow-glass: 0 8px 32px 0 rgba(0, 0, 0, .37)}*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{box-sizing:border-box}.app-container[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;background:#121212}.map-layer[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.poster-layer[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:3000;background:#000;display:flex;flex-direction:row;overflow:hidden}.poster-preview-area[_ngcontent-%COMP%]{flex:1;height:100%;position:relative;display:flex;justify-content:center;align-items:center;padding:40px;background:radial-gradient(circle at center,#1a1a1a,#000);overflow:hidden}.poster-preview-area[_ngcontent-%COMP%]   app-poster-view[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.poster-preview-area[_ngcontent-%COMP%]   .close-poster-btn[_ngcontent-%COMP%]{position:absolute;top:20px;left:20px;background:#00000080;color:#fff;z-index:10}.poster-preview-area[_ngcontent-%COMP%]   .close-poster-btn[_ngcontent-%COMP%]:hover{background:#000c}.poster-sidebar[_ngcontent-%COMP%]{width:400px;height:100%;background:#18181b;border-left:1px solid rgba(255,255,255,.1);display:flex;flex-direction:column;padding:30px;box-shadow:-10px 0 30px #00000080;z-index:3002}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{margin-bottom:30px}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:700;color:#fff;letter-spacing:-.5px}.poster-sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#a1a1aa;font-size:1rem}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]{margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid rgba(255,255,255,.1)}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]{margin-top:15px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-label[_ngcontent-%COMP%]{display:block;color:#a1a1aa;font-size:.8rem;margin-bottom:8px;text-transform:uppercase;letter-spacing:1px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn[_ngcontent-%COMP%]{flex:1;padding:8px;border:1px solid rgba(255,255,255,.1);background:#ffffff0d;color:#d4d4d8;border-radius:8px;cursor:pointer;font-size:.9rem;transition:all .2s}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a}.poster-sidebar[_ngcontent-%COMP%]   .download-section[_ngcontent-%COMP%]   .resolution-options[_ngcontent-%COMP%]   .res-buttons[_ngcontent-%COMP%]   .res-btn.active[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;border-color:var(--primary-color);font-weight:600}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding-top:20px}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 15px;color:#d4d4d8;font-size:.85rem;text-transform:uppercase;letter-spacing:1.5px;font-weight:600}.poster-sidebar[_ngcontent-%COMP%]   .theme-section[_ngcontent-%COMP%]   app-sidebar-style-selector[_ngcontent-%COMP%]{flex:1;width:100%;height:100%;overflow:hidden}.full-width[_ngcontent-%COMP%]{width:100%;justify-content:center;padding:16px;font-size:1.1rem;font-weight:600;border-radius:12px}.actions-container[_ngcontent-%COMP%]{position:absolute;bottom:180px;right:20px;z-index:2000;display:flex;flex-direction:column;gap:15px}.action-btn[_ngcontent-%COMP%]{border:none;border-radius:30px;padding:12px 24px;display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:600;box-shadow:0 4px 10px #0000004d;transition:transform .2s,box-shadow .2s}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 15px #0006}.action-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.generate-btn[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;font-size:16px;padding:15px 30px}.custom-btn[_ngcontent-%COMP%]{border:none;border-radius:12px;padding:10px 20px;font-size:14px;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .2s;color:#fff;background:#ffffff1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.1)}.custom-btn[_ngcontent-%COMP%]:hover{background:#fff3;transform:translateY(-2px)}.custom-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.custom-btn.primary[_ngcontent-%COMP%]{background:var(--primary-color);box-shadow:0 4px 15px #6200ee66}.custom-btn.primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #6200ee99}.custom-btn.accent[_ngcontent-%COMP%]{background:var(--accent-color);color:#000;box-shadow:0 4px 15px #03dac666}.custom-btn.accent[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #03dac699}.custom-btn.icon-only[_ngcontent-%COMP%]{padding:10px;border-radius:50%;width:40px;height:40px;justify-content:center}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid rgba(255,255,255,.3);border-radius:50%;border-top-color:var(--primary-color);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}svg.icon[_ngcontent-%COMP%]{width:20px;height:20px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000000b3;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:5000;display:flex;justify-content:center;align-items:center}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;color:#fff}.loading-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:500;letter-spacing:.5px}.big-spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:5px solid rgba(255,255,255,.1);border-radius:50%;border-top-color:var(--primary-color);animation:_ngcontent-%COMP%_spin 1s ease-in-out infinite}"],changeDetection:0})};_l(ya,Zd).catch(r=>console.error(r));
